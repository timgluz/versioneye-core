<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Versioneye-core</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.10.0/application.js' type='text/javascript'></script>    
    <link href='./assets/0.10.0/application.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="./assets/0.10.0/favicon_red.png" />
    <link rel="icon" type="image/png" href="./assets/0.10.0/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.10.0/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2015-08-25T15:32:25+02:00">2015-08-25T15:32:25+02:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent"><span class="red">77.8%</span></span>
     covered at
     <span class="covered_strength">
       <span class="green">
         80.54
       </span>
    </span> hits/line)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>187</b> files in total.
    <b>10319</b> relevant lines. 
    <span class="green"><b>8028</b> lines covered</span> and
    <span class="red"><b>2291</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
        <th>Avg. Hits / Line</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td class="strong"><a href="#8de22b2521e1d8217ca696f8a17adb83f425c4db" class="src_link" title="lib/settings.rb">lib/settings.rb</a></td>
        <td class="red strong">70.73 %</td>
        <td>61</td>
        <td>41</td>
        <td>29</td>
        <td>12</td>
        <td>9.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#72d215bd0807aabfef41132ca2a471b2139da806" class="src_link" title="lib/versioneye-core.rb">lib/versioneye-core.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>111</td>
        <td>75</td>
        <td>60</td>
        <td>15</td>
        <td>0.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4d42772b7dde53052f9daac7ee64b8ca46bd86b3" class="src_link" title="lib/versioneye/cache.rb">lib/versioneye/cache.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>21</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>12.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#38e014306f3b91da32fb365bcffe50bd75adc7cc" class="src_link" title="lib/versioneye/log.rb">lib/versioneye/log.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>11</td>
        <td>11</td>
        <td>0</td>
        <td>64.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3e4a08b016cf3159779943ef66a9bcc1ac612a0e" class="src_link" title="lib/versioneye/mailers/feedback_mailer.rb">lib/versioneye/mailers/feedback_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>28</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#eb2e725298ec67394801f8269ecc54781cdf9dd3" class="src_link" title="lib/versioneye/mailers/newsletter_mailer.rb">lib/versioneye/mailers/newsletter_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>13</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>5.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#023ab62e3e733ba2cff1f1fe7e7fc3269b5bcb68" class="src_link" title="lib/versioneye/mailers/notification_mailer.rb">lib/versioneye/mailers/notification_mailer.rb</a></td>
        <td class="green strong">96.55 %</td>
        <td>48</td>
        <td>29</td>
        <td>28</td>
        <td>1</td>
        <td>4.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fe6e1eed1d7e2bd697acb4c227f60661908d2b7e" class="src_link" title="lib/versioneye/mailers/project_mailer.rb">lib/versioneye/mailers/project_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>48</td>
        <td>30</td>
        <td>30</td>
        <td>0</td>
        <td>3.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#bfd7fc7c224a881aaffe4477f61b87fb348b16a3" class="src_link" title="lib/versioneye/mailers/receipt_mailer.rb">lib/versioneye/mailers/receipt_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>1.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0509c8d9f5d3659370f504f4f2cb75c767e55ef5" class="src_link" title="lib/versioneye/mailers/submitted_url_mailer.rb">lib/versioneye/mailers/submitted_url_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>47</td>
        <td>28</td>
        <td>28</td>
        <td>0</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#44774af43b6a278b3610b6dd58c2b8a321efed46" class="src_link" title="lib/versioneye/mailers/subscription_mailer.rb">lib/versioneye/mailers/subscription_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>13</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d7b82867188f8e81f2a246ef772f3952f8a021e6" class="src_link" title="lib/versioneye/mailers/super_mailer.rb">lib/versioneye/mailers/super_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>13</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>13.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6a8ea20f1337ab167e2d7857113339d799b3bf20" class="src_link" title="lib/versioneye/mailers/user_mailer.rb">lib/versioneye/mailers/user_mailer.rb</a></td>
        <td class="green strong">97.47 %</td>
        <td>132</td>
        <td>79</td>
        <td>77</td>
        <td>2</td>
        <td>1.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2bb780a60770e9ad826e43b01540d12dc2a635e2" class="src_link" title="lib/versioneye/mailers/versioncomment_mailer.rb">lib/versioneye/mailers/versioncomment_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>9</td>
        <td>9</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b929e942cca642e06ccd772d9a589327681783f2" class="src_link" title="lib/versioneye/mailers/versioncommentreply_mailer.rb">lib/versioneye/mailers/versioncommentreply_mailer.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>17</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c1fe53b47042c688a278b2e829d68590fb5cee43" class="src_link" title="lib/versioneye/migrations/product_migration.rb">lib/versioneye/migrations/product_migration.rb</a></td>
        <td class="red strong">7.25 %</td>
        <td>105</td>
        <td>69</td>
        <td>5</td>
        <td>64</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d3a533b7f00f817eb42d311e2fffeab4c70fa4d2" class="src_link" title="lib/versioneye/migrations/versionlink_migration.rb">lib/versioneye/migrations/versionlink_migration.rb</a></td>
        <td class="red strong">16.67 %</td>
        <td>23</td>
        <td>12</td>
        <td>2</td>
        <td>10</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#899e17f2290a455de390e246dc98fb3bb64043ab" class="src_link" title="lib/versioneye/model.rb">lib/versioneye/model.rb</a></td>
        <td class="green strong">98.59 %</td>
        <td>82</td>
        <td>71</td>
        <td>70</td>
        <td>1</td>
        <td>6.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#edafa99c889264bcc5e6c6c365192c9e9b1be157" class="src_link" title="lib/versioneye/models/api.rb">lib/versioneye/models/api.rb</a></td>
        <td class="green strong">95.83 %</td>
        <td>40</td>
        <td>24</td>
        <td>23</td>
        <td>1</td>
        <td>1.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0c1599be28cdd40452e478b5ab47ce7adc6b9cd3" class="src_link" title="lib/versioneye/models/api_call.rb">lib/versioneye/models/api_call.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>21</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1b9fb2fc87ff69e72a85022c2c6ffbe188a1b514" class="src_link" title="lib/versioneye/models/auditlog.rb">lib/versioneye/models/auditlog.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>30</td>
        <td>18</td>
        <td>18</td>
        <td>0</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d3138a7cdfad6bc11650544ad33e59c00971dc55" class="src_link" title="lib/versioneye/models/author.rb">lib/versioneye/models/author.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>89</td>
        <td>53</td>
        <td>53</td>
        <td>0</td>
        <td>3.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#eb41db192947905ae88cb5a152eee1efdfcd6155" class="src_link" title="lib/versioneye/models/badge.rb">lib/versioneye/models/badge.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>48</td>
        <td>26</td>
        <td>26</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#03b26ab8aaf34204439416be3ab8dc9a8a8f455e" class="src_link" title="lib/versioneye/models/billing_address.rb">lib/versioneye/models/billing_address.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>86</td>
        <td>58</td>
        <td>58</td>
        <td>0</td>
        <td>3.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e5b70b200c3cece08da1c44c1cb0ca9a70827448" class="src_link" title="lib/versioneye/models/bitbucket_repo.rb">lib/versioneye/models/bitbucket_repo.rb</a></td>
        <td class="green strong">92.86 %</td>
        <td>96</td>
        <td>56</td>
        <td>52</td>
        <td>4</td>
        <td>3.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#11102434ee95117740b3d86023b6aff4db14a9ad" class="src_link" title="lib/versioneye/models/circle_element.rb">lib/versioneye/models/circle_element.rb</a></td>
        <td class="red strong">47.83 %</td>
        <td>78</td>
        <td>46</td>
        <td>22</td>
        <td>24</td>
        <td>0.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ff0c0e5b70d8a9855a6f28e95bac1eb8c0f4c278" class="src_link" title="lib/versioneye/models/crawle.rb">lib/versioneye/models/crawle.rb</a></td>
        <td class="yellow strong">85.71 %</td>
        <td>23</td>
        <td>14</td>
        <td>12</td>
        <td>2</td>
        <td>0.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cba135c1dee484db519649b5af3fc919debbb39f" class="src_link" title="lib/versioneye/models/crawler_task.rb">lib/versioneye/models/crawler_task.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>35</td>
        <td>29</td>
        <td>29</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#beed9800feb24c05e5198895ff68c8d24b1ddfd5" class="src_link" title="lib/versioneye/models/dependency.rb">lib/versioneye/models/dependency.rb</a></td>
        <td class="yellow strong">88.78 %</td>
        <td>171</td>
        <td>98</td>
        <td>87</td>
        <td>11</td>
        <td>6.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0ad029cc46fda94f1e8c92b697ed5af7c2c3dc0d" class="src_link" title="lib/versioneye/models/developer.rb">lib/versioneye/models/developer.rb</a></td>
        <td class="green strong">91.67 %</td>
        <td>67</td>
        <td>36</td>
        <td>33</td>
        <td>3</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1c20423c8157b9b4984aacd1d05be125e30465cd" class="src_link" title="lib/versioneye/models/docker_image.rb">lib/versioneye/models/docker_image.rb</a></td>
        <td class="red strong">69.23 %</td>
        <td>24</td>
        <td>13</td>
        <td>9</td>
        <td>4</td>
        <td>0.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#53f3f213481726164b9199f3c06cb0d1873765e0" class="src_link" title="lib/versioneye/models/email_setting.rb">lib/versioneye/models/email_setting.rb</a></td>
        <td class="red strong">58.33 %</td>
        <td>47</td>
        <td>36</td>
        <td>21</td>
        <td>15</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9aeaceafa0a546ea2a02d39f7008f6209b0168e3" class="src_link" title="lib/versioneye/models/enterprise_lead.rb">lib/versioneye/models/enterprise_lead.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>21</td>
        <td>16</td>
        <td>16</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9af0f473c2bb5522412268801f84d2f3fd87271b" class="src_link" title="lib/versioneye/models/error_message.rb">lib/versioneye/models/error_message.rb</a></td>
        <td class="red strong">72.73 %</td>
        <td>18</td>
        <td>11</td>
        <td>8</td>
        <td>3</td>
        <td>0.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d6130675591330a039c04b44388f106d99711b60" class="src_link" title="lib/versioneye/models/event.rb">lib/versioneye/models/event.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>21</td>
        <td>14</td>
        <td>14</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#46ce6b00660e3c5cb05a02e26fed207e78ddba8f" class="src_link" title="lib/versioneye/models/github_repo.rb">lib/versioneye/models/github_repo.rb</a></td>
        <td class="red strong">61.64 %</td>
        <td>131</td>
        <td>73</td>
        <td>45</td>
        <td>28</td>
        <td>0.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#496423b99000756b5af4682ea45445866d628b56" class="src_link" title="lib/versioneye/models/global_setting.rb">lib/versioneye/models/global_setting.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>59</td>
        <td>30</td>
        <td>30</td>
        <td>0</td>
        <td>6.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#888894a0292ed0ef171cdae7dc510a2c8d53fe00" class="src_link" title="lib/versioneye/models/helpers/billing_types.rb">lib/versioneye/models/helpers/billing_types.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>8</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#02ab1528e1f252b8ff975cf27817b44ec27fa1b6" class="src_link" title="lib/versioneye/models/helpers/countries.rb">lib/versioneye/models/helpers/countries.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>288</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9c40a0c2d82cfd81b6f4c41f965931058b6a4cb6" class="src_link" title="lib/versioneye/models/helpers/indexer.rb">lib/versioneye/models/helpers/indexer.rb</a></td>
        <td class="red strong">17.39 %</td>
        <td>42</td>
        <td>23</td>
        <td>4</td>
        <td>19</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7fd565cb281cd0c8d94146b809af1170a74c6fdf" class="src_link" title="lib/versioneye/models/helpers/product_constants.rb">lib/versioneye/models/helpers/product_constants.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>43</td>
        <td>29</td>
        <td>29</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ac748934104b8bbda9a806696b8f2fce1f6edca8" class="src_link" title="lib/versioneye/models/helpers/product_es_mapping.rb">lib/versioneye/models/helpers/product_es_mapping.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>21</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
        <td>64.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7aa103ab34341ef7ca4233bf944da48cdb2a2c59" class="src_link" title="lib/versioneye/models/json_cache.rb">lib/versioneye/models/json_cache.rb</a></td>
        <td class="yellow strong">81.82 %</td>
        <td>20</td>
        <td>11</td>
        <td>9</td>
        <td>2</td>
        <td>0.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b9eac2c77932cb445c225c5e86db6cdf72abd1a0" class="src_link" title="lib/versioneye/models/language.rb">lib/versioneye/models/language.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>26</td>
        <td>19</td>
        <td>19</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5ec97d42c114b8824d91cb4900fbd7386de704ac" class="src_link" title="lib/versioneye/models/language_daily_stats.rb">lib/versioneye/models/language_daily_stats.rb</a></td>
        <td class="red strong">72.57 %</td>
        <td>375</td>
        <td>226</td>
        <td>164</td>
        <td>62</td>
        <td>332.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5ee86d8678ba6d12cf858ca59ec68eaf1ae689fe" class="src_link" title="lib/versioneye/models/language_feed.rb">lib/versioneye/models/language_feed.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>7</td>
        <td>7</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c79d52dd469cc4484235165c4fd0a3e89aab8de5" class="src_link" title="lib/versioneye/models/license.rb">lib/versioneye/models/license.rb</a></td>
        <td class="green strong">94.87 %</td>
        <td>68</td>
        <td>39</td>
        <td>37</td>
        <td>2</td>
        <td>84.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0138d5a81f5498e655410a3ebd795a42abeeb5f0" class="src_link" title="lib/versioneye/models/license_cach.rb">lib/versioneye/models/license_cach.rb</a></td>
        <td class="red strong">78.57 %</td>
        <td>30</td>
        <td>14</td>
        <td>11</td>
        <td>3</td>
        <td>0.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#91e16f33fd85cb1975f0855628f9e95675d8da29" class="src_link" title="lib/versioneye/models/license_element.rb">lib/versioneye/models/license_element.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>23</td>
        <td>12</td>
        <td>12</td>
        <td>0</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8c332ea066030e0f806429a04892c7053fa9a11e" class="src_link" title="lib/versioneye/models/license_whitelist.rb">lib/versioneye/models/license_whitelist.rb</a></td>
        <td class="green strong">95.45 %</td>
        <td>80</td>
        <td>44</td>
        <td>42</td>
        <td>2</td>
        <td>6.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#23361090e59b1322605ea926f2f57d6c4ea69546" class="src_link" title="lib/versioneye/models/lottery.rb">lib/versioneye/models/lottery.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>15</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d3c00abd5ace6ca87cd93632da190ca696796337" class="src_link" title="lib/versioneye/models/mail_track.rb">lib/versioneye/models/mail_track.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>37</td>
        <td>22</td>
        <td>22</td>
        <td>0</td>
        <td>5.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cefe91e961cc1230686528a47b0078bcc3822cb7" class="src_link" title="lib/versioneye/models/maven_repository.rb">lib/versioneye/models/maven_repository.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>78</td>
        <td>61</td>
        <td>61</td>
        <td>0</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1a9196178742d49e99f1a14c71f57e868ea1b351" class="src_link" title="lib/versioneye/models/newest.rb">lib/versioneye/models/newest.rb</a></td>
        <td class="red strong">69.57 %</td>
        <td>78</td>
        <td>46</td>
        <td>32</td>
        <td>14</td>
        <td>8.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2700fd92476583699ffb94dfa7eb7b085b2e258b" class="src_link" title="lib/versioneye/models/notification.rb">lib/versioneye/models/notification.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>31</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>2.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#42d1e4a532dc77b4a964acc7f62c4ba8fe85d9ed" class="src_link" title="lib/versioneye/models/np_domain.rb">lib/versioneye/models/np_domain.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>16</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cba4aaf031294928ea76d3c98cab92e9e03e4e26" class="src_link" title="lib/versioneye/models/plan.rb">lib/versioneye/models/plan.rb</a></td>
        <td class="green strong">97.47 %</td>
        <td>110</td>
        <td>79</td>
        <td>77</td>
        <td>2</td>
        <td>30.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fd509f5886246c44429996c26313ae984b665e44" class="src_link" title="lib/versioneye/models/pom.rb">lib/versioneye/models/pom.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>12</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1b18e55b1ef66475a870c13e5b27792824ed19db" class="src_link" title="lib/versioneye/models/product.rb">lib/versioneye/models/product.rb</a></td>
        <td class="yellow strong">81.82 %</td>
        <td>440</td>
        <td>264</td>
        <td>216</td>
        <td>48</td>
        <td>382.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8f2c3d318556ca07471888079f4ace34f66f75c6" class="src_link" title="lib/versioneye/models/product_resource.rb">lib/versioneye/models/product_resource.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>25</td>
        <td>17</td>
        <td>17</td>
        <td>0</td>
        <td>1.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#89faec3d7f4ec2f99eadb2ad85cf181e73c37956" class="src_link" title="lib/versioneye/models/project.rb">lib/versioneye/models/project.rb</a></td>
        <td class="green strong">91.27 %</td>
        <td>374</td>
        <td>252</td>
        <td>230</td>
        <td>22</td>
        <td>25.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a00c77a74d497434e29c9e298d34b85d2c6a3e37" class="src_link" title="lib/versioneye/models/project_collaborator.rb">lib/versioneye/models/project_collaborator.rb</a></td>
        <td class="green strong">95.65 %</td>
        <td>78</td>
        <td>46</td>
        <td>44</td>
        <td>2</td>
        <td>2.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0528ea7a38d4aa0d1e641620e1a734c08e090f5a" class="src_link" title="lib/versioneye/models/projectdependency.rb">lib/versioneye/models/projectdependency.rb</a></td>
        <td class="yellow strong">87.8 %</td>
        <td>151</td>
        <td>82</td>
        <td>72</td>
        <td>10</td>
        <td>448.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0c77504b43f6a03eeb0ade7e09d20a9b6c656e5c" class="src_link" title="lib/versioneye/models/promo_code.rb">lib/versioneye/models/promo_code.rb</a></td>
        <td class="green strong">94.12 %</td>
        <td>30</td>
        <td>17</td>
        <td>16</td>
        <td>1</td>
        <td>1.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f399c88f997c0c173b9fd8ccc9c62eadca2a6a19" class="src_link" title="lib/versioneye/models/receipt.rb">lib/versioneye/models/receipt.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>147</td>
        <td>96</td>
        <td>96</td>
        <td>0</td>
        <td>6.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3c84e131050bbea0205cd36330722ba228fca841" class="src_link" title="lib/versioneye/models/receipt_line.rb">lib/versioneye/models/receipt_line.rb</a></td>
        <td class="green strong">97.14 %</td>
        <td>56</td>
        <td>35</td>
        <td>34</td>
        <td>1</td>
        <td>6.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c877b70ccf8e5d7da67a00e35b0162ddf57c7e5a" class="src_link" title="lib/versioneye/models/refer.rb">lib/versioneye/models/refer.rb</a></td>
        <td class="yellow strong">87.5 %</td>
        <td>14</td>
        <td>8</td>
        <td>7</td>
        <td>1</td>
        <td>0.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b7726256052254183930921d29ba050d8c8ed302" class="src_link" title="lib/versioneye/models/reference.rb">lib/versioneye/models/reference.rb</a></td>
        <td class="yellow strong">89.29 %</td>
        <td>46</td>
        <td>28</td>
        <td>25</td>
        <td>3</td>
        <td>1.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b69c26f3fc048bc4a666d474c1dade0b241d651c" class="src_link" title="lib/versioneye/models/repository.rb">lib/versioneye/models/repository.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>22</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2bc26067e033f0846af8c482c45fd811b16c4b9f" class="src_link" title="lib/versioneye/models/searchlog.rb">lib/versioneye/models/searchlog.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>10</td>
        <td>6</td>
        <td>6</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f8f18fae8481e687304ab23c9746bf443982a84d" class="src_link" title="lib/versioneye/models/security_vulnerability.rb">lib/versioneye/models/security_vulnerability.rb</a></td>
        <td class="green strong">93.75 %</td>
        <td>29</td>
        <td>16</td>
        <td>15</td>
        <td>1</td>
        <td>0.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#48f8f17eca631f72f10e3a36d80e60f5ba710c80" class="src_link" title="lib/versioneye/models/spdx_license.rb">lib/versioneye/models/spdx_license.rb</a></td>
        <td class="green strong">95.0 %</td>
        <td>36</td>
        <td>20</td>
        <td>19</td>
        <td>1</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5451b27ce4621ac91d4e4071115b74fa94e4b978" class="src_link" title="lib/versioneye/models/stash_repo.rb">lib/versioneye/models/stash_repo.rb</a></td>
        <td class="red strong">66.67 %</td>
        <td>54</td>
        <td>30</td>
        <td>20</td>
        <td>10</td>
        <td>0.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b4ffb808ecc8336414da7a8ca11a2c0ad3768200" class="src_link" title="lib/versioneye/models/submitted_url.rb">lib/versioneye/models/submitted_url.rb</a></td>
        <td class="green strong">95.45 %</td>
        <td>68</td>
        <td>44</td>
        <td>42</td>
        <td>2</td>
        <td>1.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#88c52b660124e90eb1f5f41c914ea169446c677b" class="src_link" title="lib/versioneye/models/traits/license_normalizer.rb">lib/versioneye/models/traits/license_normalizer.rb</a></td>
        <td class="green strong">98.66 %</td>
        <td>1150</td>
        <td>598</td>
        <td>590</td>
        <td>8</td>
        <td>603.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#75b41b339787ac7b57b2faed77ecdd933d909bd3" class="src_link" title="lib/versioneye/models/user.rb">lib/versioneye/models/user.rb</a></td>
        <td class="red strong">80.0 %</td>
        <td>514</td>
        <td>325</td>
        <td>260</td>
        <td>65</td>
        <td>52.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ca793d36e9f1fa01b13db7ded8f091c9a39e9939" class="src_link" title="lib/versioneye/models/user_email.rb">lib/versioneye/models/user_email.rb</a></td>
        <td class="green strong">94.59 %</td>
        <td>62</td>
        <td>37</td>
        <td>35</td>
        <td>2</td>
        <td>2.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#467613ccef531012164eaa2a4eee73b1a29d1b7f" class="src_link" title="lib/versioneye/models/user_notification_setting.rb">lib/versioneye/models/user_notification_setting.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>30</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>7.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f8c9a3acd0a75b4a0e3184cdd3f8d0bf95b91e82" class="src_link" title="lib/versioneye/models/user_permission.rb">lib/versioneye/models/user_permission.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>10</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8330f6a9e7856e62decb02126bca9545522efa38" class="src_link" title="lib/versioneye/models/userlinkcollection.rb">lib/versioneye/models/userlinkcollection.rb</a></td>
        <td class="red strong">72.55 %</td>
        <td>80</td>
        <td>51</td>
        <td>37</td>
        <td>14</td>
        <td>0.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5e32c59ab812242dcba33b7feecc0872e66717d3" class="src_link" title="lib/versioneye/models/version.rb">lib/versioneye/models/version.rb</a></td>
        <td class="green strong">90.91 %</td>
        <td>58</td>
        <td>33</td>
        <td>30</td>
        <td>3</td>
        <td>1406.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5616fd91f22d64bb04ed7dc5ec5fa37c81b3b8eb" class="src_link" title="lib/versioneye/models/versionarchive.rb">lib/versioneye/models/versionarchive.rb</a></td>
        <td class="green strong">97.44 %</td>
        <td>78</td>
        <td>39</td>
        <td>38</td>
        <td>1</td>
        <td>48.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#13c5870d74a8bf84cd50757161b62ba895ec7fc4" class="src_link" title="lib/versioneye/models/versioncomment.rb">lib/versioneye/models/versioncomment.rb</a></td>
        <td class="yellow strong">82.0 %</td>
        <td>86</td>
        <td>50</td>
        <td>41</td>
        <td>9</td>
        <td>0.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#884b3f03d589017d41fc7a34eae0ff71a6551c89" class="src_link" title="lib/versioneye/models/versioncommentreply.rb">lib/versioneye/models/versioncommentreply.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>13</td>
        <td>8</td>
        <td>8</td>
        <td>0</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#266fb694a7bf8d3a3e1ef67a5c66146249b4e134" class="src_link" title="lib/versioneye/models/versionlink.rb">lib/versioneye/models/versionlink.rb</a></td>
        <td class="yellow strong">88.46 %</td>
        <td>113</td>
        <td>52</td>
        <td>46</td>
        <td>6</td>
        <td>236.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5352c762589de20e3f2415e8dac047dbf9b979c5" class="src_link" title="lib/versioneye/package_managers/cocoapods_package_manager.rb">lib/versioneye/package_managers/cocoapods_package_manager.rb</a></td>
        <td class="yellow strong">80.3 %</td>
        <td>168</td>
        <td>66</td>
        <td>53</td>
        <td>13</td>
        <td>9.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#506d9bf1116f7e1362d5ab8588f0199d0b0b7111" class="src_link" title="lib/versioneye/package_managers/package_manager.rb">lib/versioneye/package_managers/package_manager.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>12</td>
        <td>6</td>
        <td>5</td>
        <td>1</td>
        <td>0.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#638310afdb028104c8819a41d72296ed1427224a" class="src_link" title="lib/versioneye/parsers/biicode_parser.rb">lib/versioneye/parsers/biicode_parser.rb</a></td>
        <td class="green strong">90.36 %</td>
        <td>131</td>
        <td>83</td>
        <td>75</td>
        <td>8</td>
        <td>6.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8402e1c9f574b88fbf80cf9cdf43e967f966e4e0" class="src_link" title="lib/versioneye/parsers/bower_parser.rb">lib/versioneye/parsers/bower_parser.rb</a></td>
        <td class="yellow strong">89.47 %</td>
        <td>94</td>
        <td>57</td>
        <td>51</td>
        <td>6</td>
        <td>3.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3b1922ecd6e540ba36fb469ab5d5e1bbf7585095" class="src_link" title="lib/versioneye/parsers/common_parser.rb">lib/versioneye/parsers/common_parser.rb</a></td>
        <td class="red strong">67.74 %</td>
        <td>79</td>
        <td>31</td>
        <td>21</td>
        <td>10</td>
        <td>59.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b5086992824ab799b3a0b330845d5ca275483b47" class="src_link" title="lib/versioneye/parsers/composer_lock_parser.rb">lib/versioneye/parsers/composer_lock_parser.rb</a></td>
        <td class="green strong">93.75 %</td>
        <td>81</td>
        <td>48</td>
        <td>45</td>
        <td>3</td>
        <td>6.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#92d1bfd6f2da70e4f32f3480c249c20d3b6ca11b" class="src_link" title="lib/versioneye/parsers/composer_parser.rb">lib/versioneye/parsers/composer_parser.rb</a></td>
        <td class="yellow strong">85.33 %</td>
        <td>310</td>
        <td>184</td>
        <td>157</td>
        <td>27</td>
        <td>13.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#41e9f86a47a1d2716e800b4e51efb0920e3da82e" class="src_link" title="lib/versioneye/parsers/gemfile_parser.rb">lib/versioneye/parsers/gemfile_parser.rb</a></td>
        <td class="yellow strong">89.31 %</td>
        <td>237</td>
        <td>159</td>
        <td>142</td>
        <td>17</td>
        <td>111.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#60b0c89797783d0a154c52eb972c36500e262235" class="src_link" title="lib/versioneye/parsers/gemfilelock_parser.rb">lib/versioneye/parsers/gemfilelock_parser.rb</a></td>
        <td class="yellow strong">87.76 %</td>
        <td>79</td>
        <td>49</td>
        <td>43</td>
        <td>6</td>
        <td>102.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#27cfb10e2a35b1d64c5b5c929fcc9b449770068c" class="src_link" title="lib/versioneye/parsers/gradle_parser.rb">lib/versioneye/parsers/gradle_parser.rb</a></td>
        <td class="yellow strong">85.53 %</td>
        <td>326</td>
        <td>152</td>
        <td>130</td>
        <td>22</td>
        <td>32.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6a5431b23e0ce68ae6031c040234c40ec8077833" class="src_link" title="lib/versioneye/parsers/lein_parser.rb">lib/versioneye/parsers/lein_parser.rb</a></td>
        <td class="red strong">70.83 %</td>
        <td>126</td>
        <td>72</td>
        <td>51</td>
        <td>21</td>
        <td>7.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0124750f369dd1868bd914fa2985de481e68cbff" class="src_link" title="lib/versioneye/parsers/package_parser.rb">lib/versioneye/parsers/package_parser.rb</a></td>
        <td class="green strong">91.63 %</td>
        <td>310</td>
        <td>203</td>
        <td>186</td>
        <td>17</td>
        <td>18.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e559a75d640bebad507f275c9f279bc207e668b8" class="src_link" title="lib/versioneye/parsers/parser_strategy.rb">lib/versioneye/parsers/parser_strategy.rb</a></td>
        <td class="yellow strong">88.46 %</td>
        <td>65</td>
        <td>26</td>
        <td>23</td>
        <td>3</td>
        <td>8.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a75811ad5875645520d9a52f6da6524c3117b0e1" class="src_link" title="lib/versioneye/parsers/podfile_parser.rb">lib/versioneye/parsers/podfile_parser.rb</a></td>
        <td class="yellow strong">82.72 %</td>
        <td>166</td>
        <td>81</td>
        <td>67</td>
        <td>14</td>
        <td>33.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e8ceb1f95691f0cf4bb60063116ea5acd7cd93c8" class="src_link" title="lib/versioneye/parsers/podfilelock_parser.rb">lib/versioneye/parsers/podfilelock_parser.rb</a></td>
        <td class="green strong">95.45 %</td>
        <td>129</td>
        <td>66</td>
        <td>63</td>
        <td>3</td>
        <td>8.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#95b728c17ade6748fb240506fc3d0787187354de" class="src_link" title="lib/versioneye/parsers/pom_json_parser.rb">lib/versioneye/parsers/pom_json_parser.rb</a></td>
        <td class="green strong">93.33 %</td>
        <td>62</td>
        <td>45</td>
        <td>42</td>
        <td>3</td>
        <td>13.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e5d3ca3821ff945a4bfbdb0bd7cac3cc8c4c8c9a" class="src_link" title="lib/versioneye/parsers/pom_parser.rb">lib/versioneye/parsers/pom_parser.rb</a></td>
        <td class="green strong">94.06 %</td>
        <td>155</td>
        <td>101</td>
        <td>95</td>
        <td>6</td>
        <td>66.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#22c48755ea26765c55db3bda56cccde804a4512a" class="src_link" title="lib/versioneye/parsers/python_setup_parser.rb">lib/versioneye/parsers/python_setup_parser.rb</a></td>
        <td class="yellow strong">89.09 %</td>
        <td>108</td>
        <td>55</td>
        <td>49</td>
        <td>6</td>
        <td>8.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e87584721b5033c3b1861d811a02715fc28f6fe4" class="src_link" title="lib/versioneye/parsers/requirements_parser.rb">lib/versioneye/parsers/requirements_parser.rb</a></td>
        <td class="red strong">70.86 %</td>
        <td>241</td>
        <td>151</td>
        <td>107</td>
        <td>44</td>
        <td>44.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#dde175fb037c3ddb9fc7bb8e4c3bfba9bf4c9134" class="src_link" title="lib/versioneye/parsers/sbt_parser.rb">lib/versioneye/parsers/sbt_parser.rb</a></td>
        <td class="green strong">91.21 %</td>
        <td>169</td>
        <td>91</td>
        <td>83</td>
        <td>8</td>
        <td>24.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5bd0c34ee50d67af59eebb5365f47bbf26d179bd" class="src_link" title="lib/versioneye/producers/common_producer.rb">lib/versioneye/producers/common_producer.rb</a></td>
        <td class="yellow strong">84.62 %</td>
        <td>22</td>
        <td>13</td>
        <td>11</td>
        <td>2</td>
        <td>1.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9ce03bb180842a21b9ebde87f35447384c16e225" class="src_link" title="lib/versioneye/producers/dependency_badge_producer.rb">lib/versioneye/producers/dependency_badge_producer.rb</a></td>
        <td class="yellow strong">84.62 %</td>
        <td>22</td>
        <td>13</td>
        <td>11</td>
        <td>2</td>
        <td>0.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cea85302e238fc64f2313a38e3c6d6d3a3cbbcdb" class="src_link" title="lib/versioneye/producers/git_repo_file_import_producer.rb">lib/versioneye/producers/git_repo_file_import_producer.rb</a></td>
        <td class="yellow strong">84.62 %</td>
        <td>24</td>
        <td>13</td>
        <td>11</td>
        <td>2</td>
        <td>2.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#92afb2ac2b69228409c500ff80deb03a05e55d65" class="src_link" title="lib/versioneye/producers/git_repo_import_producer.rb">lib/versioneye/producers/git_repo_import_producer.rb</a></td>
        <td class="red strong">15.38 %</td>
        <td>24</td>
        <td>13</td>
        <td>2</td>
        <td>11</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#1a2a098df89aaadeca68a688356e7cd8d76c1722" class="src_link" title="lib/versioneye/producers/git_repos_import_producer.rb">lib/versioneye/producers/git_repos_import_producer.rb</a></td>
        <td class="red strong">15.38 %</td>
        <td>24</td>
        <td>13</td>
        <td>2</td>
        <td>11</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8b2c4799274c3c11c21d9b578764e956fc79d3a2" class="src_link" title="lib/versioneye/producers/language_daily_stats_producer.rb">lib/versioneye/producers/language_daily_stats_producer.rb</a></td>
        <td class="red strong">15.38 %</td>
        <td>22</td>
        <td>13</td>
        <td>2</td>
        <td>11</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#7665c375e6802c2b5cc9f165ec996e041d68b7b9" class="src_link" title="lib/versioneye/producers/process_receipts_producer.rb">lib/versioneye/producers/process_receipts_producer.rb</a></td>
        <td class="red strong">15.38 %</td>
        <td>22</td>
        <td>13</td>
        <td>2</td>
        <td>11</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d7057aae748271e96c1a247f66d75b4f540318c4" class="src_link" title="lib/versioneye/producers/producer.rb">lib/versioneye/producers/producer.rb</a></td>
        <td class="red strong">76.92 %</td>
        <td>26</td>
        <td>13</td>
        <td>10</td>
        <td>3</td>
        <td>3.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0605095f2ffc99a4e014ccdc51f681125fd28581" class="src_link" title="lib/versioneye/producers/project_update_producer.rb">lib/versioneye/producers/project_update_producer.rb</a></td>
        <td class="yellow strong">84.62 %</td>
        <td>22</td>
        <td>13</td>
        <td>11</td>
        <td>2</td>
        <td>3.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#97e95c4b38562b84324cf94a62ca232533f9832e" class="src_link" title="lib/versioneye/producers/send_notification_emails_producer.rb">lib/versioneye/producers/send_notification_emails_producer.rb</a></td>
        <td class="red strong">15.38 %</td>
        <td>22</td>
        <td>13</td>
        <td>2</td>
        <td>11</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ef099a0fa570192b919614b0d9ba466c08a0ec2f" class="src_link" title="lib/versioneye/producers/sync_producer.rb">lib/versioneye/producers/sync_producer.rb</a></td>
        <td class="red strong">15.38 %</td>
        <td>24</td>
        <td>13</td>
        <td>2</td>
        <td>11</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#449fcacc6fef587831747f821a6c3573486f7f27" class="src_link" title="lib/versioneye/producers/update_index_producer.rb">lib/versioneye/producers/update_index_producer.rb</a></td>
        <td class="red strong">15.38 %</td>
        <td>22</td>
        <td>13</td>
        <td>2</td>
        <td>11</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a35868840e0ce2646fffaabd028a6bc1bb7d7200" class="src_link" title="lib/versioneye/producers/update_meta_data_producer.rb">lib/versioneye/producers/update_meta_data_producer.rb</a></td>
        <td class="red strong">15.38 %</td>
        <td>22</td>
        <td>13</td>
        <td>2</td>
        <td>11</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#25d98efada6fc761af2b08f0acab768f412d3b95" class="src_link" title="lib/versioneye/remote_api/me_client.rb">lib/versioneye/remote_api/me_client.rb</a></td>
        <td class="red strong">73.33 %</td>
        <td>28</td>
        <td>15</td>
        <td>11</td>
        <td>4</td>
        <td>1.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c43a76cdd611fe258f2ce58b489e976cc701c6a8" class="src_link" title="lib/versioneye/remote_api/product_client.rb">lib/versioneye/remote_api/product_client.rb</a></td>
        <td class="yellow strong">86.21 %</td>
        <td>51</td>
        <td>29</td>
        <td>25</td>
        <td>4</td>
        <td>60.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#63061edb23a391cb1afeebf41427286d1c6e9157" class="src_link" title="lib/versioneye/service.rb">lib/versioneye/service.rb</a></td>
        <td class="green strong">96.88 %</td>
        <td>154</td>
        <td>128</td>
        <td>124</td>
        <td>4</td>
        <td>3.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e4df02add37c24e49c4f793d1575e267138ea7df" class="src_link" title="lib/versioneye/services/admin_service.rb">lib/versioneye/services/admin_service.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>11</td>
        <td>5</td>
        <td>5</td>
        <td>0</td>
        <td>1.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#3f83b7ead3f1f187d31697a3396095f253205294" class="src_link" title="lib/versioneye/services/analytics_service.rb">lib/versioneye/services/analytics_service.rb</a></td>
        <td class="red strong">25.0 %</td>
        <td>72</td>
        <td>24</td>
        <td>6</td>
        <td>18</td>
        <td>0.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9d3d9b7319d56df873564d203bf58576c0bf456b" class="src_link" title="lib/versioneye/services/author_service.rb">lib/versioneye/services/author_service.rb</a></td>
        <td class="green strong">98.0 %</td>
        <td>90</td>
        <td>50</td>
        <td>49</td>
        <td>1</td>
        <td>3.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#83b090d0db6e7ac415e577269b2823d4f20ae8ba" class="src_link" title="lib/versioneye/services/badge_ref_service.rb">lib/versioneye/services/badge_ref_service.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>45</td>
        <td>28</td>
        <td>28</td>
        <td>0</td>
        <td>1.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cd06526fd9398de7d4ada659cf7d58b6a832e5e3" class="src_link" title="lib/versioneye/services/badge_service.rb">lib/versioneye/services/badge_service.rb</a></td>
        <td class="green strong">97.5 %</td>
        <td>116</td>
        <td>80</td>
        <td>78</td>
        <td>2</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#01a736e8c7eac96ef0660340c5fdcd6c788c4361" class="src_link" title="lib/versioneye/services/bitbucket_service.rb">lib/versioneye/services/bitbucket_service.rb</a></td>
        <td class="red strong">45.24 %</td>
        <td>140</td>
        <td>84</td>
        <td>38</td>
        <td>46</td>
        <td>0.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#db23610fcc2f6aad9e36f486f439287afc11413c" class="src_link" title="lib/versioneye/services/circle_element_service.rb">lib/versioneye/services/circle_element_service.rb</a></td>
        <td class="red strong">43.62 %</td>
        <td>129</td>
        <td>94</td>
        <td>41</td>
        <td>53</td>
        <td>0.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8d6c58693e33c375534ca6ea347f9a0aca97f28d" class="src_link" title="lib/versioneye/services/dependency_service.rb">lib/versioneye/services/dependency_service.rb</a></td>
        <td class="red strong">65.09 %</td>
        <td>175</td>
        <td>106</td>
        <td>69</td>
        <td>37</td>
        <td>6.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a5e5b8c1cf313ba57809bb745d724fae79257d26" class="src_link" title="lib/versioneye/services/email_setting_service.rb">lib/versioneye/services/email_setting_service.rb</a></td>
        <td class="yellow strong">88.24 %</td>
        <td>28</td>
        <td>17</td>
        <td>15</td>
        <td>2</td>
        <td>2.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ef61b5f38ea512d60d50ac0278a1333c7a304a7a" class="src_link" title="lib/versioneye/services/enterprise_service.rb">lib/versioneye/services/enterprise_service.rb</a></td>
        <td class="yellow strong">86.36 %</td>
        <td>33</td>
        <td>22</td>
        <td>19</td>
        <td>3</td>
        <td>2.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#468219498fcf60539b0c2fa153c9b270073ad865" class="src_link" title="lib/versioneye/services/git_hub_service.rb">lib/versioneye/services/git_hub_service.rb</a></td>
        <td class="red strong">24.18 %</td>
        <td>159</td>
        <td>91</td>
        <td>22</td>
        <td>69</td>
        <td>0.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4b7d3c389b07c951ae95d9e19119c769bd682b34" class="src_link" title="lib/versioneye/services/http_service.rb">lib/versioneye/services/http_service.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>19</td>
        <td>13</td>
        <td>13</td>
        <td>0</td>
        <td>141.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#13f39c00374f370dd1aaeacf29ebab45cea51e52" class="src_link" title="lib/versioneye/services/language_service.rb">lib/versioneye/services/language_service.rb</a></td>
        <td class="red strong">75.86 %</td>
        <td>54</td>
        <td>29</td>
        <td>22</td>
        <td>7</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#85e649118f2391815e03fe944504753dfeff2720" class="src_link" title="lib/versioneye/services/license_service.rb">lib/versioneye/services/license_service.rb</a></td>
        <td class="red strong">11.86 %</td>
        <td>101</td>
        <td>59</td>
        <td>7</td>
        <td>52</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#c5b41e7978f05ddbf1ce0ff24219986e030b47e9" class="src_link" title="lib/versioneye/services/license_whitelist_service.rb">lib/versioneye/services/license_whitelist_service.rb</a></td>
        <td class="yellow strong">84.78 %</td>
        <td>147</td>
        <td>92</td>
        <td>78</td>
        <td>14</td>
        <td>5.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#20d7776644fce76e8b5461f31d9ca12f76540691" class="src_link" title="lib/versioneye/services/lwl_pdf_service.rb">lib/versioneye/services/lwl_pdf_service.rb</a></td>
        <td class="red strong">61.76 %</td>
        <td>121</td>
        <td>68</td>
        <td>42</td>
        <td>26</td>
        <td>2.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5bd4c6af78f82bfaab8b60136a8dda69e36cc7e3" class="src_link" title="lib/versioneye/services/newest_service.rb">lib/versioneye/services/newest_service.rb</a></td>
        <td class="yellow strong">81.67 %</td>
        <td>223</td>
        <td>120</td>
        <td>98</td>
        <td>22</td>
        <td>19.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#90b3812379fd7f03292cd5521d25de6f4549bbc1" class="src_link" title="lib/versioneye/services/newsletter_service.rb">lib/versioneye/services/newsletter_service.rb</a></td>
        <td class="red strong">75.0 %</td>
        <td>34</td>
        <td>20</td>
        <td>15</td>
        <td>5</td>
        <td>4.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#755ee258e42e91618efab9f0568815619744885d" class="src_link" title="lib/versioneye/services/notification_service.rb">lib/versioneye/services/notification_service.rb</a></td>
        <td class="yellow strong">87.32 %</td>
        <td>112</td>
        <td>71</td>
        <td>62</td>
        <td>9</td>
        <td>3.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#0eb156a04e157c09b276cbd07b17f1cde78ee9f3" class="src_link" title="lib/versioneye/services/product_service.rb">lib/versioneye/services/product_service.rb</a></td>
        <td class="red strong">79.71 %</td>
        <td>234</td>
        <td>138</td>
        <td>110</td>
        <td>28</td>
        <td>10.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6a3a58acd9c2b082e4d540886fb821ffe34f50a2" class="src_link" title="lib/versioneye/services/project_batch_update_service.rb">lib/versioneye/services/project_batch_update_service.rb</a></td>
        <td class="green strong">93.65 %</td>
        <td>118</td>
        <td>63</td>
        <td>59</td>
        <td>4</td>
        <td>5.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#b089dffcf89f5eb38ab71389853c1ad767df5df6" class="src_link" title="lib/versioneye/services/project_collaborator_service.rb">lib/versioneye/services/project_collaborator_service.rb</a></td>
        <td class="green strong">93.94 %</td>
        <td>69</td>
        <td>33</td>
        <td>31</td>
        <td>2</td>
        <td>2.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#69afb924e0948edda2509576aed3fb325e7fd478" class="src_link" title="lib/versioneye/services/project_import_service.rb">lib/versioneye/services/project_import_service.rb</a></td>
        <td class="yellow strong">82.39 %</td>
        <td>341</td>
        <td>176</td>
        <td>145</td>
        <td>31</td>
        <td>2.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5ba26566392b08d32526f7168e2629f1eecab10c" class="src_link" title="lib/versioneye/services/project_parse_service.rb">lib/versioneye/services/project_parse_service.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>39</td>
        <td>20</td>
        <td>20</td>
        <td>0</td>
        <td>7.8</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e49694cbd703d3299a9c701b73e40d769fe5ec90" class="src_link" title="lib/versioneye/services/project_service.rb">lib/versioneye/services/project_service.rb</a></td>
        <td class="green strong">95.09 %</td>
        <td>504</td>
        <td>285</td>
        <td>271</td>
        <td>14</td>
        <td>26.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4c9f310a875adbab340e9fc6e7c0b4827738ecd8" class="src_link" title="lib/versioneye/services/project_update_service.rb">lib/versioneye/services/project_update_service.rb</a></td>
        <td class="yellow strong">87.5 %</td>
        <td>105</td>
        <td>64</td>
        <td>56</td>
        <td>8</td>
        <td>7.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#78295a205a70e9491b99368b45f308579d234c8c" class="src_link" title="lib/versioneye/services/projectdependency_service.rb">lib/versioneye/services/projectdependency_service.rb</a></td>
        <td class="green strong">90.07 %</td>
        <td>230</td>
        <td>141</td>
        <td>127</td>
        <td>14</td>
        <td>248.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9ddcbac774057fef4db218be6fbb4e03cb320e05" class="src_link" title="lib/versioneye/services/receipt_service.rb">lib/versioneye/services/receipt_service.rb</a></td>
        <td class="green strong">91.14 %</td>
        <td>142</td>
        <td>79</td>
        <td>72</td>
        <td>7</td>
        <td>2.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#989b570050923b35cfba548928598ac0fbe7b8e3" class="src_link" title="lib/versioneye/services/reference_service.rb">lib/versioneye/services/reference_service.rb</a></td>
        <td class="red strong">78.57 %</td>
        <td>31</td>
        <td>14</td>
        <td>11</td>
        <td>3</td>
        <td>2.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6063bee9eb4bc2c8d8de629b1f0c1e9f4bf09bb5" class="src_link" title="lib/versioneye/services/scm_meta_data_service.rb">lib/versioneye/services/scm_meta_data_service.rb</a></td>
        <td class="red strong">16.67 %</td>
        <td>63</td>
        <td>36</td>
        <td>6</td>
        <td>30</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e00df85ff7d3422d334ac4f2bf0b06fec606e195" class="src_link" title="lib/versioneye/services/stash_service.rb">lib/versioneye/services/stash_service.rb</a></td>
        <td class="red strong">17.05 %</td>
        <td>144</td>
        <td>88</td>
        <td>15</td>
        <td>73</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#8642528e0c9dffbcbeb40cd0747bdc6fc13044d7" class="src_link" title="lib/versioneye/services/statistic_service.rb">lib/versioneye/services/statistic_service.rb</a></td>
        <td class="red strong">19.61 %</td>
        <td>96</td>
        <td>51</td>
        <td>10</td>
        <td>41</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#24c17185ed488c996d2ce2a64393d6f08ac60b1d" class="src_link" title="lib/versioneye/services/submitted_url_service.rb">lib/versioneye/services/submitted_url_service.rb</a></td>
        <td class="green strong">90.48 %</td>
        <td>34</td>
        <td>21</td>
        <td>19</td>
        <td>2</td>
        <td>2.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#637244e36651162b658c459c74e15b7ef76e885e" class="src_link" title="lib/versioneye/services/sync_service.rb">lib/versioneye/services/sync_service.rb</a></td>
        <td class="yellow strong">83.95 %</td>
        <td>269</td>
        <td>162</td>
        <td>136</td>
        <td>26</td>
        <td>115.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#00afbf990e9ead950b7b0f24420766c39296400b" class="src_link" title="lib/versioneye/services/transfer_service.rb">lib/versioneye/services/transfer_service.rb</a></td>
        <td class="red strong">13.64 %</td>
        <td>35</td>
        <td>22</td>
        <td>3</td>
        <td>19</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fcd363f7b0a3c6b5c9e3e7cd99895ca138f50451" class="src_link" title="lib/versioneye/services/user_service.rb">lib/versioneye/services/user_service.rb</a></td>
        <td class="red strong">73.96 %</td>
        <td>155</td>
        <td>96</td>
        <td>71</td>
        <td>25</td>
        <td>4.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#db3e86cba480773ee0c8ec365a015601c0acb188" class="src_link" title="lib/versioneye/services/version_service.rb">lib/versioneye/services/version_service.rb</a></td>
        <td class="green strong">94.35 %</td>
        <td>290</td>
        <td>177</td>
        <td>167</td>
        <td>10</td>
        <td>129.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d3fdc4a01e058687c104d4179b94be4944f64b5d" class="src_link" title="lib/versioneye/services_ext/bitbucket.rb">lib/versioneye/services_ext/bitbucket.rb</a></td>
        <td class="red strong">64.47 %</td>
        <td>271</td>
        <td>152</td>
        <td>98</td>
        <td>54</td>
        <td>3.0</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ffc0e94f679bc5a454d0b3876cd94d3f1ab530fa" class="src_link" title="lib/versioneye/services_ext/es_product.rb">lib/versioneye/services_ext/es_product.rb</a></td>
        <td class="yellow strong">82.86 %</td>
        <td>197</td>
        <td>70</td>
        <td>58</td>
        <td>12</td>
        <td>15.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#6d316dcf642d6c5f6c0eb68cf003c07aa95efec7" class="src_link" title="lib/versioneye/services_ext/es_user.rb">lib/versioneye/services_ext/es_user.rb</a></td>
        <td class="red strong">25.0 %</td>
        <td>84</td>
        <td>40</td>
        <td>10</td>
        <td>30</td>
        <td>0.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#01e836c5be6be12982db113a3361913334660b2a" class="src_link" title="lib/versioneye/services_ext/github.rb">lib/versioneye/services_ext/github.rb</a></td>
        <td class="red strong">45.76 %</td>
        <td>474</td>
        <td>271</td>
        <td>124</td>
        <td>147</td>
        <td>6.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#95a22b81ce71dc61fa01280d469506bd530e595f" class="src_link" title="lib/versioneye/services_ext/mongo_product.rb">lib/versioneye/services_ext/mongo_product.rb</a></td>
        <td class="red strong">63.49 %</td>
        <td>106</td>
        <td>63</td>
        <td>40</td>
        <td>23</td>
        <td>7.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#84eacefc3c9c04d5979cdbb2edb0a073ebd170b2" class="src_link" title="lib/versioneye/services_ext/octokit_api.rb">lib/versioneye/services_ext/octokit_api.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>26</td>
        <td>10</td>
        <td>10</td>
        <td>0</td>
        <td>1.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#5319a17e185d25268b7d5a197c8b132104eb8c41" class="src_link" title="lib/versioneye/services_ext/s3.rb">lib/versioneye/services_ext/s3.rb</a></td>
        <td class="yellow strong">82.26 %</td>
        <td>103</td>
        <td>62</td>
        <td>51</td>
        <td>11</td>
        <td>0.9</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#9071d9e46ea6d607da5746683b9ac12aa04ea47b" class="src_link" title="lib/versioneye/services_ext/stash.rb">lib/versioneye/services_ext/stash.rb</a></td>
        <td class="red strong">23.17 %</td>
        <td>154</td>
        <td>82</td>
        <td>19</td>
        <td>63</td>
        <td>0.2</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ce504371b3f33f5e79e227462f22cd633e7bd3c6" class="src_link" title="lib/versioneye/services_ext/stripe_service.rb">lib/versioneye/services_ext/stripe_service.rb</a></td>
        <td class="green strong">100.0 %</td>
        <td>70</td>
        <td>39</td>
        <td>39</td>
        <td>0</td>
        <td>2.3</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f4e9b8253a7894598caa862e8f1acb2b19bddc42" class="src_link" title="lib/versioneye/updaters/bitbucket_updater.rb">lib/versioneye/updaters/bitbucket_updater.rb</a></td>
        <td class="red strong">71.43 %</td>
        <td>43</td>
        <td>28</td>
        <td>20</td>
        <td>8</td>
        <td>1.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#4ccb88010326baf53e23cd207dc2c37ca4f88c6c" class="src_link" title="lib/versioneye/updaters/common_updater.rb">lib/versioneye/updaters/common_updater.rb</a></td>
        <td class="green strong">92.11 %</td>
        <td>74</td>
        <td>38</td>
        <td>35</td>
        <td>3</td>
        <td>4.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d60bf1bb5704de017291a55648cc9b562b1eb4c0" class="src_link" title="lib/versioneye/updaters/github_updater.rb">lib/versioneye/updaters/github_updater.rb</a></td>
        <td class="yellow strong">83.33 %</td>
        <td>39</td>
        <td>24</td>
        <td>20</td>
        <td>4</td>
        <td>2.6</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#af31d53c21c3b6c27aa1af5cedfa182e8b35a215" class="src_link" title="lib/versioneye/updaters/stash_updater.rb">lib/versioneye/updaters/stash_updater.rb</a></td>
        <td class="red strong">14.29 %</td>
        <td>55</td>
        <td>35</td>
        <td>5</td>
        <td>30</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#ded313462d7a762a982ceb5353b66ae2450e438c" class="src_link" title="lib/versioneye/updaters/update_strategy.rb">lib/versioneye/updaters/update_strategy.rb</a></td>
        <td class="yellow strong">90.0 %</td>
        <td>28</td>
        <td>10</td>
        <td>9</td>
        <td>1</td>
        <td>5.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#cb192a7d1f14d0188ef535b1e420834247f0d1a3" class="src_link" title="lib/versioneye/updaters/upload_updater.rb">lib/versioneye/updaters/upload_updater.rb</a></td>
        <td class="red strong">75.0 %</td>
        <td>45</td>
        <td>28</td>
        <td>21</td>
        <td>7</td>
        <td>22.4</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#aa230b85a53b5802b291126c0268c067ec22f73a" class="src_link" title="lib/versioneye/updaters/url_updater.rb">lib/versioneye/updaters/url_updater.rb</a></td>
        <td class="yellow strong">86.67 %</td>
        <td>25</td>
        <td>15</td>
        <td>13</td>
        <td>2</td>
        <td>1.7</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#edb18a518ac09bc5e2941db4708458d81a16881e" class="src_link" title="lib/versioneye/workers/common_worker.rb">lib/versioneye/workers/common_worker.rb</a></td>
        <td class="red strong">9.38 %</td>
        <td>58</td>
        <td>32</td>
        <td>3</td>
        <td>29</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#f2f3e23ec617d2efb964da47cf3d372f23ed3e47" class="src_link" title="lib/versioneye/workers/dependency_badge_worker.rb">lib/versioneye/workers/dependency_badge_worker.rb</a></td>
        <td class="red strong">78.79 %</td>
        <td>55</td>
        <td>33</td>
        <td>26</td>
        <td>7</td>
        <td>1.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#fbff4af57429cbcaada43a4e0d578ebb8db51112" class="src_link" title="lib/versioneye/workers/git_repo_file_import_worker.rb">lib/versioneye/workers/git_repo_file_import_worker.rb</a></td>
        <td class="yellow strong">81.48 %</td>
        <td>84</td>
        <td>54</td>
        <td>44</td>
        <td>10</td>
        <td>2.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#d61515fc8d27fa0b47e273c22241d58fdf914936" class="src_link" title="lib/versioneye/workers/git_repo_import_worker.rb">lib/versioneye/workers/git_repo_import_worker.rb</a></td>
        <td class="red strong">12.2 %</td>
        <td>121</td>
        <td>82</td>
        <td>10</td>
        <td>72</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#2c80b50083cde15ce30d6e2432a5e3d5aba65632" class="src_link" title="lib/versioneye/workers/git_repos_import_worker.rb">lib/versioneye/workers/git_repos_import_worker.rb</a></td>
        <td class="red strong">9.86 %</td>
        <td>113</td>
        <td>71</td>
        <td>7</td>
        <td>64</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#166f3a1a2a4c9ea61510660887848699cef30a3c" class="src_link" title="lib/versioneye/workers/language_daily_stats_worker.rb">lib/versioneye/workers/language_daily_stats_worker.rb</a></td>
        <td class="red strong">12.5 %</td>
        <td>40</td>
        <td>24</td>
        <td>3</td>
        <td>21</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#14925a3bbf6acfd91e9b3ff2063265e9554da150" class="src_link" title="lib/versioneye/workers/process_receipts_worker.rb">lib/versioneye/workers/process_receipts_worker.rb</a></td>
        <td class="red strong">12.5 %</td>
        <td>38</td>
        <td>24</td>
        <td>3</td>
        <td>21</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#92dbed1925791e53ac20c9208a00a7b86b8eceb7" class="src_link" title="lib/versioneye/workers/project_update_worker.rb">lib/versioneye/workers/project_update_worker.rb</a></td>
        <td class="red strong">74.0 %</td>
        <td>84</td>
        <td>50</td>
        <td>37</td>
        <td>13</td>
        <td>2.5</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#20e2e2108128c7101835128ed5119866d819b8da" class="src_link" title="lib/versioneye/workers/send_notification_emails_worker.rb">lib/versioneye/workers/send_notification_emails_worker.rb</a></td>
        <td class="red strong">12.5 %</td>
        <td>37</td>
        <td>24</td>
        <td>3</td>
        <td>21</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#a22e214036e3b57d8e980508c029387eb777b3e4" class="src_link" title="lib/versioneye/workers/sync_worker.rb">lib/versioneye/workers/sync_worker.rb</a></td>
        <td class="red strong">11.54 %</td>
        <td>42</td>
        <td>26</td>
        <td>3</td>
        <td>23</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#31ee0c75abb967c62cfcabb46afa9975dd5229cf" class="src_link" title="lib/versioneye/workers/update_index_worker.rb">lib/versioneye/workers/update_index_worker.rb</a></td>
        <td class="red strong">12.0 %</td>
        <td>41</td>
        <td>25</td>
        <td>3</td>
        <td>22</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#41f051870ef3fbf70e7a537fbfd24e5d25b730e3" class="src_link" title="lib/versioneye/workers/update_meta_data_worker.rb">lib/versioneye/workers/update_meta_data_worker.rb</a></td>
        <td class="red strong">12.5 %</td>
        <td>38</td>
        <td>24</td>
        <td>3</td>
        <td>21</td>
        <td>0.1</td>
      </tr>
      
      <tr>
        <td class="strong"><a href="#e7928aba3f99d544d09b3bfdad4e927ec89241c1" class="src_link" title="lib/versioneye/workers/worker.rb">lib/versioneye/workers/worker.rb</a></td>
        <td class="red strong">78.95 %</td>
        <td>38</td>
        <td>19</td>
        <td>15</td>
        <td>4</td>
        <td>5.6</td>
      </tr>
      
    </tbody>
  </table>
</div>


        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.10.0 
        and simplecov-html v0.10.0<br/>
        using RSpec
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="8de22b2521e1d8217ca696f8a17adb83f425c4db">
  <div class="header">
    <h3>lib/settings.rb</h3>
    <h4><span class="red">70.73 %</span> covered</h4>
    <div>
      <b>41</b> relevant lines. 
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;singleton&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;json&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/model&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/models/global_setting&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">class Settings</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include Singleton</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &#39;initialize Settings&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    load_settings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def load_settings( path_to_settings = &#39;config/settings.json&#39; )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot;load #{path_to_settings}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    json = File.read( path_to_settings )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    settings = JSON.parse(json)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if settings.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    environment = ENV[&#39;RAILS_ENV&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    if environment.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">      environment = &#39;development&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    instance_variable_set(&quot;@environment&quot;, environment)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    self.class.class_eval { attr_reader &quot;environment&quot;.intern }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    settings[environment].each { |name, value|</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="29">
          <span class="hits">56</span>
          
          <code class="ruby">      if value &amp;&amp; value.is_a?(String) &amp;&amp; value.match(/\Aenv_/)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="30">
          <span class="hits">3</span>
          
          <code class="ruby">        new_val = value.gsub(&quot;env_&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="31">
          <span class="hits">3</span>
          
          <code class="ruby">        value = ENV[new_val]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="34">
          <span class="hits">56</span>
          
          <code class="ruby">      instance_variable_set(&quot;@#{name}&quot;, value)</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="35">
          <span class="hits">112</span>
          
          <code class="ruby">      self.class.class_eval { attr_reader name.intern }</code>
        </li>
      
        <li class="covered" data-hits="112" data-linenumber="36">
          <span class="hits">112</span>
          
          <code class="ruby">      self.class.class_eval { attr_writer name.intern }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def reload_from_db gs</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="41">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if gs.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="43">
          <span class="hits">5</span>
          
          <code class="ruby">    keys = gs.keys self.environment</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="44">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if keys.nil? || keys.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    keys.each do |key|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">      value = gs.get self.environment, key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">      value = true  if value.eql?(&quot;true&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">      value = false if value.eql?(&quot;false&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">      name = key.downcase</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">      instance_variable_set(&quot;@#{name}&quot;, value)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">      self.class.class_eval { attr_reader name.intern }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      puts &quot;set #{key.downcase} = #{value}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    p e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    p e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="72d215bd0807aabfef41132ca2a471b2139da806">
  <div class="header">
    <h3>lib/versioneye-core.rb</h3>
    <h4><span class="red">80.0 %</span> covered</h4>
    <div>
      <b>75</b> relevant lines. 
      <span class="green"><b>60</b> lines covered</span> and
      <span class="red"><b>15</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;log4r&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;log4r/configurator&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;mongoid&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;tire&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;dalli&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;httparty&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;action_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;stripe&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;settings&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/model&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/service&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">class VersioneyeCore</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot;start initialize versioneye-core&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    init_logger</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    init_mongodb</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    init_settings</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    init_elastic_search</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    init_memcached</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    init_email</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    init_stripe</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    init_s3</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot;end initialize versioneye-core&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_mongodb</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot; - initialize MongoDB for #{Settings.instance.environment} &quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    Mongoid.load!(&quot;config/mongoid.yml&quot;, Settings.instance.environment)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_email</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot; - initialize email settings&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">    ActionMailer::Base.raise_delivery_errors = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    ActionMailer::Base.delivery_method = :smtp</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    ActionMailer::Base.view_paths = File.expand_path(&#39;../versioneye/views/&#39;, __FILE__)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    EmailSettingService.update_action_mailer_from_db</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_stripe</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot; - initialize Stripe&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">    env = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if env.to_s.eql?(&quot;enterprise&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">    Stripe.api_key = Settings.instance.stripe_secret_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_s3</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot; - initialize Amazon S3&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    env = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if env.to_s.eql?(&quot;enterprise&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    S3.set_aws_crendentials</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_logger</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot; - initialize Logger&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">    Log4r::Configurator.load_xml_file(&#39;config/log4r.xml&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_elastic_search</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">    es_url = &#39;localhost:9200&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    if !Settings.instance.elasticsearch_addr.to_s.empty? &amp;&amp; !Settings.instance.elasticsearch_port.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">      es_url = &quot;#{Settings.instance.elasticsearch_addr}:#{Settings.instance.elasticsearch_port}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot; - initialize ElasticSearch with #{es_url} for env: #{Settings.instance.environment}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">    Tire.configure do</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">      url es_url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_settings</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot; - reload Settings from DB!&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">    Settings.instance.reload_from_db GlobalSetting.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_memcached</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">    puts &quot; - initialize init_memcached!&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">    Versioneye::Cache.instance.mc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">    def log</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">      Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4d42772b7dde53052f9daac7ee64b8ca46bd86b3">
  <div class="header">
    <h3>lib/versioneye/cache.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;singleton&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">module Versioneye</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  class Cache</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    include Singleton</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">      mc_url = &#39;127.0.0.1:11211&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">      if !Settings.instance.memcache_addr.to_s.empty? &amp;&amp; !Settings.instance.memcache_port.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">        mc_url = &quot;#{Settings.instance.memcache_addr}:#{Settings.instance.memcache_port}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">      options = { :username =&gt; &#39;&#39;, :password =&gt; &#39;&#39;, :namespace =&gt; &#39;veye&#39;, :expires_in =&gt; 1.day, :compress =&gt; true }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">      @memcache = Dalli::Client.new( mc_url, options )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    def mc</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="17">
          <span class="hits">142</span>
          
          <code class="ruby">      @memcache</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="38e014306f3b91da32fb365bcffe50bd75adc7cc">
  <div class="header">
    <h3>lib/versioneye/log.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;singleton&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;log4r&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;log4r/configurator&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">module Versioneye</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  class Log</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    include Singleton</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    include Log4r</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    def initialize</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">      Configurator.load_xml_file(&#39;config/log4r.xml&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    def log</code>
        </li>
      
        <li class="covered" data-hits="702" data-linenumber="15">
          <span class="hits">702</span>
          
          <code class="ruby">      Logger[&#39;MainLogger&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3e4a08b016cf3159779943ef66a9bcc1ac612a0e">
  <div class="header">
    <h3>lib/versioneye/mailers/feedback_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class FeedbackMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def feedback_email(name, email, feedback)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    @name     = name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    @email    = email</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    @feedback = feedback</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    rnd_val = create_random_value</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    subject = &quot;VersionEye Feedback #{rnd_val}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; &#39;reiz@versioneye.com&#39;, :subject =&gt; subject) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from(m)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    def create_random_value</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      chars = &#39;0123456789&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      value = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="23">
          <span class="hits">8</span>
          
          <code class="ruby">      7.times { value &lt;&lt; chars[rand(chars.size)] }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">      value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="eb2e725298ec67394801f8269ecc54781cdf9dd3">
  <div class="header">
    <h3>lib/versioneye/mailers/newsletter_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class NewsletterMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def newsletter_new_features_email( user )</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="5">
          <span class="hits">6</span>
          
          <code class="ruby">    @user = user</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">    @newsletter = &quot;newsletter_features&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="7">
          <span class="hits">6</span>
          
          <code class="ruby">    mail(:to =&gt; @user.email, :subject =&gt; &#39;PHP Security Vulnerabilities&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="8">
          <span class="hits">12</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="023ab62e3e733ba2cff1f1fe7e7fc3269b5bcb68">
  <div class="header">
    <h3>lib/versioneye/mailers/notification_mailer.rb</h3>
    <h4><span class="green">96.55 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines. 
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class NotificationMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def new_version_email(user, notifications)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="5">
          <span class="hits">6</span>
          
          <code class="ruby">    @newsletter = &quot;notification_emails&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">    @user = user</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="7">
          <span class="hits">6</span>
          
          <code class="ruby">    @notifications = notifications</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="8">
          <span class="hits">6</span>
          
          <code class="ruby">    @link =  &quot;#{Settings.instance.server_url}/&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="9">
          <span class="hits">6</span>
          
          <code class="ruby">    @user_product_index = ProjectService.user_product_index_map( user )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="11">
          <span class="hits">6</span>
          
          <code class="ruby">    names = first_names notifications</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="12">
          <span class="hits">6</span>
          
          <code class="ruby">    m = mail(:to =&gt; @user.email, :subject =&gt; &quot;Update: #{names}&quot;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="13">
          <span class="hits">12</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="15">
          <span class="hits">6</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def status(count)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    @count = count</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; &#39;reiz@versioneye.com&#39;, :subject =&gt; &quot;#{count} notifications&quot;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    def first_names notifications</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="32">
          <span class="hits">6</span>
          
          <code class="ruby">      names = Array.new</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="33">
          <span class="hits">6</span>
          
          <code class="ruby">      max = 2</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="34">
          <span class="hits">6</span>
          
          <code class="ruby">      max = 1 if notifications.size == 2</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="35">
          <span class="hits">6</span>
          
          <code class="ruby">      max = 0 if notifications.size == 1</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="36">
          <span class="hits">6</span>
          
          <code class="ruby">      (0..max).each do |num|</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="37">
          <span class="hits">7</span>
          
          <code class="ruby">        notification = notifications[num]</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="38">
          <span class="hits">7</span>
          
          <code class="ruby">        names.push notification.product.name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="40">
          <span class="hits">6</span>
          
          <code class="ruby">      result = names.join(&#39;, &#39;)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="41">
          <span class="hits">6</span>
          
          <code class="ruby">      if notifications.size &gt; 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">        result = &quot;#{result} ...&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="44">
          <span class="hits">6</span>
          
          <code class="ruby">      result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="fe6e1eed1d7e2bd697acb4c227f60661908d2b7e">
  <div class="header">
    <h3>lib/versioneye/mailers/project_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>30</b> relevant lines. 
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def projectnotification_email( project, user = nil, unknown_licenses = nil, red_licenses = nil )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="5">
          <span class="hits">3</span>
          
          <code class="ruby">    @project_name = project.name</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">    @projectlink  = &quot;#{Settings.instance.server_url}/user/projects/#{project.id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="7">
          <span class="hits">3</span>
          
          <code class="ruby">    @base_url     = Settings.instance.server_url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="8">
          <span class="hits">3</span>
          
          <code class="ruby">    @user         = user ? user : project.user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>
          
          <code class="ruby">    deps  = ProjectService.outdated_dependencies( project, true )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>
          
          <code class="ruby">    if unknown_licenses.nil? || red_licenses.nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">      unknown_licenses = ProjectService.unknown_licenses( project )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">      red_licenses     = ProjectService.red_licenses( project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="16">
          <span class="hits">3</span>
          
          <code class="ruby">    @outdated_dependencies_count = 0</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="17">
          <span class="hits">3</span>
          
          <code class="ruby">    @unknown_licenses_count = 0</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>
          
          <code class="ruby">    @red_licenses_count = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="20">
          <span class="hits">3</span>
          
          <code class="ruby">    @outdated_dependencies_count = deps.count if deps &amp;&amp; !deps.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="21">
          <span class="hits">3</span>
          
          <code class="ruby">    @unknown_licenses_count = unknown_licenses.count if unknown_licenses &amp;&amp; !unknown_licenses.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="22">
          <span class="hits">3</span>
          
          <code class="ruby">    @red_licenses_count = red_licenses.count if red_licenses &amp;&amp; !red_licenses.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="24">
          <span class="hits">3</span>
          
          <code class="ruby">    email = user ? user.email : Project.email_for(project, @user)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="26">
          <span class="hits">3</span>
          
          <code class="ruby">    m = mail(:to =&gt; email, :subject =&gt; &quot;Project Notification for #{project.name}&quot;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="27">
          <span class="hits">6</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="29">
          <span class="hits">3</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def projectnotifications_email user, projects, col_projects, period</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="34">
          <span class="hits">5</span>
          
          <code class="ruby">    @newsletter = &quot;project_emails&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="35">
          <span class="hits">5</span>
          
          <code class="ruby">    @user = user</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="36">
          <span class="hits">5</span>
          
          <code class="ruby">    @projects = projects</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="37">
          <span class="hits">5</span>
          
          <code class="ruby">    @col_projects = col_projects</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="38">
          <span class="hits">5</span>
          
          <code class="ruby">    @period = period</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="39">
          <span class="hits">5</span>
          
          <code class="ruby">    @projectlink = &quot;#{Settings.instance.server_url}/user/projects&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="41">
          <span class="hits">5</span>
          
          <code class="ruby">    m = mail(:to =&gt; user.email, :subject =&gt; &quot;#{period.capitalize} Project Notifications&quot;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="42">
          <span class="hits">10</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="44">
          <span class="hits">5</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="bfd7fc7c224a881aaffe4477f61b87fb348b16a3">
  <div class="header">
    <h3>lib/versioneye/mailers/receipt_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ReceiptMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def receipt_email( receipt, pdf )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    @user = receipt.user</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">    email = fetch_email receipt</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    attachments[receipt.filename] = pdf</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    m = mail(:to =&gt; email, :subject =&gt; &quot;Receipt - #{receipt.receipt_nr}&quot;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="10">
          <span class="hits">4</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    def fetch_email receipt</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">      return receipt.email if !receipt.email.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">      return receipt.user.email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0509c8d9f5d3659370f504f4f2cb75c767e55ef5">
  <div class="header">
    <h3>lib/versioneye/mailers/submitted_url_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SubmittedUrlMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def new_submission_email(submitted_url)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    @base_url = Settings.instance.server_url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    @submitted_url = submitted_url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    @user = submitted_url.user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; &#39;reiz@versioneye.com&#39;, :subject =&gt; &#39;New Submission&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def approved_url_email(submitted_url)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    @submitted_url = submitted_url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    @user = submitted_url.user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; @user.email, :subject =&gt; &#39;Your submitted Resource is accepted.&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def declined_url_email(submitted_url)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    @submitted_url = submitted_url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    @user = submitted_url.user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; @user.email, :subject =&gt; &#39;You submitted Resource is declined.&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def integrated_url_email(submitted_url, product)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>
          
          <code class="ruby">    @base_url = Settings.instance.server_url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="37">
          <span class="hits">3</span>
          
          <code class="ruby">    @submitted_url = submitted_url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="38">
          <span class="hits">3</span>
          
          <code class="ruby">    @user = submitted_url.user</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>
          
          <code class="ruby">    @product = product</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="40">
          <span class="hits">3</span>
          
          <code class="ruby">    m = mail(:to =&gt; @user.email, :subject =&gt; &#39;Your submitted Resource is integrated&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="41">
          <span class="hits">6</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="43">
          <span class="hits">3</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="44774af43b6a278b3610b6dd58c2b8a321efed46">
  <div class="header">
    <h3>lib/versioneye/mailers/subscription_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SubscriptionMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_subscription( user )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    @user =  user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(to: user.email, subject: &#39;VersionEye Subscription&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from(m)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d7b82867188f8e81f2a246ef772f3952f8a021e6">
  <div class="header">
    <h3>lib/versioneye/mailers/super_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SuperMailer &lt; ActionMailer::Base</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  layout &#39;email_html_layout&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  default from: &quot;\&quot;#{Settings.instance.smtp_sender_name}\&quot; &lt;#{Settings.instance.smtp_sender_email}&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  private </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    def set_from( mail )</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="9">
          <span class="hits">46</span>
          
          <code class="ruby">      mail.from = &quot;\&quot;#{Settings.instance.smtp_sender_name}\&quot; &lt;#{Settings.instance.smtp_sender_email}&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="10">
          <span class="hits">46</span>
          
          <code class="ruby">      mail  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6a8ea20f1337ab167e2d7857113339d799b3bf20">
  <div class="header">
    <h3>lib/versioneye/mailers/user_mailer.rb</h3>
    <h4><span class="green">97.47 %</span> covered</h4>
    <div>
      <b>79</b> relevant lines. 
      <span class="green"><b>77</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UserMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def test_email( email )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    m = mail( :to =&gt; email, :subject =&gt; &#39;VersionEye Test Email&#39; )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def verification_email(user, verification, email)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    @user  = user</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    source = fetch_source( user )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    @verificationlink = &quot;#{Settings.instance.server_url}/users/activate/#{source}/#{verification}&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    m = mail( :to =&gt; email, :subject =&gt; &#39;Verification&#39; ) do |format|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="15">
          <span class="hits">4</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def verification_email_only(user, verification, email)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    @user = user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    @verificationlink = &quot;#{Settings.instance.server_url}/users/activate/email/#{verification}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; email, :subject =&gt; &#39;Verification&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def verification_email_reminder(user, verification, email)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    @user  = user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    source = fetch_source( user )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    @verificationlink = &quot;#{Settings.instance.server_url}/users/activate/#{source}/#{verification}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail( :to =&gt; email, :subject =&gt; &#39;Verification Reminder&#39; ) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def collaboration_invitation(collaborator)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="43">
          <span class="hits">2</span>
          
          <code class="ruby">    @caller  = collaborator.caller</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">    @owner   = collaborator.owner</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="45">
          <span class="hits">2</span>
          
          <code class="ruby">    @project = collaborator.project</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">    m = mail( :to =&gt; collaborator[:invitation_email], :subject =&gt; &#39;Invitation to project collabration&#39; ) do |format|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="47">
          <span class="hits">4</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def new_collaboration( collaborator )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="54">
          <span class="hits">4</span>
          
          <code class="ruby">    @caller        = collaborator.caller</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="55">
          <span class="hits">4</span>
          
          <code class="ruby">    @project       = collaborator.project</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="56">
          <span class="hits">4</span>
          
          <code class="ruby">    @callee        = collaborator.user</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="57">
          <span class="hits">4</span>
          
          <code class="ruby">    @collaboration = collaborator</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="58">
          <span class="hits">4</span>
          
          <code class="ruby">    m = mail( :to =&gt; @callee[:email], :subject =&gt; &quot;#{@caller[:fullname]} added you as collaborator&quot; ) do |format|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="59">
          <span class="hits">8</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="61">
          <span class="hits">4</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  def invited_user_author( user, authors )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">    @user    = user </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    @authors = authors</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail( :to =&gt; user.email, :subject =&gt; &quot;Edit your VersionEye pages.&quot; ) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="69">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  def reset_password(user)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="76">
          <span class="hits">4</span>
          
          <code class="ruby">    @user = user</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="77">
          <span class="hits">4</span>
          
          <code class="ruby">    @url  = &quot;#{Settings.instance.server_url}/updatepassword/#{@user.verification}&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="78">
          <span class="hits">4</span>
          
          <code class="ruby">    m = mail(:to =&gt; @user.email, :subject =&gt; &#39;Password Reset&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="79">
          <span class="hits">8</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="81">
          <span class="hits">4</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def new_ticket(user, ticket)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">    @fullname = user[:fullname]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">    @ticket   = ticket</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; user[:email], :subject =&gt; &quot;VersionEye&#39;s lottery confirmation&quot;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="89">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">  def suggest_packages_email( user )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">    @fullname = user[:fullname]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; user[:email], :subject =&gt; &quot;Follow popular software packages on VersionEye&quot;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="98">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">  def non_profit_signup( user, np_domain )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">    @user = user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">    @npd  = np_domain</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; user[:email], :subject =&gt; &quot;You got #{np_domain.free_projects} private projects at VersionEye for free!&quot;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="108">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">  def deleted( user, why )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">    @user = user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">    @why = why</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; &#39;reiz@versioneye.com&#39;, :subject =&gt; &quot;User #{user.fullname} deleted&quot;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="118">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_source( user )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="125">
          <span class="hits">3</span>
          
          <code class="ruby">    source = &quot;email&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="126">
          <span class="hits">3</span>
          
          <code class="ruby">    source = &quot;bitbucket&quot; if user.bitbucket_id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="127">
          <span class="hits">3</span>
          
          <code class="ruby">    source = &quot;github&quot;    if user.github_id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="128">
          <span class="hits">3</span>
          
          <code class="ruby">    source</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2bb780a60770e9ad826e43b01540d12dc2a635e2">
  <div class="header">
    <h3>lib/versioneye/mailers/versioncomment_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>9</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class VersioncommentMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def versioncomment_email(product, follower, user, comment)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    @prod        = product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    @follower    = follower</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    @user        = user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    @commentlink = &quot;#{Settings.instance.server_url}/vc/#{comment.id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; @follower.email, :subject =&gt; &#39;Comment on Package&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b929e942cca642e06ccd772d9a589327681783f2">
  <div class="header">
    <h3>lib/versioneye/mailers/versioncommentreply_mailer.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class VersioncommentreplyMailer &lt; SuperMailer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def versioncomment_reply_email(comment_user, reply_user, comment)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    @comment_user = comment_user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    @reply_user   = reply_user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    @comment      = comment</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    @prod         = comment.product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    @commentlink = &quot;#{Settings.instance.server_url}/vc/#{comment.id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    m = mail(:to =&gt; @comment_user.email, :subject =&gt; &quot;#{reply_user.fullname} replied to your comment&quot;, :tag =&gt; &#39;versioncomment&#39;) do |format|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">      format.html{ render layout: &#39;email_html_layout&#39; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    set_from( m )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c1fe53b47042c688a278b2e829d68590fb5cee43">
  <div class="header">
    <h3>lib/versioneye/migrations/product_migration.rb</h3>
    <h4><span class="red">7.25 %</span> covered</h4>
    <div>
      <b>69</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>64</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProductMigration &lt; Versioneye::Service </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;builder&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.migrate </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    count = 0 </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    Product.where(:language =&gt; &#39;Java&#39;, :created_at.lt =&gt; &#39;2012-07-30&#39;).each do |product| </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      next if product.versions.empty? </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">      group_id = product.group_id.gsub(&quot;.&quot;, &quot;/&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">      product.versions.each do |version| </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">        next if version.to_s.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">        product.version = version.to_s </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">        archives = product.archives </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">        next if archives.nil? || archives.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">        archives.each do |archive|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">          begin </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">            next if version.to_s.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">            if archive.link.to_s.empty? </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">              archive.remove </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">            if archive.link.match(/#{version.to_s}/i).nil? </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">              p archive</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">              p &quot;- &quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">              product.dependencies.each do |dep| </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">                dep.delete </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">              product.http_version_links.each do |link| </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">                link.delete </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">              end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">              product.remove_version version.to_s </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">              archive.delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">              count += 1 </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">              p count </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">            end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">          rescue =&gt; e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">            p &quot;link: #{archive.link} - #{version.to_s}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">            p e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">            p e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">          end </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.xml_site_map</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    logger.info &quot;xml_site_map&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    uris = Hash.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    sitemap_count = 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    ProductService.all_products_paged do |products| </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">      products.each do |product|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">        next if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">        </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">        uri = &quot;#{product.language_esc}/#{product.to_param}/#{product.version_to_url_param}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">        modified = DateTime.now.strftime(&quot;%Y-%m-%d&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">        p &quot;#{modified} - #{uri}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">        uris[uri] = {:uri =&gt; uri, :modified =&gt; modified}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">      if uris.count &gt; 49000</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">        logger.info &quot;#{uris.count}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">        logger.info &quot;sitemap count: #{sitemap_count}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">        write_to_xml(uris, &quot;sitemap-#{sitemap_count}.xml&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">        uris = Hash.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">        sitemap_count += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    end </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    logger.info &quot;#{uris.count}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">    logger.info &quot;sitemap count: #{sitemap_count}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">    write_to_xml(uris, &quot;sitemap-#{sitemap_count}.xml&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    p e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">    p e.backtrace.join(&#39;\n&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.write_to_xml(uris, name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">    logger.info &quot;write to xml&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">    xml = Builder::XmlMarkup.new( :indent =&gt; 2 )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">    xml.instruct!(:xml, :encoding =&gt; &quot;UTF8&quot;, :version =&gt; &quot;1.0&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    xml.urlset(:xmlns =&gt; &quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;) do |urlset|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">      uris.each_pair do |key, val|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">        urlset.url do |url|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">          uri = val[:uri]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">          modified = val[:modified]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">          url.loc &quot;https://www.versioneye.com/#{uri}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">          url.lastmod modified</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">    xml_data = xml.target!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    xml_file = File.open(name, &quot;w&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    xml_file.write(xml_data)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">    xml_file.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">end </code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d3a533b7f00f817eb42d311e2fffeab4c70fa4d2">
  <div class="header">
    <h3>lib/versioneye/migrations/versionlink_migration.rb</h3>
    <h4><span class="red">16.67 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class VersionlinkMigration &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.migrate_clojure_links</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    Versionlink.where(:language =&gt; &quot;Java&quot;).each do |link|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">      next if link.product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      product = Product.fetch_product(&quot;Clojure&quot;, link.prod_key)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">      next if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">        p &quot;Clojure / #{link.prod_key}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">        link.language = product.language</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">        link.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">        p e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">        link.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="899e17f2290a455de390e246dc98fb3bb64043ab">
  <div class="header">
    <h3>lib/versioneye/model.rb</h3>
    <h4><span class="green">98.59 %</span> covered</h4>
    <div>
      <b>71</b> relevant lines. 
      <span class="green"><b>70</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module Versioneye</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  class Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/log&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/mail_track&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/badge&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/docker_image&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/api&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/api_call&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/auditlog&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/billing_address&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/bitbucket_repo&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/circle_element&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/crawle&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/crawler_task&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/dependency&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/developer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/author&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/error_message&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/event&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/email_setting&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/enterprise_lead&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/github_repo&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/stash_repo&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/json_cache&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/language&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/language_daily_stats&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/language_feed&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/license&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/license_whitelist&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/license_element&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/license_cach&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/lottery&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/maven_repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/newest&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/notification&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/pom&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/plan&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/product&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/product_resource&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/project&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/project_collaborator&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/projectdependency&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/promo_code&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/refer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/receipt&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/receipt_line&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/repository&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/searchlog&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/security_vulnerability&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/submitted_url&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/spdx_license&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/user&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/user_email&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/user_notification_setting&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/userlinkcollection&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/user_permission&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/version&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/versionarchive&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/versioncomment&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/versioncommentreply&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/versionlink&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/global_setting&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/np_domain&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/reference&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/models/helpers/indexer&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    def ids</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="70">
          <span class="hits">45</span>
          
          <code class="ruby">      self.id.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.log</code>
        </li>
      
        <li class="covered" data-hits="350" data-linenumber="74">
          <span class="hits">350</span>
          
          <code class="ruby">      Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    def log</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">      Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="edafa99c889264bcc5e6c6c365192c9e9b1be157">
  <div class="header">
    <h3>lib/versioneye/models/api.rb</h3>
    <h4><span class="green">95.83 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Api &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id            , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :api_key            , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :calls              , type: Integer, default: 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :enterprise_projects, type: Integer, default: 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :active             , type: Boolean, default: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ api_key: 1 }, { name: &quot;api_key_index&quot;, unique: true, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :user_id, presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :api_key, presence: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">                      length: {minimum: 20, maximum: 20},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">                      uniqueness: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.by_user(user)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    Api.where(user_id: user[:_id].to_s).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_new(user)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">    new_api = Api.new(user_id: user[:_id].to_s)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">    new_api.generate_api_key!</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    new_api.save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    new_api</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.generate_api_key(length = 20)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    length = (length / 2.0).round</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    length = 1 if length &lt; 1</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">    SecureRandom.hex(length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def generate_api_key!(length =  20)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">    self.api_key = Api.generate_api_key(length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0c1599be28cdd40452e478b5ab47ce7adc6b9cd3">
  <div class="header">
    <h3>lib/versioneye/models/api_call.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ApiCall &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :api_key    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :fullpath   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :http_method, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :ip         , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ api_key: 1 }, { name: &quot;api_key_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ user_id: 1 }, { name: &quot;user_id_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :fullpath, presence: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_user,    -&gt;(user)   { where(user_id: user.id.to_s) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_api_key, -&gt;(api_key){ where(api_key: api_key) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :today,      -&gt;{ where(:created_at.gte =&gt; Date.today.midnight, :created_at.lt =&gt; Date.tomorrow.midnight) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1b9fb2fc87ff69e72a85022c2c6ffbe188a1b514">
  <div class="header">
    <h3>lib/versioneye/models/auditlog.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>18</b> relevant lines. 
      <span class="green"><b>18</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Auditlog &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :domain     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :domain_id  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :action     , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ user_id: 1 }, { name: &quot;user_id_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :user_id  , presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :domain   , presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :domain_id, presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :action   , presence: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_user,    -&gt;(user)   { where(user_id: user.id.to_s) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :today,      -&gt;{ where(:created_at.gte =&gt; Date.today.midnight, :created_at.lt =&gt; Date.tomorrow.midnight) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.add user, domain, id, action</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="23">
          <span class="hits">3</span>
          
          <code class="ruby">    Auditlog.new({:user_id =&gt; user.id.to_s, :domain =&gt; domain, :domain_id =&gt; id, :action =&gt; action }).save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    User.find user_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d3138a7cdfad6bc11650544ad33e59c00971dc55">
  <div class="header">
    <h3>lib/versioneye/models/author.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>53</b> relevant lines. 
      <span class="green"><b>53</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Author &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name_id         , type: String # name without white spaces and downcased</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name            , type: String # This is the real name of the developer!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email           , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :homepage        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :organization    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :organization_url, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :role            , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :timezone        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :contributor     , type: Boolean, default: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :emails        , type: Array, default: []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :emails_count  , type: Integer, default: 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :languages        , type: Array, default: []  # Uniq. language codes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :languages_count  , type: Integer, default: 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :product_ids     , type: Array, default: []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :products        , type: Array  # Array of &lt;LANGUAGE&gt;::&lt;PROD_KEY&gt;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :products_count  , type: Integer, default: 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_uniqueness_of :name_id, :message =&gt; &#39;exist already.&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ name_id: 1 }, { name: &quot;nameid_index&quot;, background: true, unique: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  # index({ email:   1 }, { name: &quot;email_index&quot;,  background: true, unique: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    &quot;#{name_id} - #{email}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_param</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">    return name_id if !name_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    Author.encode_name(name) if !name.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_name_id</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="46">
          <span class="hits">5</span>
          
          <code class="ruby">    self.name_id = Author.encode_name( self.name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.encode_name name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    name.gsub(&quot; &quot;, &quot;_&quot;).gsub(&quot;&quot;, &quot;ss&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      .gsub(&quot;&quot;, &quot;ue&quot;).gsub(&quot;&quot;, &quot;Ue&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      .gsub(&quot;&quot;, &quot;ae&quot;).gsub(&quot;&quot;, &quot;Ae&quot;)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="54">
          <span class="hits">20</span>
          
          <code class="ruby">      .gsub(&quot;&quot;, &quot;oe&quot;).gsub(&quot;&quot;, &quot;Oe&quot;).downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_product id, language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="59">
          <span class="hits">8</span>
          
          <code class="ruby">    key = &quot;#{language}::#{prod_key}&quot;.downcase</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="60">
          <span class="hits">8</span>
          
          <code class="ruby">    self.products = [] if products.nil?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="61">
          <span class="hits">8</span>
          
          <code class="ruby">    self.products.push( key ) if !products.include?(key)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="62">
          <span class="hits">8</span>
          
          <code class="ruby">    self.products_count = self.products.count</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="63">
          <span class="hits">8</span>
          
          <code class="ruby">    self.product_ids.push( id ) if id &amp;&amp; !product_ids.include?( id )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="65">
          <span class="hits">8</span>
          
          <code class="ruby">    self.languages.push( language ) if !self.languages.include?( language )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="66">
          <span class="hits">8</span>
          
          <code class="ruby">    self.languages_count = self.languages.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="68">
          <span class="hits">8</span>
          
          <code class="ruby">    self.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from developer</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="73">
          <span class="hits">7</span>
          
          <code class="ruby">    self.name             = developer.name             if !developer.name.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="74">
          <span class="hits">7</span>
          
          <code class="ruby">    self.email            = developer.email            if !developer.email.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="75">
          <span class="hits">7</span>
          
          <code class="ruby">    self.homepage         = developer.homepage         if !developer.homepage.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="76">
          <span class="hits">7</span>
          
          <code class="ruby">    self.organization     = developer.organization     if !developer.organization.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="77">
          <span class="hits">7</span>
          
          <code class="ruby">    self.organization_url = developer.organization_url if !developer.organization_url.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="78">
          <span class="hits">7</span>
          
          <code class="ruby">    self.role             = developer.role             if !developer.role.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="79">
          <span class="hits">7</span>
          
          <code class="ruby">    self.timezone         = developer.timezone         if !developer.timezone.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="80">
          <span class="hits">7</span>
          
          <code class="ruby">    self.contributor      = developer.contributor      if !developer.contributor.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="81">
          <span class="hits">7</span>
          
          <code class="ruby">    if !self.emails.include?( developer.email )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="82">
          <span class="hits">7</span>
          
          <code class="ruby">      self.emails.push developer.email</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="83">
          <span class="hits">7</span>
          
          <code class="ruby">      self.emails_count = self.emails.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="85">
          <span class="hits">7</span>
          
          <code class="ruby">    self.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="eb41db192947905ae88cb5a152eee1efdfcd6155">
  <div class="header">
    <h3>lib/versioneye/models/badge.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>26</b> relevant lines. 
      <span class="green"><b>26</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Badge &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_NONE_SVG      = &quot;&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; width=\&quot;126\&quot; height=\&quot;20\&quot;&gt;&lt;linearGradient id=\&quot;b\&quot; x2=\&quot;0\&quot; y2=\&quot;100%\&quot;&gt;&lt;stop offset=\&quot;0\&quot; stop-color=\&quot;#bbb\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;stop offset=\&quot;1\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;/linearGradient&gt;&lt;mask id=\&quot;a\&quot;&gt;&lt;rect width=\&quot;126\&quot; height=\&quot;20\&quot; rx=\&quot;3\&quot; fill=\&quot;#fff\&quot;/&gt;&lt;/mask&gt;&lt;g mask=\&quot;url(#a)\&quot;&gt;&lt;path fill=\&quot;#555\&quot; d=\&quot;M0 0h88v20H0z\&quot;/&gt;&lt;path fill=\&quot;#97CA00\&quot; d=\&quot;M88 0h38v20H88z\&quot;/&gt;&lt;path fill=\&quot;url(#b)\&quot; d=\&quot;M0 0h126v20H0z\&quot;/&gt;&lt;/g&gt;&lt;g fill=\&quot;#fff\&quot; text-anchor=\&quot;middle\&quot; font-family=\&quot;DejaVu Sans,Verdana,Geneva,sans-serif\&quot; font-size=\&quot;11\&quot;&gt;&lt;text x=\&quot;44\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;44\&quot; y=\&quot;14\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;106\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;none&lt;/text&gt;&lt;text x=\&quot;106\&quot; y=\&quot;14\&quot;&gt;none&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  A_UPTODATE_SVG  = &quot;&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; width=\&quot;156\&quot; height=\&quot;20\&quot;&gt;&lt;linearGradient id=\&quot;b\&quot; x2=\&quot;0\&quot; y2=\&quot;100%\&quot;&gt;&lt;stop offset=\&quot;0\&quot; stop-color=\&quot;#bbb\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;stop offset=\&quot;1\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;/linearGradient&gt;&lt;mask id=\&quot;a\&quot;&gt;&lt;rect width=\&quot;156\&quot; height=\&quot;20\&quot; rx=\&quot;3\&quot; fill=\&quot;#fff\&quot;/&gt;&lt;/mask&gt;&lt;g mask=\&quot;url(#a)\&quot;&gt;&lt;path fill=\&quot;#555\&quot; d=\&quot;M0 0h88v20H0z\&quot;/&gt;&lt;path fill=\&quot;#97CA00\&quot; d=\&quot;M88 0h68v20H88z\&quot;/&gt;&lt;path fill=\&quot;url(#b)\&quot; d=\&quot;M0 0h156v20H0z\&quot;/&gt;&lt;/g&gt;&lt;g fill=\&quot;#fff\&quot; text-anchor=\&quot;middle\&quot; font-family=\&quot;DejaVu Sans,Verdana,Geneva,sans-serif\&quot; font-size=\&quot;11\&quot;&gt;&lt;text x=\&quot;44\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;44\&quot; y=\&quot;14\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;121\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;up to date&lt;/text&gt;&lt;text x=\&quot;121\&quot; y=\&quot;14\&quot;&gt;up to date&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  A_OUTOFDATE_SVG = &quot;&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; width=\&quot;160\&quot; height=\&quot;20\&quot;&gt;&lt;linearGradient id=\&quot;b\&quot; x2=\&quot;0\&quot; y2=\&quot;100%\&quot;&gt;&lt;stop offset=\&quot;0\&quot; stop-color=\&quot;#bbb\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;stop offset=\&quot;1\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;/linearGradient&gt;&lt;mask id=\&quot;a\&quot;&gt;&lt;rect width=\&quot;160\&quot; height=\&quot;20\&quot; rx=\&quot;3\&quot; fill=\&quot;#fff\&quot;/&gt;&lt;/mask&gt;&lt;g mask=\&quot;url(#a)\&quot;&gt;&lt;path fill=\&quot;#555\&quot; d=\&quot;M0 0h88v20H0z\&quot;/&gt;&lt;path fill=\&quot;#dfb317\&quot; d=\&quot;M88 0h72v20H88z\&quot;/&gt;&lt;path fill=\&quot;url(#b)\&quot; d=\&quot;M0 0h160v20H0z\&quot;/&gt;&lt;/g&gt;&lt;g fill=\&quot;#fff\&quot; text-anchor=\&quot;middle\&quot; font-family=\&quot;DejaVu Sans,Verdana,Geneva,sans-serif\&quot; font-size=\&quot;11\&quot;&gt;&lt;text x=\&quot;44\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;44\&quot; y=\&quot;14\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;123\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;out of date&lt;/text&gt;&lt;text x=\&quot;123\&quot; y=\&quot;14\&quot;&gt;out of date&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  A_UPDATE_SVG    = &quot;&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; width=\&quot;141\&quot; height=\&quot;20\&quot;&gt;&lt;linearGradient id=\&quot;b\&quot; x2=\&quot;0\&quot; y2=\&quot;100%\&quot;&gt;&lt;stop offset=\&quot;0\&quot; stop-color=\&quot;#bbb\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;stop offset=\&quot;1\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;/linearGradient&gt;&lt;mask id=\&quot;a\&quot;&gt;&lt;rect width=\&quot;141\&quot; height=\&quot;20\&quot; rx=\&quot;3\&quot; fill=\&quot;#fff\&quot;/&gt;&lt;/mask&gt;&lt;g mask=\&quot;url(#a)\&quot;&gt;&lt;path fill=\&quot;#555\&quot; d=\&quot;M0 0h88v20H0z\&quot;/&gt;&lt;path fill=\&quot;#e05d44\&quot; d=\&quot;M88 0h53v20H88z\&quot;/&gt;&lt;path fill=\&quot;url(#b)\&quot; d=\&quot;M0 0h141v20H0z\&quot;/&gt;&lt;/g&gt;&lt;g fill=\&quot;#fff\&quot; text-anchor=\&quot;middle\&quot; font-family=\&quot;DejaVu Sans,Verdana,Geneva,sans-serif\&quot; font-size=\&quot;11\&quot;&gt;&lt;text x=\&quot;44\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;44\&quot; y=\&quot;14\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;113.5\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;update!&lt;/text&gt;&lt;text x=\&quot;113.5\&quot; y=\&quot;14\&quot;&gt;update!&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  A_UNKNOWN_SVG   = &quot;&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; width=\&quot;149\&quot; height=\&quot;20\&quot;&gt;&lt;linearGradient id=\&quot;b\&quot; x2=\&quot;0\&quot; y2=\&quot;100%\&quot;&gt;&lt;stop offset=\&quot;0\&quot; stop-color=\&quot;#bbb\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;stop offset=\&quot;1\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;/linearGradient&gt;&lt;mask id=\&quot;a\&quot;&gt;&lt;rect width=\&quot;149\&quot; height=\&quot;20\&quot; rx=\&quot;3\&quot; fill=\&quot;#fff\&quot;/&gt;&lt;/mask&gt;&lt;g mask=\&quot;url(#a)\&quot;&gt;&lt;path fill=\&quot;#555\&quot; d=\&quot;M0 0h88v20H0z\&quot;/&gt;&lt;path fill=\&quot;#9f9f9f\&quot; d=\&quot;M88 0h61v20H88z\&quot;/&gt;&lt;path fill=\&quot;url(#b)\&quot; d=\&quot;M0 0h149v20H0z\&quot;/&gt;&lt;/g&gt;&lt;g fill=\&quot;#fff\&quot; text-anchor=\&quot;middle\&quot; font-family=\&quot;DejaVu Sans,Verdana,Geneva,sans-serif\&quot; font-size=\&quot;11\&quot;&gt;&lt;text x=\&quot;44\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;44\&quot; y=\&quot;14\&quot;&gt;dependencies&lt;/text&gt;&lt;text x=\&quot;117.5\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;unknown&lt;/text&gt;&lt;text x=\&quot;117.5\&quot; y=\&quot;14\&quot;&gt;unknown&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  A_REF_0_SVG   = &quot;&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; width=\&quot;88\&quot; height=\&quot;20\&quot;&gt;&lt;linearGradient id=\&quot;b\&quot; x2=\&quot;0\&quot; y2=\&quot;100%\&quot;&gt;&lt;stop offset=\&quot;0\&quot; stop-color=\&quot;#bbb\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;stop offset=\&quot;1\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;/linearGradient&gt;&lt;mask id=\&quot;a\&quot;&gt;&lt;rect width=\&quot;88\&quot; height=\&quot;20\&quot; rx=\&quot;3\&quot; fill=\&quot;#fff\&quot;/&gt;&lt;/mask&gt;&lt;g mask=\&quot;url(#a)\&quot;&gt;&lt;path fill=\&quot;#555\&quot; d=\&quot;M0 0h71v20H0z\&quot;/&gt;&lt;path fill=\&quot;#e05d44\&quot; d=\&quot;M71 0h17v20H71z\&quot;/&gt;&lt;path fill=\&quot;url(#b)\&quot; d=\&quot;M0 0h88v20H0z\&quot;/&gt;&lt;/g&gt;&lt;g fill=\&quot;#fff\&quot; text-anchor=\&quot;middle\&quot; font-family=\&quot;DejaVu Sans,Verdana,Geneva,sans-serif\&quot; font-size=\&quot;11\&quot;&gt;&lt;text x=\&quot;35.5\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;references&lt;/text&gt;&lt;text x=\&quot;35.5\&quot; y=\&quot;14\&quot;&gt;references&lt;/text&gt;&lt;text x=\&quot;78.5\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;0&lt;/text&gt;&lt;text x=\&quot;78.5\&quot; y=\&quot;14\&quot;&gt;0&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  A_REF_TEMPLATE_SVG = &quot;&lt;svg xmlns=\&quot;http://www.w3.org/2000/svg\&quot; width=\&quot;123\&quot; height=\&quot;20\&quot;&gt;&lt;linearGradient id=\&quot;b\&quot; x2=\&quot;0\&quot; y2=\&quot;100%\&quot;&gt;&lt;stop offset=\&quot;0\&quot; stop-color=\&quot;#bbb\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;stop offset=\&quot;1\&quot; stop-opacity=\&quot;.1\&quot;/&gt;&lt;/linearGradient&gt;&lt;mask id=\&quot;a\&quot;&gt;&lt;rect width=\&quot;123\&quot; height=\&quot;20\&quot; rx=\&quot;3\&quot; fill=\&quot;#fff\&quot;/&gt;&lt;/mask&gt;&lt;g mask=\&quot;url(#a)\&quot;&gt;&lt;path fill=\&quot;#555\&quot; d=\&quot;M0 0h71v20H0z\&quot;/&gt;&lt;path fill=\&quot;#97CA00\&quot; d=\&quot;M71 0h52v20H71z\&quot;/&gt;&lt;path fill=\&quot;url(#b)\&quot; d=\&quot;M0 0h123v20H0z\&quot;/&gt;&lt;/g&gt;&lt;g fill=\&quot;#fff\&quot; text-anchor=\&quot;middle\&quot; font-family=\&quot;DejaVu Sans,Verdana,Geneva,sans-serif\&quot; font-size=\&quot;11\&quot;&gt;&lt;text x=\&quot;35.5\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;references&lt;/text&gt;&lt;text x=\&quot;35.5\&quot; y=\&quot;14\&quot;&gt;references&lt;/text&gt;&lt;text x=\&quot;96\&quot; y=\&quot;15\&quot; fill=\&quot;#010101\&quot; fill-opacity=\&quot;.3\&quot;&gt;TMP&lt;/text&gt;&lt;text x=\&quot;96\&quot; y=\&quot;14\&quot;&gt;TMP&lt;/text&gt;&lt;/g&gt;&lt;/svg&gt;&quot; </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  A_UP_TO_DATE  = &#39;up_to_date&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  A_OUT_OF_DATE = &#39;out_of_date&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  A_UPDATE      = &#39;update!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  A_NONE        = &#39;none&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  A_UNKNOWN     = &#39;unknown&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  A_REF_0       = &#39;0&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SOURCE_PROJECT = &#39;project&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SOURCE_PRODUCT = &#39;product&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_DEPENDENCY = &#39;dependency&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_REFERENCE  = &#39;reference&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  # project_id or &#39;lang:::prod_key:::version&#39; or &#39;lang:::prod_key:::version:::type&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  field :key     , type: String </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  # up-to-date or out-of-date</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  field :status  , type: String </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  # &#39;dependency&#39; or &#39;reference&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  field :badge_type, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  # &#39;project&#39; or &#39;product&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  field :badge_source, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  # The actual svg xml code </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  field :svg     , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ key: 1 }, { name: &quot;key_index&quot;, background: true, unique: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="03b26ab8aaf34204439416be3ab8dc9a8a8f455e">
  <div class="header">
    <h3>lib/versioneye/models/billing_address.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>58</b> relevant lines. 
      <span class="green"><b>58</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class BillingAddress &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/helpers/countries&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::Countries</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/helpers/billing_types&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::BillingTypes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :type   , type: String, :default =&gt; A_TYPE_INDIVIDUAL</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :street , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :zip    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :city   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :country, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :company, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :taxid  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email  , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :type   , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name   , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :street , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :zip    , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :city   , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :country, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ user_id: 1 }, { name: &quot;user_id_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  before_save :validate_country, :validate_company, :validate_taxid</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from_params( params )</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="36">
          <span class="hits">6</span>
          
          <code class="ruby">    self.type    = params[:type] if !params[:type].to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="37">
          <span class="hits">6</span>
          
          <code class="ruby">    self.name    = params[:name]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="38">
          <span class="hits">6</span>
          
          <code class="ruby">    self.street  = params[:street]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="39">
          <span class="hits">6</span>
          
          <code class="ruby">    self.zip     = params[:zip_code]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="40">
          <span class="hits">6</span>
          
          <code class="ruby">    self.city    = params[:city]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="41">
          <span class="hits">6</span>
          
          <code class="ruby">    self.country = params[:country]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="42">
          <span class="hits">6</span>
          
          <code class="ruby">    self.company = params[:company]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="43">
          <span class="hits">6</span>
          
          <code class="ruby">    self.taxid   = params[:taxid]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="44">
          <span class="hits">6</span>
          
          <code class="ruby">    self.email   = params[:email]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="45">
          <span class="hits">6</span>
          
          <code class="ruby">    self.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def taxid_mandatory?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="49">
          <span class="hits">9</span>
          
          <code class="ruby">    return true if type.eql?(A_TYPE_CORPORATE) &amp;&amp; A_EU.keys.include?(country)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="50">
          <span class="hits">5</span>
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def company_mandatory?</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="54">
          <span class="hits">11</span>
          
          <code class="ruby">    return true if type.eql?(A_TYPE_CORPORATE)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="55">
          <span class="hits">5</span>
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    # For corporations the company name is mandatory</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    def validate_company</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="62">
          <span class="hits">11</span>
          
          <code class="ruby">      if company_mandatory? &amp;&amp; company.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>
          
          <code class="ruby">        self.errors.messages[:company] = [&quot;is mandatory&quot;]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="64">
          <span class="hits">2</span>
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="66">
          <span class="hits">9</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    # For corporations in the EU the taxid is mandatory</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">    def validate_taxid</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="71">
          <span class="hits">9</span>
          
          <code class="ruby">      if taxid_mandatory? &amp;&amp; taxid.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="72">
          <span class="hits">2</span>
          
          <code class="ruby">        self.errors.messages[:taxid] = [&quot;is mandatory&quot;]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="73">
          <span class="hits">2</span>
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="75">
          <span class="hits">7</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">    def validate_country</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="79">
          <span class="hits">13</span>
          
          <code class="ruby">      if !A_COUNTRIES.keys.include?(self.country)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="80">
          <span class="hits">2</span>
          
          <code class="ruby">        self.errors.messages[:country] = [&quot;is not valid value&quot;]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="81">
          <span class="hits">2</span>
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="83">
          <span class="hits">11</span>
          
          <code class="ruby">      true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e5b70b200c3cece08da1c44c1cb0ca9a70827448">
  <div class="header">
    <h3>lib/versioneye/models/bitbucket_repo.rb</h3>
    <h4><span class="green">92.86 %</span> covered</h4>
    <div>
      <b>56</b> relevant lines. 
      <span class="green"><b>52</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class BitbucketRepo &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :fullname     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_login   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :owner_login  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :owner_type   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :private      , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :scm          , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :html_url     , type: String # web url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :clone_url    , type: String # clone url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :size         , type: Integer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :branches     , type: Array</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_files, type: Hash, default: nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at   , type: DateTime, default: DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at   , type: DateTime, default: DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :cached_at    , type: DateTime, default: DateTime.now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ user_id: 1 },     { name: &quot;user_id_index&quot;    , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ name: 1 },        { name: &quot;name_index&quot;       , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ fullname: 1 },    { name: &quot;fullname_index&quot;   , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1 },    { name: &quot;language_index&quot;   , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ owner_login: 1 }, { name: &quot;owner_login_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ owner_type: 1 },  { name: &quot;owner_type_index&quot; , background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_language    , -&gt;(lang){where(language: lang)}</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="33">
          <span class="hits">7</span>
          
          <code class="ruby">  scope :by_user        , -&gt;(user){where(user_id: user[:_id])}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_owner_login , -&gt;(owner){where(owner_login: owner)}</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="35">
          <span class="hits">7</span>
          
          <code class="ruby">  scope :by_fullname    , -&gt;(name){where(fullname: name)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.revision_for user, fullname, branch, filename </code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="39">
          <span class="hits">5</span>
          
          <code class="ruby">    repo = BitbucketRepo.where(:user_id =&gt; user.id.to_s, :fullname =&gt; fullname).first</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="40">
          <span class="hits">5</span>
          
          <code class="ruby">    repo.project_files[branch].each do |files| </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">      return files[&quot;revision&quot;] if files[&quot;path&quot;].eql?(filename)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    nil </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="45">
          <span class="hits">5</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="46">
          <span class="hits">5</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="47">
          <span class="hits">5</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_owner_type(user, owner_info)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="51">
          <span class="hits">7</span>
          
          <code class="ruby">    owner_type = &#39;team&#39;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="52">
          <span class="hits">7</span>
          
          <code class="ruby">    if user[:bitbucket_id] == owner_info[:username]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="53">
          <span class="hits">6</span>
          
          <code class="ruby">      owner_type = &#39;user&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="56">
          <span class="hits">7</span>
          
          <code class="ruby">    return owner_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.build_or_update( user, repo )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="60">
          <span class="hits">7</span>
          
          <code class="ruby">    return nil if repo.nil? || repo.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="62">
          <span class="hits">7</span>
          
          <code class="ruby">    repo = repo.deep_symbolize_keys if repo.respond_to?(&quot;deep_symbolize_keys&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="64">
          <span class="hits">7</span>
          
          <code class="ruby">    owner_info = repo[:owner]</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="65">
          <span class="hits">7</span>
          
          <code class="ruby">    owner_type = get_owner_type(user, owner_info)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="66">
          <span class="hits">7</span>
          
          <code class="ruby">    repo_links = repo[:links]</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="67">
          <span class="hits">7</span>
          
          <code class="ruby">    fullname = repo[:full_name]</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="68">
          <span class="hits">7</span>
          
          <code class="ruby">    fullname = repo[:fullname] if fullname.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="70">
          <span class="hits">7</span>
          
          <code class="ruby">    repo = BitbucketRepo.find_or_create_by(:user_id =&gt; user.id.to_s, :fullname =&gt; fullname)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="71">
          <span class="hits">7</span>
          
          <code class="ruby">    repo.update_attributes!({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">      user_login: user[:bitbucket_id],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      name: repo[:name],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">      scm: repo[:scm],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">      owner_login: owner_info[:username],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">      owner_type: owner_type,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">      language: repo[:language].to_s.downcase,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">      description: repo[:description],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">      private: repo[:is_private],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">      html_url: repo_links[:html][:href],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">      clone_url: repo_links[:clone].to_a.last[:href],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">      size: repo[:size]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">      # This will be completed by bitbucket_repo_import_worker or have to be set from extern.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">      # branches: repo_branches,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">      # project_files: project_files,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="89">
          <span class="hits">7</span>
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="11102434ee95117740b3d86023b6aff4db14a9ad">
  <div class="header">
    <h3>lib/versioneye/models/circle_element.rb</h3>
    <h4><span class="red">47.83 %</span> covered</h4>
    <div>
      <b>46</b> relevant lines. 
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>24</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class CircleElement &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # This attributes describe to which product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # this circle_element belongs to. Parent!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # This fields are only important if you wanan store the</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # instance to DB. Otherwise they can be empty!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language           , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key           , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_version       , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_scope         , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  # This attributes describe the circle_element itself!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dep_prod_key       , type: String, :default =&gt; &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version            , type: String, :default =&gt; &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :text               , type: String, :default =&gt; &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :connections_string , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dependencies_string, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :level              , type: Integer, :default =&gt; 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :connections, :dependencies</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_circle(language, prod_key, version, scope)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    CircleElement.where(language: language, prod_key: prod_key, prod_version: version, prod_scope: scope)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_arrays</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    self.connections  = Array.new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    self.dependencies = Array.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.store_circle(circle, lang, prod_key, version, scope)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    circle.each do |key, element|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      element.language            = lang</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">      element.prod_key            = prod_key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">      element.prod_version        = version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">      element.prod_scope          = scope</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      element.connections_string  = element.connections_as_string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">      element.dependencies_string = element.dependencies_as_string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">      element.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def connections_as_string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    response = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    return response if connections.nil? or connections.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    connections.each do |conn|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">      response += &quot;\&quot;#{conn}\&quot;,&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    end_pos = response.size - 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    response[0..end_pos]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def dependencies_as_string</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    response = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    return response if dependencies.nil? or dependencies.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    dependencies.each do |dep|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">      response += &quot;\&quot;#{dep}\&quot;,&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    end_pos = response.size - 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    response[0..end_pos]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def as_json(options = {})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">      :text        =&gt; self.text,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      :id          =&gt; self.dep_prod_key,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">      :connections =&gt; self.connections</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ff0c0e5b70d8a9855a6f28e95bac1eb8c0f4c278">
  <div class="header">
    <h3>lib/versioneye/models/crawle.rb</h3>
    <h4><span class="yellow">85.71 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Crawle &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :crawler_name   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :crawler_version, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :repository_src , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :start_point    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :exec_group     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :duration       , type: DateTime</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :error_messages</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def crawler_name_and_version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    &quot;#{crawler_name} - #{crawler_version}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_param</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    _id.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="cba135c1dee484db519649b5af3fc919debbb39f">
  <div class="header">
    <h3>lib/versioneye/models/crawler_task.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines. 
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class CrawlerTask &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :poison_pill  , type: Boolean, default: false # Use it to kill crawler</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :runs         , type: Integer, default: 0     # How many times crawled</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :fails        , type: Integer, default: 0     # How many times failed</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :task         , type: String                  # Task Type, classification. Use format &lt;crawlers_name&gt;/&lt;task_name&gt;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :task_failed  , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :re_crawl     , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url          , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url_params   , type: Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url_exists   , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :repo_owner   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :repo_name    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :repo_fullname, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :registry_name, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :tag_name     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :weight       , type: Integer, default: 0 # To prioritize tasks</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :data         , type: Hash                # Subdocument to keep pre-cached data</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :crawled_at   , type: DateTime            # When it had last successful crawl</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_task      , -&gt;(name){where(task: name)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :crawlable    , -&gt;{ where(re_crawl: true, url_exists: true) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ task: 1 },          { name: &quot;task_index&quot;    , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ task: 1, re_crawl: 1, url_exists: 1 }, { name: &quot;task_recrawl_urlexists_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ repo_fullname: 1 }, { name: &quot;repo_fullname_index&quot; , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ task: 1, repo_fullname: 1 }, { name: &quot;task_repo_fullname_index&quot; , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ task: 1, repo_fullname: 1, tag_name: 1 }, { name: &quot;task_repo_fullname_tag_index&quot; , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ task: 1, repo_fullname: 1, prod_key: 1 }, { name: &quot;task_repo_fullname_prod_key_index&quot; , background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="beed9800feb24c05e5198895ff68c8d24b1ddfd5">
  <div class="header">
    <h3>lib/versioneye/models/dependency.rb</h3>
    <h4><span class="yellow">88.78 %</span> covered</h4>
    <div>
      <b>98</b> relevant lines. 
      <span class="green"><b>87</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Dependency &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/project&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/product&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # This Model describes the relationship between 2 products/packages</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # This Model describes 1 dependency of a package to another package</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SCOPE_RUNTIME     = &#39;runtime&#39;     # RubyGems</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SCOPE_REQUIRE     = &#39;require&#39;     # PHP Composer, Bower</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SCOPE_PROVIDED    = &#39;provided&#39;    # Java Maven</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SCOPE_TEST        = &#39;test&#39;        # Java Maven</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SCOPE_COMPILE     = &#39;compile&#39;     # NPM, Maven and many more! </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SCOPE_DEVELOPMENT = &#39;development&#39; # NPM, Bower </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SCOPE_BUNDLED     = &#39;bundled&#39;     # NPM</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SCOPE_OPTIONAL    = &#39;optional&#39;    # NPM</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  # Podspecs of CocoaPods doesn&#39;t have scopes/targets</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  # But Podfiles can have targets</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  # This attributes describe to which product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  # this dependency belongs to. Parent!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_type   , type: String,  :default =&gt; Project::A_TYPE_RUBYGEMS</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language    , type: String,  :default =&gt; Product::A_LANGUAGE_RUBY</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key    , type: String   # This dependency belongs to this prod_key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_version, type: String   # This dependency belongs to this version of prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  # This attributes describe the dependency itself!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dep_prod_key, type: String   # prod_key of the dependency (Foreign Key)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version     , type: String   # version of the dependency. This is the unfiltered version string. It is not parsed yet.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  field :group_id    , type: String   # Maven specific</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  field :artifact_id , type: String   # Maven specific</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  field :scope       , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  # known or unknown dependency.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  # If there is no product for dep_prod_key in our db then it&#39;s unknown</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  field :known       , type: Boolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  # The current/newest version of the product, which this dep is referencing</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  field :current_version, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  # The parsed version, without operator</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  field :parsed_version , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  field :outdated, type: Boolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, prod_version: 1, dep_prod_key: 1, version: 1, scope: 1 }, { name: &quot;parent_fk_index&quot;, background: true, unique: true, drop_dups: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, prod_version: 1 }, { name: &quot;prod_key_lang_ver_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, dep_prod_key: 1 }, { name: &quot;language_dep_prod_key_index&quot; , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ group_id: 1, artifact_id: 1 }, { name: &quot;groupid_artifactid_index&quot; , background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove_dependencies language, prod_key, version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">    Dependency.where( language: language, prod_key: prod_key, prod_version: version ).delete_all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_lang_key_and_version( language, prod_key, version)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="60">
          <span class="hits">9</span>
          
          <code class="ruby">    langs = language_array(language)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="61">
          <span class="hits">9</span>
          
          <code class="ruby">    Dependency.where( :language.in =&gt; langs, prod_key: prod_key, prod_version: version )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_lang_key_version_scope(language, prod_key, version, scope)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="65">
          <span class="hits">12</span>
          
          <code class="ruby">    langs = language_array(language)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="66">
          <span class="hits">12</span>
          
          <code class="ruby">    if scope</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="67">
          <span class="hits">11</span>
          
          <code class="ruby">      return Dependency.where( :language.in =&gt; langs, prod_key: prod_key, prod_version: version, scope: scope )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">      return Dependency.where( :language.in =&gt; langs, prod_key: prod_key, prod_version: version )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by(language, prod_key, prod_version, dep_name, dep_version, dep_prod_key)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="74">
          <span class="hits">2</span>
          
          <code class="ruby">    dependencies = Dependency.where(language: language, prod_key: prod_key, prod_version: prod_version, name: dep_name, version: dep_version, dep_prod_key: dep_prod_key)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="75">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if dependencies.nil? || dependencies.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">  def product</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="80">
          <span class="hits">27</span>
          
          <code class="ruby">    return maven_product( group_id, artifact_id ) if group_id &amp;&amp; artifact_id</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="81">
          <span class="hits">8</span>
          
          <code class="ruby">    return bower_product( dep_prod_key ) if prod_type &amp;&amp; prod_type.eql?(Project::A_TYPE_BOWER)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="82">
          <span class="hits">8</span>
          
          <code class="ruby">    Product.fetch_product( language, dep_prod_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  # In the world of Maven (Java) every package is identified by a group_id and artifact_id.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def maven_product( group_id, artifact_id )</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="87">
          <span class="hits">19</span>
          
          <code class="ruby">    Product.find_by_group_and_artifact( group_id, artifact_id, language )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  # prod_key for bower packages are assembled by &#39;owner/bower_name&#39;. We did it that way</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  # because on bower the names are case sensitive. To avoid case sensitive URLs we descided</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  # to take the owner into the prod_key.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  # Unfortunately the dependencies in the bower.json only contains the bower name, without the owner.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  # That&#39;s why we fetch dependencies for bower through prod_type and name. This combination is unique.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">  def bower_product( dep_prod_key )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">    Product.where(:prod_type =&gt; Project::A_TYPE_BOWER, :prod_key =&gt; dep_prod_key).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">  def parent_product</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    Product.fetch_product( language, prod_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">  def language_escaped</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    Product.encode_language( language )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_known</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="108">
          <span class="hits">2</span>
          
          <code class="ruby">    self.known = self.product.nil?() ? false : true</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="109">
          <span class="hits">2</span>
          
          <code class="ruby">    self.save()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_known_if_nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">    self.update_known() if self.known.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.main_scope( language, prod_type = nil )</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="117">
          <span class="hits">16</span>
          
          <code class="ruby">    if prod_type.to_s.eql?( Project::A_TYPE_BOWER )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">      return A_SCOPE_REQUIRE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="121">
          <span class="hits">15</span>
          
          <code class="ruby">    if language.eql?( Product::A_LANGUAGE_RUBY )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="122">
          <span class="hits">2</span>
          
          <code class="ruby">      return A_SCOPE_RUNTIME</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="123">
          <span class="hits">13</span>
          
          <code class="ruby">    elsif language.eql?( Product::A_LANGUAGE_JAVA ) || language.eql?( Product::A_LANGUAGE_CLOJURE ) || language.eql?( Product::A_LANGUAGE_BIICODE )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="124">
          <span class="hits">11</span>
          
          <code class="ruby">      return A_SCOPE_COMPILE</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="125">
          <span class="hits">2</span>
          
          <code class="ruby">    elsif language.eql?( Product::A_LANGUAGE_NODEJS)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">      return A_SCOPE_COMPILE</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="127">
          <span class="hits">1</span>
          
          <code class="ruby">    elsif language.eql?( Product::A_LANGUAGE_PHP ) || language.eql?( Product::A_LANGUAGE_JAVASCRIPT )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">      return A_SCOPE_REQUIRE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="132">
          <span class="hits">1</span>
          
          <code class="ruby">  def dep_prod_key_for_url</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">    Product.encode_prod_key dep_prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="136">
          <span class="hits">1</span>
          
          <code class="ruby">  def version_for_url</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">    Version.encode_version( parsed_version )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">    return self.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="143">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">    &quot;Dependency - #{language}:#{prod_key}:#{prod_version} depends on #{dep_prod_key}:#{version} scope: #{scope} - name: #{name}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">  def set_prod_type_if_nil</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="148">
          <span class="hits">30</span>
          
          <code class="ruby">    self.prod_type = Project::A_TYPE_RUBYGEMS  if self.language.eql?(Product::A_LANGUAGE_RUBY)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="149">
          <span class="hits">30</span>
          
          <code class="ruby">    self.prod_type = Project::A_TYPE_COMPOSER  if self.language.eql?(Product::A_LANGUAGE_PHP)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="150">
          <span class="hits">30</span>
          
          <code class="ruby">    self.prod_type = Project::A_TYPE_PIP       if self.language.eql?(Product::A_LANGUAGE_PYTHON)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="151">
          <span class="hits">30</span>
          
          <code class="ruby">    self.prod_type = Project::A_TYPE_NPM       if self.language.eql?(Product::A_LANGUAGE_NODEJS)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="152">
          <span class="hits">30</span>
          
          <code class="ruby">    self.prod_type = Project::A_TYPE_MAVEN2    if self.language.eql?(Product::A_LANGUAGE_JAVA)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="153">
          <span class="hits">30</span>
          
          <code class="ruby">    self.prod_type = Project::A_TYPE_LEIN      if self.language.eql?(Product::A_LANGUAGE_CLOJURE)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="154">
          <span class="hits">30</span>
          
          <code class="ruby">    self.prod_type = Project::A_TYPE_BOWER     if self.language.eql?(Product::A_LANGUAGE_JAVASCRIPT)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="155">
          <span class="hits">30</span>
          
          <code class="ruby">    self.prod_type = Project::A_TYPE_COCOAPODS if self.language.eql?(Product::A_LANGUAGE_OBJECTIVEC)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="156">
          <span class="hits">30</span>
          
          <code class="ruby">    self.prod_type = Project::A_TYPE_BIICODE   if self.language.eql?(Product::A_LANGUAGE_BIICODE)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="157">
          <span class="hits">30</span>
          
          <code class="ruby">    self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="160">
          <span class="hits">1</span>
          
          <code class="ruby">  private </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="162">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.language_array language </code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="163">
          <span class="hits">21</span>
          
          <code class="ruby">      langs = [language]</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="164">
          <span class="hits">21</span>
          
          <code class="ruby">      if language.eql?(Product::A_LANGUAGE_CLOJURE || language.eql?(Product::A_LANGUAGE_JAVA))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">        langs = [Product::A_LANGUAGE_CLOJURE, Product::A_LANGUAGE_JAVA]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="167">
          <span class="hits">21</span>
          
          <code class="ruby">      langs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0ad029cc46fda94f1e8c92b697ed5af7c2c3dc0d">
  <div class="header">
    <h3>lib/versioneye/models/developer.rb</h3>
    <h4><span class="green">91.67 %</span> covered</h4>
    <div>
      <b>36</b> relevant lines. 
      <span class="green"><b>33</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Developer &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # This developer belongs to the product with this attributes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version         , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  # combination of language and prod_key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :lang_key        , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :developer       , type: String # This is the username of the developer! Legacy. The name is taken from maven. The very first implementation.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name            , type: String # This is the real name of the developer!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email           , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :homepage        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :organization    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :organization_url, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :role            , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :timezone        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :contributor     , type: Boolean, default: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :to_author       , type: Boolean, default: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, version: 1, name: 1 }, { name: &quot;language_prod_key_version_name_index&quot;, background: true, unique: true, drop_dups: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, version: 1 },          { name: &quot;language_prod_key_version_index&quot;,      background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1 },                      { name: &quot;language_prod_key_index&quot;,              background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ name: 1 }, { name: &quot;name_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  before_save :update_lang_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    &quot;#{name} - #{email}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_param</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="42">
          <span class="hits">3</span>
          
          <code class="ruby">    return Author.encode_name(self.name)      if !self.name.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    return Author.encode_name(self.developer) if !self.developer.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    return &quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def product</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="49">
          <span class="hits">8</span>
          
          <code class="ruby">    Product.fetch_product language, prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_lang_key</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="54">
          <span class="hits">15</span>
          
          <code class="ruby">    self.lang_key = &quot;#{language}:::#{prod_key}&quot;.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by language, prod_key, version, name = nil</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="59">
          <span class="hits">3</span>
          
          <code class="ruby">    if name.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">      return Developer.where( language: language, prod_key: prod_key, version: version )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="62">
          <span class="hits">3</span>
          
          <code class="ruby">      return Developer.where( language: language, prod_key: prod_key, version: version, name: name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1c20423c8157b9b4984aacd1d05be125e30465cd">
  <div class="header">
    <h3>lib/versioneye/models/docker_image.rb</h3>
    <h4><span class="red">69.23 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class DockerImage &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :image_name   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :image_version, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description  , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    &quot;#{image_name}:#{image_version} - #{description}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.by_name name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    DockerImage.where(:image_name =&gt; name).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.version name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    image = DockerImage.where(:image_name =&gt; name).first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    return image.image_version if image</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="53f3f213481726164b9199f3c06cb0d1873765e0">
  <div class="header">
    <h3>lib/versioneye/models/email_setting.rb</h3>
    <h4><span class="red">58.33 %</span> covered</h4>
    <div>
      <b>36</b> relevant lines. 
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>15</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class EmailSetting &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :address             , type: String , default: &#39;your.smtp.server.com&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :port                , type: Integer, default: 587</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :username            , type: String , default: &#39;username&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :password            , type: String , default: &#39;password&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :domain              , type: String , default: &#39;your.domain.com&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :authentication      , type: String , default: &#39;plain&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :enable_starttls_auto, type: Boolean, default: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :sender_name         , type: String , default: &#39;VersionEye&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :sender_email        , type: String , default: &#39;notify@versioneye.com&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :address , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :port    , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :enable_starttls_auto, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :sender_email, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_default</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="22">
          <span class="hits">6</span>
          
          <code class="ruby">    email_setting = EmailSetting.new</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="23">
          <span class="hits">6</span>
          
          <code class="ruby">    email_setting.save</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="24">
          <span class="hits">6</span>
          
          <code class="ruby">    email_setting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from params</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    self.address              = params[:address]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    self.port                 = params[:port]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    self.username             = params[:username]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    self.password             = params[:password] if params[:password]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    self.domain               = params[:domain]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    self.authentication       = params[:authentication]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    tls = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    if params[:enable_starttls_auto] &amp;&amp; params[:enable_starttls_auto].eql?(&quot;true&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      tls = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    self.enable_starttls_auto = tls</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    self.sender_name          = params[:sender_name] if params[:sender_name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    self.sender_email         = params[:sender_email] if params[:sender_email]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    self.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9aeaceafa0a546ea2a02d39f7008f6209b0168e3">
  <div class="header">
    <h3>lib/versioneye/models/enterprise_lead.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class EnterpriseLead &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :scm           , type: String, default: &#39;github&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :repository    , type: String, default: &#39;nexus&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :ci            , type: String, default: &#39;jenkins&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :virtualization, type: String, default: &#39;vmware&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name          , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :note          , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :scm,            :message =&gt; &#39;is mandatory&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :repository,     :message =&gt; &#39;is mandatory&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :ci,             :message =&gt; &#39;is mandatory&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :virtualization, :message =&gt; &#39;is mandatory&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name,           :message =&gt; &#39;is mandatory&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :email,          :message =&gt; &#39;is mandatory&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9af0f473c2bb5522412268801f84d2f3fd87271b">
  <div class="header">
    <h3>lib/versioneye/models/error_message.rb</h3>
    <h4><span class="red">72.73 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ErrorMessage &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :subject     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :errormessage, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :source      , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :crawle</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_page( page_number  )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    page_number = 1 if page_number.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    query = Mongoid::Criteria.new(ErrorMessage)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    query.paginate( :page =&gt; page_number, :per_page =&gt; 30 )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d6130675591330a039c04b44388f106d99711b60">
  <div class="header">
    <h3>lib/versioneye/models/event.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>14</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Event &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :type, type: String  # new_version, user_follow_user, user_follow_product, version_comment,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_name    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_version , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_type    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_group_id, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :follower_id, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :followed_id, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version_comment_id, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version_comment_user_id, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="46ce6b00660e3c5cb05a02e26fed207e78ddba8f">
  <div class="header">
    <h3>lib/versioneye/models/github_repo.rb</h3>
    <h4><span class="red">61.64 %</span> covered</h4>
    <div>
      <b>73</b> relevant lines. 
      <span class="green"><b>45</b> lines covered</span> and
      <span class="red"><b>28</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class GithubRepo &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  field :github_id   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :fullname    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_login  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :owner_login , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :owner_type  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :owner_avatar, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :private     , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :fork        , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :github_url  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :homepage    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :git_url     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :html_url    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :forks       , type: Integer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :watchers    , type: Integer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :size        , type: Integer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :etag        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :branches    , type: Array</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_files, type: Hash,    :default =&gt; nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  field :created_at  , type: DateTime, :default =&gt; DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  field :updated_at  , type: DateTime, :default =&gt; DateTime.now #when github repo was updated</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  field :pushed_at   , type: DateTime, :default =&gt; DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  field :cached_at   , type: DateTime, :default =&gt; DateTime.now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ user_id: 1 },     { name: &quot;user_id_index&quot;    , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ name: 1 },        { name: &quot;name_index&quot;       , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ fullname: 1 },    { name: &quot;fullname_index&quot;   , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1 },    { name: &quot;language_index&quot;   , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ owner_login: 1 }, { name: &quot;owner_login_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ owner_type: 1 },  { name: &quot;owner_type_index&quot; , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ owner_login: 1, owner_type: 1 }, { name: &quot;login_typ_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ github_id: 1, fullname: 1 },     { name: &quot;githubid_fullname_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_language   , -&gt;(lang){where(language: lang)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_user       , -&gt;(user){where(user_id: user._id)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_owner_login, -&gt;(login){where(owner_login: login)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_fullname   , -&gt;(fullname){where(fullname: fullname)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_owner_type , -&gt;(type_name){where(owner_type: type_name)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_org        , -&gt;(org_name){where(owner_login: org_name, owner_type: &#39;organization&#39;)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_owner_type(user, owner_info)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    owner_type = &quot;unknown&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    user_login = github_login_for user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    case owner_info[:type].to_s.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    when &#39;organization&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">      owner_type = &#39;organization&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    when &#39;user&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">      if user_login != owner_info[:login] then</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">        owner_type = &#39;team&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">        owner_type = &#39;user&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">      owner_type = &#39;unknown&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    owner_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.github_login_for user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    if user[:github_login].nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">      user_info = Github.user(user.github_token)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">      if user_info</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">        user[:github_login] = user_info[:login]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">        user.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    user[:github_login]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  # This dataset is incomplete. It will be completed by github_repo_import_worker</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.build_or_update user, repo_data, etag = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">    return nil if repo_data.nil? || repo_data.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    repo_data = repo_data.deep_symbolize_keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">    owner_info = repo_data[:owner]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    owner_type = get_owner_type(user, owner_info)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">    repo = GithubRepo.find_or_create_by(:github_id =&gt; user.github_id, :fullname =&gt; repo_data[:full_name])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">    repo.update_attributes!({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      user_id: user.id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      user_login: user[:user_login],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      name: repo_data[:name],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">      fullname: repo_data[:full_name],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">      owner_login: owner_info[:login],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">      owner_avatar: owner_info[:avatar_url],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">      owner_type: owner_type,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">      language: repo_data[:language].to_s.downcase,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">      description: repo_data[:description],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">      private: repo_data[:private],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">      fork: repo_data[:fork],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">      github_url: repo_data[:url],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">      homepage: repo_data[:homepage],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">      git_url: repo_data[:git_url],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">      html_url: repo_data[:html_url],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">      forks: repo_data[:forks],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">      watchers: repo_data[:watchers],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">      size: repo_data[:size],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">      etag: etag.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">      created_at: repo_data[:created_at],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">      updated_at: repo_data[:updated_at],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">      pushed_at: repo_data[:pushed_at]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">      # This will be completed by github_repo_import_worker or have to be set from extern.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">      # branches: repo_data[:branches],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">      # project_files: repo_data[:project_files],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="496423b99000756b5af4682ea45445866d628b56">
  <div class="header">
    <h3>lib/versioneye/models/global_setting.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>30</b> relevant lines. 
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class GlobalSetting &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :environment , type: String, default: &#39;development&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :key         , type: String, default: &#39;RAILS_ENV&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :value       , type: String, default: &#39;development&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ environment: 1, key: 1, value: 1 }, { unique: true, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ environment: 1, key: 1},            { unique: true, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">    &quot;#{environment} : #{key} : #{value}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get env, key</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="20">
          <span class="hits">18</span>
          
          <code class="ruby">    return nil if env.to_s.empty? || key.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="22">
          <span class="hits">18</span>
          
          <code class="ruby">    gs = GlobalSetting.where(:environment =&gt; env, :key =&gt; key.upcase).first</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="23">
          <span class="hits">18</span>
          
          <code class="ruby">    return nil if gs.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="25">
          <span class="hits">13</span>
          
          <code class="ruby">    gs.value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.set env, key, value</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="30">
          <span class="hits">18</span>
          
          <code class="ruby">    return nil if env.to_s.empty? || key.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="32">
          <span class="hits">18</span>
          
          <code class="ruby">    gs = GlobalSetting.where(:environment =&gt; env, :key =&gt; key.upcase).first</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="33">
          <span class="hits">18</span>
          
          <code class="ruby">    if gs.nil?</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="34">
          <span class="hits">15</span>
          
          <code class="ruby">      gs = GlobalSetting.new(:environment =&gt; env, :key =&gt; key.upcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="36">
          <span class="hits">18</span>
          
          <code class="ruby">    gs.value = value</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="37">
          <span class="hits">18</span>
          
          <code class="ruby">    gs.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.keys env</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="42">
          <span class="hits">7</span>
          
          <code class="ruby">    GlobalSetting.where(:environment =&gt; env).distinct(:key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def get env, key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    GlobalSetting.get env, key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def set env, key, value</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    GlobalSetting.set env, key, value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  def keys env</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="55">
          <span class="hits">6</span>
          
          <code class="ruby">    GlobalSetting.keys env</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="888894a0292ed0ef171cdae7dc510a2c8d53fe00">
  <div class="header">
    <h3>lib/versioneye/models/helpers/billing_types.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module VersionEye</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  module BillingTypes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    A_TYPE_INDIVIDUAL = &#39;Individual&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    A_TYPE_CORPORATE = &#39;Corporation&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="02ab1528e1f252b8ff975cf27817b44ec27fa1b6">
  <div class="header">
    <h3>lib/versioneye/models/helpers/countries.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module VersionEye</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  module Countries</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    A_COUNTRIES = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">      &quot;AF&quot; =&gt; &quot;Afghanistan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">      &quot;AX&quot; =&gt; &quot;land Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">      &quot;AL&quot; =&gt; &quot;Albania&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">      &quot;DZ&quot; =&gt; &quot;Algeria&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">      &quot;AS&quot; =&gt; &quot;American Samoa&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">      &quot;AD&quot; =&gt; &quot;Andorra&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      &quot;AO&quot; =&gt; &quot;Angola&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">      &quot;AI&quot; =&gt; &quot;Anguilla&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">      &quot;AQ&quot; =&gt; &quot;Antarctica&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">      &quot;AG&quot; =&gt; &quot;Antigua and Barbuda&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      &quot;AR&quot; =&gt; &quot;Argentina&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">      &quot;AM&quot; =&gt; &quot;Armenia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      &quot;AW&quot; =&gt; &quot;Aruba&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      &quot;AU&quot; =&gt; &quot;Australia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      &quot;AT&quot; =&gt; &quot;Austria&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">      &quot;AZ&quot; =&gt; &quot;Azerbaijan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      &quot;BS&quot; =&gt; &quot;Bahamas&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      &quot;BH&quot; =&gt; &quot;Bahrain&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      &quot;BD&quot; =&gt; &quot;Bangladesh&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">      &quot;BB&quot; =&gt; &quot;Barbados&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      &quot;BY&quot; =&gt; &quot;Belarus&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      &quot;BE&quot; =&gt; &quot;Belgium&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">      &quot;BZ&quot; =&gt; &quot;Belize&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">      &quot;BJ&quot; =&gt; &quot;Benin&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      &quot;BM&quot; =&gt; &quot;Bermuda&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      &quot;BT&quot; =&gt; &quot;Bhutan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      &quot;BO&quot; =&gt; &quot;Bolivia, Plurinational State of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">      &quot;BQ&quot; =&gt; &quot;Bonaire, Sint Eustatius and Saba&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">      &quot;BA&quot; =&gt; &quot;Bosnia and Herzegovina&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      &quot;BW&quot; =&gt; &quot;Botswana&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">      &quot;BV&quot; =&gt; &quot;Bouvet Island&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">      &quot;BR&quot; =&gt; &quot;Brazil&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">      &quot;IO&quot; =&gt; &quot;British Indian Ocean Territory&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">      &quot;BN&quot; =&gt; &quot;Brunei Darussalam&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      &quot;BG&quot; =&gt; &quot;Bulgaria&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      &quot;BF&quot; =&gt; &quot;Burkina Faso&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">      &quot;BI&quot; =&gt; &quot;Burundi&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">      &quot;KH&quot; =&gt; &quot;Cambodia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      &quot;CM&quot; =&gt; &quot;Cameroon&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">      &quot;CA&quot; =&gt; &quot;Canada&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">      &quot;CV&quot; =&gt; &quot;Cabo Verde&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">      &quot;KY&quot; =&gt; &quot;Cayman Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">      &quot;CF&quot; =&gt; &quot;Central African Republic&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      &quot;TD&quot; =&gt; &quot;Chad&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">      &quot;CL&quot; =&gt; &quot;Chile&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">      &quot;CN&quot; =&gt; &quot;China&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">      &quot;CX&quot; =&gt; &quot;Christmas Island&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      &quot;CC&quot; =&gt; &quot;Cocos (Keeling) Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      &quot;CO&quot; =&gt; &quot;Colombia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      &quot;KM&quot; =&gt; &quot;Comoros&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">      &quot;CG&quot; =&gt; &quot;Congo&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">      &quot;CD&quot; =&gt; &quot;Congo, the Democratic Republic of the&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      &quot;CK&quot; =&gt; &quot;Cook Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">      &quot;CR&quot; =&gt; &quot;Costa Rica&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">      &quot;CI&quot; =&gt; &quot;Cte d&#39;Ivoire&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">      &quot;HR&quot; =&gt; &quot;Croatia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">      &quot;CU&quot; =&gt; &quot;Cuba&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">      &quot;CW&quot; =&gt; &quot;Curaao&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">      &quot;CY&quot; =&gt; &quot;Cyprus&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      &quot;CZ&quot; =&gt; &quot;Czech Republic&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">      &quot;DK&quot; =&gt; &quot;Denmark&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">      &quot;DJ&quot; =&gt; &quot;Djibouti&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">      &quot;DM&quot; =&gt; &quot;Dominica&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">      &quot;DO&quot; =&gt; &quot;Dominican Republic&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">      &quot;EC&quot; =&gt; &quot;Ecuador&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">      &quot;EG&quot; =&gt; &quot;Egypt&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">      &quot;SV&quot; =&gt; &quot;El Salvador&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">      &quot;GQ&quot; =&gt; &quot;Equatorial Guinea&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      &quot;ER&quot; =&gt; &quot;Eritrea&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">      &quot;EE&quot; =&gt; &quot;Estonia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">      &quot;ET&quot; =&gt; &quot;Ethiopia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">      &quot;FK&quot; =&gt; &quot;Falkland Islands (Malvinas)&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">      &quot;FO&quot; =&gt; &quot;Faroe Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">      &quot;FJ&quot; =&gt; &quot;Fiji&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">      &quot;FI&quot; =&gt; &quot;Finland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">      &quot;FR&quot; =&gt; &quot;France&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">      &quot;GF&quot; =&gt; &quot;French Guiana&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">      &quot;PF&quot; =&gt; &quot;French Polynesia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">      &quot;TF&quot; =&gt; &quot;French Southern Territories&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">      &quot;GA&quot; =&gt; &quot;Gabon&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">      &quot;GM&quot; =&gt; &quot;Gambia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">      &quot;GE&quot; =&gt; &quot;Georgia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">      &quot;DE&quot; =&gt; &quot;Germany&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      &quot;GH&quot; =&gt; &quot;Ghana&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">      &quot;GI&quot; =&gt; &quot;Gibraltar&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">      &quot;GR&quot; =&gt; &quot;Greece&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">      &quot;GL&quot; =&gt; &quot;Greenland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">      &quot;GD&quot; =&gt; &quot;Grenada&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">      &quot;GP&quot; =&gt; &quot;Guadeloupe&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">      &quot;GU&quot; =&gt; &quot;Guam&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">      &quot;GT&quot; =&gt; &quot;Guatemala&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">      &quot;GG&quot; =&gt; &quot;Guernsey&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      &quot;GN&quot; =&gt; &quot;Guinea&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      &quot;GW&quot; =&gt; &quot;Guinea-Bissau&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      &quot;GY&quot; =&gt; &quot;Guyana&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">      &quot;HT&quot; =&gt; &quot;Haiti&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">      &quot;HM&quot; =&gt; &quot;Heard Island and McDonald Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">      &quot;VA&quot; =&gt; &quot;Holy See (Vatican City State)&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">      &quot;HN&quot; =&gt; &quot;Honduras&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">      &quot;HK&quot; =&gt; &quot;Hong Kong&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">      &quot;HU&quot; =&gt; &quot;Hungary&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">      &quot;IS&quot; =&gt; &quot;Iceland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">      &quot;IN&quot; =&gt; &quot;India&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">      &quot;ID&quot; =&gt; &quot;Indonesia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">      &quot;IR&quot; =&gt; &quot;Iran, Islamic Republic of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">      &quot;IQ&quot; =&gt; &quot;Iraq&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">      &quot;IE&quot; =&gt; &quot;Ireland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">      &quot;IM&quot; =&gt; &quot;Isle of Man&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">      &quot;IL&quot; =&gt; &quot;Israel&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">      &quot;IT&quot; =&gt; &quot;Italy&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">      &quot;JM&quot; =&gt; &quot;Jamaica&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">      &quot;JP&quot; =&gt; &quot;Japan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">      &quot;JE&quot; =&gt; &quot;Jersey&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">      &quot;JO&quot; =&gt; &quot;Jordan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">      &quot;KZ&quot; =&gt; &quot;Kazakhstan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">      &quot;KE&quot; =&gt; &quot;Kenya&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">      &quot;KI&quot; =&gt; &quot;Kiribati&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">      &quot;KP&quot; =&gt; &quot;Korea, Democratic People&#39;s Republic of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">      &quot;KR&quot; =&gt; &quot;Korea, Republic of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">      &quot;KW&quot; =&gt; &quot;Kuwait&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">      &quot;KG&quot; =&gt; &quot;Kyrgyzstan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">      &quot;LA&quot; =&gt; &quot;Lao People&#39;s Democratic Republic&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">      &quot;LV&quot; =&gt; &quot;Latvia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">      &quot;LB&quot; =&gt; &quot;Lebanon&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">      &quot;LS&quot; =&gt; &quot;Lesotho&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">      &quot;LR&quot; =&gt; &quot;Liberia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">      &quot;LY&quot; =&gt; &quot;Libya&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">      &quot;LI&quot; =&gt; &quot;Liechtenstein&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">      &quot;LT&quot; =&gt; &quot;Lithuania&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">      &quot;LU&quot; =&gt; &quot;Luxembourg&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">      &quot;MO&quot; =&gt; &quot;Macao&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">      &quot;MK&quot; =&gt; &quot;Macedonia, the former Yugoslav Republic of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">      &quot;MG&quot; =&gt; &quot;Madagascar&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">      &quot;MW&quot; =&gt; &quot;Malawi&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">      &quot;MY&quot; =&gt; &quot;Malaysia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">      &quot;MV&quot; =&gt; &quot;Maldives&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">      &quot;ML&quot; =&gt; &quot;Mali&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">      &quot;MT&quot; =&gt; &quot;Malta&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">      &quot;MH&quot; =&gt; &quot;Marshall Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">      &quot;MQ&quot; =&gt; &quot;Martinique&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">      &quot;MR&quot; =&gt; &quot;Mauritania&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">      &quot;MU&quot; =&gt; &quot;Mauritius&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">      &quot;YT&quot; =&gt; &quot;Mayotte&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">      &quot;MX&quot; =&gt; &quot;Mexico&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">      &quot;FM&quot; =&gt; &quot;Micronesia, Federated States of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">      &quot;MD&quot; =&gt; &quot;Moldova, Republic of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">      &quot;MC&quot; =&gt; &quot;Monaco&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">      &quot;MN&quot; =&gt; &quot;Mongolia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">      &quot;ME&quot; =&gt; &quot;Montenegro&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">      &quot;MS&quot; =&gt; &quot;Montserrat&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">      &quot;MA&quot; =&gt; &quot;Morocco&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">      &quot;MZ&quot; =&gt; &quot;Mozambique&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">      &quot;MM&quot; =&gt; &quot;Myanmar&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">      &quot;NA&quot; =&gt; &quot;Namibia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">      &quot;NR&quot; =&gt; &quot;Nauru&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">      &quot;NP&quot; =&gt; &quot;Nepal&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">      &quot;NL&quot; =&gt; &quot;Netherlands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">      &quot;NC&quot; =&gt; &quot;New Caledonia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">      &quot;NZ&quot; =&gt; &quot;New Zealand&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">      &quot;NI&quot; =&gt; &quot;Nicaragua&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">      &quot;NE&quot; =&gt; &quot;Niger&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">      &quot;NG&quot; =&gt; &quot;Nigeria&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">      &quot;NU&quot; =&gt; &quot;Niue&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">      &quot;NF&quot; =&gt; &quot;Norfolk Island&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">      &quot;MP&quot; =&gt; &quot;Northern Mariana Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">      &quot;NO&quot; =&gt; &quot;Norway&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">      &quot;OM&quot; =&gt; &quot;Oman&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">      &quot;PK&quot; =&gt; &quot;Pakistan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">      &quot;PW&quot; =&gt; &quot;Palau&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">      &quot;PS&quot; =&gt; &quot;Palestine, State of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">      &quot;PA&quot; =&gt; &quot;Panama&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">      &quot;PG&quot; =&gt; &quot;Papua New Guinea&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">      &quot;PY&quot; =&gt; &quot;Paraguay&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">      &quot;PE&quot; =&gt; &quot;Peru&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">      &quot;PH&quot; =&gt; &quot;Philippines&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">      &quot;PN&quot; =&gt; &quot;Pitcairn&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">      &quot;PL&quot; =&gt; &quot;Poland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">      &quot;PT&quot; =&gt; &quot;Portugal&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">      &quot;PR&quot; =&gt; &quot;Puerto Rico&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">      &quot;QA&quot; =&gt; &quot;Qatar&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">      &quot;RE&quot; =&gt; &quot;Runion&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">      &quot;RO&quot; =&gt; &quot;Romania&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">      &quot;RU&quot; =&gt; &quot;Russian Federation&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">      &quot;RW&quot; =&gt; &quot;Rwanda&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">      &quot;BL&quot; =&gt; &quot;Saint Barthlemy&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">      &quot;SH&quot; =&gt; &quot;Saint Helena, Ascension and Tristan da Cunha&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">      &quot;KN&quot; =&gt; &quot;Saint Kitts and Nevis&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">      &quot;LC&quot; =&gt; &quot;Saint Lucia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">      &quot;MF&quot; =&gt; &quot;Saint Martin (French part)&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">      &quot;PM&quot; =&gt; &quot;Saint Pierre and Miquelon&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">      &quot;VC&quot; =&gt; &quot;Saint Vincent and the Grenadines&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">      &quot;WS&quot; =&gt; &quot;Samoa&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">      &quot;SM&quot; =&gt; &quot;San Marino&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">      &quot;ST&quot; =&gt; &quot;Sao Tome and Principe&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">      &quot;SA&quot; =&gt; &quot;Saudi Arabia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">      &quot;SN&quot; =&gt; &quot;Senegal&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      &quot;RS&quot; =&gt; &quot;Serbia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">      &quot;SC&quot; =&gt; &quot;Seychelles&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">      &quot;SL&quot; =&gt; &quot;Sierra Leone&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">      &quot;SG&quot; =&gt; &quot;Singapore&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">      &quot;SX&quot; =&gt; &quot;Sint Maarten (Dutch part)&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">      &quot;SK&quot; =&gt; &quot;Slovakia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">      &quot;SI&quot; =&gt; &quot;Slovenia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">      &quot;SB&quot; =&gt; &quot;Solomon Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">      &quot;SO&quot; =&gt; &quot;Somalia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">      &quot;ZA&quot; =&gt; &quot;South Africa&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">      &quot;GS&quot; =&gt; &quot;South Georgia and the South Sandwich Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">      &quot;SS&quot; =&gt; &quot;South Sudan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">      &quot;ES&quot; =&gt; &quot;Spain&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">      &quot;LK&quot; =&gt; &quot;Sri Lanka&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">      &quot;SD&quot; =&gt; &quot;Sudan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">      &quot;SR&quot; =&gt; &quot;Suriname&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">      &quot;SJ&quot; =&gt; &quot;Svalbard and Jan Mayen&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby">      &quot;SZ&quot; =&gt; &quot;Swaziland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">      &quot;SE&quot; =&gt; &quot;Sweden&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">      &quot;CH&quot; =&gt; &quot;Switzerland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">      &quot;SY&quot; =&gt; &quot;Syrian Arab Republic&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">      &quot;TW&quot; =&gt; &quot;Taiwan, Province of China&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">      &quot;TJ&quot; =&gt; &quot;Tajikistan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">      &quot;TZ&quot; =&gt; &quot;Tanzania, United Republic of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">      &quot;TH&quot; =&gt; &quot;Thailand&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">      &quot;TL&quot; =&gt; &quot;Timor-Leste&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">      &quot;TG&quot; =&gt; &quot;Togo&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">      &quot;TK&quot; =&gt; &quot;Tokelau&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">      &quot;TO&quot; =&gt; &quot;Tonga&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">      &quot;TT&quot; =&gt; &quot;Trinidad and Tobago&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">      &quot;TN&quot; =&gt; &quot;Tunisia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">      &quot;TR&quot; =&gt; &quot;Turkey&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">      &quot;TM&quot; =&gt; &quot;Turkmenistan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">      &quot;TC&quot; =&gt; &quot;Turks and Caicos Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">      &quot;TV&quot; =&gt; &quot;Tuvalu&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">      &quot;UG&quot; =&gt; &quot;Uganda&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">      &quot;UA&quot; =&gt; &quot;Ukraine&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">      &quot;AE&quot; =&gt; &quot;United Arab Emirates&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">      &quot;GB&quot; =&gt; &quot;United Kingdom&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">      &quot;US&quot; =&gt; &quot;United States&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">      &quot;UM&quot; =&gt; &quot;United States Minor Outlying Islands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">      &quot;UY&quot; =&gt; &quot;Uruguay&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">      &quot;UZ&quot; =&gt; &quot;Uzbekistan&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">      &quot;VU&quot; =&gt; &quot;Vanuatu&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">      &quot;VE&quot; =&gt; &quot;Venezuela, Bolivarian Republic of&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">      &quot;VN&quot; =&gt; &quot;Viet Nam&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">      &quot;VG&quot; =&gt; &quot;Virgin Islands, British&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">      &quot;VI&quot; =&gt; &quot;Virgin Islands, U.S.&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">      &quot;WF&quot; =&gt; &quot;Wallis and Futuna&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">      &quot;EH&quot; =&gt; &quot;Western Sahara&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">      &quot;YE&quot; =&gt; &quot;Yemen&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">      &quot;ZM&quot; =&gt; &quot;Zambia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">      &quot;ZW&quot; =&gt; &quot;Zimbabwe&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="256">
          <span class="hits">1</span>
          
          <code class="ruby">    A_EU = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">      &quot;AT&quot; =&gt; &quot;Austria&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">      &quot;BE&quot; =&gt; &quot;Belgium&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">      &quot;BG&quot; =&gt; &quot;Bulgaria&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">      &quot;HR&quot; =&gt; &quot;Croatia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">      &quot;CY&quot; =&gt; &quot;Cyprus&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">      &quot;CZ&quot; =&gt; &quot;Czech Republic&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">      &quot;DK&quot; =&gt; &quot;Denmark&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">      &quot;EE&quot; =&gt; &quot;Estonia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">      &quot;FI&quot; =&gt; &quot;Finland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby">      &quot;FR&quot; =&gt; &quot;France&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">      &quot;DE&quot; =&gt; &quot;Germany&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">      &quot;GR&quot; =&gt; &quot;Greece&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">      &quot;HU&quot; =&gt; &quot;Hungary&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">      &quot;IE&quot; =&gt; &quot;Ireland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">      &quot;IT&quot; =&gt; &quot;Italy&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">      &quot;LV&quot; =&gt; &quot;Latvia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">      &quot;LT&quot; =&gt; &quot;Lithuania&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">      &quot;LU&quot; =&gt; &quot;Luxembourg&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">      &quot;MT&quot; =&gt; &quot;Malta&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">      &quot;NL&quot; =&gt; &quot;Netherlands&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby">      &quot;PL&quot; =&gt; &quot;Poland&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby">      &quot;PT&quot; =&gt; &quot;Portugal&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby">      &quot;RO&quot; =&gt; &quot;Romania&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">      &quot;SK&quot; =&gt; &quot;Slovakia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">      &quot;SI&quot; =&gt; &quot;Slovenia&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby">      &quot;ES&quot; =&gt; &quot;Spain&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">      &quot;SE&quot; =&gt; &quot;Sweden&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">      &quot;GB&quot; =&gt; &quot;United Kingdom&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9c40a0c2d82cfd81b6f4c41f965931058b6a4cb6">
  <div class="header">
    <h3>lib/versioneye/models/helpers/indexer.rb</h3>
    <h4><span class="red">17.39 %</span> covered</h4>
    <div>
      <b>23</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>19</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Indexer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_indexes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    ::Mongoid.models.each do |model|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">      index_keys = model.collection.indexes.map{ |doc| doc[&quot;name&quot;] }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">      next if index_keys.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      next if model.embedded?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">      create_index model     </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    end.compact</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    p e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    p e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_index model </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    p &quot;creating index for #{model}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    result = model.create_indexes</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    p &quot; - #{result}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  rescue =&gt; e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    p e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    p e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.drop_indexes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    ::Mongoid.models.each do |model|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">      next if model.embedded?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      p &quot;drop indexes for #{model}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">      result = model.remove_indexes</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      p &quot; - #{result}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    end.compact</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    p e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    p e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7fd565cb281cd0c8d94146b809af1170a74c6fdf">
  <div class="header">
    <h3>lib/versioneye/models/helpers/product_constants.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines. 
      <span class="green"><b>29</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module VersionEye</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  module ProductConstants</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_RUBY         = &#39;Ruby&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_PYTHON       = &#39;Python&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_NODEJS       = &#39;Node.JS&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_JAVA         = &#39;Java&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_PHP          = &#39;PHP&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_R            = &#39;R&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_JAVASCRIPT   = &#39;JavaScript&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_CLOJURE      = &#39;Clojure&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_C            = &#39;C&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_C_PP         = &#39;C++&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_CPP          = &#39;CPP&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_BIICODE      = &#39;Biicode&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_OBJECTIVEC   = &#39;Objective-C&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_GO           = &#39;Go&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_CSS          = &#39;CSS&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_COFFEESCRIPT = &#39;CoffeeScript&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_ACTIONSCRIPT = &#39;ActionScript&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_TYPESCRIPT   = &#39;TypeScript&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_LIVESCRIPT   = &#39;LiveScript&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_PURESCRIPT   = &#39;PureScript&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGUAGE_HTML         = &#39;HTML&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      # TODO check if this can be removed</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGS_ALL           = [A_LANGUAGE_JAVA, A_LANGUAGE_RUBY, A_LANGUAGE_PYTHON, A_LANGUAGE_PHP, A_LANGUAGE_NODEJS, A_LANGUAGE_JAVASCRIPT, A_LANGUAGE_CLOJURE, A_LANGUAGE_R, A_LANGUAGE_OBJECTIVEC, A_LANGUAGE_C, A_LANGUAGE_CSS, A_LANGUAGE_C_PP, A_LANGUAGE_COFFEESCRIPT, A_LANGUAGE_GO]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      # TODO remove this, take the list from DB.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGS_LANGUAGE_PAGE = [A_LANGUAGE_JAVA, A_LANGUAGE_RUBY, A_LANGUAGE_PYTHON, A_LANGUAGE_PHP, A_LANGUAGE_NODEJS, A_LANGUAGE_JAVASCRIPT, A_LANGUAGE_COFFEESCRIPT, A_LANGUAGE_CLOJURE, A_LANGUAGE_R, A_LANGUAGE_OBJECTIVEC, A_LANGUAGE_CSS, A_LANGUAGE_BIICODE, A_LANGUAGE_HTML]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">      # For the search filter</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGS_FILTER        = [A_LANGUAGE_JAVA, A_LANGUAGE_RUBY, A_LANGUAGE_PYTHON, A_LANGUAGE_PHP, A_LANGUAGE_NODEJS, A_LANGUAGE_JAVASCRIPT, A_LANGUAGE_CLOJURE, A_LANGUAGE_R, A_LANGUAGE_OBJECTIVEC, A_LANGUAGE_CSS, A_LANGUAGE_BIICODE]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">      # Supported for package managers</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGS_SUPPORTED     = [A_LANGUAGE_JAVA, A_LANGUAGE_RUBY, A_LANGUAGE_PYTHON, A_LANGUAGE_PHP, A_LANGUAGE_NODEJS, A_LANGUAGE_JAVASCRIPT, A_LANGUAGE_CLOJURE, A_LANGUAGE_R, A_LANGUAGE_OBJECTIVEC, A_LANGUAGE_CSS, A_LANGUAGE_BIICODE]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGS_DEP_BADGE     = [A_LANGUAGE_JAVA, A_LANGUAGE_RUBY,                    A_LANGUAGE_PHP, A_LANGUAGE_NODEJS, A_LANGUAGE_JAVASCRIPT, A_LANGUAGE_COFFEESCRIPT, A_LANGUAGE_CLOJURE,               A_LANGUAGE_OBJECTIVEC, A_LANGUAGE_CSS, A_LANGUAGE_BIICODE, A_LANGUAGE_HTML]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">      A_LANGS_DEP_GRAPH     = [A_LANGUAGE_RUBY, A_LANGUAGE_PHP, A_LANGUAGE_NODEJS, A_LANGUAGE_JAVASCRIPT, A_LANGUAGE_OBJECTIVEC]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ac748934104b8bbda9a806696b8f2fce1f6edca8">
  <div class="header">
    <h3>lib/versioneye/models/helpers/product_es_mapping.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>4</b> relevant lines. 
      <span class="green"><b>4</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module VersionEye</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  module ProductEsMapping</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    def to_indexed_json # For ElasticSearch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">      {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">        :_id                =&gt; self.id.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">        :_type              =&gt; &#39;product&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">        :name               =&gt; self.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">        :description        =&gt; self.description.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">        :description_manual =&gt; self.description_manual.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">        :followers          =&gt; self.followers,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">        :used_by_count      =&gt; self.used_by_count,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">        :group_id           =&gt; self.group_id.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">        :prod_key           =&gt; self.prod_key,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">        :language           =&gt; self.language,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">        :prod_type          =&gt; self.prod_type</code>
        </li>
      
        <li class="covered" data-hits="255" data-linenumber="17">
          <span class="hits">255</span>
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7aa103ab34341ef7ca4233bf944da48cdb2a2c59">
  <div class="header">
    <h3>lib/versioneye/models/json_cache.rb</h3>
    <h4><span class="yellow">81.82 %</span> covered</h4>
    <div>
      <b>11</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class JsonCache &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :json_string, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  A_LANGUAGE_PROJECT_COUNT = &#39;lang_project_count&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  A_LANGUAGE_PROJECT_TREND = &#39;lang_project_trend&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.language_project_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    JsonCache.where(:name =&gt; A_LANGUAGE_PROJECT_COUNT).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.language_project_trend</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    JsonCache.where(:name =&gt; A_LANGUAGE_PROJECT_TREND).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b9eac2c77932cb445c225c5e86db6cdf72abd1a0">
  <div class="header">
    <h3>lib/versioneye/models/language.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines. 
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Language &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description       , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :supported_managers, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :latest_version    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stable_version    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :licence           , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :licence_url       , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :main_url       , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :wiki_url       , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :repo_url       , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :issue_url      , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :mailinglist_url, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :irc_url        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :irc            , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :twitter_name   , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_language, -&gt;(lang){where(name: Product.decode_language(lang))}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5ec97d42c114b8824d91cb4900fbd7386de704ac">
  <div class="header">
    <h3>lib/versioneye/models/language_daily_stats.rb</h3>
    <h4><span class="red">72.57 %</span> covered</h4>
    <div>
      <b>226</b> relevant lines. 
      <span class="green"><b>164</b> lines covered</span> and
      <span class="red"><b>62</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LanguageDailyStats &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :date, type: DateTime</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :date_string, type: String #format: %Y-%m-%d</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :Clojure   , type: Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :Java      , type: Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :Javascript, type: Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :Nodejs    , type: Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :Php       , type: Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :Python    , type: Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :R         , type: Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :Ruby      , type: Hash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :Objectivec, type: Hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  index({date: -1},        {background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  index({date_string: -1}, {background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  index({created_at: -1},  {background: true})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.initial_metrics_table</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      &#39;new_version&#39;    =&gt; 0, # new   versions  publised</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">      &#39;novel_package&#39;  =&gt; 0, # new   libraries published</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">      &#39;total_package&#39;  =&gt; 0, # total packages  upto this date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      &#39;total_artifact&#39; =&gt; 0  # total artifacts upto this date</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="30">
          <span class="hits">2112</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_counts(ndays = 1, skip = 0)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="34">
          <span class="hits">8</span>
          
          <code class="ruby">    ndays += skip</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="35">
          <span class="hits">8</span>
          
          <code class="ruby">    ndays.times do |n|</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="36">
          <span class="hits">192</span>
          
          <code class="ruby">      next if n &lt; skip</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="37">
          <span class="hits">192</span>
          
          <code class="ruby">      log_msg = &quot;Counting language_daily_stats: #{n + 1} / #{ndays}&quot;</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="38">
          <span class="hits">192</span>
          
          <code class="ruby">      log.debug( log_msg )</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="39">
          <span class="hits">192</span>
          
          <code class="ruby">      p log_msg</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="40">
          <span class="hits">192</span>
          
          <code class="ruby">      self.update_day_stats(n)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize_metrics_tables</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="49">
          <span class="hits">192</span>
          
          <code class="ruby">    Product::A_LANGS_SUPPORTED.each do |lang|</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="50">
          <span class="hits">2112</span>
          
          <code class="ruby">      lang_key       = LanguageDailyStats.language_to_sym( lang )</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="51">
          <span class="hits">2112</span>
          
          <code class="ruby">      self[lang_key] = LanguageDailyStats.initial_metrics_table</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.language_to_sym(lang)</code>
        </li>
      
        <li class="covered" data-hits="7021" data-linenumber="56">
          <span class="hits">7021</span>
          
          <code class="ruby">    lang = Product.encode_language(lang).capitalize</code>
        </li>
      
        <li class="covered" data-hits="7021" data-linenumber="57">
          <span class="hits">7021</span>
          
          <code class="ruby">    lang = lang.gsub(/\-/, &#39;&#39;) # Special rule for Objective-C</code>
        </li>
      
        <li class="covered" data-hits="7021" data-linenumber="58">
          <span class="hits">7021</span>
          
          <code class="ruby">    lang = lang.gsub(/\./, &#39;&#39;) # Special rule for Node.JS</code>
        </li>
      
        <li class="covered" data-hits="7021" data-linenumber="59">
          <span class="hits">7021</span>
          
          <code class="ruby">    lang.to_sym</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.to_date_string(that_day)</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="63">
          <span class="hits">387</span>
          
          <code class="ruby">    that_day.strftime(&#39;%Y-%m-%d&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.new_document(that_day, save = false)</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="67">
          <span class="hits">192</span>
          
          <code class="ruby">    day_string = self.to_date_string(that_day)</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="68">
          <span class="hits">192</span>
          
          <code class="ruby">    self.where(date_string: day_string).delete_all # remove previous document</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="70">
          <span class="hits">192</span>
          
          <code class="ruby">    new_doc  = LanguageDailyStats.new date: that_day.at_midnight</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="71">
          <span class="hits">192</span>
          
          <code class="ruby">    new_doc[:date_string] = self.to_date_string(that_day)</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="72">
          <span class="hits">192</span>
          
          <code class="ruby">    new_doc.initialize_metrics_tables</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="74">
          <span class="hits">192</span>
          
          <code class="ruby">    new_doc.save if save</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="75">
          <span class="hits">192</span>
          
          <code class="ruby">    new_doc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_day_stats( n )</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="79">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day = n.days.ago.at_beginning_of_day</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="80">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day_doc = self.new_document(that_day, false)</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="81">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day_doc.count_releases</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="82">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day_doc.count_language_packages</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="83">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day_doc.count_language_artifacts</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="84">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day_doc.save </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">  def count_releases</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="88">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day = self[:date]</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="89">
          <span class="hits">192</span>
          
          <code class="ruby">    next_day = (that_day + 1.day)</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="90">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day_releases = Newest.since_to( that_day.at_midnight, next_day.at_midnight )</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="91">
          <span class="hits">192</span>
          
          <code class="ruby">    return if that_day_releases.nil? || that_day_releases.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="93">
          <span class="hits">13</span>
          
          <code class="ruby">    that_day_releases.each do |release|</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="94">
          <span class="hits">223</span>
          
          <code class="ruby">      self.count_release( release )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">  def count_release(release)</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="99">
          <span class="hits">223</span>
          
          <code class="ruby">    if release[:language].nil? || release[:language].empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">      LanguageDailyStats.log.error(&quot;Product #{release[:prod_key]} misses language&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="104">
          <span class="hits">223</span>
          
          <code class="ruby">    language = normalize_language release[:language]</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="105">
          <span class="hits">223</span>
          
          <code class="ruby">    if !Product::A_LANGS_SUPPORTED.include?(language)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">      LanguageDailyStats.log.warn(&quot;Product #{release[:prod_key]} language #{language} is not supported.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="110">
          <span class="hits">223</span>
          
          <code class="ruby">    metric_key = LanguageDailyStats.language_to_sym( language )</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="111">
          <span class="hits">223</span>
          
          <code class="ruby">    self.inc_version( metric_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="113">
          <span class="hits">223</span>
          
          <code class="ruby">    that_day_midnight = self[:date].at_midnight</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="114">
          <span class="hits">223</span>
          
          <code class="ruby">    next_day_midnight = that_day_midnight + 1.day</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="115">
          <span class="hits">223</span>
          
          <code class="ruby">    count = Product.where(:language =&gt; language, :prod_key =&gt; release.prod_key,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">      :created_at.gte =&gt; that_day_midnight, :created_at.lte =&gt; next_day_midnight).count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="118">
          <span class="hits">223</span>
          
          <code class="ruby">    self.inc_novel(metric_key) if count &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">  def count_language_packages</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="122">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day = self[:date]</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="123">
          <span class="hits">192</span>
          
          <code class="ruby">    Product::A_LANGS_SUPPORTED.each do |lang|</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="124">
          <span class="hits">2112</span>
          
          <code class="ruby">      lang_total = Product.by_language(lang).where(:created_at.lt =&gt; that_day.at_midnight).count</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="125">
          <span class="hits">2112</span>
          
          <code class="ruby">      language_key = LanguageDailyStats.language_to_sym(lang)</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="126">
          <span class="hits">2112</span>
          
          <code class="ruby">      self.inc_total_package(language_key, lang_total)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="130">
          <span class="hits">1</span>
          
          <code class="ruby">  def count_language_artifacts</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="131">
          <span class="hits">192</span>
          
          <code class="ruby">    that_day = self[:date]</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="132">
          <span class="hits">192</span>
          
          <code class="ruby">    Product::A_LANGS_SUPPORTED.each do |lang|</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="133">
          <span class="hits">2112</span>
          
          <code class="ruby">      n_artifacts = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="135">
          <span class="hits">2112</span>
          
          <code class="ruby">      language_key = LanguageDailyStats.language_to_sym(lang)</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="136">
          <span class="hits">2112</span>
          
          <code class="ruby">      n_artifacts  = LanguageDailyStats.count_artifacts( lang, that_day )</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="137">
          <span class="hits">2112</span>
          
          <code class="ruby">      p &quot;#{n_artifacts} for #{language_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="138">
          <span class="hits">2112</span>
          
          <code class="ruby">      self.inc_total_artifact(language_key, n_artifacts)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.count_artifacts language, until_date</code>
        </li>
      
        <li class="covered" data-hits="2113" data-linenumber="148">
          <span class="hits">2113</span>
          
          <code class="ruby">    ag = Product.collection.aggregate(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">      { &#39;$unwind&#39; =&gt; &quot;$versions&quot; }, </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">      { &#39;$match&#39; =&gt; {&#39;language&#39; =&gt; &quot;#{language}&quot;} }, </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">      { &#39;$group&#39; =&gt; { &#39;_id&#39; =&gt; &#39;&#39;, &#39;count&#39; =&gt; {&#39;$sum&#39; =&gt; 1} } } </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="covered" data-hits="2113" data-linenumber="153">
          <span class="hits">2113</span>
          
          <code class="ruby">    return ag.first[&quot;count&quot;] if ag &amp;&amp; ag.first </code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="154">
          <span class="hits">2112</span>
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">    0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="162">
          <span class="hits">1</span>
          
          <code class="ruby">  def inc_version(metric_key, val = 1)</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="163">
          <span class="hits">223</span>
          
          <code class="ruby">    self[metric_key][&#39;new_version&#39;] += val </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="166">
          <span class="hits">1</span>
          
          <code class="ruby">  def inc_novel(metric_key, val =  1)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">    self[metric_key][&#39;novel_package&#39;] += val </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="170">
          <span class="hits">1</span>
          
          <code class="ruby">  def inc_total_package(metric_key, val =  1)</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="171">
          <span class="hits">2112</span>
          
          <code class="ruby">    self[metric_key][&#39;total_package&#39;] += val </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>
          
          <code class="ruby">  def inc_total_artifact(metric_key, val = 1)</code>
        </li>
      
        <li class="covered" data-hits="2112" data-linenumber="175">
          <span class="hits">2112</span>
          
          <code class="ruby">    self[metric_key][&#39;total_artifact&#39;] += val </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="178">
          <span class="hits">1</span>
          
          <code class="ruby">  def metrics</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="179">
          <span class="hits">42</span>
          
          <code class="ruby">    doc = self.attributes</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="180">
          <span class="hits">42</span>
          
          <code class="ruby">    langs_keys = []</code>
        </li>
      
        <li class="covered" data-hits="504" data-linenumber="181">
          <span class="hits">504</span>
          
          <code class="ruby">    Product::A_LANGS_SUPPORTED.each {|lang| langs_keys &lt;&lt; LanguageDailyStats.language_to_sym(lang)}</code>
        </li>
      
        <li class="covered" data-hits="714" data-linenumber="182">
          <span class="hits">714</span>
          
          <code class="ruby">    doc.keep_if {|key, val| langs_keys.include?(key.to_sym)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">  #shows only metrics of Stats doc</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="186">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.doc_metrics(doc)</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="187">
          <span class="hits">42</span>
          
          <code class="ruby">    if doc.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="188">
          
          
          <code class="ruby">      log.warn(&quot;It tried to read not existing todays stat - returning new empty doc.&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">      doc = self.new_document(Date.today)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="191">
          <span class="hits">42</span>
          
          <code class="ruby">    doc.metrics</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="194">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.combine_docs(docs)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="195">
          <span class="hits">5</span>
          
          <code class="ruby">    stats = {}</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="196">
          <span class="hits">5</span>
          
          <code class="ruby">    docs.each do |doc|</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="197">
          <span class="hits">39</span>
          
          <code class="ruby">      doc_stats = LanguageDailyStats.doc_metrics(doc)</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="198">
          <span class="hits">39</span>
          
          <code class="ruby">      stats.merge!(doc_stats) do |lang_key, doc1, doc2|</code>
        </li>
      
        <li class="covered" data-hits="374" data-linenumber="199">
          <span class="hits">374</span>
          
          <code class="ruby">        doc1 ||= {}</code>
        </li>
      
        <li class="covered" data-hits="1870" data-linenumber="200">
          <span class="hits">1870</span>
          
          <code class="ruby">        doc1.merge(doc2) {|metric, oldval, newval| oldval + newval}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="204">
          <span class="hits">5</span>
          
          <code class="ruby">    stats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">  #-- query helpers</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="208">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.latest_stats(lang = &quot;Ruby&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">    lang_key = LanguageDailyStats.language_to_sym(lang)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">    doc = LanguageDailyStats.where(:&quot;#{lang_key.to_s}.total_artifact&quot;.gt =&gt; 0).desc(:date).first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">    self.doc_metrics(doc)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="214">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.since_to(dt_since, dt_to)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="215">
          <span class="hits">5</span>
          
          <code class="ruby">    self.where(:date.gte =&gt; dt_since, :date.lt =&gt; dt_to).desc(:date)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.today_stats</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="219">
          <span class="hits">2</span>
          
          <code class="ruby">    dt_string = LanguageDailyStats.to_date_string(Date.today)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="220">
          <span class="hits">2</span>
          
          <code class="ruby">    doc = self.where(date_string: dt_string).shift</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="221">
          <span class="hits">2</span>
          
          <code class="ruby">    self.doc_metrics(doc)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.yesterday_stats</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>
          
          <code class="ruby">    dt_string = LanguageDailyStats.to_date_string(1.day.ago)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="226">
          <span class="hits">1</span>
          
          <code class="ruby">    doc = self.where(date_string: dt_string).shift</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="227">
          <span class="hits">1</span>
          
          <code class="ruby">    self.doc_metrics(doc)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">  #stats for 2days ago</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="231">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.t2_stats</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="232">
          
          
          <code class="ruby">    dt_string = LanguageDailyStats.to_date_string(2.day.ago)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="233">
          
          
          <code class="ruby">    doc = self.where(date_string: dt_string).shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="234">
          
          
          <code class="ruby">    self.doc_metrics(doc)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="238">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.current_week_stats</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="239">
          <span class="hits">1</span>
          
          <code class="ruby">    dt_since = Date.today.at_beginning_of_week</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="240">
          <span class="hits">1</span>
          
          <code class="ruby">    dt_to    = DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="241">
          <span class="hits">1</span>
          
          <code class="ruby">    rows = self.since_to(dt_since, dt_to)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="242">
          <span class="hits">1</span>
          
          <code class="ruby">    self.combine_docs(rows)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="245">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.last_week_stats</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="246">
          <span class="hits">1</span>
          
          <code class="ruby">    dt_monday      = Date.today.at_beginning_of_week</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="247">
          <span class="hits">1</span>
          
          <code class="ruby">    dt_prev_monday = dt_monday - 7</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="248">
          <span class="hits">1</span>
          
          <code class="ruby">    rows = self.since_to(dt_prev_monday, dt_monday)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="249">
          <span class="hits">1</span>
          
          <code class="ruby">    self.combine_docs(rows)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="253">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.current_month_stats</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="254">
          <span class="hits">1</span>
          
          <code class="ruby">    dt_since = Date.today.at_beginning_of_month</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="255">
          <span class="hits">1</span>
          
          <code class="ruby">    dt_to    = DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="256">
          <span class="hits">1</span>
          
          <code class="ruby">    rows = self.since_to(dt_since, dt_to)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="257">
          <span class="hits">1</span>
          
          <code class="ruby">    self.combine_docs(rows)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="260">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.last_30_days_stats</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="261">
          
          
          <code class="ruby">    self.since_to(30.days.ago.at_midnight, Date.tomorrow.at_midnight).asc(:date)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="264">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.last_month_stats</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="265">
          <span class="hits">1</span>
          
          <code class="ruby">    month_ago = Date.today &lt;&lt; 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="266">
          <span class="hits">1</span>
          
          <code class="ruby">    rows      = self.since_to(month_ago.at_beginning_of_month, Date.today.at_beginning_of_month)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="267">
          <span class="hits">1</span>
          
          <code class="ruby">    self.combine_docs(rows)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="270">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.two_months_ago_stats</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="271">
          <span class="hits">1</span>
          
          <code class="ruby">    month_ago      = Date.today &lt;&lt; 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="272">
          <span class="hits">1</span>
          
          <code class="ruby">    two_months_ago = Date.today &lt;&lt; 2</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="273">
          <span class="hits">1</span>
          
          <code class="ruby">    rows           = self.since_to(two_months_ago.at_beginning_of_month, month_ago.at_beginning_of_month)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="274">
          <span class="hits">1</span>
          
          <code class="ruby">    self.combine_docs(rows)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby">  #-- response helpers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="279">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.to_metric_response(metric, t0_stats, t1_stats)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="280">
          
          
          <code class="ruby">    rows = []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="282">
          
          
          <code class="ruby">    Product::A_LANGS_SUPPORTED.each do |lang|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="283">
          
          
          <code class="ruby">      lang_key = LanguageDailyStats.language_to_sym(lang).to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="285">
          
          
          <code class="ruby">      t0_metric_value = t0_stats.has_key?(lang_key) ? t0_stats[lang_key][metric] : nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="286">
          
          
          <code class="ruby">      t1_metric_value = t1_stats.has_key?(lang_key) ? t1_stats[lang_key][metric] : nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">      if t0_metric_value and t1_metric_value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">        diff = t0_metric_value - t1_metric_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">        diff  = 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">      rows &lt;&lt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">        title: lang,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">        value: t0_metric_value || 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby">        t1: diff</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="297">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">    rows.sort_by {|row| row[:title]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="302">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_time_span(time_span)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">    case time_span</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">    when :today</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">      t1 = self.today_stats</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">      t2 = self.yesterday_stats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">    when :yesterday</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="308">
          
          
          <code class="ruby">      t1 = self.yesterday_stats</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="309">
          
          
          <code class="ruby">      t2 = self.t2_stats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby">    when :current_week</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">      t1 = self.current_week_stats</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="312">
          
          
          <code class="ruby">      t2 = self.last_week_stats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">    when :current_month</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="314">
          
          
          <code class="ruby">      t1 = self.current_month_stats</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="315">
          
          
          <code class="ruby">      t2 = self.last_month_stats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">    when :last_month</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">      t1 = self.last_month_stats</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">      t2 = self.two_months_ago_stats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="320">
          
          
          <code class="ruby">      t1 = self.yesterday_stats</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">      t2 = self.t2_stats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="323">
          
          
          <code class="ruby">    return t1, t2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="326">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.latest_versions(time_span)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="327">
          
          
          <code class="ruby">    t1, t2 = get_time_span(time_span)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="328">
          
          
          <code class="ruby">    self.to_metric_response(&#39;new_version&#39;, t1, t2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="331">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.novel_releases(time_span)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="332">
          
          
          <code class="ruby">    t1, t2 = get_time_span(time_span)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">    self.to_metric_response(&#39;novel_package&#39;, t1, t2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="336">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.language_timeline30(lang, metric)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">    rows = self.last_30_days_stats</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">    results = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">    return results if rows.nil? || rows.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="341">
          
          
          <code class="ruby">    lang_key = LanguageDailyStats.language_to_sym(lang)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">    rows.each do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="343">
          
          
          <code class="ruby">      val = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">      val = row[lang_key][metric] if row.has_attribute?(lang_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby">      results &lt;&lt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">        title: lang,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby">        value: val || 0,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby">        date: row[:date_string]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="350">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="352">
          
          
          <code class="ruby">    results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="355">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.versions_timeline30(lang)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="356">
          
          
          <code class="ruby">    self.language_timeline30(lang, &#39;new_version&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="359">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.novel_releases_timeline30(lang)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="360">
          
          
          <code class="ruby">    self.language_timeline30(lang, &#39;novel_package&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="363">
          <span class="hits">1</span>
          
          <code class="ruby">  private </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">    # In the UI all variants of JavaScript are bundled/displayed as JavaScript! </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="366">
          <span class="hits">1</span>
          
          <code class="ruby">    def normalize_language lang </code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="367">
          <span class="hits">223</span>
          
          <code class="ruby">      return Product::A_LANGUAGE_JAVASCRIPT if lang.eql?(&quot;PureScript&quot;)</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="368">
          <span class="hits">223</span>
          
          <code class="ruby">      return Product::A_LANGUAGE_JAVASCRIPT if lang.eql?(&quot;CoffeeScript&quot;)</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="369">
          <span class="hits">223</span>
          
          <code class="ruby">      return Product::A_LANGUAGE_JAVASCRIPT if lang.eql?(&quot;ActionScript&quot;)</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="370">
          <span class="hits">223</span>
          
          <code class="ruby">      return Product::A_LANGUAGE_JAVASCRIPT if lang.eql?(&quot;TypeScript&quot;)</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="371">
          <span class="hits">223</span>
          
          <code class="ruby">      return Product::A_LANGUAGE_JAVASCRIPT if lang.eql?(&quot;LiveScript&quot;)</code>
        </li>
      
        <li class="covered" data-hits="223" data-linenumber="372">
          <span class="hits">223</span>
          
          <code class="ruby">      return lang</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5ee86d8678ba6d12cf858ca59ec68eaf1ae689fe">
  <div class="header">
    <h3>lib/versioneye/models/language_feed.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>7</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LanguageFeed &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :title,     type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url,       type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language,  type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_language, -&gt;(lang){where(language: lang)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c79d52dd469cc4484235165c4fd0a3e89aab8de5">
  <div class="header">
    <h3>lib/versioneye/models/license.rb</h3>
    <h4><span class="green">94.87 %</span> covered</h4>
    <div>
      <b>39</b> relevant lines. 
      <span class="green"><b>37</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class License &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/traits/license_normalizer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::LicenseNormalizer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # This license belongs to the product with this attributes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version      , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name           , type: String # For example MIT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url            , type: String # URL to the license text</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :comments       , type: String # Maven specific</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :distributions  , type: String # Maven specific</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :spdx_identifier, type: String # For example AGPL-1.0. See http://spdx.org/licenses/</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :source         , type: String # Where it was crawled</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  # TODO This is causing a too large index. For Python some names are containnign the license text. This need to be fixest! See -&gt; License.where(:name =&gt; /\n/).count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  # index({ language: 1, prod_key: 1, version: 1, name: 1 }, { name: &quot;language_prod_key_version_name_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, version: 1 },          { name: &quot;language_prod_key_version_index&quot;     , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1},                       { name: &quot;language_prod_key_index&quot;             , background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :language, :message =&gt; &#39;language is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :prod_key, :message =&gt; &#39;prod_key is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name, :message =&gt; &#39;name is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    Product.fetch_product(self.language, self.prod_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.for_product( product, ignore_version = false )</code>
        </li>
      
        <li class="covered" data-hits="809" data-linenumber="35">
          <span class="hits">809</span>
          
          <code class="ruby">    if ignore_version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">      return License.where(:language =&gt; product.language, :prod_key =&gt; product.prod_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="808" data-linenumber="38">
          <span class="hits">808</span>
          
          <code class="ruby">      return License.where(:language =&gt; product.language, :prod_key =&gt; product.prod_key, :version =&gt; product.version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  # Returns the licenses with nil version!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.for_product_global product</code>
        </li>
      
        <li class="covered" data-hits="806" data-linenumber="44">
          <span class="hits">806</span>
          
          <code class="ruby">    return License.where(:language =&gt; product.language, :prod_key =&gt; product.prod_key, :version =&gt; nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_or_create language, prod_key, version, name, url = nil, comments = nil, distributions = nil</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="48">
          <span class="hits">144</span>
          
          <code class="ruby">    license = License.where(:language =&gt; language, :prod_key =&gt; prod_key, :version =&gt; version, :name =&gt; name).first</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="49">
          <span class="hits">144</span>
          
          <code class="ruby">    return license if license</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="143" data-linenumber="51">
          <span class="hits">143</span>
          
          <code class="ruby">    license = License.new({ :language =&gt; language, :prod_key =&gt; prod_key, :version =&gt; version, :name =&gt; name, :url =&gt; url, :comments =&gt; comments, :distributions =&gt; distributions })</code>
        </li>
      
        <li class="covered" data-hits="143" data-linenumber="52">
          <span class="hits">143</span>
          
          <code class="ruby">    if license.save</code>
        </li>
      
        <li class="covered" data-hits="143" data-linenumber="53">
          <span class="hits">143</span>
          
          <code class="ruby">      log.info &quot;new license (#{name}) for #{language}:#{prod_key}:#{version}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    else </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">      log.error &quot;Can&#39;t save license (#{name}) for #{language}:#{prod_key}:#{version} because #{license.errors.full_messages.to_json}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="143" data-linenumber="57">
          <span class="hits">143</span>
          
          <code class="ruby">    license</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    if url </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">      return &quot;[License for (#{language}/#{prod_key}/#{version}) : #{name}/#{url}]&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    else </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">      return &quot;[License for (#{language}/#{prod_key}/#{version}) : #{name}]&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0138d5a81f5498e655410a3ebd795a42abeeb5f0">
  <div class="header">
    <h3>lib/versioneye/models/license_cach.rb</h3>
    <h4><span class="red">78.57 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LicenseCach &lt; Versioneye::Model </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name      , type: String # For example MIT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url       , type: String # URL to the license text</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # true  = it&#39;s conform with the license whitelist of the project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  # false = it violates the license whitelist of the project </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  # nil   = There is no license white list defined in the project </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :on_whitelist, type: Boolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :license_id, type: String </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  embedded_in :projectdependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    &quot;#{on_whitelist} - #{name} - #{url}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def link </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    url </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def name_substitute </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    name </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">end </code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="91e16f33fd85cb1975f0855628f9e95675d8da29">
  <div class="header">
    <h3>lib/versioneye/models/license_element.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>12</b> relevant lines. 
      <span class="green"><b>12</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LicenseElement &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/traits/license_normalizer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::LicenseNormalizer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  embedded_in :license_whitelist</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="16">
          <span class="hits">9</span>
          
          <code class="ruby">    name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_param</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8c332ea066030e0f806429a04892c7053fa9a11e">
  <div class="header">
    <h3>lib/versioneye/models/license_whitelist.rb</h3>
    <h4><span class="green">95.45 %</span> covered</h4>
    <div>
      <b>44</b> relevant lines. 
      <span class="green"><b>42</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LicenseWhitelist &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name,             type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :default,          type: Boolean, default: false </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :pessimistic_mode, type: Boolean, default: false </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  embeds_many :license_elements</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  index({user_id: 1, name: 1},  { name: &quot;user_id_name&quot;, background: true, unique: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="18">
          <span class="hits">41</span>
          
          <code class="ruby">  scope :by_user, -&gt;(user) { where(user_id: user[:_id].to_s) }</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="19">
          <span class="hits">26</span>
          
          <code class="ruby">  scope :by_name, -&gt;(name)  { where(name:  name ) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_param</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from params</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    self.name = params[:name]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_by user, name</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="34">
          <span class="hits">18</span>
          
          <code class="ruby">    self.by_user(user).by_name(name).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def license_by_name name</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="38">
          <span class="hits">23</span>
          
          <code class="ruby">    license_elements.each do |license|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>
          
          <code class="ruby">      return license if license.to_s.eql?( name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    log.error e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def license_elements_empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="48">
          <span class="hits">7</span>
          
          <code class="ruby">    license_elements.nil? || license_elements.size == 0 ? true : false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_license_element( name )</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="52">
          <span class="hits">23</span>
          
          <code class="ruby">    unless license_by_name(name)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="53">
          <span class="hits">22</span>
          
          <code class="ruby">      license_element = LicenseElement.new(:name =&gt; name)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="54">
          <span class="hits">22</span>
          
          <code class="ruby">      license_elements.push( license_element )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove_license_element name</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="59">
          <span class="hits">4</span>
          
          <code class="ruby">    license_elements.each do |license_element|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="60">
          <span class="hits">5</span>
          
          <code class="ruby">      if license_element.to_s.eql?( name )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="61">
          <span class="hits">3</span>
          
          <code class="ruby">        license_element.remove</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="62">
          <span class="hits">3</span>
          
          <code class="ruby">        self.save</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="63">
          <span class="hits">3</span>
          
          <code class="ruby">        return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def include_license_substitute? name</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="70">
          <span class="hits">26</span>
          
          <code class="ruby">    license_elements.each do |license_element|</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="71">
          <span class="hits">25</span>
          
          <code class="ruby">      return true if license_element.equals_id?( name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="73">
          <span class="hits">15</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def auditlogs</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="77">
          <span class="hits">2</span>
          
          <code class="ruby">    Auditlog.where(:domain =&gt; &quot;LicenseWhitelist&quot;, :domain_id =&gt; self.id.to_s).desc(:created_at)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="23361090e59b1322605ea926f2f57d6c4ea69546">
  <div class="header">
    <h3>lib/versioneye/models/lottery.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Lottery &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :selection, type: Array</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :active, type: Boolean, default: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :won, type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prize, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :migrated, default: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_user, -&gt;(user){where(user_id: user[:_id].to_s)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d3c00abd5ace6ca87cd93632da190ca696796337">
  <div class="header">
    <h3>lib/versioneye/models/mail_track.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>22</b> relevant lines. 
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class MailTrack &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :template   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :period     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_id , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ user_id: 1, template: 1 }, { name: &quot;user_id_template_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.add user_id, template_name, period, project_id = nil</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="14">
          <span class="hits">11</span>
          
          <code class="ruby">    MailTrack.new(:user_id =&gt; user_id, :template =&gt; template_name, :period =&gt; period, :project_id =&gt; project_id ).save </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.send_already? user_id, template_name, period</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="18">
          <span class="hits">13</span>
          
          <code class="ruby">    mails = fetch_by user_id, template_name, period</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="19">
          <span class="hits">13</span>
          
          <code class="ruby">    !mails.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_by user_id, template_name, period</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="23">
          <span class="hits">18</span>
          
          <code class="ruby">    time_ago = date_for period</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="24">
          <span class="hits">18</span>
          
          <code class="ruby">    MailTrack.where(:user_id =&gt; user_id, :template =&gt; template_name, :period =&gt; period, :created_at.gt =&gt; time_ago)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.date_for period </code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="28">
          <span class="hits">18</span>
          
          <code class="ruby">    if period.eql?(Project::A_PERIOD_DAILY)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="29">
          <span class="hits">14</span>
          
          <code class="ruby">      return DateTime.now - 24.hours</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="30">
          <span class="hits">4</span>
          
          <code class="ruby">    elsif period.eql?(Project::A_PERIOD_WEEKLY)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">      return DateTime.now - 1.week</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    else </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">      return DateTime.now - 1.month</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="cefe91e961cc1230686528a47b0078bcc3822cb7">
  <div class="header">
    <h3>lib/versioneye/models/maven_repository.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>61</b> relevant lines. 
      <span class="green"><b>61</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class MavenRepository &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :replace_with_repo_src, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_uniqueness_of :url, :message =&gt; &#39;m2 repository url exist already.&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ name: 1 }, { name: &quot;name_index&quot;, unique: true, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fill_it</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    repos = Hash.new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;custom&#39;]             = &#39;http://localhost:9090/maven2&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;central&#39;]            = &#39;http://repo.maven.apache.org/maven2&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;codeHaus&#39;]           = &#39;http://repository.codehaus.org/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;typesafe&#39;]           = &#39;http://repo.typesafe.com/typesafe/releases/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;akka&#39;]               = &#39;http://repo.akka.io/releases&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;ibiblio&#39;]            = &#39;http://mirrors.ibiblio.org/maven2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;antelink&#39;]           = &#39;http://maven.antelink.com/content/repositories/central/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;alfresco&#39;]           = &#39;https://artifacts.alfresco.com/nexus/content/groups/public/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;activity&#39;]           = &#39;https://maven.alfresco.com/nexus/content/repositories/activiti-releases/org/activiti/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;activity_designer&#39;]  = &#39;https://maven.alfresco.com/nexus/content/repositories/activiti/org/activiti/designer/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;servicemix&#39;]         = &#39;http://svn.apache.org/repos/asf/servicemix/m2-repo&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;springRelease&#39;]      = &#39;http://maven.springframework.org/release/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;springMilestone&#39;]    = &#39;http://maven.springframework.org/milestone/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;primeFaces&#39;]         = &#39;http://repository.primefaces.org/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;iceFaces&#39;]           = &#39;http://anonsvn.icesoft.org/repo/maven2/releases/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;glassfish&#39;]          = &#39;http://download.java.net/maven/glassfish/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;googleCode&#39;]         = &#39;http://google-maven-repository.googlecode.com/svn/repository/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;gradle&#39;]             = &#39;http://gradle.artifactoryonline.com/gradle/libs/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;atlassian&#39;]          = &#39;https://maven.atlassian.com/content/repositories/atlassian-public/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;atlassianContrib&#39;]   = &#39;https://maven.atlassian.com/content/repositories/atlassian-contrib/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;selenium&#39;]           = &#39;http://nexus.openqa.org/content/repositories/releases/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;jbossPublic&#39;]        = &#39;http://repository.jboss.org/nexus/content/groups/public-jboss/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;appFuse&#39;]            = &#39;http://static.appfuse.org/repository/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;fuse&#39;]               = &#39;http://repo.fusesource.com/maven2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;dojo&#39;]               = &#39;http://download.dojotoolkit.org/maven2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;ejb3unit&#39;]           = &#39;http://ejb3unit.sourceforge.net/maven2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;freehep&#39;]            = &#39;http://java.freehep.org/maven2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;geotools&#39;]           = &#39;http://download.osgeo.org/webdav/geotools/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;fuin&#39;]               = &#39;http://www.fuin.org/maven-repository/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;guiceyFruit&#39;]        = &#39;http://guiceyfruit.googlecode.com/svn/repo/releases/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;jasig&#39;]              = &#39;http://developer.jasig.org/repo/content/groups/m2-legacy/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;javanet&#39;]            = &#39;http://download.java.net/maven/2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;objectweb&#39;]          = &#39;http://repository.ow2.org/nexus/content/repositories/releases/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;restlet&#39;]            = &#39;http://maven.restlet.org/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;seasar&#39;]             = &#39;http://maven.seasar.org/maven2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;smartclient&#39;]        = &#39;http://www.smartclient.com/maven2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;abl&#39;]                = &#39;http://resources.automatedbusinesslogic.com/maven2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;carbonfive&#39;]         = &#39;http://mvn.carbonfive.com/nexus/content/groups/public/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;jfrog&#39;]              = &#39;http://repo.jfrog.org/artifactory/libs-releases/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;eviware&#39;]            = &#39;http://www.eviware.com/repository/maven2/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;devzendo&#39;]           = &#39;http://devzendo-org-repo.googlecode.com/svn/trunk/releases/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;pentaho&#39;]            = &#39;http://repository.pentaho.org/artifactory/pentaho/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;jcenter&#39;]            = &#39;http://jcenter.bintray.com&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;conjars&#39;]            = &#39;http://conjars.org/repo&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    repos[&#39;adobe&#39;]              = &#39;https://repo.adobe.com/nexus/content/groups/public/&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    repos.keys.each do |key|</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="64">
          <span class="hits">45</span>
          
          <code class="ruby">      repo = MavenRepository.new( { :name =&gt; key, :url =&gt; repos[key], :language =&gt; Product::A_LANGUAGE_JAVA } )</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="65">
          <span class="hits">45</span>
          
          <code class="ruby">      repo.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">    repo_clojure = MavenRepository.new( { :name =&gt; &#39;cloJars&#39;, :url =&gt; &#39;https://clojars.org/repo&#39;, :language =&gt; Product::A_LANGUAGE_CLOJURE } )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    repo_clojure.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"># https://repository.jboss.org/nexus/content/repositories/releases</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"># http://maven.restlet.org/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"># https://repository.jboss.org/nexus/content/repositories/thirdparty-releases/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"># http://artifactory.javassh.com/public-releases</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"># http://maven.vaadin.com/vaadin-addons</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1a9196178742d49e99f1a14c71f57e868ea1b351">
  <div class="header">
    <h3>lib/versioneye/models/newest.rb</h3>
    <h4><span class="red">69.57 %</span> covered</h4>
    <div>
      <b>46</b> relevant lines. 
      <span class="green"><b>32</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Newest &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # Every time a crawler is finding a new product or a new version of a product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # it has to create a &#39;newest&#39; entry.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name      , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_type , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :product_id, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :processed , type: Boolean, default: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_language, -&gt;(lang){where(language: lang)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  index({language: 1, prod_key: 1, version: 1}, { name: &quot;lang_prod_vers_index&quot;,   background: true, unique: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  index({updated_at: -1},                       { name: &quot;updated_at_index&quot;,       background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  index({updated_at: -1, language: -1},         { name: &quot;updated_language_index&quot;, background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  index({created_at: -1, language: -1},         { name: &quot;created_language_index&quot;, background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  index({created_at: -1},                       { name: &quot;created_at_index&quot;,       background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  index({language:   -1},                       { name: &quot;language_index&quot;,         background: true})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    &quot;#{language} : #{prod_key} : #{version}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def product</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    if !self.product_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">      product = product_by_id </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">      return product if product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    return Product.fetch_product self.language, self.prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def product_by_id </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">    Product.find(self.product_id) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  rescue =&gt; e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    nil </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_newest language, prod_key, version</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="46">
          <span class="hits">171</span>
          
          <code class="ruby">    Newest.where(:language =&gt; language, :prod_key =&gt; prod_key, :version =&gt; version).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_newest( count )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">    Newest.all().desc( :created_at ).limit( count )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.since_to(dt_since, dt_to)</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="54">
          <span class="hits">194</span>
          
          <code class="ruby">    self.where(:created_at.gte =&gt; dt_since, :created_at.lt =&gt; dt_to).desc(:created_at)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.balanced_newest(count)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    newest = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    Product::A_LANGS_SUPPORTED.each do |lang|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">      newest.concat Newest.where(language: lang).desc(:created_at).limit(count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    newest.shuffle.first(count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.balanced_novel(count)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    newest = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    Product::A_LANGS_SUPPORTED.each do |lang|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">      newest.concat Newest.where(language: lang, novel: true).desc(:created_at).limit(count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">    newest.shuffle.first(count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  def language_esc</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    return &#39;nodejs&#39; if language.eql?(Product::A_LANGUAGE_NODEJS)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    language.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2700fd92476583699ffb94dfa7eb7b085b2e258b">
  <div class="header">
    <h3>lib/versioneye/models/notification.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Notification &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version_id    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :read          , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :sent_email    , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email_disabled, type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :classification, type: String # nil for follow. Oterwise project. </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  index({product_id: 1, user_id: 1, version_id: 1}, { name: &quot;prod_user_vers_index&quot;, background: true, unique: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  index({user_id: 1}, { name: &quot;user_index&quot;, background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  index({user_id: 1, sent_email: 1}, { name: &quot;user_unsent_index&quot;, background: true})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :user_id   , :message =&gt; &#39;User is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :product_id, :message =&gt; &#39;Product is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="22">
          <span class="hits">11</span>
          
          <code class="ruby">  scope :all_not_sent, -&gt;{where(sent_email: false)}</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="23">
          <span class="hits">11</span>
          
          <code class="ruby">  scope :by_user     , -&gt;(user){where(user_id: user.id)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_user_id  , -&gt;(user_id){where(user_id: user_id).desc(:created_at).limit(30)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.unsent_user_notifications( user )</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="28">
          <span class="hits">9</span>
          
          <code class="ruby">    by_user( user ).all_not_sent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="42d1e4a532dc77b4a964acc7f62c4ba8fe85d9ed">
  <div class="header">
    <h3>lib/versioneye/models/np_domain.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class NpDomain &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # Non Profit Domains</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :domain       , type: String , default: &#39;@etna-alternance.net&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :free_projects, type: Integer, default: 50</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :domain       , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :free_projects, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_uniqueness_of :domain, :message =&gt; &#39;exist already.&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="cba4aaf031294928ea76d3c98cab92e9e03e4e26">
  <div class="header">
    <h3>lib/versioneye/models/plan.rb</h3>
    <h4><span class="green">97.47 %</span> covered</h4>
    <div>
      <b>79</b> relevant lines. 
      <span class="green"><b>77</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Plan &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PLAN_TRIAL_0      = &#39;03_trial_0&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PLAN_TRIAL_1      = &#39;03_trial_1&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PLAN_PERSONAL_3   = &#39;03_personal_3&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PLAN_PERSONAL_6   = &#39;03_personal_6&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PLAN_PERSONAL_9   = &#39;03_personal_9&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PLAN_BUSINESS_25  = &#39;03_business_25&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PLAN_BUSINESS_50  = &#39;03_business_50&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PLAN_BUSINESS_100 = &#39;03_business_100&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name_id         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name            , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :price           , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :private_projects, type: Integer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many :users</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.by_name_id name_id</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="25">
          <span class="hits">4</span>
          
          <code class="ruby">    Plan.where(:name_id =&gt; name_id).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_defaults</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="29">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_0 = Plan.new</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="30">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_0.name_id = A_PLAN_TRIAL_0</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="31">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_0.name = &#39;Trial / Free&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="32">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_0.price = &#39;0&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="33">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_0.private_projects = 1</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="34">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_0.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="36">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_1 = Plan.new</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="37">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_1.name_id = A_PLAN_TRIAL_1</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="38">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_1.name = &#39;Trial / Starter&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="39">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_1.price = &#39;1&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="40">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_1.private_projects = 2</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="41">
          <span class="hits">31</span>
          
          <code class="ruby">    trial_1.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="43">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_1 = Plan.new</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="44">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_1.name_id = A_PLAN_PERSONAL_3</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="45">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_1.name = &#39;Personal / Small&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="46">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_1.price = &#39;3&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="47">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_1.private_projects = 5</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="48">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_1.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="50">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_2 = Plan.new</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="51">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_2.name_id = A_PLAN_PERSONAL_6</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="52">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_2.name = &#39;Personal / Normal&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="53">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_2.price = &#39;6&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="54">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_2.private_projects = 10</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="55">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_2.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="57">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_3 = Plan.new</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="58">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_3.name_id = A_PLAN_PERSONAL_9</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="59">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_3.name = &#39;Personal / Big&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="60">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_3.price = &#39;9&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="61">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_3.private_projects = 15</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="62">
          <span class="hits">31</span>
          
          <code class="ruby">    personal_3.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="64">
          <span class="hits">31</span>
          
          <code class="ruby">    business_1 = Plan.new</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="65">
          <span class="hits">31</span>
          
          <code class="ruby">    business_1.name_id = A_PLAN_BUSINESS_25</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="66">
          <span class="hits">31</span>
          
          <code class="ruby">    business_1.name = &#39;Business / Small&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="67">
          <span class="hits">31</span>
          
          <code class="ruby">    business_1.price = &#39;25&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="68">
          <span class="hits">31</span>
          
          <code class="ruby">    business_1.private_projects = 50</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="69">
          <span class="hits">31</span>
          
          <code class="ruby">    business_1.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="71">
          <span class="hits">31</span>
          
          <code class="ruby">    business_2 = Plan.new</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="72">
          <span class="hits">31</span>
          
          <code class="ruby">    business_2.name_id = A_PLAN_BUSINESS_50</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="73">
          <span class="hits">31</span>
          
          <code class="ruby">    business_2.name = &#39;Business / Normal&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="74">
          <span class="hits">31</span>
          
          <code class="ruby">    business_2.price = &#39;50&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="75">
          <span class="hits">31</span>
          
          <code class="ruby">    business_2.private_projects = 100</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="76">
          <span class="hits">31</span>
          
          <code class="ruby">    business_2.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="78">
          <span class="hits">31</span>
          
          <code class="ruby">    business_3 = Plan.new</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="79">
          <span class="hits">31</span>
          
          <code class="ruby">    business_3.name_id = A_PLAN_BUSINESS_100</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="80">
          <span class="hits">31</span>
          
          <code class="ruby">    business_3.name = &#39;Business / Big&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="81">
          <span class="hits">31</span>
          
          <code class="ruby">    business_3.price = &#39;100&#39;</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="82">
          <span class="hits">31</span>
          
          <code class="ruby">    business_3.private_projects = 200</code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="83">
          <span class="hits">31</span>
          
          <code class="ruby">    business_3.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.current_plans</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">    Plan.where(name_id: /\A03/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.free_plan</code>
        </li>
      
        <li class="covered" data-hits="868" data-linenumber="91">
          <span class="hits">868</span>
          
          <code class="ruby">    Plan.where(name_id: A_PLAN_TRIAL_0).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.personal_plan</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="95">
          <span class="hits">8</span>
          
          <code class="ruby">    Plan.where(name_id: A_PLAN_PERSONAL_3).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.personal_plan_6</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="99">
          <span class="hits">3</span>
          
          <code class="ruby">    Plan.where(name_id: A_PLAN_PERSONAL_6).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.business_small_plan</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="103">
          <span class="hits">3</span>
          
          <code class="ruby">    Plan.where(name_id: A_PLAN_BUSINESS_25).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.business_normal_plan</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">    Plan.where(name_id: A_PLAN_BUSINESS_50).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="fd509f5886246c44429996c26313ae984b665e44">
  <div class="header">
    <h3>lib/versioneye/models/pom.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Pom &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url    , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ url: 1 }, { name: &quot;url_index&quot;, unique: true, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :url, presence: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1b18e55b1ef66475a870c13e5b27792824ed19db">
  <div class="header">
    <h3>lib/versioneye/models/product.rb</h3>
    <h4><span class="yellow">81.82 %</span> covered</h4>
    <div>
      <b>264</b> relevant lines. 
      <span class="green"><b>216</b> lines covered</span> and
      <span class="red"><b>48</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Product &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/helpers/product_constants&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::ProductConstants</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/helpers/product_es_mapping&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::ProductEsMapping</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name_downcase, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key     , type: String # Unique identifier inside a language</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_type    , type: String # Identifies the package manager</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version      , type: String, default: &#39;0.0.0+NA&#39; # latest stable version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :tags         , type: Array  # Array of keywords</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :group_id   , type: String # Maven specific - GroupID lower case</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :artifact_id, type: String # Maven specific - ArtifactId lower case</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :parent_id  , type: String # Maven specific</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :group_id_orig   , type: String # Maven specific</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :artifact_id_orig, type: String # Maven specific</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description       , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description_manual, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  field :downloads         , type: Integer, default: 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  field :followers         , type: Integer, default: 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  field :used_by_count     , type: Integer, default: 0 # Number of references, projects using this one.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dep_count         , type: Integer, default: 0 # Number of direct dependencies.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  field :average_release_time, type: Integer, default: 0 # Number of average release dates.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  field :twitter_name, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  field :reindex, type: Boolean, default: true # Trigger to reindex in ElasticSearch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  embeds_many :versions     # unsorted versions</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  embeds_many :repositories</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  has_and_belongs_to_many :users</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :language , :message =&gt; &#39;language  is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :prod_type, :message =&gt; &#39;prod_type is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :prod_key , :message =&gt; &#39;prod_key  is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name     , :message =&gt; &#39;name      is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  # For indexing use task: rake db:mongoid:create_indexes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ prod_key: 1, language: 1 },    { name: &quot;prod_key_language_index&quot;, unique: true, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ group_id: 1, artifact_id: 1 }, { name: &quot;group_id_artifact_id_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ name: 1 },                     { name: &quot;name_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ name_downcase: 1 },            { name: &quot;name_downcase_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ prod_type: 1, name: 1 },       { name: &quot;prod_type_name_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ created_at: -1},               { name: &quot;created_at_index&quot;, background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ updated_at: -1},               { name: &quot;updated_at_index&quot;, background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ updated_at: -1, language: -1}, { name: &quot;updated_language_index&quot;, background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ tags: 1},                      { name: &quot;tags_index&quot;, background: true})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :version_newest, :project_usage</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :released_days_ago, :released_ago_in_words, :released_ago_text</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :in_my_products, :dependencies_cache</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2113" data-linenumber="64">
          <span class="hits">2113</span>
          
          <code class="ruby">  scope :by_language, -&gt;(lang){where(language: lang)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  def show_dependency_badge?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    A_LANGS_DEP_BADGE.include?(self.language)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def save(*arg)</code>
        </li>
      
        <li class="covered" data-hits="1422" data-linenumber="72">
          <span class="hits">1422</span>
          
          <code class="ruby">    self.name_downcase = self.name.downcase if self.name</code>
        </li>
      
        <li class="covered" data-hits="1422" data-linenumber="73">
          <span class="hits">1422</span>
          
          <code class="ruby">    super</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    &quot;&lt;Product #{language} / #{prod_key} (#{version}) &gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_param</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="81">
          <span class="hits">21</span>
          
          <code class="ruby">    Product.encode_prod_key self.prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  def long_name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="85">
          <span class="hits">2</span>
          
          <code class="ruby">    if !group_id.to_s.empty? &amp;&amp; !artifact_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">      return &quot;#{group_id}:#{artifact_id}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">    return name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">  def group_id_original</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">    return group_id_orig if !group_id_orig.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    group_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">  def artifact_id_original</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">    return artifact_id_orig if !artifact_id_orig.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">    return name if !name.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">    artifact_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_tag tag_name</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="103">
          <span class="hits">3</span>
          
          <code class="ruby">    self.tags = [] if tags.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="104">
          <span class="hits">3</span>
          
          <code class="ruby">    self.tags.push( tag_name ) if !self.tags.include?( tag_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove_tag tag_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">    self.tags = [] if tags.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    self.tags.delete( tag_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  ######## SEARCH METHODS ####################</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_id id</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="115">
          <span class="hits">5</span>
          
          <code class="ruby">    self.find id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_product lang, key</code>
        </li>
      
        <li class="covered" data-hits="5514" data-linenumber="122">
          <span class="hits">5514</span>
          
          <code class="ruby">    return nil if lang.to_s.strip.empty? || key.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="3477" data-linenumber="123">
          <span class="hits">3477</span>
          
          <code class="ruby">    return Product.find_by_key( key ) if lang.eql? &#39;package&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3476" data-linenumber="125">
          <span class="hits">3476</span>
          
          <code class="ruby">    product = Product.find_by_lang_key( lang, key.downcase )</code>
        </li>
      
        <li class="covered" data-hits="3476" data-linenumber="126">
          <span class="hits">3476</span>
          
          <code class="ruby">    product = Product.find_by_lang_key( lang, key ) if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="3476" data-linenumber="127">
          <span class="hits">3476</span>
          
          <code class="ruby">    product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="130">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_bower name</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="131">
          <span class="hits">15</span>
          
          <code class="ruby">    return nil if name.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="133">
          <span class="hits">14</span>
          
          <code class="ruby">    product = Product.where(prod_type: Project::A_TYPE_BOWER, name: name).first</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="134">
          <span class="hits">14</span>
          
          <code class="ruby">    product = Product.where(prod_type: Project::A_TYPE_BOWER, name_downcase: name.to_s.downcase).first if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="135">
          <span class="hits">14</span>
          
          <code class="ruby">    product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  # legacy, still used by fall back search and API v1.0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_key searched_key</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="140">
          <span class="hits">6</span>
          
          <code class="ruby">    Product.where(prod_key: searched_key).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="143">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_lang_key language, searched_key</code>
        </li>
      
        <li class="covered" data-hits="6325" data-linenumber="144">
          <span class="hits">6325</span>
          
          <code class="ruby">    Product.where(language: language, prod_key: searched_key).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_group_and_artifact group, artifact, language = nil</code>
        </li>
      
        <li class="covered" data-hits="1986" data-linenumber="148">
          <span class="hits">1986</span>
          
          <code class="ruby">    return nil if group.to_s.strip.empty? || artifact.to_s.strip.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1984" data-linenumber="150">
          <span class="hits">1984</span>
          
          <code class="ruby">    product = nil</code>
        </li>
      
        <li class="covered" data-hits="1984" data-linenumber="151">
          <span class="hits">1984</span>
          
          <code class="ruby">    if language</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="152">
          <span class="hits">21</span>
          
          <code class="ruby">      product = Product.where( group_id: group, artifact_id: artifact, language: language ).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1984" data-linenumber="154">
          <span class="hits">1984</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="1970" data-linenumber="155">
          <span class="hits">1970</span>
          
          <code class="ruby">      product = Product.where( group_id: group, artifact_id: artifact ).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1984" data-linenumber="157">
          <span class="hits">1984</span>
          
          <code class="ruby">    product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="160">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.by_prod_keys language, prod_keys</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="161">
          <span class="hits">4</span>
          
          <code class="ruby">    if language.to_s.strip.empty? || prod_keys.nil? || prod_keys.empty? || !prod_keys.is_a?(Array)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="162">
          <span class="hits">3</span>
          
          <code class="ruby">      return Mongoid::Criteria.new(Product).where(:prod_key =&gt; &quot;-1-1&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="164">
          <span class="hits">1</span>
          
          <code class="ruby">    Product.where(:language =&gt; language, :prod_key.in =&gt; prod_keys)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">  ######## START VERSIONS ###################</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>
          
          <code class="ruby">  def sorted_versions</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="170">
          <span class="hits">4</span>
          
          <code class="ruby">    Naturalsorter::Sorter.sort_version_by_method( versions, &quot;version&quot;, false )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="174">
          
          
          <code class="ruby">    versions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="177">
          <span class="hits">1</span>
          
          <code class="ruby">  def version_by_number searched_version</code>
        </li>
      
        <li class="covered" data-hits="1272" data-linenumber="178">
          <span class="hits">1272</span>
          
          <code class="ruby">    versions.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="4298" data-linenumber="179">
          <span class="hits">4298</span>
          
          <code class="ruby">      return version if version.to_s.eql?( searched_version )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">    log.error e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="187">
          <span class="hits">1</span>
          
          <code class="ruby">  def versions_empty?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="188">
          <span class="hits">9</span>
          
          <code class="ruby">    versions.nil? || versions.size == 0 ? true : false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_version(version_string, hash = {})</code>
        </li>
      
        <li class="covered" data-hits="644" data-linenumber="192">
          <span class="hits">644</span>
          
          <code class="ruby">    return nil if version_by_number(version_string)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="612" data-linenumber="194">
          <span class="hits">612</span>
          
          <code class="ruby">    version_hash = {:version =&gt; version_string}</code>
        </li>
      
        <li class="covered" data-hits="612" data-linenumber="195">
          <span class="hits">612</span>
          
          <code class="ruby">    version_hash = version_hash.merge(hash) if !hash.nil? and !hash.empty?</code>
        </li>
      
        <li class="covered" data-hits="612" data-linenumber="196">
          <span class="hits">612</span>
          
          <code class="ruby">    version = Version.new(version_hash)</code>
        </li>
      
        <li class="covered" data-hits="612" data-linenumber="197">
          <span class="hits">612</span>
          
          <code class="ruby">    versions.push( version )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="200">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove_version version_string</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="201">
          <span class="hits">3</span>
          
          <code class="ruby">    versions.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="202">
          <span class="hits">5</span>
          
          <code class="ruby">      if version.to_s.eql?( version_string )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="203">
          <span class="hits">2</span>
          
          <code class="ruby">        version.remove</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="204">
          <span class="hits">2</span>
          
          <code class="ruby">        self.version = sorted_versions.first.to_s</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="205">
          <span class="hits">2</span>
          
          <code class="ruby">        self.save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="206">
          <span class="hits">2</span>
          
          <code class="ruby">        return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="209">
          <span class="hits">1</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">  def check_nil_version</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="213">
          <span class="hits">7</span>
          
          <code class="ruby">    if versions &amp;&amp; !versions.empty? &amp;&amp; (version.nil? || version.eql?(&#39;0.0.0+NA&#39;))</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="214">
          <span class="hits">2</span>
          
          <code class="ruby">      self.version = sorted_versions.first</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="215">
          <span class="hits">2</span>
          
          <code class="ruby">      self.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">  ######## ENCODE / DECODE ###################</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.encode_prod_key prod_key</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="222">
          <span class="hits">27</span>
          
          <code class="ruby">    return &quot;0&quot; if prod_key.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="223">
          <span class="hits">24</span>
          
          <code class="ruby">    prod_key.to_s.gsub(&#39;/&#39;, &#39;:&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="226">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.decode_prod_key prod_key</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="227">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if prod_key.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="228">
          <span class="hits">2</span>
          
          <code class="ruby">    prod_key.to_s.gsub(&#39;:&#39;, &#39;/&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="231">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.encode_language language</code>
        </li>
      
        <li class="covered" data-hits="7061" data-linenumber="232">
          <span class="hits">7061</span>
          
          <code class="ruby">    return nil if language.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="7058" data-linenumber="233">
          <span class="hits">7058</span>
          
          <code class="ruby">    language.to_s.gsub(&quot;\.&quot;, &quot;&quot;).downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="236">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.decode_language language</code>
        </li>
      
        <li class="covered" data-hits="2294" data-linenumber="237">
          <span class="hits">2294</span>
          
          <code class="ruby">    return nil if language.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="2291" data-linenumber="238">
          <span class="hits">2291</span>
          
          <code class="ruby">    return A_LANGUAGE_NODEJS       if language.match(/\Anode/i)</code>
        </li>
      
        <li class="covered" data-hits="2289" data-linenumber="239">
          <span class="hits">2289</span>
          
          <code class="ruby">    return A_LANGUAGE_CSS          if language.match(/\ACSS/i)</code>
        </li>
      
        <li class="covered" data-hits="2289" data-linenumber="240">
          <span class="hits">2289</span>
          
          <code class="ruby">    return A_LANGUAGE_PHP          if language.match(/\Aphp/i)</code>
        </li>
      
        <li class="covered" data-hits="2288" data-linenumber="241">
          <span class="hits">2288</span>
          
          <code class="ruby">    return A_LANGUAGE_OBJECTIVEC   if language.match(/\AObjective-C/i)</code>
        </li>
      
        <li class="covered" data-hits="2287" data-linenumber="242">
          <span class="hits">2287</span>
          
          <code class="ruby">    return A_LANGUAGE_JAVASCRIPT   if language.match(/\AJavaScript/i)</code>
        </li>
      
        <li class="covered" data-hits="2286" data-linenumber="243">
          <span class="hits">2286</span>
          
          <code class="ruby">    return A_LANGUAGE_COFFEESCRIPT if language.match(/\ACoffeeScript/i)</code>
        </li>
      
        <li class="covered" data-hits="2286" data-linenumber="244">
          <span class="hits">2286</span>
          
          <code class="ruby">    return A_LANGUAGE_ACTIONSCRIPT if language.match(/\AActionScript/i)</code>
        </li>
      
        <li class="covered" data-hits="2286" data-linenumber="245">
          <span class="hits">2286</span>
          
          <code class="ruby">    return A_LANGUAGE_TYPESCRIPT   if language.match(/\ATypeScript/i)</code>
        </li>
      
        <li class="covered" data-hits="2286" data-linenumber="246">
          <span class="hits">2286</span>
          
          <code class="ruby">    return A_LANGUAGE_LIVESCRIPT   if language.match(/\ALiveScript/i)</code>
        </li>
      
        <li class="covered" data-hits="2286" data-linenumber="247">
          <span class="hits">2286</span>
          
          <code class="ruby">    return A_LANGUAGE_HTML         if language.match(/\Ahtml/i)</code>
        </li>
      
        <li class="covered" data-hits="2286" data-linenumber="248">
          <span class="hits">2286</span>
          
          <code class="ruby">    return language.capitalize</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="251">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_in_my_products array_of_product_ids</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="252">
          
          
          <code class="ruby">    self.in_my_products = array_of_product_ids.include?(_id.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">  ########## ELSE #############</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="257">
          <span class="hits">1</span>
          
          <code class="ruby">  def released_at</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">    ver = version_by_number version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">    return ver.released_at if ver</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="260">
          
          
          <code class="ruby">    &quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="263">
          <span class="hits">1</span>
          
          <code class="ruby">  def description_summary</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="264">
          
          
          <code class="ruby">    if description &amp;&amp; description_manual</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="265">
          
          
          <code class="ruby">      &quot;#{description} \n \n #{description_manual}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">    elsif description &amp;&amp; !description_manual</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="267">
          
          
          <code class="ruby">      return description</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">    elsif !description &amp;&amp; description_manual</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">      return description_manual</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="271">
          
          
          <code class="ruby">      &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="275">
          <span class="hits">1</span>
          
          <code class="ruby">  def short_summary</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="276">
          
          
          <code class="ruby">    desc = description</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="277">
          
          
          <code class="ruby">    desc = description_manual if description_manual.to_s.length &gt; description.to_s.length</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="278">
          
          
          <code class="ruby">    return get_summary( desc , 125)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="281">
          <span class="hits">1</span>
          
          <code class="ruby">  def name_and_version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">    &quot;#{name} : #{version}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="285">
          <span class="hits">1</span>
          
          <code class="ruby">  def name_version limit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="286">
          
          
          <code class="ruby">    nameversion = &quot;#{name} (#{version})&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">    if nameversion.length &gt; limit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">      &quot;#{nameversion[0, limit]}..&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">      nameversion</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="294">
          <span class="hits">1</span>
          
          <code class="ruby">  def language_esc lang = nil</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="295">
          <span class="hits">33</span>
          
          <code class="ruby">    lang = self.language if lang.nil?</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="296">
          <span class="hits">33</span>
          
          <code class="ruby">    Product.encode_language lang</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="299">
          <span class="hits">1</span>
          
          <code class="ruby">  def license_info</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="300">
          <span class="hits">18</span>
          
          <code class="ruby">    licenses = self.licenses false</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="301">
          <span class="hits">18</span>
          
          <code class="ruby">    return &#39;unknown&#39; if licenses.nil? || licenses.empty?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="302">
          <span class="hits">10</span>
          
          <code class="ruby">    licenses.map{|a| a.name_substitute}.join(&#39;, &#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="305">
          <span class="hits">1</span>
          
          <code class="ruby">  def comments</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">    Versioncomment.find_by_prod_key_and_version(self.language, self.prod_key, self.version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby">  # An artifact (product + version) can have multiple licenses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby">  # at the same time. That&#39;s not a bug!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="311">
          <span class="hits">1</span>
          
          <code class="ruby">  def licenses ignore_version = false</code>
        </li>
      
        <li class="covered" data-hits="806" data-linenumber="312">
          <span class="hits">806</span>
          
          <code class="ruby">    substitute_names = []</code>
        </li>
      
        <li class="covered" data-hits="806" data-linenumber="313">
          <span class="hits">806</span>
          
          <code class="ruby">    licenses = []</code>
        </li>
      
        <li class="covered" data-hits="806" data-linenumber="314">
          <span class="hits">806</span>
          
          <code class="ruby">    lics = License.for_product self, ignore_version</code>
        </li>
      
        <li class="covered" data-hits="806" data-linenumber="315">
          <span class="hits">806</span>
          
          <code class="ruby">    consolidate_licenses lics, substitute_names, licenses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="806" data-linenumber="317">
          <span class="hits">806</span>
          
          <code class="ruby">    lics = License.for_product_global self</code>
        </li>
      
        <li class="covered" data-hits="806" data-linenumber="318">
          <span class="hits">806</span>
          
          <code class="ruby">    consolidate_licenses lics, substitute_names, licenses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="806" data-linenumber="320">
          <span class="hits">806</span>
          
          <code class="ruby">    licenses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="323">
          <span class="hits">1</span>
          
          <code class="ruby">  def licenses_all ignore_version = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="324">
          
          
          <code class="ruby">    licenses = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="325">
          
          
          <code class="ruby">    lics1 = License.for_product self, true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="326">
          
          
          <code class="ruby">    lics2 = License.for_product_global self</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="327">
          
          
          <code class="ruby">    lics1.each do |license|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="328">
          
          
          <code class="ruby">      licenses &lt;&lt; license</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="330">
          
          
          <code class="ruby">    lics2.each do |license|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="331">
          
          
          <code class="ruby">      licenses &lt;&lt; license</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">    licenses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="336">
          <span class="hits">1</span>
          
          <code class="ruby">  def developers</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">    Developer.find_by self.language, self.prod_key, self.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="340">
          <span class="hits">1</span>
          
          <code class="ruby">  def dependencies scope = nil</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="341">
          <span class="hits">9</span>
          
          <code class="ruby">    dependencies_cache ||= {}</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="342">
          <span class="hits">9</span>
          
          <code class="ruby">    scope = Dependency.main_scope( self.language, self.prod_type ) unless scope</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="343">
          <span class="hits">9</span>
          
          <code class="ruby">    if dependencies_cache[scope].nil?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="344">
          <span class="hits">9</span>
          
          <code class="ruby">      dependencies_cache[scope] = Dependency.find_by_lang_key_version_scope( language, prod_key, version, scope )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="346">
          <span class="hits">9</span>
          
          <code class="ruby">    dependencies_cache[scope]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="349">
          <span class="hits">1</span>
          
          <code class="ruby">  def all_dependencies( version = nil )</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="350">
          <span class="hits">6</span>
          
          <code class="ruby">    version = self.version if version.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="351">
          <span class="hits">6</span>
          
          <code class="ruby">    Dependency.find_by_lang_key_and_version( language, prod_key, version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">  # Returns the links which belong to the product and are not</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby">  # bounded to a specific verison of the product.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="356">
          
          
          <code class="ruby">  # For example link to project homepage.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="357">
          <span class="hits">1</span>
          
          <code class="ruby">  def http_links</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="358">
          <span class="hits">4</span>
          
          <code class="ruby">    links = Versionlink.where(language: language, prod_key: self.prod_key, version_id: nil).asc(:name)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="359">
          <span class="hits">4</span>
          
          <code class="ruby">    get_http_links links</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="360">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">  # Returns the links which are bounded to a specific version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">  # of the product.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby">  # For example link to an artifact or a migration path.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="365">
          <span class="hits">1</span>
          
          <code class="ruby">  def http_version_links</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="366">
          <span class="hits">2</span>
          
          <code class="ruby">    links = Versionlink.where(language: language, prod_key: self.prod_key, version_id: self.version ).asc(:name)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="367">
          <span class="hits">2</span>
          
          <code class="ruby">    get_http_links links</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby">  # Returns all links which are bounded to a specific version AND</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">  # the product links which are not bounded to a specific version.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="372">
          <span class="hits">1</span>
          
          <code class="ruby">  def http_version_links_combined</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="373">
          <span class="hits">1</span>
          
          <code class="ruby">    links_1 = http_links</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="374">
          <span class="hits">1</span>
          
          <code class="ruby">    links_2 = http_version_links</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="375">
          <span class="hits">1</span>
          
          <code class="ruby">    links_1 &lt;&lt; links_2</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="376">
          <span class="hits">1</span>
          
          <code class="ruby">    links_1.flatten!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="377">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="379">
          <span class="hits">1</span>
          
          <code class="ruby">  def archives</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">    downloads = Versionarchive.archives( self.language, self.prod_key, self.version.to_s )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="383">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.unique_languages_for_product_ids(product_ids)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="384">
          <span class="hits">1</span>
          
          <code class="ruby">    Product.where(:_id.in =&gt; product_ids).distinct(:language)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="385">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="386">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="387">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_url_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="388">
          
          
          <code class="ruby">    &quot;/#{language_esc}/#{to_param}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="389">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="391">
          <span class="hits">1</span>
          
          <code class="ruby">  def version_to_url_param</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="392">
          
          
          <code class="ruby">    Version.encode_version version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="395">
          <span class="hits">1</span>
          
          <code class="ruby">  def main_scope</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="396">
          
          
          <code class="ruby">    Dependency.main_scope self.language</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="398">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="399">
          <span class="hits">1</span>
          
          <code class="ruby">  def auditlogs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="400">
          
          
          <code class="ruby">    Auditlog.where(:domain_id =&gt; self.id.to_s).desc(:created_at)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="401">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="403">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="405">
          <span class="hits">1</span>
          
          <code class="ruby">    def consolidate_licenses lics, substitute_names, licenses</code>
        </li>
      
        <li class="covered" data-hits="1612" data-linenumber="406">
          <span class="hits">1612</span>
          
          <code class="ruby">      return if lics.nil? || lics.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="66" data-linenumber="408">
          <span class="hits">66</span>
          
          <code class="ruby">      lics.each do |license|</code>
        </li>
      
        <li class="covered" data-hits="85" data-linenumber="409">
          <span class="hits">85</span>
          
          <code class="ruby">        if !substitute_names.include?( license.name_substitute )</code>
        </li>
      
        <li class="covered" data-hits="83" data-linenumber="410">
          <span class="hits">83</span>
          
          <code class="ruby">          substitute_names &lt;&lt; license.name_substitute</code>
        </li>
      
        <li class="covered" data-hits="83" data-linenumber="411">
          <span class="hits">83</span>
          
          <code class="ruby">          licenses &lt;&lt; license</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="413">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="416">
          <span class="hits">1</span>
          
          <code class="ruby">    def get_summary text, size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="417">
          
          
          <code class="ruby">      return &#39;&#39; if text.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="418">
          
          
          <code class="ruby">      return &quot;#{text[0..size]}...&quot; if text.size &gt; size</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="419">
          
          
          <code class="ruby">      text[0..size]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="421">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="422">
          <span class="hits">1</span>
          
          <code class="ruby">    def get_http_links links</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="423">
          <span class="hits">6</span>
          
          <code class="ruby">      result = []</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="424">
          <span class="hits">6</span>
          
          <code class="ruby">      return result if links.nil? || links.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="426">
          <span class="hits">4</span>
          
          <code class="ruby">      links.each do |link|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="427">
          <span class="hits">4</span>
          
          <code class="ruby">        next if link.nil?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="428">
          <span class="hits">4</span>
          
          <code class="ruby">        next if link.link.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="429">
          <span class="hits">4</span>
          
          <code class="ruby">        next if link.link.match(/\Ahttp*/i) == nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="430">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="431">
          <span class="hits">4</span>
          
          <code class="ruby">        if !link.to_s.match(&quot;search.maven.org&quot;) &amp;&amp; !self.group_id.to_s.empty? &amp;&amp; link.to_s.match(self.group_id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="432">
          
          
          <code class="ruby">          link.link = link.to_s.gsub( self.group_id , self.group_id.gsub(/\./, &quot;/&quot;) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="433">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="435">
          <span class="hits">4</span>
          
          <code class="ruby">        result &lt;&lt; link</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="437">
          <span class="hits">4</span>
          
          <code class="ruby">      result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="439">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8f2c3d318556ca07471888079f4ace34f66f75c6">
  <div class="header">
    <h3>lib/versioneye/models/product_resource.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>17</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProductResource &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url          , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :resource_type, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :crawler_name , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :crawled      , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_type    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :force_fullname, type: Boolean, default: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  has_one :submitted_url, autosave: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :url, :resource_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_id( id )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="20">
          <span class="hits">3</span>
          
          <code class="ruby">    id = id.to_s.strip</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="21">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if id.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    return ProductResource.find(id) if ProductResource.where(_id: id).exists?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="89faec3d7f4ec2f99eadb2ad85cf181e73c37956">
  <div class="header">
    <h3>lib/versioneye/models/project.rb</h3>
    <h4><span class="green">91.27 %</span> covered</h4>
    <div>
      <b>252</b> relevant lines. 
      <span class="green"><b>230</b> lines covered</span> and
      <span class="red"><b>22</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Project &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_RUBYGEMS  = &#39;RubyGem&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_PIP       = &#39;PIP&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_NPM       = &#39;npm&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_COMPOSER  = &#39;composer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_GRADLE    = &#39;gradle&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_SBT       = &#39;sbt&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_MAVEN2    = &#39;Maven2&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_LEIN      = &#39;Lein&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_BOWER     = &#39;Bower&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_GITHUB    = &#39;GitHub&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_R         = &#39;R&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_COCOAPODS = &#39;CocoaPods&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TYPE_BIICODE   = &#39;Biicode&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SOURCE_UPLOAD    = &#39;upload&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SOURCE_URL       = &#39;url&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SOURCE_GITHUB    = &#39;github&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SOURCE_BITBUCKET = &#39;bitbucket&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SOURCE_STASH     = &#39;stash&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SOURCE_API       = &#39;API&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PERIOD_MONTHLY = &#39;monthly&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PERIOD_WEEKLY  = &#39;weekly&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  A_PERIOD_DAILY   = &#39;daily&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name_downcase, type: String # downcased name, because MongoDB doesn&#39;t support case insensitive search.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  field :license      , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  field :group_id   , type: String # Maven specific</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  field :artifact_id, type: String # Maven specific</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_type  , type: String,  :default =&gt; A_TYPE_MAVEN2</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language      , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_key   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  field :period        , type: String,  :default =&gt; A_PERIOD_DAILY</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  field :notify_after_api_update, type: Boolean, :default =&gt; false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url           , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  field :source        , type: String,  :default =&gt; A_SOURCE_UPLOAD</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  field :s3_filename   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  field :allow_zero_deps, type: Boolean, :default =&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  field :scm_fullname  , type: String # repo name, for example &#39;reiz/gemify&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  field :scm_branch    , type: String, default: &quot;master&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  field :scm_revision  , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dep_number      , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  field :out_number      , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  field :unknown_number  , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  field :licenses_red    , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  field :licenses_unknown, type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  field :sv_count        , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  # These are the numbers summed up from all children</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  field :dep_number_sum      , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  field :out_number_sum      , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  field :unknown_number_sum  , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  field :licenses_red_sum    , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  field :licenses_unknown_sum, type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  field :sv_count_sum        , type: Integer, :default =&gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  field :public         , type: Boolean, :default =&gt; false  # visible for everybody</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  field :private_project, type: Boolean, :default =&gt; false  # private project from GitHub/Bitbucket</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  field :parent_id      , type: String,  :default =&gt; nil    # id of the parent project.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  field :license_whitelist_id, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  field :parsing_errors , type: Array, :default =&gt; []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :name       , presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :project_key, presence: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many   :projectdependencies</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many   :collaborators, class_name: &#39;ProjectCollaborator&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  index({project_key: 1, project_type: 1}, { name: &quot;key_type_index&quot;,  background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  index({user_id: 1, private_project: 1},  { name: &quot;user_id_private_index&quot;, background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  index({user_id: 1}, { name: &quot;user_id_index&quot;, background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">  index({name: 1},    { name: &quot;name_index&quot;,    background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">  index({source: 1},  { name: &quot;source_index&quot;,  background: true})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="90">
          <span class="hits">9</span>
          
          <code class="ruby">  scope :by_collaborator, -&gt;(user){ all_in(_id: ProjectCollaborator.by_user(user).to_a.map(&amp;:project_id)) }</code>
        </li>
      
        <li class="covered" data-hits="209" data-linenumber="91">
          <span class="hits">209</span>
          
          <code class="ruby">  scope :by_user   , -&gt;(user)    { where(user_id: user[:_id].to_s) }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="92">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :by_user_id, -&gt;(user_id) { where(user_id: user_id.to_s) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_id     , -&gt;(id)      { where(_id: id.to_s) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_source , -&gt;(source)  { where(source:  source ) }</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="95">
          <span class="hits">11</span>
          
          <code class="ruby">  scope :by_period , -&gt;(period)  { where(period:  period ) }</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="96">
          <span class="hits">12</span>
          
          <code class="ruby">  scope :parents   , -&gt; { where(parent_id: nil ) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_github , -&gt;(reponame){ where(source: A_SOURCE_GITHUB, scm_fullname: reponame) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :lwl_pdf_list, :has_kids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">  before_save :perpare_name_for_search</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="104">
          <span class="hits">10</span>
          
          <code class="ruby">    &quot;&lt;Project #{language}/#{project_type} #{name}&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">  def ids</code>
        </li>
      
        <li class="covered" data-hits="98" data-linenumber="108">
          <span class="hits">98</span>
          
          <code class="ruby">    id.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>
          
          <code class="ruby">  def parent</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="112">
          <span class="hits">4</span>
          
          <code class="ruby">    Project.find parent_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">  def children</code>
        </li>
      
        <li class="covered" data-hits="100" data-linenumber="116">
          <span class="hits">100</span>
          
          <code class="ruby">    Project.where(:parent_id =&gt; self.id.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">  def scopes</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">    return [] if self.projectdependencies.nil? || self.projectdependencies.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">    scopes = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">    self.projectdependencies.each do |dependency|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">      scopes &lt;&lt; dependency.scope if !scopes.include?( dependency.scope )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">    scopes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">  def dependencies(scope = nil)</code>
        </li>
      
        <li class="covered" data-hits="468" data-linenumber="129">
          <span class="hits">468</span>
          
          <code class="ruby">    return self.projectdependencies if scope.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">    return self.projectdependencies if self.projectdependencies.nil? || self.projectdependencies.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="131">
          
          
          <code class="ruby">    deps = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">    self.projectdependencies.each do |dependency|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">      deps &lt;&lt; dependency if dependency.scope.eql?(scope)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">    deps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">  def sorted_dependencies_by_rank( deps = nil )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">    deps = self.dependencies if deps.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">    return deps if deps.nil? or deps.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="141">
          <span class="hits">4</span>
          
          <code class="ruby">    deps.sort_by {|dep| dep[:status_rank] }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">  def unmuted_dependencies</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="145">
          <span class="hits">4</span>
          
          <code class="ruby">    deps = self.projectdependencies</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="146">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if deps.nil?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="147">
          <span class="hits">4</span>
          
          <code class="ruby">    deps.any_in(muted: [false, nil])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">  def muted_dependencies</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="151">
          <span class="hits">20</span>
          
          <code class="ruby">    deps = self.projectdependencies</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="152">
          <span class="hits">20</span>
          
          <code class="ruby">    return nil if deps.nil?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="153">
          <span class="hits">20</span>
          
          <code class="ruby">    deps.any_in(muted: [true])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="156">
          <span class="hits">1</span>
          
          <code class="ruby">  def muted_dependencies_count</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="157">
          <span class="hits">3</span>
          
          <code class="ruby">    deps = muted_dependencies</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="158">
          <span class="hits">3</span>
          
          <code class="ruby">    return 0 if deps.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="159">
          <span class="hits">3</span>
          
          <code class="ruby">    deps.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="162">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_id( id )</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="163">
          <span class="hits">37</span>
          
          <code class="ruby">    Project.find( id )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="170">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_ga( group_id, artifact_id )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="171">
          <span class="hits">3</span>
          
          <code class="ruby">    Project.where(:group_id =&gt; group_id, :artifact_id =&gt; artifact_id).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>
          
          <code class="ruby">  def filename</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="175">
          <span class="hits">15</span>
          
          <code class="ruby">    self.s3_filename.to_s.gsub(/\A\S+\_/, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="178">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.private_project_count_by_user user_id</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="179">
          <span class="hits">12</span>
          
          <code class="ruby">    Project.where( user_id: user_id, private_project: true ).count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="182">
          <span class="hits">1</span>
          
          <code class="ruby">  def show_dependency_badge?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="183">
          <span class="hits">2</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="186">
          <span class="hits">1</span>
          
          <code class="ruby">  def visible_for_user?(user)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="187">
          <span class="hits">9</span>
          
          <code class="ruby">    return true  if self[:public]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="188">
          <span class="hits">8</span>
          
          <code class="ruby">    return false if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="189">
          <span class="hits">7</span>
          
          <code class="ruby">    return true  if user.admin</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="190">
          <span class="hits">6</span>
          
          <code class="ruby">    return true  if self.user_id.to_s == user[:_id].to_s</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="191">
          <span class="hits">3</span>
          
          <code class="ruby">    return true  if ProjectCollaborator.collaborator?(self[:_id], user[:_id])</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="192">
          <span class="hits">2</span>
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="195">
          <span class="hits">1</span>
          
          <code class="ruby">  def collaborator( user )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="196">
          <span class="hits">11</span>
          
          <code class="ruby">    return nil if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="197">
          <span class="hits">10</span>
          
          <code class="ruby">    return nil if collaborators.nil? || collaborators.size == 0</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="198">
          <span class="hits">5</span>
          
          <code class="ruby">    collaborators.each do |collaborator|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="199">
          <span class="hits">5</span>
          
          <code class="ruby">      return collaborator if user._id.to_s.eql?( collaborator.user_id.to_s )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="204">
          <span class="hits">1</span>
          
          <code class="ruby">  def license_whitelist</code>
        </li>
      
        <li class="covered" data-hits="69" data-linenumber="205">
          <span class="hits">69</span>
          
          <code class="ruby">    return nil if license_whitelist_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="206">
          <span class="hits">44</span>
          
          <code class="ruby">    LicenseWhitelist.find license_whitelist_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="208">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">  def license_whitelist_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">    lwl = license_whitelist</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">    return lwl.name if lwl</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">  def collaborator?( user )</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="219">
          <span class="hits">12</span>
          
          <code class="ruby">    return false if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="220">
          <span class="hits">11</span>
          
          <code class="ruby">    return true if !self.user.nil? &amp;&amp; self.user.username.eql?( user.username )</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="221">
          <span class="hits">6</span>
          
          <code class="ruby">    !collaborator( user ).nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove_collaborators</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="225">
          <span class="hits">8</span>
          
          <code class="ruby">    collaborators.each { |collaborator| collaborator.remove }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="228">
          <span class="hits">1</span>
          
          <code class="ruby">  def known_dependencies</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="229">
          <span class="hits">3</span>
          
          <code class="ruby">    self.projectdependencies.find_all {|dep| dep.prod_key }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="232">
          <span class="hits">1</span>
          
          <code class="ruby">  def remove_dependencies</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="233">
          <span class="hits">19</span>
          
          <code class="ruby">    Projectdependency.where(:project_id =&gt; self.ids).each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="60" data-linenumber="234">
          <span class="hits">60</span>
          
          <code class="ruby">      dep.delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="236">
          <span class="hits">19</span>
          
          <code class="ruby">    projectdependencies.clear</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="239">
          <span class="hits">1</span>
          
          <code class="ruby">  def save_dependencies</code>
        </li>
      
        <li class="covered" data-hits="359" data-linenumber="240">
          <span class="hits">359</span>
          
          <code class="ruby">    projectdependencies.each { |dependency| dependency.save }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="243">
          <span class="hits">1</span>
          
          <code class="ruby">  def muted_prod_keys</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="244">
          <span class="hits">15</span>
          
          <code class="ruby">    prod_keys = Array.new</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="245">
          <span class="hits">15</span>
          
          <code class="ruby">    mute_messages = {}</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="246">
          <span class="hits">15</span>
          
          <code class="ruby">    muted_deps = muted_dependencies</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="247">
          <span class="hits">15</span>
          
          <code class="ruby">    muted_deps.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="248">
          <span class="hits">3</span>
          
          <code class="ruby">      key = dep_key(dep)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="249">
          <span class="hits">3</span>
          
          <code class="ruby">      prod_keys &lt;&lt; key</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="250">
          <span class="hits">3</span>
          
          <code class="ruby">      mute_messages[key] = dep.mute_message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="252">
          <span class="hits">15</span>
          
          <code class="ruby">    {:keys =&gt; prod_keys, :messages =&gt; mute_messages}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="255">
          <span class="hits">1</span>
          
          <code class="ruby">  def make_project_key!</code>
        </li>
      
        <li class="covered" data-hits="218" data-linenumber="256">
          <span class="hits">218</span>
          
          <code class="ruby">    if self.project_key.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="257">
          <span class="hits">216</span>
          
          <code class="ruby">      self.project_key = make_project_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="261">
          <span class="hits">1</span>
          
          <code class="ruby">  def make_project_key</code>
        </li>
      
        <li class="covered" data-hits="216" data-linenumber="262">
          <span class="hits">216</span>
          
          <code class="ruby">    return Project.create_random_value() if self.user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="208" data-linenumber="264">
          <span class="hits">208</span>
          
          <code class="ruby">    project_nr = 1</code>
        </li>
      
        <li class="covered" data-hits="208" data-linenumber="265">
          <span class="hits">208</span>
          
          <code class="ruby">    project_key_text = &quot;#{self.project_type}_#{self.name}&quot;.downcase</code>
        </li>
      
        <li class="covered" data-hits="208" data-linenumber="266">
          <span class="hits">208</span>
          
          <code class="ruby">    project_key_text.gsub!(/[\s|\W|\_]+/, &quot;_&quot;)</code>
        </li>
      
        <li class="covered" data-hits="208" data-linenumber="267">
          <span class="hits">208</span>
          
          <code class="ruby">    if project_key_text.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">      project_key_text = Project.create_random_value()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="208" data-linenumber="271">
          <span class="hits">208</span>
          
          <code class="ruby">    similar_projects = Project.by_user(self.user).where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">                        project_key: Regexp.new(&quot;#{project_key_text}&quot;),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">                        project_type: self.project_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby">                      )</code>
        </li>
      
        <li class="covered" data-hits="208" data-linenumber="275">
          <span class="hits">208</span>
          
          <code class="ruby">    project_nr += similar_projects.count unless similar_projects.nil?</code>
        </li>
      
        <li class="covered" data-hits="208" data-linenumber="276">
          <span class="hits">208</span>
          
          <code class="ruby">    &quot;#{project_key_text}_#{project_nr}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="278">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="280">
          
          
          <code class="ruby">    Project.create_random_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="283">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from new_project</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="284">
          <span class="hits">12</span>
          
          <code class="ruby">    return nil if new_project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="286">
          <span class="hits">12</span>
          
          <code class="ruby">    self.dep_number     = new_project.dep_number</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="287">
          <span class="hits">12</span>
          
          <code class="ruby">    self.out_number     = new_project.out_number</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="288">
          <span class="hits">12</span>
          
          <code class="ruby">    self.unknown_number = new_project.unknown_number</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="289">
          <span class="hits">12</span>
          
          <code class="ruby">    self.description    = new_project.description</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="290">
          <span class="hits">12</span>
          
          <code class="ruby">    self.license        = new_project.license</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="291">
          <span class="hits">12</span>
          
          <code class="ruby">    self.url            = new_project.url</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="292">
          <span class="hits">12</span>
          
          <code class="ruby">    if new_project.s3_filename</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="293">
          <span class="hits">1</span>
          
          <code class="ruby">      self.s3_filename  = new_project.s3_filename</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="296">
          <span class="hits">12</span>
          
          <code class="ruby">    self.overwrite_dependencies( new_project.projectdependencies )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="298">
          <span class="hits">12</span>
          
          <code class="ruby">    self.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="301">
          <span class="hits">1</span>
          
          <code class="ruby">  def overwrite_dependencies( new_dependencies )</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="302">
          <span class="hits">13</span>
          
          <code class="ruby">    muted_deps    = muted_prod_keys</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="303">
          <span class="hits">13</span>
          
          <code class="ruby">    muted_keys    = muted_deps[:keys]</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="304">
          <span class="hits">13</span>
          
          <code class="ruby">    mute_messages = muted_deps[:messages]</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="305">
          <span class="hits">13</span>
          
          <code class="ruby">    remove_dependencies</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="306">
          <span class="hits">13</span>
          
          <code class="ruby">    new_dependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="133" data-linenumber="307">
          <span class="hits">133</span>
          
          <code class="ruby">      key = dep_key(dep)</code>
        </li>
      
        <li class="covered" data-hits="133" data-linenumber="308">
          <span class="hits">133</span>
          
          <code class="ruby">      if muted_keys.include?( key )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="309">
          <span class="hits">1</span>
          
          <code class="ruby">        dep.muted = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="310">
          <span class="hits">1</span>
          
          <code class="ruby">        dep.mute_message = mute_messages[key]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="311">
          <span class="hits">1</span>
          
          <code class="ruby">        dep.outdated = false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="312">
          <span class="hits">1</span>
          
          <code class="ruby">        dep.outdated_updated_at = DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="313">
          <span class="hits">1</span>
          
          <code class="ruby">        self.out_number = self.out_number.to_i - 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="133" data-linenumber="315">
          <span class="hits">133</span>
          
          <code class="ruby">      projectdependencies.push dep</code>
        </li>
      
        <li class="covered" data-hits="133" data-linenumber="316">
          <span class="hits">133</span>
          
          <code class="ruby">      dep.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="320">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.email_for(project, user)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="321">
          <span class="hits">5</span>
          
          <code class="ruby">    return user.email if project.email.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="323">
          <span class="hits">3</span>
          
          <code class="ruby">    user_email = user.get_email( project.email )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="324">
          <span class="hits">3</span>
          
          <code class="ruby">    return user_email.email if user_email &amp;&amp; user_email.verified?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="326">
          <span class="hits">2</span>
          
          <code class="ruby">    return user.email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="329">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_random_value</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="330">
          <span class="hits">10</span>
          
          <code class="ruby">    chars = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="331">
          <span class="hits">10</span>
          
          <code class="ruby">    value = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="210" data-linenumber="332">
          <span class="hits">210</span>
          
          <code class="ruby">    20.times { value &lt;&lt; chars[rand(chars.size)] }</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="333">
          <span class="hits">10</span>
          
          <code class="ruby">    value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="335">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="336">
          <span class="hits">1</span>
          
          <code class="ruby">  def sum_own!</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="337">
          <span class="hits">68</span>
          
          <code class="ruby">    self.dep_number_sum       = self.dep_number</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="338">
          <span class="hits">68</span>
          
          <code class="ruby">    self.out_number_sum       = self.out_number</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="339">
          <span class="hits">68</span>
          
          <code class="ruby">    self.unknown_number_sum   = self.unknown_number</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="340">
          <span class="hits">68</span>
          
          <code class="ruby">    self.licenses_red_sum     = self.licenses_red</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="341">
          <span class="hits">68</span>
          
          <code class="ruby">    self.licenses_unknown_sum = self.licenses_unknown</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="342">
          <span class="hits">68</span>
          
          <code class="ruby">    self.sv_count_sum         = self.sv_count</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="343">
          <span class="hits">68</span>
          
          <code class="ruby">    self.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="344">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="346">
          <span class="hits">1</span>
          
          <code class="ruby">  def sum_reset!</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="347">
          <span class="hits">16</span>
          
          <code class="ruby">    self.dep_number_sum       = 0</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="348">
          <span class="hits">16</span>
          
          <code class="ruby">    self.out_number_sum       = 0</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="349">
          <span class="hits">16</span>
          
          <code class="ruby">    self.unknown_number_sum   = 0</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="350">
          <span class="hits">16</span>
          
          <code class="ruby">    self.licenses_red_sum     = 0</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="351">
          <span class="hits">16</span>
          
          <code class="ruby">    self.licenses_unknown_sum = 0</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="352">
          <span class="hits">16</span>
          
          <code class="ruby">    self.sv_count_sum         = 0</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="353">
          <span class="hits">16</span>
          
          <code class="ruby">    self.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="356">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_binding</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="357">
          
          
          <code class="ruby">    binding()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="359">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="360">
          <span class="hits">1</span>
          
          <code class="ruby">  def auditlogs</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="361">
          <span class="hits">1</span>
          
          <code class="ruby">    Auditlog.where(:domain_id =&gt; self.ids).desc(:created_at)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="364">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="366">
          <span class="hits">1</span>
          
          <code class="ruby">    def dep_key dep</code>
        </li>
      
        <li class="covered" data-hits="136" data-linenumber="367">
          <span class="hits">136</span>
          
          <code class="ruby">      &quot;#{dep.language}_#{dep.prod_key}_#{dep.version_current}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="370">
          <span class="hits">1</span>
          
          <code class="ruby">    def perpare_name_for_search</code>
        </li>
      
        <li class="covered" data-hits="546" data-linenumber="371">
          <span class="hits">546</span>
          
          <code class="ruby">      self.name_downcase = self.name.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="374">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a00c77a74d497434e29c9e298d34b85d2c6a3e37">
  <div class="header">
    <h3>lib/versioneye/models/project_collaborator.rb</h3>
    <h4><span class="green">95.65 %</span> covered</h4>
    <div>
      <b>46</b> relevant lines. 
      <span class="green"><b>44</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectCollaborator &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_id, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id   , type: String # the user who is added as collaborator</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :owner_id  , type: String # the owner of the project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :caller_id , type: String # another contributor can add more contributors</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :active, type: Boolean, default: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :invitation_email, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :invitation_code , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :invitation_sent , type: Boolean, default: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :period, type: String, default: Project::A_PERIOD_WEEKLY</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  index({project_id: 1, user_id: 1}, { name: &quot;project_user_index&quot;, background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  index({user_id: 1},          { name: &quot;user_index&quot;,               background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  index({project_id: 1},       { name: &quot;project_index&quot;,            background: true})</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  index({invitation_email: 1}, { name: &quot;invitation_email_index&quot;,   background: true})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :project_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :owner_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :caller_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_period, -&gt;(period){ where(period:  period ) }</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="31">
          <span class="hits">22</span>
          
          <code class="ruby">  scope :by_user, -&gt;(user){ any_of({user_id: user.id.to_s},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">                                   {invitation_email: user[:email]}) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    self.find(id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.collaborator?(project_id, user_id)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="42">
          <span class="hits">9</span>
          
          <code class="ruby">    self.where(project_id: project_id, user_id: user_id.to_s).exists?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def user</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="46">
          <span class="hits">7</span>
          
          <code class="ruby">    User.find_by_id(self[:user_id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def owner</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="50">
          <span class="hits">4</span>
          
          <code class="ruby">    User.find_by_id(self[:owner_id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def caller</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="54">
          <span class="hits">9</span>
          
          <code class="ruby">    User.find_by_id(self[:caller_id])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  def owner?(current_user)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="58">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if current_user.nil? || !current_user.has_attribute?(:_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="59">
          <span class="hits">2</span>
          
          <code class="ruby">    self.owner_id == current_user.id.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  # TODO this doesn&#39;t work for users who just signed up, who are invited by email to the project!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def current?(user)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="64">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="65">
          <span class="hits">2</span>
          
          <code class="ruby">    return false if self[:user_id].nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">    self[:user_id].to_s == user[:_id].to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def accepted?(current_user)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="70">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if current_user.nil? or !current_user.has_attribute?(:_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="71">
          <span class="hits">2</span>
          
          <code class="ruby">    self[:active] &amp;&amp; (self.user_id == current_user.id.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">  def not_accepted?(current_user)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">    not accepted?(current_user)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0528ea7a38d4aa0d1e641620e1a734c08e090f5a">
  <div class="header">
    <h3>lib/versioneye/models/projectdependency.rb</h3>
    <h4><span class="yellow">87.8 %</span> covered</h4>
    <div>
      <b>82</b> relevant lines. 
      <span class="green"><b>72</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Projectdependency &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;naturalsorter&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # This Model describes the relationship between a project and a software component / dependency </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # This Model describes 1 dependency of a project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  # This project dependency refers to the product with the given language and prod_key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :ext_link   , type: String # Link to external package. For example zip file on GitHub / Google Code.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name       , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :group_id   , type: String # Maven specific</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :artifact_id, type: String # Maven specific</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version_current  , type: String  # the newest version from the database</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version_requested, type: String  # requested version from the project file -&gt; locked version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version_label    , type: String  # the version number from the projectfile (Gemfile, package.json)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :comperator       , type: String, :default =&gt; &#39;=&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :scope            , type: String, :default =&gt; Dependency::A_SCOPE_COMPILE</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  field :release          , type: Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stability        , type: String, :default =&gt; VersionTagRecognizer::A_STABILITY_STABLE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  field :outdated           , type: Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  field :outdated_updated_at, type: DateTime, :default =&gt; DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  field :muted              , type: Boolean , :default =&gt; false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  field :mute_message       , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  field :sv_ids           , type: Array, default: []  # SecurityVulnerability IDs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  field :lwl_violation    , type: String # [nil, partial, yes]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  embeds_many :license_caches, cascade_callbacks: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  index({project_id: 1}, { name: &quot;project_index&quot;, background: true})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="46">
          <span class="hits">5</span>
          
          <code class="ruby">    &quot;&lt;Projectdependency: #{project} depends on #{name} (#{version_label}/#{version_requested}) current: #{version_current} &gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def language_esc lang = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    lang = self.language if lang.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    return nil if lang.to_s.empty? </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    Product.encode_language lang</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_id id</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="58">
          <span class="hits">5</span>
          
          <code class="ruby">    Projectdependency.find id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def version </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    version_requested</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def security_vulnerabilities </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">    return nil if sv_ids.to_a.empty? </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    SecurityVulnerability.where(:_id.in =&gt; sv_ids)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  def product</code>
        </li>
      
        <li class="covered" data-hits="2452" data-linenumber="76">
          <span class="hits">2452</span>
          
          <code class="ruby">    if project &amp;&amp; project.project_type.to_s.eql?( Project::A_TYPE_BOWER )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">      product = Product.fetch_bower name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">      return product if product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2452" data-linenumber="81">
          <span class="hits">2452</span>
          
          <code class="ruby">    if !group_id.to_s.empty? &amp;&amp; !artifact_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="916" data-linenumber="82">
          <span class="hits">916</span>
          
          <code class="ruby">      product = Product.find_by_group_and_artifact self.group_id, self.artifact_id</code>
        </li>
      
        <li class="covered" data-hits="916" data-linenumber="83">
          <span class="hits">916</span>
          
          <code class="ruby">      return product if product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2269" data-linenumber="86">
          <span class="hits">2269</span>
          
          <code class="ruby">    Product.fetch_product( self.language, self.prod_key.to_s.downcase )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">  def find_or_init_product</code>
        </li>
      
        <li class="covered" data-hits="2001" data-linenumber="91">
          <span class="hits">2001</span>
          
          <code class="ruby">    if project &amp;&amp; project.project_type.to_s.eql?( Project::A_TYPE_BOWER )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">      product = Product.fetch_bower name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">      return product if product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2000" data-linenumber="96">
          <span class="hits">2000</span>
          
          <code class="ruby">    if !group_id.to_s.empty? &amp;&amp; !artifact_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="612" data-linenumber="97">
          <span class="hits">612</span>
          
          <code class="ruby">      product = Product.find_by_group_and_artifact self.group_id, self.artifact_id</code>
        </li>
      
        <li class="covered" data-hits="612" data-linenumber="98">
          <span class="hits">612</span>
          
          <code class="ruby">      return product if product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1962" data-linenumber="101">
          <span class="hits">1962</span>
          
          <code class="ruby">    pk = prod_key </code>
        </li>
      
        <li class="covered" data-hits="1962" data-linenumber="102">
          <span class="hits">1962</span>
          
          <code class="ruby">    pk = name.to_s.downcase if pk.to_s.empty? </code>
        </li>
      
        <li class="covered" data-hits="1962" data-linenumber="103">
          <span class="hits">1962</span>
          
          <code class="ruby">    product = Product.fetch_product( language, pk )</code>
        </li>
      
        <li class="covered" data-hits="1962" data-linenumber="104">
          <span class="hits">1962</span>
          
          <code class="ruby">    if product</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="105">
          <span class="hits">19</span>
          
          <code class="ruby">      self.update_attribute(:prod_key, pk)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="106">
          <span class="hits">19</span>
          
          <code class="ruby">      return product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1943" data-linenumber="109">
          <span class="hits">1943</span>
          
          <code class="ruby">    init_product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">  def possible_prod_key</code>
        </li>
      
        <li class="covered" data-hits="219" data-linenumber="114">
          <span class="hits">219</span>
          
          <code class="ruby">    return self.prod_key if !self.prod_key.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="189" data-linenumber="116">
          <span class="hits">189</span>
          
          <code class="ruby">    possible_prod_key = self.name.to_s.downcase</code>
        </li>
      
        <li class="covered" data-hits="189" data-linenumber="117">
          <span class="hits">189</span>
          
          <code class="ruby">    if self.group_id &amp;&amp; self.artifact_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">      possible_prod_key = &quot;#{self.group_id}/#{self.artifact_id}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="189" data-linenumber="120">
          <span class="hits">189</span>
          
          <code class="ruby">    possible_prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">  def unknown?</code>
        </li>
      
        <li class="covered" data-hits="217" data-linenumber="125">
          <span class="hits">217</span>
          
          <code class="ruby">    prod_key.nil? &amp;&amp; ext_link.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="129">
          <span class="hits">1</span>
          
          <code class="ruby">  def known?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="130">
          <span class="hits">1</span>
          
          <code class="ruby">    !self.unknown?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_binding</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">    binding()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="142">
          <span class="hits">1</span>
          
          <code class="ruby">    def init_product</code>
        </li>
      
        <li class="covered" data-hits="1943" data-linenumber="143">
          <span class="hits">1943</span>
          
          <code class="ruby">      product             = Product.new</code>
        </li>
      
        <li class="covered" data-hits="1943" data-linenumber="144">
          <span class="hits">1943</span>
          
          <code class="ruby">      product.name        = self.name</code>
        </li>
      
        <li class="covered" data-hits="1943" data-linenumber="145">
          <span class="hits">1943</span>
          
          <code class="ruby">      product.language    = self.language if self.language</code>
        </li>
      
        <li class="covered" data-hits="1943" data-linenumber="146">
          <span class="hits">1943</span>
          
          <code class="ruby">      product.group_id    = self.group_id.to_s.downcase</code>
        </li>
      
        <li class="covered" data-hits="1943" data-linenumber="147">
          <span class="hits">1943</span>
          
          <code class="ruby">      product.artifact_id = self.artifact_id.to_s.downcase</code>
        </li>
      
        <li class="covered" data-hits="1943" data-linenumber="148">
          <span class="hits">1943</span>
          
          <code class="ruby">      product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0c77504b43f6a03eeb0ade7e09d20a9b6c656e5c">
  <div class="header">
    <h3>lib/versioneye/models/promo_code.rb</h3>
    <h4><span class="green">94.12 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>16</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class PromoCode &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name                 , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :end_date             , type: DateTime, default: (DateTime.now + 30.days)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :free_private_projects, type: Integer, default: 2</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :redeemed             , type: Integer, default: 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_uniqueness_of :name, :message =&gt; &#39;Name exist already.&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    &quot;#{name} - free private projects: #{free_private_projects}. Ends: #{end_date}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.by_name name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    PromoCode.where(:name =&gt; name).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def is_valid?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    DateTime.now &lt; end_date</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def redeem!</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    self.redeemed = self.redeemed.to_i + 1</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    self.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f399c88f997c0c173b9fd8ccc9c62eadca2a6a19">
  <div class="header">
    <h3>lib/versioneye/models/receipt.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>96</b> relevant lines. 
      <span class="green"><b>96</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Receipt &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/helpers/billing_types&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::BillingTypes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/helpers/countries&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::Countries</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  # Billing Address.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :type   , type: String, :default =&gt; BillingAddress::A_TYPE_INDIVIDUAL</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :street , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :zip    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :city   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :country, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :company, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :taxid  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email  , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  # Rechnungsnummer, fortlaufend! Wichtig fuer das Finanzamt!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :receipt_nr  , type: Integer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  # This fields filled from Stripe invoice object.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  field :total         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  field :currency      , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  field :paid          , type: Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  field :closed        , type: Boolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  field :invoice_id    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  field :invoice_date  , type: Time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  field :period_start  , type: Time</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  field :period_end    , type: Time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  embeds_many :receipt_lines</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :plan</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :type   , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :name   , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :street , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :zip    , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :city   , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :country, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :invoice_date, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :period_start, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :period_end  , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :total       , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :currency    , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :paid        , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :closed      , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :receipt_nr, presence: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">                         length: {minimum: 1, maximum: 250},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">                         uniqueness: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :invoice_id, presence: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">                         length: {minimum: 1, maximum: 250},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">                         uniqueness: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  before_save :pre_process</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def pre_process</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="70">
          <span class="hits">9</span>
          
          <code class="ruby">    return false if company_mandatory? &amp;&amp; company.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="71">
          <span class="hits">8</span>
          
          <code class="ruby">    return false if taxid_mandatory? &amp;&amp; taxid.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="72">
          <span class="hits">7</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from_billing_address ba</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="76">
          <span class="hits">19</span>
          
          <code class="ruby">    self.type    = ba.type</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="77">
          <span class="hits">19</span>
          
          <code class="ruby">    self.name    = ba.name</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="78">
          <span class="hits">19</span>
          
          <code class="ruby">    self.street  = ba.street</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="79">
          <span class="hits">19</span>
          
          <code class="ruby">    self.zip     = ba.zip</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="80">
          <span class="hits">19</span>
          
          <code class="ruby">    self.city    = ba.city</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="81">
          <span class="hits">19</span>
          
          <code class="ruby">    self.country = ba.country</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="82">
          <span class="hits">19</span>
          
          <code class="ruby">    self.company = ba.company</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="83">
          <span class="hits">19</span>
          
          <code class="ruby">    self.taxid   = ba.taxid</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="84">
          <span class="hits">19</span>
          
          <code class="ruby">    self.email   = ba.email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from_invoice invoice</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="88">
          <span class="hits">19</span>
          
          <code class="ruby">    self.invoice_id   = invoice[:id]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="89">
          <span class="hits">19</span>
          
          <code class="ruby">    self.invoice_date = Time.at invoice[:date]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="90">
          <span class="hits">19</span>
          
          <code class="ruby">    self.period_start = Time.at invoice[:period_start]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="91">
          <span class="hits">19</span>
          
          <code class="ruby">    self.period_end   = Time.at invoice[:period_end]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="92">
          <span class="hits">19</span>
          
          <code class="ruby">    self.total        = invoice[:total]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="93">
          <span class="hits">19</span>
          
          <code class="ruby">    self.currency     = invoice[:currency]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="94">
          <span class="hits">19</span>
          
          <code class="ruby">    self.paid         = invoice[:paid]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="95">
          <span class="hits">19</span>
          
          <code class="ruby">    self.closed       = invoice[:closed]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="97">
          <span class="hits">19</span>
          
          <code class="ruby">    invoice.lines.each do |line|</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="98">
          <span class="hits">19</span>
          
          <code class="ruby">      receipt_line = ReceiptLine.new</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="99">
          <span class="hits">19</span>
          
          <code class="ruby">      receipt_line.update_from line</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="100">
          <span class="hits">19</span>
          
          <code class="ruby">      receipt_lines &lt;&lt; receipt_line</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">  def taxid_mandatory?</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="105">
          <span class="hits">17</span>
          
          <code class="ruby">    return true if type.eql?(A_TYPE_CORPORATE) &amp;&amp; A_EU.keys.include?(country)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="106">
          <span class="hits">11</span>
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">  def company_mandatory?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="110">
          <span class="hits">9</span>
          
          <code class="ruby">    return true if type.eql?(A_TYPE_CORPORATE)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="111">
          <span class="hits">6</span>
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">  def tax_free</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="115">
          <span class="hits">11</span>
          
          <code class="ruby">    !A_EU.keys.include?(country)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">  def taxable</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="119">
          <span class="hits">12</span>
          
          <code class="ruby">    return true if country.to_s.eql?(&#39;DE&#39;)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="120">
          <span class="hits">7</span>
          
          <code class="ruby">    if type.eql?(A_TYPE_INDIVIDUAL) &amp;&amp; A_EU.keys.include?(country)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="121">
          <span class="hits">2</span>
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="123">
          <span class="hits">5</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">  def reverse_charge</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="127">
          <span class="hits">12</span>
          
          <code class="ruby">    return false if country.to_s.eql?(&#39;DE&#39;)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="128">
          <span class="hits">7</span>
          
          <code class="ruby">    return false if !A_EU.keys.include?(country)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="129">
          <span class="hits">4</span>
          
          <code class="ruby">    return true if type.eql?(A_TYPE_CORPORATE) &amp;&amp; A_EU.keys.include?(country)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="130">
          <span class="hits">2</span>
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  # Expose private binding() method.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_binding</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="135">
          <span class="hits">8</span>
          
          <code class="ruby">    binding()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">  def filename</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="139">
          <span class="hits">11</span>
          
          <code class="ruby">    date_str = invoice_date.strftime(&quot;%Y-%m-%d&quot;)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="140">
          <span class="hits">11</span>
          
          <code class="ruby">    &quot;#{date_str}-VersionEye-#{receipt_nr}.pdf&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="143">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">    filename</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3c84e131050bbea0205cd36330722ba228fca841">
  <div class="header">
    <h3>lib/versioneye/models/receipt_line.rb</h3>
    <h4><span class="green">97.14 %</span> covered</h4>
    <div>
      <b>35</b> relevant lines. 
      <span class="green"><b>34</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ReceiptLine &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/helpers/billing_types&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::BillingTypes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;versioneye/models/helpers/countries&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  include VersionEye::Countries</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  # Billing Address.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :type   , type: String, default: &#39;invoiceitem&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :amount        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :currency      , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description   , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :period_start  , type: Time</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :period_end    , type: Time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :plan_id       , type: String # Can be empty </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :plan_name     , type: String # Can be empty </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  embedded_in :receipt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :type   , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :amount      , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :currency    , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :description , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :period_start, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :period_end  , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from json_line </code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="38">
          <span class="hits">19</span>
          
          <code class="ruby">    self.type = json_line[:type]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="39">
          <span class="hits">19</span>
          
          <code class="ruby">    self.amount = json_line[:amount]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="40">
          <span class="hits">19</span>
          
          <code class="ruby">    self.currency = json_line[:currency]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="41">
          <span class="hits">19</span>
          
          <code class="ruby">    self.description = json_line[:description]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="42">
          <span class="hits">19</span>
          
          <code class="ruby">    self.period_start = Time.at json_line[:period][:start]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="43">
          <span class="hits">19</span>
          
          <code class="ruby">    self.period_end   = Time.at json_line[:period][:end]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="44">
          <span class="hits">19</span>
          
          <code class="ruby">    if !json_line[:plan].to_s.empty? </code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="45">
          <span class="hits">19</span>
          
          <code class="ruby">      self.plan_id = json_line[:plan][:id]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="46">
          <span class="hits">19</span>
          
          <code class="ruby">      self.plan_name = json_line[:plan][:name]</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="47">
          <span class="hits">19</span>
          
          <code class="ruby">      self.description = self.plan_name if self.description.to_s.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  # Expose private binding() method.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_binding</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    binding()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c877b70ccf8e5d7da67a00e35b0162ddf57c7e5a">
  <div class="header">
    <h3>lib/versioneye/models/refer.rb</h3>
    <h4><span class="yellow">87.5 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Refer &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :count, type: Integer, default: 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_by_name(name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    Refer.where(name: name).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b7726256052254183930921d29ba050d8c8ed302">
  <div class="header">
    <h3>lib/versioneye/models/reference.rb</h3>
    <h4><span class="yellow">89.29 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Reference  &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :group_id    , type: String   # Maven specific</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :artifact_id , type: String   # Maven specific</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :ref_count, type: Integer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_keys, type: Array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1 }, { name: &quot;language_prod_key_index&quot; , background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from prod_keys</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="18">
          <span class="hits">8</span>
          
          <code class="ruby">    self.ref_count = prod_keys.count</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="19">
          <span class="hits">8</span>
          
          <code class="ruby">    self.prod_keys = prod_keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def products page = 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    page = page.to_i - 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    page = 0 if page.to_i &lt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    per_page = 30</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    skip  = page * per_page</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    limit = skip + per_page</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    filter = prod_keys[skip..limit]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if filter.nil? || filter.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    if group_id &amp;&amp; artifact_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">      return Product.where(:group_id.ne =&gt; nil, :artifact_id.ne =&gt; nil, :prod_key.in =&gt; filter).desc(:used_by_count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">      return Product.where(:language =&gt; language, :prod_key.in =&gt; filter).desc(:used_by_count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="43">
          <span class="hits">4</span>
          
          <code class="ruby">    Reference.where(:language =&gt; language, :prod_key =&gt; prod_key).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b69c26f3fc048bc4a666d474c1dade0b241d651c">
  <div class="header">
    <h3>lib/versioneye/models/repository.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Repository &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :src     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :repotype, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  embedded_in :product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def as_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">      :repo_source =&gt; self.src,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">      :repo_type =&gt; self.repotype</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    src</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2bc26067e033f0846af8c482c45fd811b16c4b9f">
  <div class="header">
    <h3>lib/versioneye/models/searchlog.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Searchlog &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :search , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :results, type: Integer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :wait   , type: Float</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f8f18fae8481e687304ab23c9746bf443982a84d">
  <div class="header">
    <h3>lib/versioneye/models/security_vulnerability.rb</h3>
    <h4><span class="green">93.75 %</span> covered</h4>
    <div>
      <b>16</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SecurityVulnerability &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # Belongs to the product with this attributes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key  , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :summary, type: String # the summary of the security vulnerability</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :cve    , type: String # CVE = Common Vulnerabilities and Exposures - https://cve.mitre.org/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :affected_versions_string, type: String </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :affected_versions, type: Array, default: []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :links, type: Hash, default: {}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :approved, type: Boolean, default: true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, summary: 1}, { name: &quot;lang_prod_key_summary_index&quot;, background: true, unique: true, drop_dups: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_language   , -&gt;(lang){where(language: lang)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_prod_key   , -&gt;(prod_key){where(prod_key: prod_key)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def product </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    Product.fetch_product language, prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="48f8f17eca631f72f10e3a36d80e60f5ba710c80">
  <div class="header">
    <h3>lib/versioneye/models/spdx_license.rb</h3>
    <h4><span class="green">95.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SpdxLicense &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :fullname    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :identifier  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :osi_approved, type: Boolean</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ fullname: 1 }  , { name: &quot;fullname_index&quot;  , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ identifier: 1 }, { name: &quot;identifier_index&quot;, background: true, unique: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    &quot;#{identifier} - #{fullname} - #{osi_approved}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.identifier_by_fullname_regex name </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">    SpdxLicense.where(:fullname =&gt; /\A#{name.strip}\z/i ).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  rescue =&gt; e </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    nil </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.identifier_by_regex name </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    SpdxLicense.where(:identifier =&gt; /\A#{name.strip}\z/i ).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  rescue =&gt; e </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    nil </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5451b27ce4621ac91d4e4071115b74fa94e4b978">
  <div class="header">
    <h3>lib/versioneye/models/stash_repo.rb</h3>
    <h4><span class="red">66.67 %</span> covered</h4>
    <div>
      <b>30</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class StashRepo &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stash_id     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :slug         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :fullname     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :scmId        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :state        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :statusMessage, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_key  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :forkable     , type: Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :public_repo  , type: Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :branches     , type: Array</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_files, type: Hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ user_id: 1 },  { name: &quot;user_id_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ fullname: 1 }, { name: &quot;fullname_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_user, -&gt;(user){where(user_id: user._id)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_fullname, -&gt;(name){where(fullname: name)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.build_or_update user, repo_data</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    return nil if repo_data.nil? || repo_data.empty? || user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    repo_data = repo_data.deep_symbolize_keys</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    project_key = repo_data[:project][:key]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    fullname = &quot;#{project_key}/#{repo_data[:name]}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    repo = StashRepo.find_or_create_by(:user_id =&gt; user._id.to_s, :stash_id =&gt; repo_data[:id])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    repo.update_attributes!({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">      slug: repo_data[:slug],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">      name: repo_data[:name],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">      fullname: fullname,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      scmId: repo_data[:scmId],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      state: repo_data[:state],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">      statusMessage: repo_data[:statusMessage],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">      forkable: repo_data[:forkable],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      public_repo: repo_data[:public],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">      project_key: project_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b4ffb808ecc8336414da7a8ca11a2c0ad3768200">
  <div class="header">
    <h3>lib/versioneye/models/submitted_url.rb</h3>
    <h4><span class="green">95.45 %</span> covered</h4>
    <div>
      <b>44</b> relevant lines. 
      <span class="green"><b>42</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SubmittedUrl &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :url             , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :message         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id         , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_email      , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :search_term     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :declined        , type: Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :declined_message, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :integrated      , type: Boolean, default: false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :product_resource</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :url       , presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :message   , presence: true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  validates :user_email, format: {with: /\A([^@\s]+)@((?:[-a-z0-9]+.)+[a-z]{2,})\z/i, :allow_blank =&gt; true}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :as_unchecked     , -&gt;{ where(declined: nil) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :as_checked       , -&gt;{ where(:declined.in =&gt; [false, true]) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :as_accepted      , -&gt;{ where(declined: false) }</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :as_declined      , -&gt;{ where(declined: true) }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">  scope :as_not_integrated, -&gt;{ where(integrated: false) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    &quot;&lt;SubmittedUrl&gt; url: #{url}, declined: #{declined}, integrated: #{integrated}, product_resource: #{product_resource_id.to_s}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_id(id)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="33">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if id.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">    return self.find(id.to_s) if self.where(_id: id.to_s).exists?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def user</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="38">
          <span class="hits">11</span>
          
          <code class="ruby">    User.find_by_id user_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def url_guessed</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">    unless url.match(/https:\/\/github.com\//).nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">      new_url = url.gsub(&#39;https://github.com/&#39;, &#39;https://api.github.com/repos/&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">      unless new_url.match(&quot;\/$&quot;).nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">        return new_url[0..-2]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">      return new_url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  def name_guessed</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="53">
          <span class="hits">2</span>
          
          <code class="ruby">    unless url.match(/https:\/\/github.com\//).nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">      name = url.gsub(&#39;https://github.com/&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">      unless name.match(&quot;\/$&quot;).nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">        return name[0..-2]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">      return name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  def type_guessed</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="64">
          <span class="hits">2</span>
          
          <code class="ruby">    return &quot;GitHub&quot; if !url.match(/github.com/).nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    &quot;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="88c52b660124e90eb1f5f41c914ea169446c677b">
  <div class="header">
    <h3>lib/versioneye/models/traits/license_normalizer.rb</h3>
    <h4><span class="green">98.66 %</span> covered</h4>
    <div>
      <b>598</b> relevant lines. 
      <span class="green"><b>590</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module VersionEye</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  module LicenseNormalizer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    A_CDDL_GPL2_W_CPE = &#39;CDDL+GPLv2 with classpath exception&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    A_CDDL_GPL        = &#39;CDDL+GPL&#39; # with calsspaht exception </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    A_EDL_1_0 = &#39;EDL-1.0&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    def name_substitute</code>
        </li>
      
        <li class="covered" data-hits="583" data-linenumber="12">
          <span class="hits">583</span>
          
          <code class="ruby">      identifier name </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    def identifier name </code>
        </li>
      
        <li class="covered" data-hits="583" data-linenumber="17">
          <span class="hits">583</span>
          
          <code class="ruby">      return &#39;unknown&#39; if name.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      # return name if name.size &gt; 100</code>
        </li>
      
        <li class="covered" data-hits="583" data-linenumber="20">
          <span class="hits">583</span>
          
          <code class="ruby">      spdx_id = spdx_identifier</code>
        </li>
      
        <li class="covered" data-hits="583" data-linenumber="21">
          <span class="hits">583</span>
          
          <code class="ruby">      return spdx_id if spdx_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="23">
          <span class="hits">10</span>
          
          <code class="ruby">      name.gsub(&quot;Licence&quot;, &quot;License&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    rescue =&gt; e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      log.error e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      name </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    # http://spdx.org/licenses/</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    def spdx_identifier </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="607" data-linenumber="34">
          <span class="hits">607</span>
          
          <code class="ruby">      spdx = spdx_2_0_map</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="607" data-linenumber="36">
          <span class="hits">607</span>
          
          <code class="ruby">      spdx_id = has_id_or_fullname?(spdx, name)</code>
        </li>
      
        <li class="covered" data-hits="607" data-linenumber="37">
          <span class="hits">607</span>
          
          <code class="ruby">      return spdx_id if !spdx_id.to_s.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="39">
          <span class="hits">370</span>
          
          <code class="ruby">      tmp_name = do_replacements(name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="41">
          <span class="hits">370</span>
          
          <code class="ruby">      return A_CDDL_GPL2_W_CPE if cddl_gpl2_w_class_exception( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="352" data-linenumber="42">
          <span class="hits">352</span>
          
          <code class="ruby">      return A_CDDL_GPL        if cddl_gpl( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="344" data-linenumber="44">
          <span class="hits">344</span>
          
          <code class="ruby">      return &#39;GPL-2.0-with-classpath-exception&#39; if gpl_20_match_w_cpe( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="332" data-linenumber="46">
          <span class="hits">332</span>
          
          <code class="ruby">      return &#39;AGPL-3.0&#39; if agpl_30_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="326" data-linenumber="47">
          <span class="hits">326</span>
          
          <code class="ruby">      return &#39;AGPL-1.0&#39; if agpl_10_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="320" data-linenumber="49">
          <span class="hits">320</span>
          
          <code class="ruby">      return &#39;LGPL-2.1+&#39; if lgpl_21_or_later_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="319" data-linenumber="50">
          <span class="hits">319</span>
          
          <code class="ruby">      return &#39;LGPL-2.1&#39;  if lgpl_21_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="316" data-linenumber="51">
          <span class="hits">316</span>
          
          <code class="ruby">      return &#39;LGPL-2.0+&#39; if lgpl_2_or_later_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="316" data-linenumber="52">
          <span class="hits">316</span>
          
          <code class="ruby">      return &#39;LGPL-2.0&#39;  if lgpl_20_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="309" data-linenumber="53">
          <span class="hits">309</span>
          
          <code class="ruby">      return &#39;LGPL-3.0+&#39; if lgpl_3_or_later_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="300" data-linenumber="54">
          <span class="hits">300</span>
          
          <code class="ruby">      return &#39;LGPL-3.0&#39;  if lgpl_3_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="293" data-linenumber="56">
          <span class="hits">293</span>
          
          <code class="ruby">      return &#39;GPL-1.0+&#39; if gpl_10_or_later_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="283" data-linenumber="57">
          <span class="hits">283</span>
          
          <code class="ruby">      return &#39;GPL-1.0&#39;  if gpl_10_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="58">
          <span class="hits">279</span>
          
          <code class="ruby">      return &#39;GPL-2.0+&#39; if gpl_20_or_later_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="269" data-linenumber="59">
          <span class="hits">269</span>
          
          <code class="ruby">      return &#39;GPL-2.0&#39;  if gpl_20_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="263" data-linenumber="60">
          <span class="hits">263</span>
          
          <code class="ruby">      return &#39;GPL-3.0+&#39; if gpl_30_or_later_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="254" data-linenumber="61">
          <span class="hits">254</span>
          
          <code class="ruby">      return &#39;GPL-3.0&#39;  if gpl_30_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="248" data-linenumber="62">
          <span class="hits">248</span>
          
          <code class="ruby">      return &#39;GPL&#39;      if gpl_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="152" data-linenumber="64">
          <span class="hits">152</span>
          
          <code class="ruby">      return &#39;CC-BY-SA-1.0&#39; if cc_by_sa_10_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="152" data-linenumber="65">
          <span class="hits">152</span>
          
          <code class="ruby">      return &#39;CC-BY-SA-2.0&#39; if cc_by_sa_20_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="152" data-linenumber="66">
          <span class="hits">152</span>
          
          <code class="ruby">      return &#39;CC-BY-SA-2.5&#39; if cc_by_sa_25_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="150" data-linenumber="67">
          <span class="hits">150</span>
          
          <code class="ruby">      return &#39;CC-BY-SA-3.0&#39; if cc_by_sa_30_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="148" data-linenumber="68">
          <span class="hits">148</span>
          
          <code class="ruby">      return &#39;CC-BY-SA-4.0&#39; if cc_by_sa_40_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="146" data-linenumber="70">
          <span class="hits">146</span>
          
          <code class="ruby">      return &#39;zlib-acknowledgement&#39; if zlib_acknowledgement_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="146" data-linenumber="72">
          <span class="hits">146</span>
          
          <code class="ruby">      return &#39;MIT&#39; if mit_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="74">
          <span class="hits">140</span>
          
          <code class="ruby">      return &#39;Unlicense&#39; if unlicense_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="136" data-linenumber="76">
          <span class="hits">136</span>
          
          <code class="ruby">      return &#39;Ruby&#39; if ruby_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="135" data-linenumber="78">
          <span class="hits">135</span>
          
          <code class="ruby">      return &#39;JSON&#39; if json_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="132" data-linenumber="80">
          <span class="hits">132</span>
          
          <code class="ruby">      return &#39;CPL-1.0&#39; if cpl_10_match( tmp_name ) # Common Public License 1.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="129" data-linenumber="82">
          <span class="hits">129</span>
          
          <code class="ruby">      return &#39;MPL-1.1&#39;  if mpl_11_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="127" data-linenumber="83">
          <span class="hits">127</span>
          
          <code class="ruby">      return &#39;MPL-1.0&#39;  if mpl_10_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="123" data-linenumber="84">
          <span class="hits">123</span>
          
          <code class="ruby">      return &#39;MPL-2.0&#39;  if mpl_20_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="121" data-linenumber="86">
          <span class="hits">121</span>
          
          <code class="ruby">      return &#39;CDDL-1.1&#39; if cddl_11_match(  tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="116" data-linenumber="87">
          <span class="hits">116</span>
          
          <code class="ruby">      return &#39;CDDL-1.0&#39; if cddl_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="89">
          <span class="hits">111</span>
          
          <code class="ruby">      return &#39;Apache-1.1&#39; if apache_license_11_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="106" data-linenumber="90">
          <span class="hits">106</span>
          
          <code class="ruby">      return &#39;Apache-1.0&#39; if apache_license_10_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="102" data-linenumber="91">
          <span class="hits">102</span>
          
          <code class="ruby">      return &#39;Apache-2.0&#39; if apache_license_20_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="93">
          <span class="hits">71</span>
          
          <code class="ruby">      return &#39;EPL-1.0&#39; if eclipse_match( tmp_name ) # Eclipse Public License 1.0</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="94">
          <span class="hits">68</span>
          
          <code class="ruby">      return A_EDL_1_0 if eclipse_distribution_match( tmp_name ) # Eclipse Distribution License 1.0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="96">
          <span class="hits">62</span>
          
          <code class="ruby">      return &#39;ClArtistic&#39;         if clarified_artistic_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="61" data-linenumber="97">
          <span class="hits">61</span>
          
          <code class="ruby">      return &#39;Artistic-1.0&#39;       if artistic_10_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="59" data-linenumber="98">
          <span class="hits">59</span>
          
          <code class="ruby">      return &#39;Artistic-1.0-Perl&#39;  if artistic_10_perl( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="99">
          <span class="hits">57</span>
          
          <code class="ruby">      return &#39;Artistic-1.0-cl8&#39;   if artistic_10_cl8( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="100">
          <span class="hits">55</span>
          
          <code class="ruby">      return &#39;Artistic-2.0&#39;       if artistic_20_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="102">
          <span class="hits">52</span>
          
          <code class="ruby">      return &#39;BSD-4-Clause-UC&#39;    if bsd_4_clause_UC_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="103">
          <span class="hits">51</span>
          
          <code class="ruby">      return &#39;BSD-4-Clause&#39;       if bsd_4_clause_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="105">
          <span class="hits">46</span>
          
          <code class="ruby">      return &#39;BSD-3-Clause-Clear&#39; if bsd_3_clause_clear_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="106">
          <span class="hits">45</span>
          
          <code class="ruby">      return &#39;BSD-3-Clause&#39;       if bsd_3_clause_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="108">
          <span class="hits">38</span>
          
          <code class="ruby">      return &#39;BSD-2-Clause-NetBSD&#39;  if bsd_2_clause_netbsd_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="109">
          <span class="hits">37</span>
          
          <code class="ruby">      return &#39;BSD-2-Clause-FreeBSD&#39; if bsd_2_clause_freebsd_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="110">
          <span class="hits">35</span>
          
          <code class="ruby">      return &#39;BSD-2-Clause&#39;         if bsd_2_clause_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="112">
          <span class="hits">27</span>
          
          <code class="ruby">      return &#39;BSD&#39; if bsd_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="114">
          <span class="hits">18</span>
          
          <code class="ruby">      return &#39;PHP-3.01&#39; if php_301_match( tmp_name )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="115">
          <span class="hits">14</span>
          
          <code class="ruby">      return &#39;PHP-3.0&#39;  if php_30_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="117">
          <span class="hits">10</span>
          
          <code class="ruby">      return &#39;SAP DEVELOPER LICENSE AGREEMENT&#39; if sap_dla_match( tmp_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">      nil </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">    def link</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="124">
          <span class="hits">24</span>
          
          <code class="ruby">      if defined?(url) &amp;&amp; url &amp;&amp; !url.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">        return url if url.match(/\Ahttp:\/\//xi) || url.match(/\Ahttps:\/\//xi)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">        return &quot;http://#{url}&quot; if url.match(/\Awww\./xi)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="128">
          <span class="hits">24</span>
          
          <code class="ruby">      return nil if name.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="130">
          <span class="hits">24</span>
          
          <code class="ruby">      spdx_id = spdx_identifier </code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="131">
          <span class="hits">24</span>
          
          <code class="ruby">      if spdx_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">        #       https://glassfish.java.net/nonav/public/CDDL+GPL.html - same </code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="133">
          <span class="hits">24</span>
          
          <code class="ruby">        return &#39;https://glassfish.java.net/public/CDDL+GPL.html&#39;     if spdx_id.to_s.eql?( A_CDDL_GPL )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">        #       https://glassfish.java.net/nonav/public/CDDL+GPL_1_1.html - same </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">        #       https://glassfish.java.net/public/CDDL+GPL_1_1.html</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="137">
          <span class="hits">24</span>
          
          <code class="ruby">        return &#39;https://glassfish.java.net/public/CDDL+GPL_1_1.html&#39; if spdx_id.to_s.eql?( A_CDDL_GPL2_W_CPE ) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="139">
          <span class="hits">24</span>
          
          <code class="ruby">        return &#39;http://www.eclipse.org/org/documents/edl-v10.php&#39;    if spdx_id.to_s.eql?( A_EDL_1_0 )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="141">
          <span class="hits">24</span>
          
          <code class="ruby">        return &quot;http://spdx.org/licenses/#{spdx_id}.html&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">    def equals_id?( license_identifier )</code>
        </li>
      
        <li class="covered" data-hits="61" data-linenumber="149">
          <span class="hits">61</span>
          
          <code class="ruby">      name_sub = self.name_substitute</code>
        </li>
      
        <li class="covered" data-hits="61" data-linenumber="150">
          <span class="hits">61</span>
          
          <code class="ruby">      return true if name_sub.eql?( license_identifier )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">      if name_sub.eql?(&#39;LGPL-2.0+&#39;) &amp;&amp; (</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-2.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-2.0+&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-2.1&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-2.1+&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-3.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-3.0+&#39;) </code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="159">
          <span class="hits">44</span>
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="160">
          <span class="hits">5</span>
          
          <code class="ruby">        return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">      if name_sub.eql?(&#39;LGPL-2.1+&#39;) &amp;&amp; (</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-2.1&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-2.1+&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-3.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-3.0+&#39;) </code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="168">
          <span class="hits">39</span>
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="169">
          <span class="hits">3</span>
          
          <code class="ruby">        return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">      if name_sub.eql?(&#39;LGPL-3.0+&#39;) &amp;&amp; (</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-3.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;LGPL-3.0+&#39;) </code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="175">
          <span class="hits">36</span>
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="176">
          <span class="hits">1</span>
          
          <code class="ruby">        return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">      if name_sub.eql?(&#39;GPL-1.0+&#39;) &amp;&amp; (</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-1.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-1.0+&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-2.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-2.0+&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-3.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-3.0+&#39;) </code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="186">
          <span class="hits">35</span>
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="187">
          <span class="hits">5</span>
          
          <code class="ruby">        return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">      if name_sub.eql?(&#39;GPL-2.0+&#39;) &amp;&amp; (</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-2.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-2.0+&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-3.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-3.0+&#39;) </code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="195">
          <span class="hits">30</span>
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="196">
          <span class="hits">3</span>
          
          <code class="ruby">        return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">      if name_sub.eql?(&#39;GPL-3.0+&#39;) &amp;&amp; (</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-3.0&#39;) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">        license_identifier.eql?(&#39;GPL-3.0+&#39;) </code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="202">
          <span class="hits">27</span>
          
          <code class="ruby">        )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>
          
          <code class="ruby">        return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="206">
          <span class="hits">26</span>
          
          <code class="ruby">      false </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">    rescue =&gt; e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="208">
          
          
          <code class="ruby">      log.error e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">      false </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="216">
          <span class="hits">1</span>
          
          <code class="ruby">    def sap_dla_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">      name.match(/\ASAP\s+DEVELOPER\s+LICENSE\s+AGREEMENT\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="218">
          <span class="hits">10</span>
          
          <code class="ruby">      name.match(/\ASAP\s+DEV\s+LICENSE\s+AGREEMENT\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>
          
          <code class="ruby">    def php_301_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">      name.match(/\APHP\s+3.01\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="223">
          <span class="hits">18</span>
          
          <code class="ruby">      name.match(/\APHP\s+31\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="226">
          <span class="hits">1</span>
          
          <code class="ruby">    def php_30_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">      name.match(/\APHP\s*3\z/i) || </code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="228">
          <span class="hits">14</span>
          
          <code class="ruby">      name.match(/\APHPv3\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">    # Creative Commons Attribution Share Alike 1.0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="232">
          <span class="hits">1</span>
          
          <code class="ruby">    def cc_by_sa_10_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">      name.match(/\ACC\s+BY\s+SA\s+1\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="152" data-linenumber="234">
          <span class="hits">152</span>
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+Attribution\s+Share\s+Alike\s+1\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+1\s+BY\s+SA\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">      name.match(/\ACC\s+1\s+BY\s+SA\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">    # Creative Commons Attribution Share Alike 2.0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="240">
          <span class="hits">1</span>
          
          <code class="ruby">    def cc_by_sa_20_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">      name.match(/\ACC\s+BY\s+SA\s+2\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="152" data-linenumber="242">
          <span class="hits">152</span>
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+Attribution\s+Share\s+Alike\s+2\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+2\s+BY\s+SA\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">      name.match(/\ACC\s+2\s+BY\s+SA\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">    # Creative Commons Attribution Share Alike 2.5</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="248">
          <span class="hits">1</span>
          
          <code class="ruby">    def cc_by_sa_25_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">      name.match(/\ACC\s+BY\s+SA\s+2\.5\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="152" data-linenumber="250">
          <span class="hits">152</span>
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+Attribution\s+Share\s+Alike\s+2\.5\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+2\.5\s+BY\s+SA\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">      name.match(/\ACC\s+2\.5\s+BY\s+SA\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">    # Creative Commons Attribution Share Alike 3.0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="256">
          <span class="hits">1</span>
          
          <code class="ruby">    def cc_by_sa_30_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">      name.match(/\ACC\s+BY\s+SA\s+3\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="150" data-linenumber="258">
          <span class="hits">150</span>
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+Attribution\s+Share\s+Alike\s+3\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+3\s+BY\s+SA\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby">      name.match(/\ACC\s+3\s+BY\s+SA\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">    # Creative Commons Attribution Share Alike 4.0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="264">
          <span class="hits">1</span>
          
          <code class="ruby">    def cc_by_sa_40_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">      name.match(/\ACC\s+BY\s+SA\s+4\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="148" data-linenumber="266">
          <span class="hits">148</span>
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+Attribution\s+Share\s+Alike\s+4\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">      name.match(/\ACreative\s+Commons\s+4\s+BY\s+SA\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">      name.match(/\ACC\s+4\s+BY\s+SA\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="271">
          <span class="hits">1</span>
          
          <code class="ruby">    def json_match name</code>
        </li>
      
        <li class="covered" data-hits="135" data-linenumber="272">
          <span class="hits">135</span>
          
          <code class="ruby">      name.match(/\AJSON\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="275">
          <span class="hits">1</span>
          
          <code class="ruby">    def mpl_10_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">      name.match(/\AMozilla\s*Public\s*1\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="127" data-linenumber="277">
          <span class="hits">127</span>
          
          <code class="ruby">      name.match(/\AMozilla\s*Public\s*1\s*\(MPL\s*1\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby">      name.match(/\AMPL\s*1\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby">      name.match(/\AMPLv1\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">    def mpl_11_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby">      name.match(/\AMozilla\s+Public\s+1\.1\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="129" data-linenumber="284">
          <span class="hits">129</span>
          
          <code class="ruby">      name.match(/\AMozilla\s+Public\s+1\.1\s+\(MPL\s+1\.1\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">      name.match(/\AMPL\s*1\.1\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">      name.match(/\AMPLv1\.1\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="289">
          <span class="hits">1</span>
          
          <code class="ruby">    def mpl_20_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">      name.match(/\AMozilla\s*Public\s*2\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="123" data-linenumber="291">
          <span class="hits">123</span>
          
          <code class="ruby">      name.match(/\AMozilla\s*Public\s*2\s*\(MPL\s*2\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">      name.match(/\AMPL\s*2\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">      name.match(/\AMPLv2\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="296">
          <span class="hits">1</span>
          
          <code class="ruby">    def ruby_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">      name.match(/\ARuby\s+1\.8\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="136" data-linenumber="298">
          <span class="hits">136</span>
          
          <code class="ruby">      name.match(/\ARuby\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="301">
          <span class="hits">1</span>
          
          <code class="ruby">    def mit_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">      name.match(/\AMIT\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="146" data-linenumber="303">
          <span class="hits">146</span>
          
          <code class="ruby">      name.match(/\AMIT\s*style\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">      name.match(/\AMIT-style\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">      name.match(/\AMIT\s*\/\s*X11\s*\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">      name.match(/\AMIT\s*\(MIT\)\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="309">
          <span class="hits">1</span>
          
          <code class="ruby">    def unlicense_match name </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby">      name.match(/\APublic\s*domain\s*\(Unlicense\)\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="311">
          <span class="hits">140</span>
          
          <code class="ruby">      name.match(/\AUnlicense\s+\(Public\s+Domain\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">      name.match(/\A\(Unlicense\)\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">      name.match(/\AUnlicensed\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">      name.match(/\Aunlicense\.org\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby">      name.match(/\Ahttp\:\/\/spdx\.org\/licenses\/Unlicense\.html\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">      name.match(/\Ahttps\:\/\/spdx\.org\/licenses\/Unlicense\.html\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="318">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="319">
          <span class="hits">1</span>
          
          <code class="ruby">    def eclipse_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby">      name.match(/\AEPL\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="321">
          <span class="hits">71</span>
          
          <code class="ruby">      name.match(/\AEPL\s*1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">      name.match(/\AEPLv1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby">      name.match(/\AEPLv1\.1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">      name.match(/\AEclipse\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Public\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Public\s*1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Public\s*v1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Public\s*v\s*1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Public\s*1\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Public\s*\(EPL\)\s*1\s*\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="333">
          <span class="hits">1</span>
          
          <code class="ruby">    def eclipse_distribution_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">      name.match(/\AEDL\s*1\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="68" data-linenumber="335">
          <span class="hits">68</span>
          
          <code class="ruby">      name.match(/\AEDLv1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby">      name.match(/\AEDLv1\.1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="337">
          
          
          <code class="ruby">      name.match(/\AEclipse\sE*Distribution\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Distribution\s*v\.s*1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Distribution\s*1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Distribution\s*v1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Distribution\s*vs*1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Distribution\s*1\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="343">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Distribution\s*\(New\s*BSD\s*\)\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="344">
          
          
          <code class="ruby">      name.match(/\AEclipse\s*Distribution\s*v\.\s*1\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="345">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="347">
          <span class="hits">1</span>
          
          <code class="ruby">    def bsd_match name</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="348">
          <span class="hits">27</span>
          
          <code class="ruby">      tmp_name = name.gsub(&quot;-&quot;, &quot; &quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="349">
          
          
          <code class="ruby">      tmp_name.match(/\ABSD\z/i) || </code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="350">
          <span class="hits">27</span>
          
          <code class="ruby">      tmp_name.match(/\ABSD\s*style\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby">      tmp_name.match(/\ABerkeley\s+Software\s+Distribution\s+\(BSD\)\s*\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">      tmp_name.match(/\ABerkeley\s+Software\s+Distribution\s*\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby">      tmp_name.match(/\ABSD\s*like\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="355">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="356">
          <span class="hits">1</span>
          
          <code class="ruby">    def bsd_2_clause_match name</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="357">
          <span class="hits">35</span>
          
          <code class="ruby">      tmp_name = name.gsub(&quot;-&quot;, &quot; &quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="359">
          <span class="hits">35</span>
          
          <code class="ruby">      if tmp_name.match(/\ABSD\z/i) &amp;&amp; defined?(url) &amp;&amp; url.to_s.match(/opensource\.org\/licenses\/BSD\-2\-Clause/i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="360">
          <span class="hits">1</span>
          
          <code class="ruby">        return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby">      end </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="362">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*2\s*Clause/i) || </code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="364">
          <span class="hits">34</span>
          
          <code class="ruby">      tmp_name.match(/BSD\s*2\s*clause\s*\&quot;Simplified\&quot;/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*2\s*clause\s*Simplified/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">      tmp_name.match(/2\s*clause\s*BSD/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="367">
          
          
          <code class="ruby">      tmp_name.match(/2\s*clause\s*BSDL/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">      tmp_name.match(/Simplified\s*BSD/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="371">
          <span class="hits">1</span>
          
          <code class="ruby">    def bsd_2_clause_freebsd_match name</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="372">
          <span class="hits">37</span>
          
          <code class="ruby">      tmp_name = name.gsub(&quot;-&quot;, &quot; &quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*2\s*Clause\s*FreeBSD/i) || </code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="374">
          <span class="hits">37</span>
          
          <code class="ruby">      tmp_name.match(/BSD\s*2\s*FreeBSD/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby">      tmp_name.match(/FreeBSD/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="377">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="378">
          <span class="hits">1</span>
          
          <code class="ruby">    def bsd_2_clause_netbsd_match name</code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="379">
          <span class="hits">38</span>
          
          <code class="ruby">      tmp_name = name.gsub(&quot;-&quot;, &quot; &quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="380">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*2\s*clause\s*NetBSD/i) || </code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="381">
          <span class="hits">38</span>
          
          <code class="ruby">      tmp_name.match(/BSD\s*2\s*NetBSD/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="382">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="384">
          <span class="hits">1</span>
          
          <code class="ruby">    def bsd_3_clause_match name</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="385">
          <span class="hits">45</span>
          
          <code class="ruby">      tmp_name = name.gsub(&quot;-&quot;, &quot; &quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="386">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*3/i) ||</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="387">
          <span class="hits">45</span>
          
          <code class="ruby">      tmp_name.match(/BSDv3/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="388">
          
          
          <code class="ruby">      tmp_name.match(/BSDv3.0/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="389">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*3\s*Clause\s*new/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*3\s*Clause\s*Revised/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*3\s*Clause/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="392">
          
          
          <code class="ruby">      tmp_name.match(/3\s*clause\s*BSD/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby">      tmp_name.match(/3\s*clause\s*BSDL/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby">      tmp_name.match(/\ARevised\s*BSD\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby">      tmp_name.match(/\ARevised\s*BSDL\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby">      tmp_name.match(/\ANew\s*BSD\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby">      tmp_name.match(/\ABSD\s*Revised\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="398">
          
          
          <code class="ruby">      tmp_name.match(/\ABSD\s*New\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="399">
          
          
          <code class="ruby">      tmp_name.match(/\ABSD\s*3\s*clause\s*\&quot;New\&quot;\s*or\s*\&quot;Revised\&quot;\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="400">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="401">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="402">
          <span class="hits">1</span>
          
          <code class="ruby">    def bsd_3_clause_clear_match name </code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="403">
          <span class="hits">46</span>
          
          <code class="ruby">      new_name = name.gsub(&quot;-&quot;, &quot; &quot;).strip </code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="404">
          <span class="hits">46</span>
          
          <code class="ruby">      return true if new_name.match(/BSD 3 Clause Clear/i)</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="405">
          <span class="hits">46</span>
          
          <code class="ruby">      return true if new_name.match(/Clear BSD/i)</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="406">
          <span class="hits">45</span>
          
          <code class="ruby">      return false </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="408">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="409">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="410">
          <span class="hits">1</span>
          
          <code class="ruby">    def bsd_4_clause_UC_match name</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="411">
          <span class="hits">52</span>
          
          <code class="ruby">      tmp_name = name.gsub(&quot;-&quot;, &quot; &quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*4\s*clause\s+\(University\s+of\s+California\s+Specific\)/i) ||</code>
        </li>
      
        <li class="covered" data-hits="52" data-linenumber="413">
          <span class="hits">52</span>
          
          <code class="ruby">      tmp_name.match(/BSD\s*4\s*clause\s+\(University\s+of\s+California\)/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*4\s+UC/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*4\s+clause\s+UC/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="416">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="417">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="418">
          <span class="hits">1</span>
          
          <code class="ruby">    def bsd_4_clause_match name</code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="419">
          <span class="hits">51</span>
          
          <code class="ruby">      tmp_name = name.gsub(&quot;-&quot;, &quot; &quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="420">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*4\s*clause/i) ||</code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="421">
          <span class="hits">51</span>
          
          <code class="ruby">      tmp_name.match(/BSD\s*4/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="422">
          
          
          <code class="ruby">      tmp_name.match(/4\s*clause\s*BSD/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby">      tmp_name.match(/BSD\s*4-clause\s*\&quot;Original\&quot;\s*or\s*\&quot;Old\&quot;/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="424">
          
          
          <code class="ruby">      tmp_name.match(/original BSD/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby">      tmp_name.match(/old BSD/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="426">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="428">
          <span class="hits">1</span>
          
          <code class="ruby">    def gpl_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby">      name.match(/\AGPL\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="248" data-linenumber="430">
          <span class="hits">248</span>
          
          <code class="ruby">      name.match(/\AGNU\s+General\s+Public\s+Library\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby">      name.match(/\AGNU\s+General\s+Public\s+\(GPL\)\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="432">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="433">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="434">
          <span class="hits">1</span>
          
          <code class="ruby">    def gpl_10_match name</code>
        </li>
      
        <li class="covered" data-hits="283" data-linenumber="435">
          <span class="hits">283</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &quot;&quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby">      new_name.match(/\AGPL1\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="283" data-linenumber="437">
          <span class="hits">283</span>
          
          <code class="ruby">      new_name.match(/\AGPLv1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s+1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="439">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+1\s+\(GPL\s+1\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+\(GPL\s+1\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="442">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+1\s+only\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="443">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+1\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="444">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="445">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="446">
          <span class="hits">1</span>
          
          <code class="ruby">    def gpl_10_or_later_match name</code>
        </li>
      
        <li class="covered" data-hits="293" data-linenumber="447">
          <span class="hits">293</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &quot;&quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="448">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="293" data-linenumber="449">
          <span class="hits">293</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="450">
          
          
          <code class="ruby">      new_name.match(/\AGPL1\+\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="293" data-linenumber="451">
          <span class="hits">293</span>
          
          <code class="ruby">      new_name.match(/\AGPLv1\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="452">
          
          
          <code class="ruby">      new_name.match(/\AGPLv1\+\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="453">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*1\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="454">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*v1\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="455">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*v1\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="456">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*1\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby">      new_name.match(/\APublic\s+1\s+or\s+later\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="458">
          
          
          <code class="ruby">      new_name.match(/\APublic\s+1\s+or\s+greater\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+1\s+or\s+later\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="460">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+1\s+or\s+greater\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="461">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+1\+\s+\(GPL\s+1\+\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="462">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+\(GPL\s+1\+\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="463">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+1\+\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="464">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="465">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="466">
          <span class="hits">1</span>
          
          <code class="ruby">    def gpl_20_match name</code>
        </li>
      
        <li class="covered" data-hits="269" data-linenumber="467">
          <span class="hits">269</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &quot;&quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="468">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*2\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="269" data-linenumber="469">
          <span class="hits">269</span>
          
          <code class="ruby">      new_name.match(/\AGPLv2\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="470">
          
          
          <code class="ruby">      new_name.match(/\AGPLv2\.0\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">      new_name.match(/\AGPLv2\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby">      new_name.match(/\AGPL2\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="473">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*2\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+2\s+\(GPL\s+2\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="475">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+\(GPL\s+2\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="476">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+2\s+only\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="477">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+2\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="478">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="479">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="480">
          <span class="hits">1</span>
          
          <code class="ruby">    def gpl_20_or_later_match name</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="481">
          <span class="hits">279</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &quot;&quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="482">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="483">
          <span class="hits">279</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="484">
          
          
          <code class="ruby">      new_name.match(/\AGPL2\+\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="485">
          <span class="hits">279</span>
          
          <code class="ruby">      new_name.match(/\AGPLv2\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="486">
          
          
          <code class="ruby">      new_name.match(/\AGPLv2\+\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="487">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*2\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="488">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*v2\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="489">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*v2\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*2\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="491">
          
          
          <code class="ruby">      new_name.match(/\APublic\s+2\s+or\s+later\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="492">
          
          
          <code class="ruby">      new_name.match(/\APublic\s+2\s+or\s+greater\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="493">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+2\s+or\s+later\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="494">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+2\s+or\s+greater\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="495">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+2\+\s+\(GPL\s+2\+\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="496">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+\(GPL\s+2\+\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="497">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+2\+\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="498">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="499">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="500">
          <span class="hits">1</span>
          
          <code class="ruby">    def gpl_20_match_w_cpe name</code>
        </li>
      
        <li class="covered" data-hits="344" data-linenumber="501">
          <span class="hits">344</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &quot;&quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="502">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+\(GPL\)\s+2\s+June\s+1991\s+with\s+\&quot;ClassPath\&quot;\s+Exception\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="344" data-linenumber="503">
          <span class="hits">344</span>
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+\(GPL\)\s+2\s+June\s+1991\s+with\s+ClassPath\s+Exception\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="504">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s*Public\s*2\.0\s*w\/Classpath\s*exception\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="505">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s*Public\s*2\s*w\/Classpath\s*exception\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="506">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s*Public\s*2\s*with\s*the\s*Classpath\s*Exception\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="507">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s*Public\s*2\s*with\s*Classpath\s*Exception\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="508">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s*Public\s*2\s*w\/\s*Classpath\s*Exception\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s*Public\s*2\s*w\s*Classpath\s*Exception\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="510">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s*Public\s*2\s*\+\s*Classpath\s*Exception\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="511">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s*Public\s*2\s*\+\s*Cpe\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*2\s*w\/\s*CPE\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="513">
          
          
          <code class="ruby">      new_name.match(/\Agplv2\+ce\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="514">
          
          
          <code class="ruby">      new_name.match(/\AGPLv2\s*w\/\s*CPE\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="515">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="516">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="517">
          <span class="hits">1</span>
          
          <code class="ruby">    def gpl_30_match name </code>
        </li>
      
        <li class="covered" data-hits="254" data-linenumber="518">
          <span class="hits">254</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &quot;&quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="519">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="254" data-linenumber="520">
          <span class="hits">254</span>
          
          <code class="ruby">      if name.match(/General\s+Public/i) &amp;&amp; defined?(url) &amp;&amp; url.to_s.match(/www\.gnu\.org\/licenses\/gpl\.txt/i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="521">
          <span class="hits">1</span>
          
          <code class="ruby">        return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="522">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="523">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="524">
          
          
          <code class="ruby">      new_name.match(/\AGPL3\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="253" data-linenumber="525">
          <span class="hits">253</span>
          
          <code class="ruby">      new_name.match(/\AGPL\s*3\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="526">
          
          
          <code class="ruby">      new_name.match(/\AGPLv3\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="527">
          
          
          <code class="ruby">      new_name.match(/\AGPLv3\.*\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="528">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+3\s+\(GPL\s+3\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="529">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+\(GPL\s+3\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="530">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+3\s+only\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="531">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+3\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="532">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="533">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="534">
          <span class="hits">1</span>
          
          <code class="ruby">    def gpl_30_or_later_match name</code>
        </li>
      
        <li class="covered" data-hits="263" data-linenumber="535">
          <span class="hits">263</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &quot;&quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="536">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="263" data-linenumber="537">
          <span class="hits">263</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="538">
          
          
          <code class="ruby">      new_name.match(/\AGPL3\+\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="263" data-linenumber="539">
          <span class="hits">263</span>
          
          <code class="ruby">      new_name.match(/\AGPLv3\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="540">
          
          
          <code class="ruby">      new_name.match(/\AGPLv3\+\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="541">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*3\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="542">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*v3\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="543">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*v3\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="544">
          
          
          <code class="ruby">      new_name.match(/\AGPL\s*3\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="545">
          
          
          <code class="ruby">      new_name.match(/\APublic\s+3\s+or\s+later\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="546">
          
          
          <code class="ruby">      new_name.match(/\APublic\s+3\s+or\s+greater\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="547">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+3\s+or\s+later\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="548">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+3\s+or\s+greater\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="549">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+3\+\s+\(GPL\s+3\+\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="550">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+\(GPL\s+3\+\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="551">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Public\s+3\+\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="552">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="553">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="554">
          <span class="hits">1</span>
          
          <code class="ruby">    def agpl_10_match name</code>
        </li>
      
        <li class="covered" data-hits="326" data-linenumber="555">
          <span class="hits">326</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &quot;&quot;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="556">
          
          
          <code class="ruby">      new_name.match(/\AAGPL\s*1\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="326" data-linenumber="557">
          <span class="hits">326</span>
          
          <code class="ruby">      new_name.match(/\AAGPLv1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="558">
          
          
          <code class="ruby">      new_name.match(/\AAGPLv1.0\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="559">
          
          
          <code class="ruby">      new_name.match(/\AAFFERO\s+General\s+Public\s*3\s*\(AGPL\s*1\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="560">
          
          
          <code class="ruby">      new_name.match(/\AAFFERO\s+General\s+Public\s*\(AGPL\s*1\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="561">
          
          
          <code class="ruby">      new_name.match(/\AAFFERO\s+General\s+Public\s*1\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="562">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="563">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="564">
          <span class="hits">1</span>
          
          <code class="ruby">    def agpl_30_match name</code>
        </li>
      
        <li class="covered" data-hits="332" data-linenumber="565">
          <span class="hits">332</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &quot;&quot;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="566">
          
          
          <code class="ruby">      new_name.match(/\AAGPL\s*3\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="332" data-linenumber="567">
          <span class="hits">332</span>
          
          <code class="ruby">      new_name.match(/\AAGPLv3\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="568">
          
          
          <code class="ruby">      new_name.match(/\AAGPLv3.0\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="569">
          
          
          <code class="ruby">      new_name.match(/\AAFFERO\s+General\s+Public\s*3\s*\(AGPL\s*3\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="570">
          
          
          <code class="ruby">      new_name.match(/\AAFFERO\s+General\s+Public\s*\(AGPL\s*3\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="571">
          
          
          <code class="ruby">      new_name.match(/\AAFFERO\s+General\s+Public\s*3\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="572">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="573">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="574">
          <span class="hits">1</span>
          
          <code class="ruby">    def lgpl_20_match name</code>
        </li>
      
        <li class="covered" data-hits="316" data-linenumber="575">
          <span class="hits">316</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="576">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*2\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="316" data-linenumber="577">
          <span class="hits">316</span>
          
          <code class="ruby">      new_name.match(/\ALGPLv2\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="578">
          
          
          <code class="ruby">      new_name.match(/\ALGPLv2\.0\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="579">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+2\s+only\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="580">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+2\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="581">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s*\(LGPL\)\s*2\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="582">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s*\(LGPL\)\s*2\s+only\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="583">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Lesser\s+Public\s+\(LGPL\)\s+2\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="584">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="585">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="586">
          <span class="hits">1</span>
          
          <code class="ruby">    def lgpl_21_match name</code>
        </li>
      
        <li class="covered" data-hits="319" data-linenumber="587">
          <span class="hits">319</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="588">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*2\.1\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="319" data-linenumber="589">
          <span class="hits">319</span>
          
          <code class="ruby">      new_name.match(/\ALGPLv2\.1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="590">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s*2\.1\s+only\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="591">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s*2\.1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="592">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s*\(LGPL\)\s*2\.1\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="593">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Lesser\s+Public\s+\(LGPL\)\s+2\.1\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="594">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+2\.1\s+February\s+1999\z/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="595">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="596">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="597">
          <span class="hits">1</span>
          
          <code class="ruby">    def lgpl_3_match name</code>
        </li>
      
        <li class="covered" data-hits="300" data-linenumber="598">
          <span class="hits">300</span>
          
          <code class="ruby">      if name.match(/\AGnu\s+Lesser\s+Public\z/i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="599">
          <span class="hits">1</span>
          
          <code class="ruby">        return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="600">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="299" data-linenumber="601">
          <span class="hits">299</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="602">
          
          
          <code class="ruby">      new_name.match(/\ALGPLv3\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="299" data-linenumber="603">
          <span class="hits">299</span>
          
          <code class="ruby">      new_name.match(/\ALGPL\s*3\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="604">
          
          
          <code class="ruby">      new_name.match(/\ALESSER\s+GENERAL\s+PUBLIC\s*3\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="605">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s*3\s*only\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="606">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+\(LGPL\s+3\)\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="607">
          
          
          <code class="ruby">      new_name.match(/\ALibrary\s+or\s+Lesser\s+General\s+Public\s+\(LGPL\)\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="608">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="609">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+\(LGPL\)\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="610">
          
          
          <code class="ruby">      new_name.match(/\AGeneral\s+Lesser\s+Public\s+\(LGPL\)\s+3\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="611">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="612">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="613">
          <span class="hits">1</span>
          
          <code class="ruby">    def lgpl_3_or_later_match name</code>
        </li>
      
        <li class="covered" data-hits="309" data-linenumber="614">
          <span class="hits">309</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="615">
          
          
          <code class="ruby">      new_name.match(/\ALGPLv3\+\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="309" data-linenumber="616">
          <span class="hits">309</span>
          
          <code class="ruby">      new_name.match(/\ALGPLv3\+\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="617">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*3\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="618">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*v3\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="619">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*v3\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="620">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*3\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="621">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+3\s+or\s+later\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="622">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+3\s+or\s+greater\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="623">
          
          
          <code class="ruby">      new_name.match(/\ALibrary\s+General\s+Public\s+3\s+or\s+later\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="624">
          
          
          <code class="ruby">      new_name.match(/\ALibrary\s+General\s+Public\s+3\s+or\s+greater\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="625">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="626">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="627">
          <span class="hits">1</span>
          
          <code class="ruby">    def lgpl_2_or_later_match name</code>
        </li>
      
        <li class="covered" data-hits="316" data-linenumber="628">
          <span class="hits">316</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="629">
          
          
          <code class="ruby">      new_name.match(/\ALGPLv2\+\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="316" data-linenumber="630">
          <span class="hits">316</span>
          
          <code class="ruby">      new_name.match(/\ALGPLv2\+\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="631">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*2\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="632">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*v2\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="633">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*v2\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="634">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*2\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="635">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+2\s+or\s+later\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="636">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+2\s+or\s+greater\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="637">
          
          
          <code class="ruby">      new_name.match(/\ALibrary\s+General\s+Public\s+2\s+or\s+later\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="638">
          
          
          <code class="ruby">      new_name.match(/\ALibrary\s+General\s+Public\s+2\s+or\s+greater\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="639">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="640">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="641">
          <span class="hits">1</span>
          
          <code class="ruby">    def lgpl_21_or_later_match name</code>
        </li>
      
        <li class="covered" data-hits="320" data-linenumber="642">
          <span class="hits">320</span>
          
          <code class="ruby">      new_name = name.gsub(/gnu/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="643">
          
          
          <code class="ruby">      new_name.match(/\ALGPLv2\.1\+\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="320" data-linenumber="644">
          <span class="hits">320</span>
          
          <code class="ruby">      new_name.match(/\ALGPLv2\.1\+\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="645">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*2\.1\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="646">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*v2\.1\+\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="647">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*v2\.1\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="648">
          
          
          <code class="ruby">      new_name.match(/\ALGPL\s*2\.1\s*or\s*later\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="649">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+2\.1\s+or\s+later\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="650">
          
          
          <code class="ruby">      new_name.match(/\ALesser\s+General\s+Public\s+2\.1\s+or\s+greater\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="651">
          
          
          <code class="ruby">      new_name.match(/\ALibrary\s+General\s+Public\s+2\.1\s+or\s+later\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="652">
          
          
          <code class="ruby">      new_name.match(/\ALibrary\s+General\s+Public\s+2\.1\s+or\s+greater\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="653">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="654">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="655">
          <span class="hits">1</span>
          
          <code class="ruby">    def clarified_artistic_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="656">
          
          
          <code class="ruby">      name.match(/\AClarified\s+Artistic\s*\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="657">
          <span class="hits">62</span>
          
          <code class="ruby">      name.match(/\AClArtistic\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="658">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="659">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="660">
          <span class="hits">1</span>
          
          <code class="ruby">    def artistic_10_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="661">
          
          
          <code class="ruby">      name.match(/\AArtistic\s*\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="61" data-linenumber="662">
          <span class="hits">61</span>
          
          <code class="ruby">      name.match(/\AArtistic\s*1\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="663">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="664">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="665">
          <span class="hits">1</span>
          
          <code class="ruby">    def artistic_10_perl name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="666">
          
          
          <code class="ruby">      name.match(/\AArtistic\s*Perl\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="59" data-linenumber="667">
          <span class="hits">59</span>
          
          <code class="ruby">      name.match(/\AArtistic\s*\(Perl\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="668">
          
          
          <code class="ruby">      name.match(/\AArtistic\s*1\s+Perl\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="669">
          
          
          <code class="ruby">      name.match(/\AArtistic\s*1\s+\(Perl\)\z/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="670">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="671">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="672">
          <span class="hits">1</span>
          
          <code class="ruby">    def artistic_10_cl8 name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="673">
          
          
          <code class="ruby">      name.match(/\AArtistic\s+1\s+cl8\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="674">
          <span class="hits">57</span>
          
          <code class="ruby">      name.match(/\AArtistic\s+1\s+w\/clause\s+8\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="675">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="676">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="677">
          <span class="hits">1</span>
          
          <code class="ruby">    def artistic_20_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="678">
          
          
          <code class="ruby">      name.match(/\AArtistic\s*2\z/) ||</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="679">
          <span class="hits">55</span>
          
          <code class="ruby">      name.match(/\APerl\s*Artistic\s*2\z/) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="680">
          
          
          <code class="ruby">      name.match(/\AArtistic\s*2\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="681">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="682">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="683">
          <span class="hits">1</span>
          
          <code class="ruby">    def apache_license_10_match name</code>
        </li>
      
        <li class="covered" data-hits="106" data-linenumber="684">
          <span class="hits">106</span>
          
          <code class="ruby">      new_name = name.gsub(/public/i, &#39;&#39;).gsub(/software/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="685">
          
          
          <code class="ruby">      new_name.match(/ASL\s*1/i) ||</code>
        </li>
      
        <li class="covered" data-hits="106" data-linenumber="686">
          <span class="hits">106</span>
          
          <code class="ruby">      new_name.match(/ASLv1/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="687">
          
          
          <code class="ruby">      new_name.match(/ASF\s*1/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="688">
          
          
          <code class="ruby">      new_name.match(/Apache\s*1/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="689">
          
          
          <code class="ruby">      new_name.match(/Apache\s+ASL\s+1/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="690">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="691">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="692">
          <span class="hits">1</span>
          
          <code class="ruby">    def apache_license_11_match name</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="693">
          <span class="hits">111</span>
          
          <code class="ruby">      new_name = name.gsub(/public/i, &#39;&#39;).gsub(/software/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="694">
          
          
          <code class="ruby">      new_name.match(/ASL\s+1\.1/xi) ||</code>
        </li>
      
        <li class="covered" data-hits="111" data-linenumber="695">
          <span class="hits">111</span>
          
          <code class="ruby">      new_name.match(/ASLv1\.1/xi) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="696">
          
          
          <code class="ruby">      new_name.match(/ASF\s+1\.1/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="697">
          
          
          <code class="ruby">      new_name.match(/ASFv1\.1/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="698">
          
          
          <code class="ruby">      new_name.match(/Apache\s*1\.1/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="699">
          
          
          <code class="ruby">      new_name.match(/Apache\s+ASL\s+1\.1/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="700">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="701">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="702">
          <span class="hits">1</span>
          
          <code class="ruby">    def apache_license_20_match name</code>
        </li>
      
        <li class="covered" data-hits="102" data-linenumber="703">
          <span class="hits">102</span>
          
          <code class="ruby">      new_name = name.gsub(/public/i, &#39;&#39;).gsub(/software/i, &#39;&#39;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="704">
          
          
          <code class="ruby">      new_name.match(/ASL\s+2/xi) ||</code>
        </li>
      
        <li class="covered" data-hits="102" data-linenumber="705">
          <span class="hits">102</span>
          
          <code class="ruby">      new_name.match(/ASLv2/xi) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="706">
          
          
          <code class="ruby">      new_name.match(/ASF\s*2/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="707">
          
          
          <code class="ruby">      new_name.match(/ASFv2/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="708">
          
          
          <code class="ruby">      new_name.match(/Apache20/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="709">
          
          
          <code class="ruby">      new_name.match(/Apache\s*2/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="710">
          
          
          <code class="ruby">      new_name.match(/Apache\s+ASL\s*2/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="711">
          
          
          <code class="ruby">      new_name.match(/Apache/i) </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="712">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="713">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="714">
          <span class="hits">1</span>
          
          <code class="ruby">    def cddl_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="715">
          
          
          <code class="ruby">      name.match(/\ACDDL\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="116" data-linenumber="716">
          <span class="hits">116</span>
          
          <code class="ruby">      name.match(/\ACDDL\s*1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="717">
          
          
          <code class="ruby">      name.match(/\ACommon\s+Development\s+and\s+Distribution\s+1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="718">
          
          
          <code class="ruby">      name.match(/\ACOMMON\s+DEVELOPMENT\s+AND\s+DISTRIBUTION\s+\(CDDL\)\s+1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="719">
          
          
          <code class="ruby">      name.match(/\ACommon\s+Development\s+and\s+Distribution\s+\(CDDL\s*1\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="720">
          
          
          <code class="ruby">      name.match(/\ACommon\s+Development\s+and\s+Distribution\s+\(CDDL\)\s+v1\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="721">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="722">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="723">
          <span class="hits">1</span>
          
          <code class="ruby">    def cddl_11_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="724">
          
          
          <code class="ruby">      name.match(/\ACDDL\s*1\.1\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="121" data-linenumber="725">
          <span class="hits">121</span>
          
          <code class="ruby">      name.match(/\ACommon\s+Development\s+and\s+Distribution\s+1\.1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="726">
          
          
          <code class="ruby">      name.match(/\ACOMMON\s+DEVELOPMENT\s+AND\s+DISTRIBUTION\s+\(CDDL\)\s+1\.1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="727">
          
          
          <code class="ruby">      name.match(/\ACommon\s+Development\s+and\s+Distribution\s+\(CDDL\s+1\.1\)\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="728">
          
          
          <code class="ruby">      name.match(/\ACommon\s+Development\s+and\s+Distribution\s+\(CDDL\)\s+v1\.1\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="729">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="730">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="731">
          
          
          <code class="ruby">    # It is with classpath exception as well. </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="732">
          <span class="hits">1</span>
          
          <code class="ruby">    def cddl_gpl name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="733">
          
          
          <code class="ruby">      if defined?(url) &amp;&amp; (</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="734">
          
          
          <code class="ruby">         url.to_s.match(/glassfish\.java\.net\/nonav\/public\/CDDL\+GPL\.html\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="735">
          
          
          <code class="ruby">         url.to_s.match(/glassfish\.java\.net\/public\/CDDL\+GPL\.html\z/i) </code>
        </li>
      
        <li class="covered" data-hits="352" data-linenumber="736">
          <span class="hits">352</span>
          
          <code class="ruby">         )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="737">
          <span class="hits">2</span>
          
          <code class="ruby">         return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="738">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="739">
          
          
          <code class="ruby">      name.match(/\ACOMMON\s+DEVELOPMENT\s+AND\s+DISTRIBUTION\s+\(CDDL\)\s+plus\s+GPL\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="350" data-linenumber="740">
          <span class="hits">350</span>
          
          <code class="ruby">      name.match(/\ACOMMON\s+DEVELOPMENT\s+AND\s+DISTRIBUTION\s+plus\s+GPL\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="741">
          
          
          <code class="ruby">      name.match(/\ACDDL\s*\+\s*GPL\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="742">
          
          
          <code class="ruby">      name.match(/\ACDDL\s*plus\s*GPL\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="743">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="744">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="745">
          <span class="hits">1</span>
          
          <code class="ruby">    def cddl_gpl2_w_class_exception name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="746">
          
          
          <code class="ruby">      if defined?(url) &amp;&amp; (</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="747">
          
          
          <code class="ruby">         url.to_s.match(/glassfish\.java\.net\/public\/CDDL\+GPL_1_1\.html\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="748">
          
          
          <code class="ruby">         url.to_s.match(/glassfish\.java\.net\/nonav\/public\/CDDL\+GPL_1_1\.html\z/i)</code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="749">
          <span class="hits">370</span>
          
          <code class="ruby">         )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="750">
          <span class="hits">2</span>
          
          <code class="ruby">         return true </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="751">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="752">
          
          
          <code class="ruby">      name.match(/\ACOMMON\s+DEVELOPMENT\s+AND\s+DISTRIBUTION\s+\(CDDL\)\s+plus\s+GPL\s*2\s*with\s*classpath\s*exception\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="368" data-linenumber="753">
          <span class="hits">368</span>
          
          <code class="ruby">      name.match(/\ACOMMON\s+DEVELOPMENT\s+AND\s+DISTRIBUTION\s+plus\s+GPL[v]*\s*2\s*with\s*classpath\s*exception\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="754">
          
          
          <code class="ruby">      name.match(/\ACDDL\s*plus\s*GPL\s*2\s*with\s*classpath\s*exception\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="755">
          
          
          <code class="ruby">      name.match(/\ACDDL\s*\+\s*GPLv2\s*with\s*classpath\s*exception\s*\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="756">
          
          
          <code class="ruby">      name.match(/\ACDDL\s*\+\s*GPL\s*2\s*with\s*classpath\s*exception\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="757">
          
          
          <code class="ruby">      name.match(/\ACDDL\s+or\s+GPLv2\s+with\s+exceptions\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="758">
          
          
          <code class="ruby">      name.match(/\ACDDL\s+or\s+GPL\s*2\s+with\s+exceptions\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="759">
          
          
          <code class="ruby">      name.match(/\ADual\s+consisting\s+of\s+the\s+CDDL\s+1\.1\s+and\s+GPL\s+2\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="760">
          
          
          <code class="ruby">      name.match(/\ACDDL\+GPL_1_1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="761">
          
          
          <code class="ruby">      name.match(/\ACDDL\s*\+\s*GPL\s+1\.1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="762">
          
          
          <code class="ruby">      name.match(/\ACDDL\s+1.1\s+\/\s+GPL\s+2\s+dual\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="763">
          
          
          <code class="ruby">      name.match(/\ACDDL\/GPLv2\+CE\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="764">
          
          
          <code class="ruby">      name.match(/\ACDDL\s*\+\s*GPL2\s*w\/\s*CPE\s*\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="765">
          
          
          <code class="ruby">      name.match(/\ACDDL\s*1\.1\s+and\s+GPL\s+2\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="766">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="767">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="768">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="769">
          <span class="hits">1</span>
          
          <code class="ruby">    def cpl_10_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="770">
          
          
          <code class="ruby">      name.match(/\ACPL1\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="132" data-linenumber="771">
          <span class="hits">132</span>
          
          <code class="ruby">      name.match(/\ACPL\s+1\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="772">
          
          
          <code class="ruby">      name.match(/\ACommon\s+Public\s+v\s+1\z/i) || </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="773">
          
          
          <code class="ruby">      name.match(/\ACommon\s+Public\s+1\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="774">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="775">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="776">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="777">
          <span class="hits">1</span>
          
          <code class="ruby">    def zlib_acknowledgement_match name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="778">
          
          
          <code class="ruby">      name.match(/\Azlib\/libpng\s*License\s*with\s*Acknowledgement\s*\z/i) ||</code>
        </li>
      
        <li class="covered" data-hits="146" data-linenumber="779">
          <span class="hits">146</span>
          
          <code class="ruby">      name.match(/\Azlib\/libpng\s*with\s*Acknowledgement\s*\z/i) ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="780">
          
          
          <code class="ruby">      name.match(/\Azlib-acknowledgement\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="781">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="782">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="783">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="784">
          <span class="hits">1</span>
          
          <code class="ruby">    private </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="785">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="786">
          <span class="hits">1</span>
          
          <code class="ruby">      def has_id_or_fullname?(map, name) </code>
        </li>
      
        <li class="covered" data-hits="607" data-linenumber="787">
          <span class="hits">607</span>
          
          <code class="ruby">        map.keys.each do |key|</code>
        </li>
      
        <li class="covered" data-hits="160807" data-linenumber="788">
          <span class="hits">160807</span>
          
          <code class="ruby">          return key if key.upcase.eql?(name.upcase)</code>
        </li>
      
        <li class="covered" data-hits="160607" data-linenumber="789">
          <span class="hits">160607</span>
          
          <code class="ruby">          return key if map[key][:fullname].upcase.eql?(name.upcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="790">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="791">
          
          
          <code class="ruby">        nil </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="792">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="793">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="794">
          <span class="hits">1</span>
          
          <code class="ruby">      def do_replacements name </code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="795">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = name.gsub(/\AThe /i, &quot;&quot;).gsub(&quot; - &quot;, &quot; &quot;).gsub(&quot;, &quot;, &quot; &quot;).strip</code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="796">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(&quot;-&quot;, &quot; &quot;).strip</code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="797">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/version/i, &quot; &quot;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="798">
          
          
          <code class="ruby">        </code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="799">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/ v1/i, &quot; 1&quot;).strip</code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="800">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/1\.0/i, &quot;1&quot;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="801">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="802">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/ v2/i, &quot; 2&quot;).strip</code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="803">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/2\.0/i, &quot;2&quot;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="804">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="805">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/ v2\.1/i, &quot; 2.1&quot;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="806">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="807">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/ v3/i, &quot; 3&quot;).strip</code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="808">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/3\.0/i, &quot;3&quot;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="809">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="810">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/ v4/i, &quot; 4&quot;).strip</code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="811">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name = tmp_name.gsub(/4\.0/i, &quot;4&quot;).strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="812">
          
          
          <code class="ruby">        </code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="813">
          <span class="hits">370</span>
          
          <code class="ruby">        if tmp_name.match(/unlicense/i) == nil</code>
        </li>
      
        <li class="covered" data-hits="366" data-linenumber="814">
          <span class="hits">366</span>
          
          <code class="ruby">          tmp_name = tmp_name.gsub(/Licenses/i, &quot; &quot;).strip </code>
        </li>
      
        <li class="covered" data-hits="366" data-linenumber="815">
          <span class="hits">366</span>
          
          <code class="ruby">          tmp_name = tmp_name.gsub(/Licences/i, &quot; &quot;).strip </code>
        </li>
      
        <li class="covered" data-hits="366" data-linenumber="816">
          <span class="hits">366</span>
          
          <code class="ruby">          tmp_name = tmp_name.gsub(/Lizenzen/i, &quot; &quot;).strip </code>
        </li>
      
        <li class="covered" data-hits="366" data-linenumber="817">
          <span class="hits">366</span>
          
          <code class="ruby">          tmp_name = tmp_name.gsub(/Licenzen/i, &quot; &quot;).strip </code>
        </li>
      
        <li class="covered" data-hits="366" data-linenumber="818">
          <span class="hits">366</span>
          
          <code class="ruby">          tmp_name = tmp_name.gsub(/License/i, &quot; &quot;).strip </code>
        </li>
      
        <li class="covered" data-hits="366" data-linenumber="819">
          <span class="hits">366</span>
          
          <code class="ruby">          tmp_name = tmp_name.gsub(/Licence/i, &quot; &quot;).strip </code>
        </li>
      
        <li class="covered" data-hits="366" data-linenumber="820">
          <span class="hits">366</span>
          
          <code class="ruby">          tmp_name = tmp_name.gsub(/Lizenz/i, &quot; &quot;).strip </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="821">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="822">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="823">
          <span class="hits">370</span>
          
          <code class="ruby">        tmp_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="824">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="825">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="826">
          <span class="hits">1</span>
          
          <code class="ruby">      def spdx_2_0_map</code>
        </li>
      
        <li class="covered" data-hits="607" data-linenumber="827">
          <span class="hits">607</span>
          
          <code class="ruby">        @@map ||= init_spdx_2_0_map</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="828">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="829">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="830">
          <span class="hits">1</span>
          
          <code class="ruby">      def init_spdx_2_0_map</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="831">
          
          
          <code class="ruby">        # This is autogenerated by the SPDX license crawler. </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="832">
          <span class="hits">1</span>
          
          <code class="ruby">        map = {}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="833">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Glide&#39;] = {:fullname =&gt; &#39;3dfx Glide License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="834">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Abstyles&#39;] = {:fullname =&gt; &#39;Abstyles License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="835">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AFL-1.1&#39;] = {:fullname =&gt; &#39;Academic Free License v1.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="836">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AFL-1.2&#39;] = {:fullname =&gt; &#39;Academic Free License v1.2&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="837">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AFL-2.0&#39;] = {:fullname =&gt; &#39;Academic Free License v2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="838">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AFL-2.1&#39;] = {:fullname =&gt; &#39;Academic Free License v2.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="839">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AFL-3.0&#39;] = {:fullname =&gt; &#39;Academic Free License v3.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="840">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AMPAS&#39;] = {:fullname =&gt; &#39;Academy of Motion Picture Arts and Sciences BSD&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="841">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;APL-1.0&#39;] = {:fullname =&gt; &#39;Adaptive Public License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="842">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Adobe-Glyph&#39;] = {:fullname =&gt; &#39;Adobe Glyph List License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="843">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;APAFML&#39;] = {:fullname =&gt; &#39;Adobe Postscript AFM License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="844">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Adobe-2006&#39;] = {:fullname =&gt; &#39;Adobe Systems Incorporated Source Code License Agreement&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="845">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AGPL-1.0&#39;] = {:fullname =&gt; &#39;Affero General Public License v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="846">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Afmparse&#39;] = {:fullname =&gt; &#39;Afmparse License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="847">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Aladdin&#39;] = {:fullname =&gt; &#39;Aladdin Free Public License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="848">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ADSL&#39;] = {:fullname =&gt; &#39;Amazon Digital Services License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="849">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AMDPLPA&#39;] = {:fullname =&gt; &#39;AMD\&#39;s plpa_map.c License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="850">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ANTLR-PD&#39;] = {:fullname =&gt; &#39;ANTLR Software Rights Notice&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="851">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Apache-1.0&#39;] = {:fullname =&gt; &#39;Apache License 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="852">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Apache-1.1&#39;] = {:fullname =&gt; &#39;Apache License 1.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="853">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Apache-2.0&#39;] = {:fullname =&gt; &#39;Apache License 2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="854">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AML&#39;] = {:fullname =&gt; &#39;Apple MIT License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="855">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;APSL-1.0&#39;] = {:fullname =&gt; &#39;Apple Public Source License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="856">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;APSL-1.1&#39;] = {:fullname =&gt; &#39;Apple Public Source License 1.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="857">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;APSL-1.2&#39;] = {:fullname =&gt; &#39;Apple Public Source License 1.2&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="858">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;APSL-2.0&#39;] = {:fullname =&gt; &#39;Apple Public Source License 2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="859">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Artistic-1.0&#39;] = {:fullname =&gt; &#39;Artistic License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="860">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Artistic-1.0-Perl&#39;] = {:fullname =&gt; &#39;Artistic License 1.0 (Perl)&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="861">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Artistic-1.0-cl8&#39;] = {:fullname =&gt; &#39;Artistic License 1.0 w/clause 8&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="862">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Artistic-2.0&#39;] = {:fullname =&gt; &#39;Artistic License 2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="863">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AAL&#39;] = {:fullname =&gt; &#39;Attribution Assurance License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="864">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Bahyph&#39;] = {:fullname =&gt; &#39;Bahyph License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="865">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Barr&#39;] = {:fullname =&gt; &#39;Barr License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="866">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Beerware&#39;] = {:fullname =&gt; &#39;Beerware License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="867">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BitTorrent-1.0&#39;] = {:fullname =&gt; &#39;BitTorrent Open Source License v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="868">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BitTorrent-1.1&#39;] = {:fullname =&gt; &#39;BitTorrent Open Source License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="869">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSL-1.0&#39;] = {:fullname =&gt; &#39;Boost Software License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="870">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Borceux&#39;] = {:fullname =&gt; &#39;Borceux license&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="871">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-2-Clause&#39;] = {:fullname =&gt; &#39;BSD 2-clause \&quot;Simplified\&quot; License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="872">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-2-Clause-FreeBSD&#39;] = {:fullname =&gt; &#39;BSD 2-clause FreeBSD License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="873">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-2-Clause-NetBSD&#39;] = {:fullname =&gt; &#39;BSD 2-clause NetBSD License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="874">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-3-Clause&#39;] = {:fullname =&gt; &#39;BSD 3-clause \&quot;New\&quot; or \&quot;Revised\&quot; License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="875">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-3-Clause-Clear&#39;] = {:fullname =&gt; &#39;BSD 3-clause Clear License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="876">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-4-Clause&#39;] = {:fullname =&gt; &#39;BSD 4-clause \&quot;Original\&quot; or \&quot;Old\&quot; License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="877">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-Protection&#39;] = {:fullname =&gt; &#39;BSD Protection License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="878">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-3-Clause-Attribution&#39;] = {:fullname =&gt; &#39;BSD with attribution&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="879">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-4-Clause-UC&#39;] = {:fullname =&gt; &#39;BSD-4-Clause (University of California-Specific)&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="880">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;bzip2-1.0.5&#39;] = {:fullname =&gt; &#39;bzip2 and libbzip2 License v1.0.5&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="881">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;bzip2-1.0.6&#39;] = {:fullname =&gt; &#39;bzip2 and libbzip2 License v1.0.6&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="882">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Caldera&#39;] = {:fullname =&gt; &#39;Caldera License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="883">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CECILL-1.0&#39;] = {:fullname =&gt; &#39;CeCILL Free Software License Agreement v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="884">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CECILL-1.1&#39;] = {:fullname =&gt; &#39;CeCILL Free Software License Agreement v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="885">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CECILL-2.0&#39;] = {:fullname =&gt; &#39;CeCILL Free Software License Agreement v2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="886">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CECILL-B&#39;] = {:fullname =&gt; &#39;CeCILL-B Free Software License Agreement&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="887">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CECILL-C&#39;] = {:fullname =&gt; &#39;CeCILL-C Free Software License Agreement&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="888">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ClArtistic&#39;] = {:fullname =&gt; &#39;Clarified Artistic License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="889">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MIT-CMU&#39;] = {:fullname =&gt; &#39;CMU License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="890">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CNRI-Python&#39;] = {:fullname =&gt; &#39;CNRI Python License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="891">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CNRI-Python-GPL-Compatible&#39;] = {:fullname =&gt; &#39;CNRI Python Open Source GPL Compatible License Agreement&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="892">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CPOL-1.02&#39;] = {:fullname =&gt; &#39;Code Project Open License 1.02&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="893">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CDDL-1.0&#39;] = {:fullname =&gt; &#39;Common Development and Distribution License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="894">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CDDL-1.1&#39;] = {:fullname =&gt; &#39;Common Development and Distribution License 1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="895">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CPAL-1.0&#39;] = {:fullname =&gt; &#39;Common Public Attribution License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="896">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CPL-1.0&#39;] = {:fullname =&gt; &#39;Common Public License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="897">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CATOSL-1.1&#39;] = {:fullname =&gt; &#39;Computer Associates Trusted Open Source License 1.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="898">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Condor-1.1&#39;] = {:fullname =&gt; &#39;Condor Public License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="899">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-1.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="900">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-2.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution 2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="901">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-2.5&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution 2.5&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="902">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-3.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution 3.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="903">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-4.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution 4.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="904">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-ND-1.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution No Derivatives 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="905">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-ND-2.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution No Derivatives 2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="906">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-ND-2.5&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution No Derivatives 2.5&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="907">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-ND-3.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution No Derivatives 3.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="908">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-ND-4.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution No Derivatives 4.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="909">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-1.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="910">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-2.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial 2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="911">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-2.5&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial 2.5&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="912">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-3.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial 3.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="913">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-4.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial 4.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="914">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-ND-1.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial No Derivatives 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="915">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-ND-2.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial No Derivatives 2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="916">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-ND-2.5&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial No Derivatives 2.5&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="917">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-ND-3.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial No Derivatives 3.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="918">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-ND-4.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial No Derivatives 4.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="919">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-SA-1.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial Share Alike 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="920">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-SA-2.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial Share Alike 2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="921">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-SA-2.5&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial Share Alike 2.5&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="922">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-SA-3.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial Share Alike 3.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="923">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-NC-SA-4.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Non Commercial Share Alike 4.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="924">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-SA-1.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Share Alike 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="925">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-SA-2.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Share Alike 2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="926">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-SA-2.5&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Share Alike 2.5&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="927">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-SA-3.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Share Alike 3.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="928">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC-BY-SA-4.0&#39;] = {:fullname =&gt; &#39;Creative Commons Attribution Share Alike 4.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="929">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CC0-1.0&#39;] = {:fullname =&gt; &#39;Creative Commons Zero v1.0 Universal&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="930">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Crossword&#39;] = {:fullname =&gt; &#39;Crossword License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="931">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;CUA-OPL-1.0&#39;] = {:fullname =&gt; &#39;CUA Office Public License v1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="932">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Cube&#39;] = {:fullname =&gt; &#39;Cube License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="933">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;D-FSL-1.0&#39;] = {:fullname =&gt; &#39;Deutsche Freie Software Lizenz&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="934">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;diffmark&#39;] = {:fullname =&gt; &#39;diffmark license&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="935">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;WTFPL&#39;] = {:fullname =&gt; &#39;Do What The F*ck You Want To Public License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="936">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;DOC&#39;] = {:fullname =&gt; &#39;DOC License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="937">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Dotseqn&#39;] = {:fullname =&gt; &#39;Dotseqn License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="938">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;DSDP&#39;] = {:fullname =&gt; &#39;DSDP License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="939">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;dvipdfm&#39;] = {:fullname =&gt; &#39;dvipdfm License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="940">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;EPL-1.0&#39;] = {:fullname =&gt; &#39;Eclipse Public License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="941">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ECL-1.0&#39;] = {:fullname =&gt; &#39;Educational Community License v1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="942">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ECL-2.0&#39;] = {:fullname =&gt; &#39;Educational Community License v2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="943">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;eGenix&#39;] = {:fullname =&gt; &#39;eGenix.com Public License 1.1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="944">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;EFL-1.0&#39;] = {:fullname =&gt; &#39;Eiffel Forum License v1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="945">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;EFL-2.0&#39;] = {:fullname =&gt; &#39;Eiffel Forum License v2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="946">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MIT-advertising&#39;] = {:fullname =&gt; &#39;Enlightenment License (e16)&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="947">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MIT-enna&#39;] = {:fullname =&gt; &#39;enna License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="948">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Entessa&#39;] = {:fullname =&gt; &#39;Entessa Public License v1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="949">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ErlPL-1.1&#39;] = {:fullname =&gt; &#39;Erlang Public License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="950">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;EUDatagrid&#39;] = {:fullname =&gt; &#39;EU DataGrid Software License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="951">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;EUPL-1.0&#39;] = {:fullname =&gt; &#39;European Union Public License 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="952">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;EUPL-1.1&#39;] = {:fullname =&gt; &#39;European Union Public License 1.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="953">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Eurosym&#39;] = {:fullname =&gt; &#39;Eurosym License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="954">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Fair&#39;] = {:fullname =&gt; &#39;Fair License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="955">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MIT-feh&#39;] = {:fullname =&gt; &#39;feh License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="956">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Frameworx-1.0&#39;] = {:fullname =&gt; &#39;Frameworx Open License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="957">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;FreeImage&#39;] = {:fullname =&gt; &#39;FreeImage Public License v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="958">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;FTL&#39;] = {:fullname =&gt; &#39;Freetype Project License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="959">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;FSFUL&#39;] = {:fullname =&gt; &#39;FSF Unlimited License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="960">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;FSFULLR&#39;] = {:fullname =&gt; &#39;FSF Unlimited License (with License Retention)&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="961">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Giftware&#39;] = {:fullname =&gt; &#39;Giftware License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="962">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GL2PS&#39;] = {:fullname =&gt; &#39;GL2PS License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="963">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Glulxe&#39;] = {:fullname =&gt; &#39;Glulxe License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="964">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;AGPL-3.0&#39;] = {:fullname =&gt; &#39;GNU Affero General Public License v3.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="965">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GFDL-1.1&#39;] = {:fullname =&gt; &#39;GNU Free Documentation License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="966">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GFDL-1.2&#39;] = {:fullname =&gt; &#39;GNU Free Documentation License v1.2&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="967">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GFDL-1.3&#39;] = {:fullname =&gt; &#39;GNU Free Documentation License v1.3&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="968">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-1.0&#39;] = {:fullname =&gt; &#39;GNU General Public License v1.0 only&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="969">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-2.0&#39;] = {:fullname =&gt; &#39;GNU General Public License v2.0 only&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="970">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-3.0&#39;] = {:fullname =&gt; &#39;GNU General Public License v3.0 only&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="971">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LGPL-2.1&#39;] = {:fullname =&gt; &#39;GNU Lesser General Public License v2.1 only&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="972">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LGPL-3.0&#39;] = {:fullname =&gt; &#39;GNU Lesser General Public License v3.0 only&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="973">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LGPL-2.0&#39;] = {:fullname =&gt; &#39;GNU Library General Public License v2 only&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="974">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;gnuplot&#39;] = {:fullname =&gt; &#39;gnuplot License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="975">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;gSOAP-1.3b&#39;] = {:fullname =&gt; &#39;gSOAP Public License v1.3b&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="976">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;HaskellReport&#39;] = {:fullname =&gt; &#39;Haskell Language Report License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="977">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;HPND&#39;] = {:fullname =&gt; &#39;Historic Permission Notice and Disclaimer&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="978">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;IBM-pibs&#39;] = {:fullname =&gt; &#39;IBM PowerPC Initialization and Boot Software&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="979">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;IPL-1.0&#39;] = {:fullname =&gt; &#39;IBM Public License v1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="980">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ImageMagick&#39;] = {:fullname =&gt; &#39;ImageMagick License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="981">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;iMatix&#39;] = {:fullname =&gt; &#39;iMatix Standard Function Library Agreement&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="982">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Imlib2&#39;] = {:fullname =&gt; &#39;Imlib2 License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="983">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;IJG&#39;] = {:fullname =&gt; &#39;Independent JPEG Group License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="984">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Intel-ACPI&#39;] = {:fullname =&gt; &#39;Intel ACPI Software License Agreement&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="985">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Intel&#39;] = {:fullname =&gt; &#39;Intel Open Source License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="986">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;IPA&#39;] = {:fullname =&gt; &#39;IPA Font License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="987">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ISC&#39;] = {:fullname =&gt; &#39;ISC License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="988">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;JasPer-2.0&#39;] = {:fullname =&gt; &#39;JasPer License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="989">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;JSON&#39;] = {:fullname =&gt; &#39;JSON License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="990">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LPPL-1.3a&#39;] = {:fullname =&gt; &#39;LaTeX Project Public License 1.3a&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="991">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LPPL-1.0&#39;] = {:fullname =&gt; &#39;LaTeX Project Public License v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="992">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LPPL-1.1&#39;] = {:fullname =&gt; &#39;LaTeX Project Public License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="993">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LPPL-1.2&#39;] = {:fullname =&gt; &#39;LaTeX Project Public License v1.2&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="994">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LPPL-1.3c&#39;] = {:fullname =&gt; &#39;LaTeX Project Public License v1.3c&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="995">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Latex2e&#39;] = {:fullname =&gt; &#39;Latex2e License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="996">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;BSD-3-Clause-LBNL&#39;] = {:fullname =&gt; &#39;Lawrence Berkeley National Labs BSD variant license&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="997">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Leptonica&#39;] = {:fullname =&gt; &#39;Leptonica License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="998">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Libpng&#39;] = {:fullname =&gt; &#39;libpng License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="999">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;libtiff&#39;] = {:fullname =&gt; &#39;libtiff License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1000">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LPL-1.02&#39;] = {:fullname =&gt; &#39;Lucent Public License v1.02&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1001">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LPL-1.0&#39;] = {:fullname =&gt; &#39;Lucent Public License Version 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1002">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MakeIndex&#39;] = {:fullname =&gt; &#39;MakeIndex License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1003">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MTLL&#39;] = {:fullname =&gt; &#39;Matrix Template Library License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1004">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MS-PL&#39;] = {:fullname =&gt; &#39;Microsoft Public License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1005">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MS-RL&#39;] = {:fullname =&gt; &#39;Microsoft Reciprocal License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1006">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MirOS&#39;] = {:fullname =&gt; &#39;MirOS Licence&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1007">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MITNFA&#39;] = {:fullname =&gt; &#39;MIT +no-false-attribs license&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1008">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MIT&#39;] = {:fullname =&gt; &#39;MIT License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1009">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Motosoto&#39;] = {:fullname =&gt; &#39;Motosoto License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1010">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MPL-1.0&#39;] = {:fullname =&gt; &#39;Mozilla Public License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1011">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MPL-1.1&#39;] = {:fullname =&gt; &#39;Mozilla Public License 1.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1012">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MPL-2.0&#39;] = {:fullname =&gt; &#39;Mozilla Public License 2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1013">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;MPL-2.0-no-copyleft-exception&#39;] = {:fullname =&gt; &#39;Mozilla Public License 2.0 (no copyleft exception)&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1014">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;mpich2&#39;] = {:fullname =&gt; &#39;mpich2 License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1015">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Multics&#39;] = {:fullname =&gt; &#39;Multics License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1016">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Mup&#39;] = {:fullname =&gt; &#39;Mup License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1017">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NASA-1.3&#39;] = {:fullname =&gt; &#39;NASA Open Source Agreement 1.3&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1018">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Naumen&#39;] = {:fullname =&gt; &#39;Naumen Public License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1019">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NBPL-1.0&#39;] = {:fullname =&gt; &#39;Net Boolean Public License v1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1020">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NetCDF&#39;] = {:fullname =&gt; &#39;NetCDF license&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1021">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NGPL&#39;] = {:fullname =&gt; &#39;Nethack General Public License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1022">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NOSL&#39;] = {:fullname =&gt; &#39;Netizen Open Source License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1023">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NPL-1.0&#39;] = {:fullname =&gt; &#39;Netscape Public License v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1024">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NPL-1.1&#39;] = {:fullname =&gt; &#39;Netscape Public License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1025">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Newsletr&#39;] = {:fullname =&gt; &#39;Newsletr License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1026">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NLPL&#39;] = {:fullname =&gt; &#39;No Limit Public License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1027">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Nokia&#39;] = {:fullname =&gt; &#39;Nokia Open Source License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1028">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NPOSL-3.0&#39;] = {:fullname =&gt; &#39;Non-Profit Open Software License 3.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1029">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Noweb&#39;] = {:fullname =&gt; &#39;Noweb License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1030">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NRL&#39;] = {:fullname =&gt; &#39;NRL License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1031">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NTP&#39;] = {:fullname =&gt; &#39;NTP License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1032">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Nunit&#39;] = {:fullname =&gt; &#39;Nunit License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1033">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OCLC-2.0&#39;] = {:fullname =&gt; &#39;OCLC Research Public License 2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1034">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ODbL-1.0&#39;] = {:fullname =&gt; &#39;ODC Open Database License v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1035">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;PDDL-1.0&#39;] = {:fullname =&gt; &#39;ODC Public Domain Dedication &amp; License 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1036">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OGTSL&#39;] = {:fullname =&gt; &#39;Open Group Test Suite License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1037">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.2.2&#39;] = {:fullname =&gt; &#39;Open LDAP Public License  2.2.2&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1038">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-1.1&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1039">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-1.2&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v1.2&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1040">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-1.3&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v1.3&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1041">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-1.4&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v1.4&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1042">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.0&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.0 (or possibly 2.0A and 2.0B)&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1043">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.0.1&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.0.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1044">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.1&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1045">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.2&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.2&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1046">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.2.1&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.2.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1047">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.3&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.3&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1048">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.4&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.4&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1049">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.5&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.5&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1050">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.6&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.6&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1051">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.7&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.7&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1052">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OLDAP-2.8&#39;] = {:fullname =&gt; &#39;Open LDAP Public License v2.8&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1053">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OML&#39;] = {:fullname =&gt; &#39;Open Market License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1054">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OPL-1.0&#39;] = {:fullname =&gt; &#39;Open Public License v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1055">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OSL-1.0&#39;] = {:fullname =&gt; &#39;Open Software License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1056">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OSL-1.1&#39;] = {:fullname =&gt; &#39;Open Software License 1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1057">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OSL-2.0&#39;] = {:fullname =&gt; &#39;Open Software License 2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1058">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OSL-2.1&#39;] = {:fullname =&gt; &#39;Open Software License 2.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1059">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OSL-3.0&#39;] = {:fullname =&gt; &#39;Open Software License 3.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1060">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OpenSSL&#39;] = {:fullname =&gt; &#39;OpenSSL License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1061">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;PHP-3.0&#39;] = {:fullname =&gt; &#39;PHP License v3.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1062">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;PHP-3.01&#39;] = {:fullname =&gt; &#39;PHP License v3.01&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1063">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Plexus&#39;] = {:fullname =&gt; &#39;Plexus Classworlds License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1064">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;PostgreSQL&#39;] = {:fullname =&gt; &#39;PostgreSQL License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1065">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;psfrag&#39;] = {:fullname =&gt; &#39;psfrag License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1066">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;psutils&#39;] = {:fullname =&gt; &#39;psutils License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1067">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Python-2.0&#39;] = {:fullname =&gt; &#39;Python License 2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1068">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;QPL-1.0&#39;] = {:fullname =&gt; &#39;Q Public License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1069">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Qhull&#39;] = {:fullname =&gt; &#39;Qhull License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1070">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Rdisc&#39;] = {:fullname =&gt; &#39;Rdisc License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1071">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;RPSL-1.0&#39;] = {:fullname =&gt; &#39;RealNetworks Public Source License v1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1072">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;RPL-1.1&#39;] = {:fullname =&gt; &#39;Reciprocal Public License 1.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1073">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;RPL-1.5&#39;] = {:fullname =&gt; &#39;Reciprocal Public License 1.5&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1074">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;RHeCos-1.1&#39;] = {:fullname =&gt; &#39;Red Hat eCos Public License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1075">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;RSCPL&#39;] = {:fullname =&gt; &#39;Ricoh Source Code Public License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1076">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Ruby&#39;] = {:fullname =&gt; &#39;Ruby License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1077">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SAX-PD&#39;] = {:fullname =&gt; &#39;Sax Public Domain Notice&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1078">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Saxpath&#39;] = {:fullname =&gt; &#39;Saxpath License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1079">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SCEA&#39;] = {:fullname =&gt; &#39;SCEA Shared Source License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1080">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SWL&#39;] = {:fullname =&gt; &#39;Scheme Widget Library (SWL) Software License Agreement&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1081">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SGI-B-1.0&#39;] = {:fullname =&gt; &#39;SGI Free Software License B v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1082">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SGI-B-1.1&#39;] = {:fullname =&gt; &#39;SGI Free Software License B v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1083">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SGI-B-2.0&#39;] = {:fullname =&gt; &#39;SGI Free Software License B v2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1084">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OFL-1.0&#39;] = {:fullname =&gt; &#39;SIL Open Font License 1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1085">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;OFL-1.1&#39;] = {:fullname =&gt; &#39;SIL Open Font License 1.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1086">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SimPL-2.0&#39;] = {:fullname =&gt; &#39;Simple Public License 2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1087">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Sleepycat&#39;] = {:fullname =&gt; &#39;Sleepycat License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1088">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SNIA&#39;] = {:fullname =&gt; &#39;SNIA Public License 1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1089">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SMLNJ&#39;] = {:fullname =&gt; &#39;Standard ML of New Jersey License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1090">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SugarCRM-1.1.3&#39;] = {:fullname =&gt; &#39;SugarCRM Public License v1.1.3&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1091">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SISSL&#39;] = {:fullname =&gt; &#39;Sun Industry Standards Source License v1.1&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1092">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SISSL-1.2&#39;] = {:fullname =&gt; &#39;Sun Industry Standards Source License v1.2&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1093">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;SPL-1.0&#39;] = {:fullname =&gt; &#39;Sun Public License v1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1094">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Watcom-1.0&#39;] = {:fullname =&gt; &#39;Sybase Open Watcom Public License 1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1095">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;TCL&#39;] = {:fullname =&gt; &#39;TCL/TK License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1096">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Unlicense&#39;] = {:fullname =&gt; &#39;The Unlicense&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1097">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;TMate&#39;] = {:fullname =&gt; &#39;TMate Open Source License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1098">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;TORQUE-1.1&#39;] = {:fullname =&gt; &#39;TORQUE v2.5+ Software License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1099">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;TOSL&#39;] = {:fullname =&gt; &#39;Trusster Open Source License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1100">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Unicode-TOU&#39;] = {:fullname =&gt; &#39;Unicode Terms of Use&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1101">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;NCSA&#39;] = {:fullname =&gt; &#39;University of Illinois/NCSA Open Source License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1102">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Vim&#39;] = {:fullname =&gt; &#39;Vim License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1103">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;VOSTROM&#39;] = {:fullname =&gt; &#39;VOSTROM Public License for Open Source&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1104">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;VSL-1.0&#39;] = {:fullname =&gt; &#39;Vovida Software License v1.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1105">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;W3C&#39;] = {:fullname =&gt; &#39;W3C Software Notice and License (2002-12-31)&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1106">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;W3C-19980720&#39;] = {:fullname =&gt; &#39;W3C Software Notice and License (1998-07-20)&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1107">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Wsuipa&#39;] = {:fullname =&gt; &#39;Wsuipa License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1108">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Xnet&#39;] = {:fullname =&gt; &#39;X.Net License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1109">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;X11&#39;] = {:fullname =&gt; &#39;X11 License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1110">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Xerox&#39;] = {:fullname =&gt; &#39;Xerox License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1111">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;XFree86-1.1&#39;] = {:fullname =&gt; &#39;XFree86 License 1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1112">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;xinetd&#39;] = {:fullname =&gt; &#39;xinetd License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1113">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;xpp&#39;] = {:fullname =&gt; &#39;XPP License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1114">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;XSkat&#39;] = {:fullname =&gt; &#39;XSkat License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1115">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;YPL-1.0&#39;] = {:fullname =&gt; &#39;Yahoo! Public License v1.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1116">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;YPL-1.1&#39;] = {:fullname =&gt; &#39;Yahoo! Public License v1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1117">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Zed&#39;] = {:fullname =&gt; &#39;Zed License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1118">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Zend-2.0&#39;] = {:fullname =&gt; &#39;Zend License v2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1119">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Zimbra-1.3&#39;] = {:fullname =&gt; &#39;Zimbra Public License v1.3&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1120">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Zimbra-1.4&#39;] = {:fullname =&gt; &#39;Zimbra Public License v1.4&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1121">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;Zlib&#39;] = {:fullname =&gt; &#39;zlib License&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1122">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;zlib-acknowledgement&#39;] = {:fullname =&gt; &#39;zlib/libpng License with Acknowledgement&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1123">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ZPL-1.1&#39;] = {:fullname =&gt; &#39;Zope Public License 1.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1124">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ZPL-2.0&#39;] = {:fullname =&gt; &#39;Zope Public License 2.0&#39;, :osi_approved =&gt; true}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1125">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ZPL-2.1&#39;] = {:fullname =&gt; &#39;Zope Public License 2.1&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1126">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;ICU&#39;] = {:fullname =&gt; &#39;ICU License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1128">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;eCos-2.0&#39;]                         = {:fullname =&gt; &#39;eCos license version 2.0&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1129">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-1.0+&#39;]                         = {:fullname =&gt; &#39;GNU General Public License v1.0 or later&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1130">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-2.0+&#39;]                         = {:fullname =&gt; &#39;GNU General Public License v2.0 or later&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1131">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-2.0-with-autoconf-exception&#39;]  = {:fullname =&gt; &#39;GNU General Public License v2.0 w/Autoconf exception&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1132">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-2.0-with-bison-exception&#39;]     = {:fullname =&gt; &#39;GNU General Public License v2.0 w/Bison exception&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1133">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-2.0-with-classpath-exception&#39;] = {:fullname =&gt; &#39;GNU General Public License v2.0 w/Classpath exception&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1134">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-2.0-with-font-exception&#39;]      = {:fullname =&gt; &#39;GNU General Public License v2.0 w/Font exception&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1135">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-2.0-with-GCC-exception&#39;]       = {:fullname =&gt; &#39;GNU General Public License v2.0 w/GCC Runtime Library exception&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1136">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-3.0+&#39;]                         = {:fullname =&gt; &#39;GNU General Public License v3.0 or later&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1137">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-3.0-with-autoconf-exception&#39;]  = {:fullname =&gt; &#39;GNU General Public License v3.0 w/Autoconf exception&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1138">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;GPL-3.0-with-GCC-exception&#39;]       = {:fullname =&gt; &#39;GNU General Public License v3.0 w/GCC Runtime Library exception&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1139">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LGPL-2.1+&#39;]                        = {:fullname =&gt; &#39;GNU Lesser General Public License v2.1 or later&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1140">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LGPL-3.0+&#39;]                        = {:fullname =&gt; &#39;GNU Lesser General Public License v3.0 or later&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1141">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;LGPL-2.0+&#39;]                        = {:fullname =&gt; &#39;GNU Library General Public License v2 or later&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1142">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;StandardML-NJ&#39;]                    = {:fullname =&gt; &#39;Standard ML of New Jersey License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1143">
          <span class="hits">1</span>
          
          <code class="ruby">        map[&#39;WXwindows&#39;]                        = {:fullname =&gt; &#39;wxWindows Library License&#39;, :osi_approved =&gt; false}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1144">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="1145">
          <span class="hits">1</span>
          
          <code class="ruby">        map</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1146">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1148">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="1150">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="75b41b339787ac7b57b2faed77ecdd933d909bd3">
  <div class="header">
    <h3>lib/versioneye/models/user.rb</h3>
    <h4><span class="red">80.0 %</span> covered</h4>
    <div>
      <b>325</b> relevant lines. 
      <span class="green"><b>260</b> lines covered</span> and
      <span class="red"><b>65</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class User &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  A_EMAIL_REGEX = /[\S]+\@[\S]+\.[\S]+\z/i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :username          , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :fullname          , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prev_fullname     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email             , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email_inactive    , type: Boolean, default: false # Inactive recipients are ones that have generated a hard bounce or a spam complaint</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :encrypted_password, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :salt              , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :admin             , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :deleted_user      , type: Boolean, default: false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :verification      , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :terms             , type: Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :datenerhebung     , type: Boolean</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :privacy_products  , type: String, default: &#39;everybody&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  field :privacy_comments  , type: String, default: &#39;everybody&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :description, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  field :location   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  field :time_zone  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  field :blog       , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  field :promo_code, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  field :refer_name, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  field :free_private_projects, type: Integer, default: 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  field :github_id   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  field :github_login, type: String # Username on github</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  field :github_token, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  field :github_scope, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  field :bitbucket_id,     type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  field :bitbucket_login,  type: String # Username on bitbucket</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  field :bitbucket_token,  type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  field :bitbucket_secret, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  field :bitbucket_scope,  type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stash_slug,   type: String # Username on stash</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stash_token,  type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stash_secret, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stripe_token      , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stripe_customer_id, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stripe_legacy_token      , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stripe_legacy_customer_id, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  field :languages, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  # Contains the language :: prod_key pairs for the packages which user is maintainer for.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  field :maintainer, type: Array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email_send_error, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  # *** RELATIONS START ***</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :plan</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  has_one    :user_permission</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">  has_one    :billing_address</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  has_one    :user_notification_setting</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many   :projects</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many   :github_repos</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many   :bitbucket_repos</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">  has_many   :stash_repos</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  has_and_belongs_to_many :products</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  # *** RELATIONS END ***</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ username: 1 },     { name: &quot;username_index&quot;,     background: true, unique: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ email: 1 },        { name: &quot;email_index&quot;,        background: true, unique: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ github_id: 1 },    { name: &quot;github_id_index&quot;,    background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ bitbucket_id: 1 }, { name: &quot;bitbucket_id_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ verification: 1 }, { name: &quot;verification_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :username          , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :fullname          , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :email             , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :encrypted_password, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :salt              , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :terms             , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :datenerhebung     , :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_uniqueness_of :username          , :message =&gt; &#39;exist already.&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_uniqueness_of :email             , :message =&gt; &#39;exist already.&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_length_of :username, minimum: 2, maximum: 50, :message =&gt; &#39;length is not ok&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_length_of :fullname, minimum: 2, maximum: 50, :message =&gt; &#39;length is not ok&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_format_of :username, with: /\A[a-zA-Z0-9_]+\z/</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_format_of :email   , :with =&gt; A_EMAIL_REGEX, :message =&gt; &#39;is not valid.&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">  before_validation :downcase_email, :check_password, :check_plan</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">  before_save :check_terms, :check_np_domain</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_verification, -&gt;(code){where(verification: code)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  # scope :live_users     , where(verification: nil, deleted_user: false)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :follows_equal  , -&gt;(n){where(:product_ids.count.eq(n))}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :follows_least  , -&gt;(n){where(:product_ids.count &gt;= n)}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :follows_max    , -&gt;(n){where(:product_ids.count &lt;= n)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :password, :new_username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_param</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">    username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="114">
          <span class="hits">194</span>
          
          <code class="ruby">    result = &quot;#{username} / #{fullname} / #{email}&quot;</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="115">
          <span class="hits">194</span>
          
          <code class="ruby">    result += &quot; - verification: #{verification}&quot; if verification</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="116">
          <span class="hits">194</span>
          
          <code class="ruby">    result += &quot; - verified account &quot; if verification.nil?</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="117">
          <span class="hits">194</span>
          
          <code class="ruby">    result += &quot; - deleted &quot; if deleted_user</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="118">
          <span class="hits">194</span>
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_verification</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="122">
          <span class="hits">4</span>
          
          <code class="ruby">    random = create_random_value</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="123">
          <span class="hits">4</span>
          
          <code class="ruby">    self.verification = secure_hash(&quot;#{random}--#{username}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">  def send_verification_email</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">    UserMailer.verification_email(self, self.verification, self.email).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">    User.log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">    User.log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.send_verification_reminders</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">    users = User.where( :verification.ne =&gt; nil )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">    users.each do |user|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">      next if user.email_inactive</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">      user.send_verification_reminder</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="141">
          <span class="hits">1</span>
          
          <code class="ruby">  def send_verification_reminder</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">    if self.verification &amp;&amp; self.deleted_user != true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">      UserMailer.verification_email_reminder(self, self.verification, self.email).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">    User.log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">    User.log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">  def send_suggestions</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">    return nil if deleted_user || email_inactive</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="152">
          
          
          <code class="ruby">    UserMailer.suggest_packages_email(self).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">    User.log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">    User.log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_username</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="160">
          <span class="hits">4</span>
          
          <code class="ruby">    name = fullname.strip</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="161">
          <span class="hits">4</span>
          
          <code class="ruby">    if name.include?(&quot; &quot;)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="162">
          <span class="hits">4</span>
          
          <code class="ruby">      name = name.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="164">
          <span class="hits">4</span>
          
          <code class="ruby">    if name.include?(&quot;-&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="165">
          <span class="hits">1</span>
          
          <code class="ruby">      name = name.gsub!(&quot;-&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="167">
          <span class="hits">4</span>
          
          <code class="ruby">    user = User.find_by_username(name)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="168">
          <span class="hits">4</span>
          
          <code class="ruby">    if user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>
          
          <code class="ruby">      name = name + create_random_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="171">
          <span class="hits">4</span>
          
          <code class="ruby">    self.username = name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.activate!(verification)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="176">
          <span class="hits">5</span>
          
          <code class="ruby">    return false if verification.to_s.strip.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="178">
          <span class="hits">3</span>
          
          <code class="ruby">    user = User.where(verification: verification).shift</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="179">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="181">
          <span class="hits">2</span>
          
          <code class="ruby">    user.verification = nil</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="182">
          <span class="hits">2</span>
          
          <code class="ruby">    user.save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="183">
          <span class="hits">2</span>
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="187">
          <span class="hits">1</span>
          
          <code class="ruby">  def activated?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="188">
          <span class="hits">4</span>
          
          <code class="ruby">    verification.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_username( username )</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="192">
          <span class="hits">23</span>
          
          <code class="ruby">    return nil if username.nil? || username.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="193">
          <span class="hits">23</span>
          
          <code class="ruby">    user = User.where( username: username ).shift</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="194">
          <span class="hits">23</span>
          
          <code class="ruby">    user = User.where( username: /\A#{username}\z/i ).shift if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="195">
          <span class="hits">23</span>
          
          <code class="ruby">    user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="198">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_email(email)</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="199">
          <span class="hits">27</span>
          
          <code class="ruby">    return nil if email.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="200">
          <span class="hits">25</span>
          
          <code class="ruby">    user = User.where(email: email.downcase).shift  if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="201">
          <span class="hits">25</span>
          
          <code class="ruby">    user = User.where(email: /\A#{email}\z/i).shift if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="202">
          <span class="hits">25</span>
          
          <code class="ruby">    user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="205">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_id( id )</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="206">
          <span class="hits">40</span>
          
          <code class="ruby">    return nil if id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="207">
          <span class="hits">39</span>
          
          <code class="ruby">    return User.find(id.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="209">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="210">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="214">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_all( page_count )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="215">
          <span class="hits">1</span>
          
          <code class="ruby">    User.all().desc(:created_at).paginate(page: page_count, per_page: 30)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">  def emails</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="219">
          <span class="hits">3</span>
          
          <code class="ruby">    UserEmail.where(user_id: self._id.to_s)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="222">
          <span class="hits">1</span>
          
          <code class="ruby">  def emails_verified</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="223">
          
          
          <code class="ruby">    UserEmail.where(user_id: self._id.to_s, verification: nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="226">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_email email</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="227">
          <span class="hits">3</span>
          
          <code class="ruby">    UserEmail.where( user_id: self._id.to_s, email: email ).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="230">
          <span class="hits">1</span>
          
          <code class="ruby">  def has_password? submitted_password</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="231">
          <span class="hits">6</span>
          
          <code class="ruby">    self.encrypted_password == encrypt(submitted_password)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="234">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_github_id github_id</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="235">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if github_id.nil? || github_id.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="236">
          <span class="hits">2</span>
          
          <code class="ruby">    User.where(github_id: github_id).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="239">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_bitbucket_id(bitbucket_id)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="240">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if bitbucket_id.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="241">
          <span class="hits">2</span>
          
          <code class="ruby">    User.where(bitbucket_id: bitbucket_id).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="244">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_stash_slug( slug )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">    return nil if slug.to_s.strip.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="246">
          
          
          <code class="ruby">    User.where( stash_slug: slug ).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="249">
          <span class="hits">1</span>
          
          <code class="ruby">  def github_account_connected?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="250">
          <span class="hits">2</span>
          
          <code class="ruby">    !self.github_id.to_s.empty? &amp;&amp; !self.github_token.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="253">
          <span class="hits">1</span>
          
          <code class="ruby">  def bitbucket_account_connected?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="254">
          <span class="hits">2</span>
          
          <code class="ruby">    !self.bitbucket_id.to_s.empty? &amp;&amp; !self.bitbucket_token.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="257">
          <span class="hits">1</span>
          
          <code class="ruby">  def stash_account_connected?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">    !self.stash_slug.to_s.empty? &amp;&amp; !self.stash_token.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="262">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.follows_max(n)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="263">
          <span class="hits">12</span>
          
          <code class="ruby">    User.all.select {|user| user[&#39;product_ids&#39;].nil? or user[&#39;product_ids&#39;].count &lt; n}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="266">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.follows_least(n)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="267">
          <span class="hits">12</span>
          
          <code class="ruby">    User.all.select {|user| !user[&#39;product_ids&#39;].nil? and user[&#39;product_ids&#39;].count &gt;= n}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="270">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.non_followers</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="271">
          <span class="hits">4</span>
          
          <code class="ruby">    User.collection.find({&#39;product_ids.0&#39; =&gt; {&#39;$exists&#39; =&gt; false}})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="274">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.authenticate(email, submitted_password)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="275">
          <span class="hits">5</span>
          
          <code class="ruby">    user = User.find_by_email( email )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="276">
          <span class="hits">5</span>
          
          <code class="ruby">    user = User.find_by_username( email ) if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="277">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil  if user.nil? || user.deleted_user</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="278">
          <span class="hits">4</span>
          
          <code class="ruby">    return user if user.has_password?(submitted_password)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.authenticate_with_salt(id, coockie_salt)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="283">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if !id || !coockie_salt</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="284">
          <span class="hits">2</span>
          
          <code class="ruby">    user = User.find( id )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="285">
          <span class="hits">2</span>
          
          <code class="ruby">    ( user &amp;&amp; user.salt == coockie_salt ) ? user : nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="287">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="288">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="289">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="292">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.authenticate_with_apikey(token)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="293">
          <span class="hits">1</span>
          
          <code class="ruby">    user_api = Api.where(api_key: token).shift</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="294">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if user_api.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="296">
          <span class="hits">1</span>
          
          <code class="ruby">    user = User.find_by_id(user_api.user_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="297">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="299">
          <span class="hits">1</span>
          
          <code class="ruby">    user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="302">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="303">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="306">
          <span class="hits">1</span>
          
          <code class="ruby">  def api</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="307">
          
          
          <code class="ruby">    Api.by_user self</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="310">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.username_valid?(username)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="311">
          <span class="hits">2</span>
          
          <code class="ruby">    user = User.find_by_username(username)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="312">
          <span class="hits">2</span>
          
          <code class="ruby">    return user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="315">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.email_valid?(email)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="316">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if email.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="318">
          <span class="hits">3</span>
          
          <code class="ruby">    user = find_by_email(email)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="319">
          <span class="hits">3</span>
          
          <code class="ruby">    user_email = UserEmail.find_by_email(email)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="320">
          <span class="hits">3</span>
          
          <code class="ruby">    return user.nil? &amp;&amp; user_email.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="323">
          <span class="hits">1</span>
          
          <code class="ruby">  def password_valid?(password)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="324">
          <span class="hits">2</span>
          
          <code class="ruby">    enc_password = encrypt(password)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="325">
          <span class="hits">2</span>
          
          <code class="ruby">    enc_password.eql?(encrypted_password)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="328">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_password( password )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="329">
          <span class="hits">2</span>
          
          <code class="ruby">    self.password = password</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="330">
          <span class="hits">2</span>
          
          <code class="ruby">    encrypt_password</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="331">
          <span class="hits">2</span>
          
          <code class="ruby">    save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="333">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="334">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from_github_json(json_user, token)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="335">
          
          
          <code class="ruby">    json_user.deep_symbolize_keys!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">    self.username = json_user[:login]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">    if self.username.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">      self.username = create_random_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="340">
          
          
          <code class="ruby">    self.cleanup_username</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="341">
          
          
          <code class="ruby">    self.ensure_unique_username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="343">
          
          
          <code class="ruby">    self.fullname = json_user[:name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">    if self.fullname.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">      self.fullname = self.username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="347">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="348">
          
          
          <code class="ruby">    self.github_id    = json_user[:id]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="349">
          
          
          <code class="ruby">    self.github_login = json_user[:login]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="350">
          
          
          <code class="ruby">    self.github_token = token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="351">
          
          
          <code class="ruby">    self.password     = create_random_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="354">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from_bitbucket_json(user_info, token, secret, scopes = &quot;read_write&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="355">
          <span class="hits">1</span>
          
          <code class="ruby">    self[:username] = user_info[:username]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="356">
          <span class="hits">1</span>
          
          <code class="ruby">    if self.username.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="357">
          
          
          <code class="ruby">      self.username = create_random_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="359">
          <span class="hits">1</span>
          
          <code class="ruby">    self.cleanup_username</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="360">
          <span class="hits">1</span>
          
          <code class="ruby">    self.ensure_unique_username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="362">
          <span class="hits">1</span>
          
          <code class="ruby">    self[:fullname] = user_info[:display_name]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="363">
          <span class="hits">1</span>
          
          <code class="ruby">    if self.fullname.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="364">
          
          
          <code class="ruby">      self.fullname = self.username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="365">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="367">
          <span class="hits">1</span>
          
          <code class="ruby">    self.bitbucket_id     = user_info[:username]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="368">
          <span class="hits">1</span>
          
          <code class="ruby">    self.bitbucket_login  = user_info[:username]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="369">
          <span class="hits">1</span>
          
          <code class="ruby">    self.bitbucket_token  = token</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="370">
          <span class="hits">1</span>
          
          <code class="ruby">    self.bitbucket_secret = secret</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="371">
          <span class="hits">1</span>
          
          <code class="ruby">    self.bitbucket_scope  = scopes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="372">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="373">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="374">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_from_stash_json( user_info, token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="375">
          
          
          <code class="ruby">    self.username = user_info[:slug]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="376">
          
          
          <code class="ruby">    if self.username.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="377">
          
          
          <code class="ruby">      self.username = create_random_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="378">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="379">
          
          
          <code class="ruby">    self.cleanup_username</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">    self.ensure_unique_username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="381">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="382">
          
          
          <code class="ruby">    self.fullname = user_info[:name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="383">
          
          
          <code class="ruby">    if self.fullname.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="384">
          
          
          <code class="ruby">      self.fullname = self.username</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="385">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="386">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="387">
          
          
          <code class="ruby">    self.stash_slug = user_info[:slug]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="388">
          
          
          <code class="ruby">    self.email = user_info[:emailAddress]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="389">
          
          
          <code class="ruby">    self.stash_token = token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="390">
          
          
          <code class="ruby">    self.stash_secret = secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="391">
          
          
          <code class="ruby">    self.terms = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="392">
          
          
          <code class="ruby">    self.datenerhebung = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="395">
          <span class="hits">1</span>
          
          <code class="ruby">  def ensure_unique_username</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="396">
          <span class="hits">1</span>
          
          <code class="ruby">    user_db = User.find_by_username( self.username )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="397">
          <span class="hits">1</span>
          
          <code class="ruby">    unless user_db.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="398">
          
          
          <code class="ruby">      random_value = create_random_value</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="399">
          
          
          <code class="ruby">      self.username = &quot;#{self.username}_#{random_value}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="400">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="401">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="403">
          <span class="hits">1</span>
          
          <code class="ruby">  def cleanup_username</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="404">
          <span class="hits">5</span>
          
          <code class="ruby">    self.username = self.username.gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="405">
          <span class="hits">5</span>
          
          <code class="ruby">    self.username = self.username.gsub(&quot;.&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="406">
          <span class="hits">5</span>
          
          <code class="ruby">    self.username = self.username.gsub(&quot;-&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="407">
          <span class="hits">5</span>
          
          <code class="ruby">    self.username = self.username.gsub(&quot;@&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="408">
          <span class="hits">5</span>
          
          <code class="ruby">    self.username.gsub(&quot;_&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="409">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="410">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="411">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_or_create_billing_address</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="412">
          <span class="hits">2</span>
          
          <code class="ruby">    if self.billing_address.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="413">
          <span class="hits">1</span>
          
          <code class="ruby">      self.billing_address = BillingAddress.new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="414">
          <span class="hits">1</span>
          
          <code class="ruby">      self.billing_address.name = self.fullname</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="415">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="416">
          <span class="hits">2</span>
          
          <code class="ruby">    self.billing_address</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="417">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="418">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="419">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_or_create_permissions</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="420">
          <span class="hits">8</span>
          
          <code class="ruby">    if self.user_permission.nil?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="421">
          <span class="hits">6</span>
          
          <code class="ruby">      self.user_permission = UserPermission.new</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="422">
          <span class="hits">6</span>
          
          <code class="ruby">      self.user_permission.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="424">
          <span class="hits">8</span>
          
          <code class="ruby">    self.user_permission</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="425">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="426">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby">  #-- ElasticSearch mapping ------------------</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="428">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_indexed_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="430">
          
          
          <code class="ruby">      :_id =&gt; self.id.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="431">
          
          
          <code class="ruby">      :_type =&gt; &quot;user&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="432">
          
          
          <code class="ruby">      :fullname =&gt; self[:fullname],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="433">
          
          
          <code class="ruby">      :username =&gt; self[:username],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby">      :email =&gt; self[:email]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="435">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="438">
          <span class="hits">1</span>
          
          <code class="ruby">  def encrypt_password</code>
        </li>
      
        <li class="covered" data-hits="781" data-linenumber="439">
          <span class="hits">781</span>
          
          <code class="ruby">    self.salt = make_salt if new_record?</code>
        </li>
      
        <li class="covered" data-hits="781" data-linenumber="440">
          <span class="hits">781</span>
          
          <code class="ruby">    self.encrypted_password = encrypt(password)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="442">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="443">
          <span class="hits">1</span>
          
          <code class="ruby">  def add_maintainer key</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="444">
          <span class="hits">2</span>
          
          <code class="ruby">    self.maintainer = [] if self.maintainer.nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="445">
          <span class="hits">2</span>
          
          <code class="ruby">    if !self.maintainer.include?(key)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="446">
          <span class="hits">2</span>
          
          <code class="ruby">      self.maintainer.push( key )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="447">
          <span class="hits">2</span>
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="448">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="449">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="450">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="451">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="452">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="453">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="454">
          <span class="hits">1</span>
          
          <code class="ruby">    def check_terms</code>
        </li>
      
        <li class="covered" data-hits="855" data-linenumber="455">
          <span class="hits">855</span>
          
          <code class="ruby">      if self.terms == false || self.terms == nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="456">
          <span class="hits">1</span>
          
          <code class="ruby">        self.errors.messages[:terms] = [&quot;must be accepted&quot;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="457">
          <span class="hits">1</span>
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="458">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="459">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="854" data-linenumber="460">
          <span class="hits">854</span>
          
          <code class="ruby">      if self.datenerhebung == false || self.datenerhebung == nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="461">
          
          
          <code class="ruby">        self.errors.messages[:datenerhebung] = [&quot;must be accepted&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="462">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="463">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="464">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="854" data-linenumber="465">
          <span class="hits">854</span>
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="466">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="468">
          <span class="hits">1</span>
          
          <code class="ruby">    def check_plan</code>
        </li>
      
        <li class="covered" data-hits="876" data-linenumber="469">
          <span class="hits">876</span>
          
          <code class="ruby">      return nil if !plan.nil?</code>
        </li>
      
        <li class="covered" data-hits="868" data-linenumber="470">
          <span class="hits">868</span>
          
          <code class="ruby">      self.plan = Plan.free_plan</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="471">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="473">
          <span class="hits">1</span>
          
          <code class="ruby">    def check_password</code>
        </li>
      
        <li class="covered" data-hits="876" data-linenumber="474">
          <span class="hits">876</span>
          
          <code class="ruby">      return nil if new_record? == false</code>
        </li>
      
        <li class="covered" data-hits="776" data-linenumber="475">
          <span class="hits">776</span>
          
          <code class="ruby">      encrypt_password</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="476">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="477">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="478">
          <span class="hits">1</span>
          
          <code class="ruby">    def check_np_domain</code>
        </li>
      
        <li class="covered" data-hits="854" data-linenumber="479">
          <span class="hits">854</span>
          
          <code class="ruby">      return true if self.new_record? == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="480">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="767" data-linenumber="481">
          <span class="hits">767</span>
          
          <code class="ruby">      esplit = email.split(&quot;@&quot;)</code>
        </li>
      
        <li class="covered" data-hits="767" data-linenumber="482">
          <span class="hits">767</span>
          
          <code class="ruby">      domain = &quot;@#{esplit.last}&quot;</code>
        </li>
      
        <li class="covered" data-hits="767" data-linenumber="483">
          <span class="hits">767</span>
          
          <code class="ruby">      npd = NpDomain.where(:domain =&gt; domain).shift</code>
        </li>
      
        <li class="covered" data-hits="767" data-linenumber="484">
          <span class="hits">767</span>
          
          <code class="ruby">      return true if npd.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="486">
          <span class="hits">1</span>
          
          <code class="ruby">      self.free_private_projects = npd.free_projects</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="487">
          <span class="hits">1</span>
          
          <code class="ruby">      UserMailer.non_profit_signup(self, npd).deliver_now</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="488">
          <span class="hits">1</span>
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="489">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="490">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="491">
          <span class="hits">1</span>
          
          <code class="ruby">    def downcase_email</code>
        </li>
      
        <li class="covered" data-hits="876" data-linenumber="492">
          <span class="hits">876</span>
          
          <code class="ruby">      self.email = self.email.downcase if self.email.present?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="493">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="494">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="495">
          <span class="hits">1</span>
          
          <code class="ruby">    def create_random_value</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="496">
          <span class="hits">5</span>
          
          <code class="ruby">      chars = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="497">
          <span class="hits">5</span>
          
          <code class="ruby">      value = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="55" data-linenumber="498">
          <span class="hits">55</span>
          
          <code class="ruby">      10.times { value &lt;&lt; chars[rand(chars.size)] }</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="499">
          <span class="hits">5</span>
          
          <code class="ruby">      value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="500">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="501">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="502">
          <span class="hits">1</span>
          
          <code class="ruby">    def make_salt</code>
        </li>
      
        <li class="covered" data-hits="776" data-linenumber="503">
          <span class="hits">776</span>
          
          <code class="ruby">      secure_hash(&quot;#{Time.now.utc}--#{password}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="504">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="505">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="506">
          <span class="hits">1</span>
          
          <code class="ruby">    def encrypt(string)</code>
        </li>
      
        <li class="covered" data-hits="789" data-linenumber="507">
          <span class="hits">789</span>
          
          <code class="ruby">      secure_hash(&quot;#{salt}--#{string}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="508">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="509">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="510">
          <span class="hits">1</span>
          
          <code class="ruby">    def secure_hash(string)</code>
        </li>
      
        <li class="covered" data-hits="1569" data-linenumber="511">
          <span class="hits">1569</span>
          
          <code class="ruby">      Digest::SHA2.hexdigest(string)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="512">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="513">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="514">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ca793d36e9f1fa01b13db7ded8f091c9a39e9939">
  <div class="header">
    <h3>lib/versioneye/models/user_email.rb</h3>
    <h4><span class="green">94.59 %</span> covered</h4>
    <div>
      <b>37</b> relevant lines. 
      <span class="green"><b>35</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UserEmail &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id     , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :email       , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :verification, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ email: 1 },        { name: &quot;email_index&quot;,        background: true, unique: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ user_id: 1 },      { name: &quot;user_id_index&quot;,      background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ verification: 1 }, { name: &quot;verification_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :email, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_format_of   :email, with: User::A_EMAIL_REGEX</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def user </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">    User.find(self.user_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  rescue =&gt; e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    nil </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def verified?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="26">
          <span class="hits">6</span>
          
          <code class="ruby">    self.verification.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_verification</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="30">
          <span class="hits">3</span>
          
          <code class="ruby">    random = create_random_value</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="31">
          <span class="hits">3</span>
          
          <code class="ruby">    self.verification = secure_hash(&quot;#{random}--#{email}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_email(email)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="35">
          <span class="hits">8</span>
          
          <code class="ruby">    UserEmail.where(email: email).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.activate!(verification)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="39">
          <span class="hits">4</span>
          
          <code class="ruby">    return false if verification.nil? || verification.strip.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    user_email = UserEmail.where(verification: verification).shift</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">    return false if user_email.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    user_email.verification = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    user_email.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    def create_random_value</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="52">
          <span class="hits">3</span>
          
          <code class="ruby">      chars = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="53">
          <span class="hits">3</span>
          
          <code class="ruby">      value = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="54">
          <span class="hits">33</span>
          
          <code class="ruby">      10.times { value &lt;&lt; chars[rand(chars.size)] }</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="55">
          <span class="hits">3</span>
          
          <code class="ruby">      value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">    def secure_hash(string)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="59">
          <span class="hits">3</span>
          
          <code class="ruby">      Digest::SHA2.hexdigest(string)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="467613ccef531012164eaa2a4eee73b1a29d1b7f">
  <div class="header">
    <h3>lib/versioneye/models/user_notification_setting.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UserNotificationSetting &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # Receiving general news from VersionEye. For example about Investments.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :newsletter_news,     type: Boolean, default: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # Receiving the newsletter about new features</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :newsletter_features, type: Boolean, default: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  # Receiving notification emails to packages I follow.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :notification_emails, type: Boolean, default: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  # Receiving notification emails to projects VersionEye is watching for me.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :project_emails, type: Boolean, default: true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_or_create_notification_setting user</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="22">
          <span class="hits">25</span>
          
          <code class="ruby">    if user.user_notification_setting.nil?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="23">
          <span class="hits">20</span>
          
          <code class="ruby">      user.user_notification_setting = UserNotificationSetting.new</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="24">
          <span class="hits">20</span>
          
          <code class="ruby">      user.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="26">
          <span class="hits">25</span>
          
          <code class="ruby">    user.user_notification_setting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f8c9a3acd0a75b4a0e3184cdd3f8d0bf95b91e82">
  <div class="header">
    <h3>lib/versioneye/models/user_permission.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UserPermission &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :lwl, type: Boolean, default: false # allowed to manage license whitelists </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  belongs_to :user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8330f6a9e7856e62decb02126bca9545522efa38">
  <div class="header">
    <h3>lib/versioneye/models/userlinkcollection.rb</h3>
    <h4><span class="red">72.55 %</span> covered</h4>
    <div>
      <b>51</b> relevant lines. 
      <span class="green"><b>37</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Userlinkcollection &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_LINKEDIN      = &#39;http://www.linkedin.com/in/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  A_XING          = &#39;http://www.xing.com/profile/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  A_GITHUB        = &#39;https://github.com/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  A_STACKOVERFLOW = &#39;http://stackoverflow.com/users/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TWITTER       = &#39;https://twitter.com/#!/&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  A_FACEBOOK      = &#39;http://www.facebook.com/people/&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id,       type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :linkedin,      type: String, :default =&gt; A_LINKEDIN</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :xing,          type: String, :default =&gt; A_XING</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  field :github,        type: String, :default =&gt; A_GITHUB</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  field :stackoverflow, type: String, :default =&gt; A_STACKOVERFLOW</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :twitter,       type: String, :default =&gt; A_TWITTER</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :facebook,      type: String, :default =&gt; A_FACEBOOK</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_all_by_user(user_id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    return nil if user_id.nil? || user_id.to_s.strip.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">  	Userlinkcollection.where( user_id: user_id ).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def linkedin_url </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    return linkedin if linkedin.match(/\Ahttp:\/\//) || linkedin.match(/\Ahttps:\/\//)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    &quot;http://#{linkedin}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def xing_url </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    return xing if xing.match(/\Ahttp:\/\//) || xing.match(/\Ahttps:\/\//)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    &quot;http://#{xing}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def github_url </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    return github if github.match(/\Ahttp:\/\//) || github.match(/\Ahttps:\/\//)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    &quot;https://#{github}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def stackoverflow_url </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    return stackoverflow if stackoverflow.match(/\Ahttp:\/\//) || stackoverflow.match(/\Ahttps:\/\//)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    &quot;http://#{stackoverflow}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  def twitter_url </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">    return twitter if twitter.match(/\Ahttp:\/\//) || twitter.match(/\Ahttps:\/\//)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    &quot;https://#{twitter}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def facebook_url </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    return facebook if facebook.match(/\Ahttp:\/\//) || facebook.match(/\Ahttps:\/\//)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    &quot;https://#{facebook}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  def empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">  	linkedin_empty? &amp;&amp; xing_empty? &amp;&amp; github_empty? &amp;&amp;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    stackoverflow_empty? &amp;&amp; twitter_empty? &amp;&amp; facebook_empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  def linkedin_empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">    self.linkedin.nil? || self.linkedin.empty? || self.linkedin.eql?(A_LINKEDIN)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def xing_empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="65">
          <span class="hits">2</span>
          
          <code class="ruby">    self.xing.nil? || self.xing.empty? || self.xing.eql?(A_XING)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  def github_empty?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="68">
          <span class="hits">6</span>
          
          <code class="ruby">    self.github.nil? || self.github.empty? || self.github.eql?(A_GITHUB)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def stackoverflow_empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    self.stackoverflow.nil? || self.stackoverflow.empty? || self.stackoverflow.eql?(A_STACKOVERFLOW)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  def twitter_empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">    self.twitter.nil? || self.twitter.empty? || self.twitter.eql?(A_TWITTER)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def facebook_empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    self.facebook.nil? || self.facebook.empty? || self.facebook.eql?(A_FACEBOOK)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5e32c59ab812242dcba33b7feecc0872e66717d3">
  <div class="header">
    <h3>lib/versioneye/models/version.rb</h3>
    <h4><span class="green">90.91 %</span> covered</h4>
    <div>
      <b>33</b> relevant lines. 
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Version &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :uid            , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version        , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :downloads      , type: Integer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :pom            , type: String # maven specific </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :tag            , type: String # biicode specific - git tag string </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :status         , type: String # biicode specific - [STABLE, DEV]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :released_at    , type: DateTime</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  field :released_string, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :sv_ids         , type: Array, default: []  # SecurityVulnerability IDs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  embedded_in :product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :semver_2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="46360" data-linenumber="21">
          <span class="hits">46360</span>
          
          <code class="ruby">    version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def as_json(parameter=nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      :version    =&gt; self.version,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">      :uid        =&gt; self.get_decimal_uid,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">      :created_at =&gt; self.created_at.strftime(&#39;%Y.%m.%d %I:%M %p&#39;),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      :updated_at =&gt; self.updated_at.strftime(&#39;%Y.%m.%d %I:%M %p&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.encode_version(version)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="34">
          <span class="hits">11</span>
          
          <code class="ruby">    return nil if version.nil?</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="35">
          <span class="hits">11</span>
          
          <code class="ruby">    version.gsub(&#39;/&#39;, &#39;:&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.decode_version(version)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if version.nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">    version.gsub(&#39;:&#39;, &#39;/&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_param</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="44">
          <span class="hits">9</span>
          
          <code class="ruby">    val = Version.encode_version(self.version)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="45">
          <span class="hits">9</span>
          
          <code class="ruby">    &quot;#{val}&quot;.strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def released_or_detected</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">    return released_at if released_at</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">    created_at</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def security_vulnerabilities </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    return nil if sv_ids.to_a.empty? </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    SecurityVulnerability.where(:_id.in =&gt; sv_ids)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5616fd91f22d64bb04ed7dc5ec5fa37c81b3b8eb">
  <div class="header">
    <h3>lib/versioneye/models/versionarchive.rb</h3>
    <h4><span class="green">97.44 %</span> covered</h4>
    <div>
      <b>39</b> relevant lines. 
      <span class="green"><b>38</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Versionarchive &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # A Versionarchive describes a downloadable archive.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # E.g. a link to a jar, zip or tar.gz file.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # Belongs to the product with this attributes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version_id, type: String # TODO rename to :version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :link      , type: String # URL</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name      , type: String # Label for the link/URL</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, version_id: 1, link: 1 }, { name: &quot;lang_prod_vers_link_index&quot;, background: true, unique: true, drop_dups: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, version_id: 1, name: 1 }, { name: &quot;lang_prod_vers_name_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, version_id: 1 }, { name: &quot;lang_prod_vers_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1                }, { name: &quot;lang_prod_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :link, :message =&gt; &#39;link is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def as_json parameter</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      :name =&gt; self.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">      :link =&gt; self.link,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">      :created_at =&gt; self.created_at.strftime(&#39;%Y.%m.%d %I:%M %p&#39;),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      :updated_at =&gt; self.updated_at.strftime(&#39;%Y.%m.%d %I:%M %p&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove_archives language, prod_key, version_number</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    Versionarchive.where( language: language, prod_key: prod_key, version_id: version_number ).delete_all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.archives(lang, prod_key, version)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="38">
          <span class="hits">5</span>
          
          <code class="ruby">    Versionarchive.where(language: lang, prod_key: prod_key, version_id: version).asc(:name).to_a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_archive_if_not_exist archive</code>
        </li>
      
        <li class="covered" data-hits="230" data-linenumber="42">
          <span class="hits">230</span>
          
          <code class="ruby">    return nil if archive.link.nil? || archive.link.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="230" data-linenumber="44">
          <span class="hits">230</span>
          
          <code class="ruby">    archive.link = add_http( archive.link )</code>
        </li>
      
        <li class="covered" data-hits="230" data-linenumber="45">
          <span class="hits">230</span>
          
          <code class="ruby">    return nil if exist_with_link?(archive.language, archive.prod_key, archive.version_id, archive.link)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="229" data-linenumber="47">
          <span class="hits">229</span>
          
          <code class="ruby">    archive.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_if_not_exist_by_name archive</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="51">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if archive.link.nil? || archive.link.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="53">
          <span class="hits">3</span>
          
          <code class="ruby">    archive.link = add_http( archive.link )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="54">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if exist_with_name?(archive.language, archive.prod_key, archive.version_id, archive.name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">    archive.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.exist_with_name?(lang, prod_key, version, name)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="60">
          <span class="hits">3</span>
          
          <code class="ruby">    archive = Versionarchive.where(:language =&gt; lang, :prod_key =&gt; prod_key,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">      :version_id =&gt; version, :name =&gt; name )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="62">
          <span class="hits">3</span>
          
          <code class="ruby">    !archive.nil? &amp;&amp; !archive.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.exist_with_link?(lang, prod_key, version, link)</code>
        </li>
      
        <li class="covered" data-hits="230" data-linenumber="66">
          <span class="hits">230</span>
          
          <code class="ruby">    archive = Versionarchive.where(:language =&gt; lang, :prod_key =&gt; prod_key,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">      :version_id =&gt; version, :link =&gt; link )</code>
        </li>
      
        <li class="covered" data-hits="230" data-linenumber="68">
          <span class="hits">230</span>
          
          <code class="ruby">    !archive.nil? &amp;&amp; !archive.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.add_http( link )</code>
        </li>
      
        <li class="covered" data-hits="235" data-linenumber="72">
          <span class="hits">235</span>
          
          <code class="ruby">    if link.match(/\Ahttp.*/).nil?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="73">
          <span class="hits">7</span>
          
          <code class="ruby">      link = &quot;http://#{link}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="235" data-linenumber="75">
          <span class="hits">235</span>
          
          <code class="ruby">    link</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="13c5870d74a8bf84cd50757161b62ba895ec7fc4">
  <div class="header">
    <h3>lib/versioneye/models/versioncomment.rb</h3>
    <h4><span class="yellow">82.0 %</span> covered</h4>
    <div>
      <b>50</b> relevant lines. 
      <span class="green"><b>41</b> lines covered</span> and
      <span class="red"><b>9</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Versioncomment &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id    , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # Belongs to the product with this attributes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language   , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  field :product_key, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_name  , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  field :comment    , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  field :update_type, type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  embeds_many :versioncommentreplys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, product_key: 1, version: 1 }, { name: &quot;lang_prod_vers_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1                }, { name: &quot;lang_prod_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ user_id:  1, },     { name: &quot;user_id_index&quot;    , background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ product_key:  1, }, { name: &quot;product_key_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :user_id,     :message =&gt; &#39;User is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :product_key, :message =&gt; &#39;Product is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :version,     :message =&gt; &#39;Version is mandatory!&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :comment,     :message =&gt; &#39;Comment is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  scope :by_user, -&gt;(user){ where(user_id: user.id) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_id( id )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    Versioncomment.find( id )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_user_id(user_id)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">    Versioncomment.where(user_id: user_id).desc(:created_at)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_prod_keys_for_user(user_id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    Versioncomment.where(user_id: user_id).distinct(:product_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.count_by_user_id( user_id )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    Versioncomment.where(user_id: user_id).count()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  # TODO double check this</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_prod_keys( prod_keys )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    Versioncomment.where(:product_key.in =&gt; prod_keys).desc(:created_at)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_prod_key_and_version(language, prod_key, version)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">    Versioncomment.where(language: language, product_key: prod_key, version: version).asc(:created_at)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    User.find( self.user_id )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def prod_key_url</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    Product.encode_prod_key( self.product_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">  def version_url</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">    Product.encode_prod_key( self.version )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">  def name_and_version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">    &quot;#{self.prod_name} (#{self.version})&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    product = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">    if self.language</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">      product = Product.fetch_product( self.language, self.product_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">    product.version = self.version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">    product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="884b3f03d589017d41fc7a34eae0ff71a6551c89">
  <div class="header">
    <h3>lib/versioneye/models/versioncommentreply.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>8</b> relevant lines. 
      <span class="green"><b>8</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Versioncommentreply &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  field :user_id , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  field :fullname, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  field :username, type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  field :comment , type: String</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  embedded_in :versioncomment</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="266fb694a7bf8d3a3e1ef67a5c66146249b4e134">
  <div class="header">
    <h3>lib/versioneye/models/versionlink.rb</h3>
    <h4><span class="yellow">88.46 %</span> covered</h4>
    <div>
      <b>52</b> relevant lines. 
      <span class="green"><b>46</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Versionlink &lt; Versioneye::Model</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # A versionlink describes an URL which belongs to an software package.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # Some versionlinks belong to a specific version of a software package.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # For example URLs to Maven artifact directories. E.g.:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # http://gradle.artifactoryonline.com/gradle/libs/org/hibernate/hibernate-core/3.3.0.CR1/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # Other URLs are project specific and belong to all versions of the software package. For</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # example a URL to the project homepage.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  # If version_id is nil this link belongs to all versions of the package.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  # It&#39;s a so called project link.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Document</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  include Mongoid::Timestamps</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  # Belongs to the product with this attributes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  field :language  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  field :prod_key  , type: String</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  field :version_id, type: String # version string. For example 1.0.1. This value can be nil. TODO rename to version.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  field :link      , type: String # URL:   for example https://github.com/500px/500px-iOS-api</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  field :name      , type: String # Label: for example &quot;500px-iOS-api&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  # true  =&gt; This link was manually added by a community member</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  # false =&gt; This link was crawled</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  field :manual    , type: Boolean, :default =&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  validates_presence_of :link, :message =&gt; &#39;is mandatory!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, version_id: 1, link: 1 }, { name: &quot;lang_prod_vers_link_index&quot;, background: true, unique: true, drop_dups: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1, version_id: 1 }, { name: &quot;lang_prod_vers_index&quot;, background: true })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  index({ language: 1, prod_key: 1                }, { name: &quot;lang_prod_index&quot;, background: true })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def to_s</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="37">
          <span class="hits">4</span>
          
          <code class="ruby">    self.link</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def as_json parameter</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">      :name =&gt; self.name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      :link =&gt; self.link</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def product</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="49">
          <span class="hits">3</span>
          
          <code class="ruby">    product = Product.fetch_product( self.language, self.prod_key )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="50">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="52">
          <span class="hits">2</span>
          
          <code class="ruby">    product.version = self.version_id if !self.version_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="53">
          <span class="hits">2</span>
          
          <code class="ruby">    product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_project_link( language, prod_key, url, name )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="58">
          <span class="hits">3</span>
          
          <code class="ruby">    link = Versionlink.where( language: language, prod_key: prod_key, link: url, :version_id =&gt; nil ).shift</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="59">
          <span class="hits">3</span>
          
          <code class="ruby">    return link if link</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="61">
          <span class="hits">2</span>
          
          <code class="ruby">    versionlink = Versionlink.new({:language =&gt; language, :prod_key =&gt; prod_key, :link =&gt; url, :name =&gt; name})</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">    versionlink.save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="63">
          <span class="hits">2</span>
          
          <code class="ruby">    versionlink</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove_project_link( language, prod_key, link, manual = nil )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="72">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if link.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="73">
          <span class="hits">3</span>
          
          <code class="ruby">    if manual</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="74">
          <span class="hits">2</span>
          
          <code class="ruby">      Versionlink.where( language: language, prod_key: prod_key, link: link, :version_id =&gt; nil, :manual =&gt; manual ).delete_all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">      Versionlink.where( language: language, prod_key: prod_key, link: link, :version_id =&gt; nil ).delete_all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_version_link(language, prod_key, version_id, link)</code>
        </li>
      
        <li class="covered" data-hits="1745" data-linenumber="82">
          <span class="hits">1745</span>
          
          <code class="ruby">    Versionlink.where( language: language, prod_key: prod_key, version_id: version_id, link: link )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_versionlink language, prod_key, version_number, link, name</code>
        </li>
      
        <li class="covered" data-hits="1745" data-linenumber="87">
          <span class="hits">1745</span>
          
          <code class="ruby">    return nil if link.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1744" data-linenumber="89">
          <span class="hits">1744</span>
          
          <code class="ruby">    if link.match(/\Ahttp.*/).nil? &amp;&amp; link.match(/\Agit.*/).nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="90">
          <span class="hits">3</span>
          
          <code class="ruby">      link = &quot;http://#{link}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1744" data-linenumber="93">
          <span class="hits">1744</span>
          
          <code class="ruby">    versionlinks = Versionlink.find_version_link(language, prod_key, version_number, link)</code>
        </li>
      
        <li class="covered" data-hits="1744" data-linenumber="94">
          <span class="hits">1744</span>
          
          <code class="ruby">    return nil if versionlinks &amp;&amp; !versionlinks.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1743" data-linenumber="96">
          <span class="hits">1743</span>
          
          <code class="ruby">    versionlink = Versionlink.new({:name =&gt; name, :link =&gt; link,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      :language =&gt; language, :prod_key =&gt; prod_key,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      :version_id =&gt; version_number })</code>
        </li>
      
        <li class="covered" data-hits="1743" data-linenumber="99">
          <span class="hits">1743</span>
          
          <code class="ruby">    versionlink.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_link</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="108">
          <span class="hits">2</span>
          
          <code class="ruby">    return &quot;http://#{self.link}&quot; if self.link.match(/\Awww.*/) != nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    self.link</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5352c762589de20e3f2415e8dac047dbf9b979c5">
  <div class="header">
    <h3>lib/versioneye/package_managers/cocoapods_package_manager.rb</h3>
    <h4><span class="yellow">80.3 %</span> covered</h4>
    <div>
      <b>66</b> relevant lines. 
      <span class="green"><b>53</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;cocoapods-core&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/package_managers/package_manager&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/log&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;open-uri&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">class CocoapodsPackageManager &lt; PackageManager</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # Public: put the best version of product into dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  # version_constraint - A String or Array of Strings, each with comperator and version number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  # project_dependency - the Projectdependency object, this will be updated through the method</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  # product            - the Product requested by the dependency. Can be nil. \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  #                      Has potentially multiple versions and version_constraint determines \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  #                      which one to choose.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  # Returns nothing but updates the dependency</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.parse_requested_version(version_constraint, project_dependency, product = nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="20">
          <span class="hits">6</span>
          
          <code class="ruby">    if version_constraint.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      update_requested_with_current( project_dependency, product )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="25">
          <span class="hits">5</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">      project_dependency.version_requested = version_constraint</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">      project_dependency.version_label     = version_constraint</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="31">
          <span class="hits">4</span>
          
          <code class="ruby">    parsed = parse_version_constraint( version_constraint )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="32">
          <span class="hits">4</span>
          
          <code class="ruby">    chosen = choose_version( parsed[:comperator], parsed[:version_requested], product.versions)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="33">
          <span class="hits">4</span>
          
          <code class="ruby">    project_dependency.version_label     = version_constraint</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="34">
          <span class="hits">4</span>
          
          <code class="ruby">    project_dependency.comperator        = parsed[:comperator]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="35">
          <span class="hits">4</span>
          
          <code class="ruby">    project_dependency.version_requested = chosen</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  # Public: uses a RegExp to parse a version_constraint string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  # version_constraint - a String. starts with a comperator, ends with a version-number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  # Examples</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  #   parse_version_constraint &#39;~&gt; 1.2.3&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  #   # =&gt; {:comperator =&gt; &#39;~&gt;&#39;, :version_requested =&gt; &#39;1.2.3&#39;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  # a Hash with keys :comperator and :version_requested</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  VERSION_REGEXP = /^(=|!=|&gt;=|&gt;|&lt;=|&lt;|~&gt;)\s*(\d(\.\d(\.\d)?)?)/</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.parse_version_constraint version_constraint</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="51">
          <span class="hits">75</span>
          
          <code class="ruby">    version_constraint.match VERSION_REGEXP</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="52">
          <span class="hits">75</span>
          
          <code class="ruby">    comperator, version = $1, $2</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="53">
          <span class="hits">75</span>
          
          <code class="ruby">    return {:comperator =&gt; comperator, :version_requested =&gt; version}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  # Public: choose THE version from an array of version candidates, use comperator and version_number.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  # comperator - a string, should be used to compare version_number to version_candidates</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  # version_number - version number, usually min or maximum bound</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  # version_candidates - an array of possible version candidates</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  # Examples</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  #   choose_version(&#39;&gt;&#39;, &#39;0&#39;, [&#39;1.1&#39;, &#39;1.0&#39;])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  #   # =&gt; &#39;1.1&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  # Returns String of chosen version number.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.choose_version(comperator, version_number, version_candidates)</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="70">
          <span class="hits">30</span>
          
          <code class="ruby">    case comperator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    when &#39;&gt;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">      VersionService.greater_than( version_candidates, version_number ).version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">    when &#39;&gt;=&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="74">
          <span class="hits">8</span>
          
          <code class="ruby">      VersionService.greater_than_or_equal( version_candidates, version_number ).version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    when &#39;&lt;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      VersionService.smaller_than( version_candidates, version_number ).version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    when &#39;&lt;=&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">      VersionService.smaller_than_or_equal( version_candidates, version_number ).version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    when &#39;~&gt;&#39;</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="80">
          <span class="hits">11</span>
          
          <code class="ruby">      starter         = VersionService.version_approximately_greater_than_starter( version_number )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="81">
          <span class="hits">11</span>
          
          <code class="ruby">      possible_vers   = VersionService.versions_start_with( version_candidates, starter )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="82">
          <span class="hits">11</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from( possible_vers )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="83">
          <span class="hits">11</span>
          
          <code class="ruby">      return highest_version.version if highest_version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">      return version_number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="86">
          <span class="hits">11</span>
          
          <code class="ruby">      version_number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    Versioneye::Log.instance.log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    version_number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  # Public: parse a string into [spec, subspec] array.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  # string - the string that will be parsed</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  # Examples</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">  #   spec_subspec &#39;ShareKit/Facebook&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">  #   # =&gt; [&#39;ShareKit&#39;, &#39;Facebook&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  #   spec_subspec &#39;ShareKit&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  #   # =&gt; [&#39;ShareKit&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  # Returns nil if the String is nil or empty, or an array containing [spec,subspec]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.spec_subspec string</code>
        </li>
      
        <li class="covered" data-hits="104" data-linenumber="106">
          <span class="hits">104</span>
          
          <code class="ruby">    return nil if string.nil? || string.empty?</code>
        </li>
      
        <li class="covered" data-hits="102" data-linenumber="107">
          <span class="hits">102</span>
          
          <code class="ruby">    string.split(&#39;/&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">## Monkey Patch CocoaPods, so we are able to parse from URLs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">module Pod</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">  class Podfile</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">    # Configures a new Podfile from the given url.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    # @param  [String] url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    #         The url which will configure the podfile with the DSL.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">    # @return [Podfile] the new Podfile</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.from_url(url)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="126">
          <span class="hits">2</span>
          
          <code class="ruby">      podfile = nil</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="127">
          <span class="hits">2</span>
          
          <code class="ruby">      open(url) do |io|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="128">
          <span class="hits">2</span>
          
          <code class="ruby">        begin</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="129">
          <span class="hits">2</span>
          
          <code class="ruby">          podfile = Podfile.new do</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">            # rubocop:disable Eval</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="131">
          <span class="hits">2</span>
          
          <code class="ruby">            eval(io.string, nil, url)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">            # rubocop:enable Eval</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">        rescue Exception =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">          Versioneye::Log.instance.log.error e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">          message = &quot;Invalid url `#{url}`: #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">          raise DSLError.new(message, url, e.backtrace)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="141">
          <span class="hits">2</span>
          
          <code class="ruby">      podfile</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>
          
          <code class="ruby">  class Lockfile</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.from_url(url)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">      p &quot;load Lockfile from_url #{url}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="149">
          <span class="hits">1</span>
          
          <code class="ruby">      open(url) do |io|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">        require &#39;yaml&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="151">
          <span class="hits">1</span>
          
          <code class="ruby">        hash = YAML.load(io)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="153">
          <span class="hits">1</span>
          
          <code class="ruby">        unless hash &amp;&amp; hash.is_a?(Hash)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">          raise Informative, &quot;Invalid Lockfile in `#{url}`&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="157">
          <span class="hits">1</span>
          
          <code class="ruby">        lockfile = Lockfile.new(hash)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>
          
          <code class="ruby">        lockfile.defined_in_file = url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>
          
          <code class="ruby">        lockfile</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">      p e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">      p e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="164">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="506d9bf1116f7e1362d5ab8588f0199d0b0b7111">
  <div class="header">
    <h3>lib/versioneye/package_managers/package_manager.rb</h3>
    <h4><span class="yellow">83.33 %</span> covered</h4>
    <div>
      <b>6</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class PackageManager</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_requested_with_current( project_dependency, product )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    if product &amp;&amp; product.version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">      project_dependency.version_requested = product.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">      project_dependency.version_requested = &#39;UNKNOWN&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    project_dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="638310afdb028104c8819a41d72296ed1427224a">
  <div class="header">
    <h3>lib/versioneye/parsers/biicode_parser.rb</h3>
    <h4><span class="green">90.36 %</span> covered</h4>
    <div>
      <b>83</b> relevant lines. 
      <span class="green"><b>75</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;semverly&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class BiicodeParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # Parser for biicode.conf</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse( url )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if url.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    body = self.fetch_response_body( url )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    parse_content( body )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( content )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if content.to_s.empty? </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if content.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">    project = init_project </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    section = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    content.each_line do |line|</code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="28">
          <span class="hits">82</span>
          
          <code class="ruby">      if line.strip.match(/\[\S*\]/i)</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="29">
          <span class="hits">18</span>
          
          <code class="ruby">        section = line.strip.downcase </code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="30">
          <span class="hits">18</span>
          
          <code class="ruby">        next </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="64" data-linenumber="32">
          <span class="hits">64</span>
          
          <code class="ruby">      if section.eql?(&#39;[requirements]&#39;) &amp;&amp; !line.strip.empty? </code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="33">
          <span class="hits">8</span>
          
          <code class="ruby">        parse_line( line, project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">    project.dep_number = project.dependencies.size</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_line( line, project )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="46">
          <span class="hits">8</span>
          
          <code class="ruby">    return nil if line.to_s.empty? </code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="47">
          <span class="hits">8</span>
          
          <code class="ruby">    return nil if line.strip.match(/\A\#/) # skip comment lines </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="49">
          <span class="hits">8</span>
          
          <code class="ruby">    owner      = nil </code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="50">
          <span class="hits">8</span>
          
          <code class="ruby">    block_name = nil </code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="51">
          <span class="hits">8</span>
          
          <code class="ruby">    track      = &#39;master&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="52">
          <span class="hits">8</span>
          
          <code class="ruby">    version    = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="54">
          <span class="hits">8</span>
          
          <code class="ruby">    short_match = line.match(/(\w*)\/(\w*)\s*\:\s*(-*\d)/i)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="55">
          <span class="hits">8</span>
          
          <code class="ruby">    if short_match</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">      owner      = short_match[1]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">      block_name = short_match[2]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="58">
          <span class="hits">2</span>
          
          <code class="ruby">      version    = short_match[3]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="61">
          <span class="hits">8</span>
          
          <code class="ruby">    long_match  = line.match(/(\w*)\/(\w*)\((\S*)\)\s*\:\s*(-*\d)/i)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="62">
          <span class="hits">8</span>
          
          <code class="ruby">    if long_match</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="63">
          <span class="hits">6</span>
          
          <code class="ruby">      owner      = long_match[1]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="64">
          <span class="hits">6</span>
          
          <code class="ruby">      block_name = long_match[2]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="65">
          <span class="hits">6</span>
          
          <code class="ruby">      track      = long_match[3]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="66">
          <span class="hits">6</span>
          
          <code class="ruby">      version    = long_match[4]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="69">
          <span class="hits">8</span>
          
          <code class="ruby">    return nil if short_match.nil? &amp;&amp; long_match.nil? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="71">
          <span class="hits">8</span>
          
          <code class="ruby">    prod_key   = &quot;#{owner}/#{owner}/#{block_name}/#{track}&quot;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="72">
          <span class="hits">8</span>
          
          <code class="ruby">    product    = Product.fetch_product Product::A_LANGUAGE_BIICODE, prod_key    </code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="73">
          <span class="hits">8</span>
          
          <code class="ruby">    dependency = init_dependency( product, prod_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="75">
          <span class="hits">8</span>
          
          <code class="ruby">    parse_requested_version( version, dependency, product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="77">
          <span class="hits">8</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="78">
          <span class="hits">8</span>
          
          <code class="ruby">    project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="79">
          <span class="hits">8</span>
          
          <code class="ruby">    project.unknown_number += 1 if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="80">
          <span class="hits">8</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  # It is important that this method is not writing into the database!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version_number, dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="86">
          <span class="hits">8</span>
          
          <code class="ruby">    if version_number.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">      self.update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="91">
          <span class="hits">8</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="92">
          <span class="hits">5</span>
          
          <code class="ruby">      dependency.comperator        = &quot;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="93">
          <span class="hits">5</span>
          
          <code class="ruby">      dependency.version_requested = version_number</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="94">
          <span class="hits">5</span>
          
          <code class="ruby">      dependency.version_label     = version_number</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="95">
          <span class="hits">5</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="98">
          <span class="hits">3</span>
          
          <code class="ruby">    version = String.new( version_number )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="100">
          <span class="hits">3</span>
          
          <code class="ruby">    version.gsub!(&#39;=&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="101">
          <span class="hits">3</span>
          
          <code class="ruby">    version.gsub!(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="102">
          <span class="hits">3</span>
          
          <code class="ruby">    dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="103">
          <span class="hits">3</span>
          
          <code class="ruby">    dependency.version_label     = version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="104">
          <span class="hits">3</span>
          
          <code class="ruby">    dependency.comperator        = &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="106">
          <span class="hits">3</span>
          
          <code class="ruby">    dependency    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_project</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="111">
          <span class="hits">2</span>
          
          <code class="ruby">    project = Project.new</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="112">
          <span class="hits">2</span>
          
          <code class="ruby">    project.project_type = Project::A_TYPE_BIICODE</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="113">
          <span class="hits">2</span>
          
          <code class="ruby">    project.language     = Product::A_LANGUAGE_BIICODE</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="114">
          <span class="hits">2</span>
          
          <code class="ruby">    project.name         = &#39;biicode.conf&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="115">
          <span class="hits">2</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_dependency( product, name )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="120">
          <span class="hits">8</span>
          
          <code class="ruby">    dependency          = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="121">
          <span class="hits">8</span>
          
          <code class="ruby">    dependency.name     = name</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="122">
          <span class="hits">8</span>
          
          <code class="ruby">    dependency.language = Product::A_LANGUAGE_BIICODE</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="123">
          <span class="hits">8</span>
          
          <code class="ruby">    if product</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="124">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.prod_key        = product.prod_key</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="125">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_current = product.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="127">
          <span class="hits">8</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8402e1c9f574b88fbf80cf9cdf43e967f966e4e0">
  <div class="header">
    <h3>lib/versioneye/parsers/bower_parser.rb</h3>
    <h4><span class="yellow">89.47 %</span> covered</h4>
    <div>
      <b>57</b> relevant lines. 
      <span class="green"><b>51</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/package_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;semverly&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">class BowerParser &lt; PackageParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # http://bower.io/docs/creating-packages/#bowerjson</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse( url )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if url.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    body = self.fetch_response_body( url )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    parse_content( body )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( content )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if content.to_s.empty? </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if content.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    data = JSON.parse( content )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if data.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    project = init_project( data )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = data[&#39;dependencies&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    if dependencies &amp;&amp; !dependencies.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">      parse_dependencies dependencies, project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = data[&#39;devDependencies&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    if dependencies &amp;&amp; !dependencies.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">      parse_dependencies dependencies, project, Dependency::A_SCOPE_DEVELOPMENT</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = project.dependencies</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if dependencies.nil? || dependencies.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    project.dep_number = project.dependencies.size</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_dependencies dependencies, project, scope = Dependency::A_SCOPE_COMPILE</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">    dependencies.each do |package_name, version_label|</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="55">
          <span class="hits">9</span>
          
          <code class="ruby">      parse_line( package_name.to_s.downcase, version_label, project, scope )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_line( package_name, version_label, project, scope = Dependency::A_SCOPE_COMPILE )</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="61">
          <span class="hits">9</span>
          
          <code class="ruby">    product    = Product.fetch_bower package_name</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="62">
          <span class="hits">9</span>
          
          <code class="ruby">    dependency = init_dependency( product, package_name )</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="63">
          <span class="hits">9</span>
          
          <code class="ruby">    dependency.scope = scope </code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="64">
          <span class="hits">9</span>
          
          <code class="ruby">    parse_requested_version( version_label, dependency, product )</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="65">
          <span class="hits">9</span>
          
          <code class="ruby">    project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="66">
          <span class="hits">9</span>
          
          <code class="ruby">    project.unknown_number += 1 if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="67">
          <span class="hits">9</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_project( data )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">    project = Project.new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">    project.project_type = Project::A_TYPE_BOWER</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">    project.language     = Product::A_LANGUAGE_JAVASCRIPT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">    project.name         = data[&#39;name&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">    project.description  = data[&#39;description&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_dependency( product, name )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="82">
          <span class="hits">11</span>
          
          <code class="ruby">    dependency          = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="83">
          <span class="hits">11</span>
          
          <code class="ruby">    dependency.name     = name</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="84">
          <span class="hits">11</span>
          
          <code class="ruby">    dependency.language = Product::A_LANGUAGE_JAVASCRIPT</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="85">
          <span class="hits">11</span>
          
          <code class="ruby">    if product</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="86">
          <span class="hits">11</span>
          
          <code class="ruby">      dependency.language        = product.language</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="87">
          <span class="hits">11</span>
          
          <code class="ruby">      dependency.prod_key        = product.prod_key</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="88">
          <span class="hits">11</span>
          
          <code class="ruby">      dependency.version_current = product.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="90">
          <span class="hits">11</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3b1922ecd6e540ba36fb469ab5d5e1bbf7585095">
  <div class="header">
    <h3>lib/versioneye/parsers/common_parser.rb</h3>
    <h4><span class="red">67.74 %</span> covered</h4>
    <div>
      <b>31</b> relevant lines. 
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/log&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;nokogiri&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def log</code>
        </li>
      
        <li class="covered" data-hits="185" data-linenumber="7">
          <span class="hits">185</span>
          
          <code class="ruby">    Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse(url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    raise NotImplementedError, &#39;Implement me in subclass!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">=begin</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  One of this bothe methods needs to be implemented in each subclass.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  def parse_file(file_path)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    raise NotImplementedError, &#39;Implement me in subclass!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  def parse_content(content)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    raise NotImplementedError, &#39;Implement me in subclass!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">=end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  # It is important that this method is NOT writing into the database!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  # Params:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  #   version           = the unparsed version string from the project file, e.g. &#39;&gt;= 2.0.1&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  #   projectdependency = This object can be empty/new. The results of the method are stored in this object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  #   product           = The corresponding product to the dependency. It can be nil if the dependency is unknown.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  # Result: The method is parsing the version string and setting this values in projectdependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  #   - projectdependency.version_label</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  #   - projectdependency.version_requested</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  #   - projectdependency.stability</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  #   - projectdependency.comperator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version, projectdependency, product)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    raise NotImplementedError, &#39;Implement me in subclass!&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_response url</code>
        </li>
      
        <li class="covered" data-hits="228" data-linenumber="45">
          <span class="hits">228</span>
          
          <code class="ruby">    url = self.do_replacements_for_github url</code>
        </li>
      
        <li class="covered" data-hits="228" data-linenumber="46">
          <span class="hits">228</span>
          
          <code class="ruby">    HttpService.fetch_response url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_response_body( url )</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="54">
          <span class="hits">192</span>
          
          <code class="ruby">    response = self.fetch_response( url )</code>
        </li>
      
        <li class="covered" data-hits="192" data-linenumber="55">
          <span class="hits">192</span>
          
          <code class="ruby">    response.body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def do_replacements_for_github(url)</code>
        </li>
      
        <li class="covered" data-hits="228" data-linenumber="63">
          <span class="hits">228</span>
          
          <code class="ruby">    if url.match(/^https:\/\/github.com\//)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">      url = url.gsub(&#39;https://github.com&#39;, &#39;https://raw.githubusercontent.com&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">      url = url.gsub(&#39;/blob/&#39;, &#39;/&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="228" data-linenumber="67">
          <span class="hits">228</span>
          
          <code class="ruby">    url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_requested_with_current( dependency, product )</code>
        </li>
      
        <li class="covered" data-hits="121" data-linenumber="71">
          <span class="hits">121</span>
          
          <code class="ruby">    if product &amp;&amp; product.version</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="72">
          <span class="hits">15</span>
          
          <code class="ruby">      dependency.version_requested = VersionService.newest_version product.versions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="106" data-linenumber="74">
          <span class="hits">106</span>
          
          <code class="ruby">      dependency.version_requested = &#39;UNKNOWN&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="121" data-linenumber="76">
          <span class="hits">121</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b5086992824ab799b3a0b330845d5ca275483b47">
  <div class="header">
    <h3>lib/versioneye/parsers/composer_lock_parser.rb</h3>
    <h4><span class="green">93.75 %</span> covered</h4>
    <div>
      <b>48</b> relevant lines. 
      <span class="green"><b>45</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/composer_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class ComposerLockParser &lt; ComposerParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse( url )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if url.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    response = self.fetch_response( url )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    parse_content( response.body )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( data )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if data.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if data.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    content = JSON.parse( data )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    project = init_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = self.fetch_project_dependencies( content )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    if dependencies</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      dependencies.each do |package|</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="22">
          <span class="hits">17</span>
          
          <code class="ruby">        self.process_package project, package</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = self.fetch_project_dev_dependencies( content )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    if dependencies</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">      dependencies.each do |package|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">        self.process_package project, package</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    project.dep_number = project.dependencies.size</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def process_package project, package</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="38">
          <span class="hits">17</span>
          
          <code class="ruby">    dependency = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="39">
          <span class="hits">17</span>
          
          <code class="ruby">    dependency.name = package[&#39;name&#39;]</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="40">
          <span class="hits">17</span>
          
          <code class="ruby">    dependency.language = Product::A_LANGUAGE_PHP</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="42">
          <span class="hits">17</span>
          
          <code class="ruby">    product = Product.fetch_product Product::A_LANGUAGE_PHP, dependency.name</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="43">
          <span class="hits">17</span>
          
          <code class="ruby">    dependency.prod_key = product.prod_key if product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="45">
          <span class="hits">17</span>
          
          <code class="ruby">    version = self.fetch_package_version( package )</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="46">
          <span class="hits">17</span>
          
          <code class="ruby">    self.parse_requested_version(version, dependency, product)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="48">
          <span class="hits">17</span>
          
          <code class="ruby">    project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="49">
          <span class="hits">17</span>
          
          <code class="ruby">    project.unknown_number += 1 unless product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="51">
          <span class="hits">17</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_package_version(package)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="55">
          <span class="hits">17</span>
          
          <code class="ruby">    return nil if package.nil? or package.empty? or not package.has_key?(&#39;version&#39;)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="56">
          <span class="hits">17</span>
          
          <code class="ruby">    version  = package[&#39;version&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    #if version string doesnt include any numbers, then look aliases</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="59">
          <span class="hits">17</span>
          
          <code class="ruby">    unless version =~ /\d+/</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="60">
          <span class="hits">10</span>
          
          <code class="ruby">      if package.has_key? &#39;extra&#39; and package[&#39;extra&#39;].has_key? &#39;branch-alias&#39;</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="61">
          <span class="hits">8</span>
          
          <code class="ruby">        aliases = package[&#39;extra&#39;][&#39;branch-alias&#39;]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="62">
          <span class="hits">8</span>
          
          <code class="ruby">        alias_value = aliases[version]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="63">
          <span class="hits">8</span>
          
          <code class="ruby">        version = alias_value unless alias_value.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="67">
          <span class="hits">17</span>
          
          <code class="ruby">    version.gsub! /^v/i, &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="68">
          <span class="hits">17</span>
          
          <code class="ruby">    version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_project_dependencies( data )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if data.nil? || data[&#39;packages&#39;].nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">    data[&#39;packages&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_project_dev_dependencies( data )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if data.nil? || data[&#39;packages-dev&#39;].nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">    data[&#39;packages-dev&#39;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="92d1bfd6f2da70e4f32f3480c249c20d3b6ca11b">
  <div class="header">
    <h3>lib/versioneye/parsers/composer_parser.rb</h3>
    <h4><span class="yellow">85.33 %</span> covered</h4>
    <div>
      <b>184</b> relevant lines. 
      <span class="green"><b>157</b> lines covered</span> and
      <span class="red"><b>27</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class ComposerParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # Parser for composer.json files from composer, packagist.org. PHP</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # http://getcomposer.org/doc/01-basic-usage.md</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # https://igor.io/2013/02/07/composer-stability-flags.html</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>
          
          <code class="ruby">    data = self.fetch_data url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>
          
          <code class="ruby">    parse_content( data )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( data )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="19">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if data.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="20">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if data.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="22">
          <span class="hits">4</span>
          
          <code class="ruby">    json_content = JSON.parse( data )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="23">
          <span class="hits">4</span>
          
          <code class="ruby">    project = init_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="25">
          <span class="hits">4</span>
          
          <code class="ruby">    dependencies = json_content[&#39;require&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="26">
          <span class="hits">4</span>
          
          <code class="ruby">    if dependencies &amp;&amp; !dependencies.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="27">
          <span class="hits">4</span>
          
          <code class="ruby">      parse_dependencies dependencies, project, json_content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="30">
          <span class="hits">4</span>
          
          <code class="ruby">    dependencies = json_content[&#39;require-dev&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="31">
          <span class="hits">4</span>
          
          <code class="ruby">    if dependencies &amp;&amp; !dependencies.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      parse_dependencies dependencies, project, json_content, Dependency::A_SCOPE_DEVELOPMENT</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="35">
          <span class="hits">4</span>
          
          <code class="ruby">    dependencies = json_content[&#39;require-test&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="36">
          <span class="hits">4</span>
          
          <code class="ruby">    if dependencies &amp;&amp; !dependencies.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">      parse_dependencies dependencies, project, json_content, Dependency::A_SCOPE_TEST</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="40">
          <span class="hits">4</span>
          
          <code class="ruby">    dependencies = project.dependencies</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="41">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if dependencies.nil? || dependencies.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="43">
          <span class="hits">4</span>
          
          <code class="ruby">    self.update_project( project, json_content )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="44">
          <span class="hits">4</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_dependencies dependencies, project, json_content, scope = Dependency::A_SCOPE_COMPILE</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="53">
          <span class="hits">4</span>
          
          <code class="ruby">    dependencies.each do |key, value|</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="54">
          <span class="hits">67</span>
          
          <code class="ruby">      self.process_dependency( key, value, project, json_content, scope )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_data url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="60">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if url.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="62">
          <span class="hits">3</span>
          
          <code class="ruby">    response = self.fetch_response(url)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="63">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if response.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="65">
          <span class="hits">3</span>
          
          <code class="ruby">    response.body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def process_dependency key, value, project, data, scope = Dependency::A_SCOPE_COMPILE</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="70">
          <span class="hits">67</span>
          
          <code class="ruby">    product    = Product.fetch_product( Product::A_LANGUAGE_PHP, key )</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="71">
          <span class="hits">67</span>
          
          <code class="ruby">    dependency = init_projectdependency( key, product )</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="72">
          <span class="hits">67</span>
          
          <code class="ruby">    dependency.scope = scope </code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="73">
          <span class="hits">67</span>
          
          <code class="ruby">    parse_requested_version( value, dependency, product )</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="74">
          <span class="hits">67</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="75">
          <span class="hits">45</span>
          
          <code class="ruby">      dep_in_ext_repo = dependency_in_repositories?( dependency, data )</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="76">
          <span class="hits">45</span>
          
          <code class="ruby">      project.unknown_number += 1 if !dep_in_ext_repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="78">
          <span class="hits">67</span>
          
          <code class="ruby">    project.out_number += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="67" data-linenumber="79">
          <span class="hits">67</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_project project, data</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="84">
          <span class="hits">4</span>
          
          <code class="ruby">    name                = data[&#39;name&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="85">
          <span class="hits">4</span>
          
          <code class="ruby">    description         = data[&#39;description&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="86">
          <span class="hits">4</span>
          
          <code class="ruby">    license             = data[&#39;license&#39;]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="87">
          <span class="hits">4</span>
          
          <code class="ruby">    project.name        = name if name</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="88">
          <span class="hits">4</span>
          
          <code class="ruby">    project.description = description if description</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="89">
          <span class="hits">4</span>
          
          <code class="ruby">    project.license     = license if license</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="90">
          <span class="hits">4</span>
          
          <code class="ruby">    project.dep_number  = project.dependencies.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  # It is important that this method is NOT writing into the database!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version version, dependency, product</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="97">
          <span class="hits">88</span>
          
          <code class="ruby">    if (version.nil? || version.empty?) &amp;&amp; !product.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">      update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="101">
          <span class="hits">88</span>
          
          <code class="ruby">    version = version.strip</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="102">
          <span class="hits">88</span>
          
          <code class="ruby">    version = version.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="103">
          <span class="hits">88</span>
          
          <code class="ruby">    version = version.gsub(&quot;&#39;&quot;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="104">
          <span class="hits">88</span>
          
          <code class="ruby">    version = version.gsub(/^v/, &#39;&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="106">
          <span class="hits">88</span>
          
          <code class="ruby">    dependency.version_label = String.new(version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="108">
          <span class="hits">88</span>
          
          <code class="ruby">    dependency.stability = VersionTagRecognizer.stability_tag_for version</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="109">
          <span class="hits">88</span>
          
          <code class="ruby">    VersionTagRecognizer.remove_minimum_stability version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="111">
          <span class="hits">88</span>
          
          <code class="ruby">    if version.empty? &amp;&amp; !product.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">      update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="87" data-linenumber="116">
          <span class="hits">87</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="117">
          <span class="hits">45</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="118">
          <span class="hits">45</span>
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    case</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">    when version.match(/\|/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">      versions = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">      parts = version.split(&quot;|&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">      parts.each do |verso|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="126">
          <span class="hits">2</span>
          
          <code class="ruby">        project_dependency = init_projectdependency product.name, product</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="127">
          <span class="hits">2</span>
          
          <code class="ruby">        parse_requested_version verso, project_dependency, product</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="128">
          <span class="hits">2</span>
          
          <code class="ruby">        versions &lt;&lt; project_dependency.version_requested</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="130">
          <span class="hits">1</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from( versions, dependency.stability )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="131">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = highest_version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">    when version.match(/,/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="135">
          <span class="hits">5</span>
          
          <code class="ruby">      stability = dependency.stability</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="136">
          <span class="hits">5</span>
          
          <code class="ruby">      versions = VersionService.from_ranges product.versions, version</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="137">
          <span class="hits">5</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from( versions, stability )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="138">
          <span class="hits">5</span>
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="139">
          <span class="hits">5</span>
          
          <code class="ruby">        dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">        dependency.version_requested = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="143">
          <span class="hits">5</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">    when version.match(/.\*\z/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">      # WildCards. 1.0.* =&gt; 1.0.0 | 1.0.2 | 1.0.20</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="147">
          <span class="hits">3</span>
          
          <code class="ruby">      ver = version.gsub(&quot;*&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="148">
          <span class="hits">3</span>
          
          <code class="ruby">      ver = ver.gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="149">
          <span class="hits">3</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from_wildcard( product.versions, ver, dependency.stability )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="150">
          <span class="hits">3</span>
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="151">
          <span class="hits">3</span>
          
          <code class="ruby">        dependency.version_requested = highest_version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="153">
          
          
          <code class="ruby">        dependency.version_requested = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="155">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">    when version.empty? || version.match(/\A\*\z/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">      # This case is not allowed. But we handle it anyway. Because we are fucking awesome!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = VersionService.newest_version_number( product.versions, dependency.stability )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="160">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label = &quot;*&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="161">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    when version.match(/\A&gt;=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">      # Greater than or equal to</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="165">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot;&gt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="166">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="167">
          <span class="hits">1</span>
          
          <code class="ruby">      greater_than_or_equal = VersionService.greater_than_or_equal( product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="168">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = greater_than_or_equal.version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &quot;&gt;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">    when version.match(/\A&gt;/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">      # Greater than version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="173">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot;&gt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="175">
          <span class="hits">1</span>
          
          <code class="ruby">      greater_than = VersionService.greater_than( product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="176">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = greater_than.version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="177">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &quot;&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">    when version.match(/\A&lt;=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">      # Less than or equal to</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="181">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot;&lt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="182">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="183">
          <span class="hits">1</span>
          
          <code class="ruby">      smaller_or_equal = VersionService.smaller_than_or_equal( product.versions, version )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="184">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = smaller_or_equal.version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="185">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &quot;&lt;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">    when version.match(/\A\&lt;/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">      # Less than version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="189">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot;\&lt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="190">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>
          
          <code class="ruby">      smaller_than = VersionService.smaller_than( product.versions, version )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="192">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = smaller_than.version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="193">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &quot;&lt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">    when version.match(/\A!=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">      # Not equal to version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="197">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot;!=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="198">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="199">
          <span class="hits">1</span>
          
          <code class="ruby">      newest_but_not = VersionService.newest_but_not( product.versions, version )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="200">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = newest_but_not.version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="201">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &quot;!=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">    when version.match(/\A~/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">      # Approximately greater than -&gt; Pessimistic Version Constraint</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="205">
          <span class="hits">6</span>
          
          <code class="ruby">      version.gsub!(&quot;~&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="206">
          <span class="hits">6</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="207">
          <span class="hits">6</span>
          
          <code class="ruby">      highest_version = VersionService.version_tilde_newest( product.versions, version )</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="208">
          <span class="hits">6</span>
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="209">
          <span class="hits">5</span>
          
          <code class="ruby">        dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="211">
          <span class="hits">1</span>
          
          <code class="ruby">        dependency.version_requested = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="213">
          <span class="hits">6</span>
          
          <code class="ruby">      dependency.comperator = &quot;~&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">    when version.match(/\A\^/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">      # Compatible with operator</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="217">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &quot;^&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="220">
          <span class="hits">1</span>
          
          <code class="ruby">      ver = version.gsub(&quot;\&gt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>
          
          <code class="ruby">      ver = ver.gsub(&quot;^&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="222">
          <span class="hits">1</span>
          
          <code class="ruby">      ver = ver.gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>
          
          <code class="ruby">      semver = SemVer.parse( ver )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>
          
          <code class="ruby">      if semver.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="226">
          
          
          <code class="ruby">        dependency.version_requested = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="228">
          <span class="hits">1</span>
          
          <code class="ruby">        start = ver</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="229">
          <span class="hits">1</span>
          
          <code class="ruby">        major = semver.major + 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="230">
          <span class="hits">1</span>
          
          <code class="ruby">        upper_range = &quot;#{major}.0.0&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="231">
          <span class="hits">1</span>
          
          <code class="ruby">        version_range   = VersionService.version_range(product.versions, start, upper_range )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="232">
          <span class="hits">1</span>
          
          <code class="ruby">        highest_version = VersionService.newest_version_from( version_range )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="233">
          <span class="hits">1</span>
          
          <code class="ruby">        if highest_version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="234">
          <span class="hits">1</span>
          
          <code class="ruby">          dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">          dependency.version_requested = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">    else # =</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="241">
          <span class="hits">20</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="242">
          <span class="hits">20</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="243">
          <span class="hits">42</span>
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">  # TODO write tests</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="250">
          <span class="hits">1</span>
          
          <code class="ruby">  def dependency_in_repositories? dependency, data</code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="251">
          <span class="hits">46</span>
          
          <code class="ruby">    return false if (dependency.nil? || data.nil?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="253">
          <span class="hits">45</span>
          
          <code class="ruby">    repos = data[&#39;repositories&#39;]</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="254">
          <span class="hits">45</span>
          
          <code class="ruby">    return false if (repos.nil? || repos.empty?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="256">
          
          
          <code class="ruby">    repos.each do |repo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">      repo_name = repo[&#39;package&#39;][&#39;name&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">      repo_version = repo[&#39;package&#39;][&#39;version&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">      repo_link = repo[&#39;package&#39;][&#39;dist&#39;][&#39;url&#39;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="260">
          
          
          <code class="ruby">      if repo_name.eql?(dependency.name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="261">
          
          
          <code class="ruby">        dependency.ext_link = repo_link</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="262">
          
          
          <code class="ruby">        dependency.version_current = repo_version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="263">
          
          
          <code class="ruby">        return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="270">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="274">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_project url = nil</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="275">
          <span class="hits">5</span>
          
          <code class="ruby">    project              = Project.new</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="276">
          <span class="hits">5</span>
          
          <code class="ruby">    project.project_type = Project::A_TYPE_COMPOSER</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="277">
          <span class="hits">5</span>
          
          <code class="ruby">    project.language     = Product::A_LANGUAGE_PHP</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="278">
          <span class="hits">5</span>
          
          <code class="ruby">    project.url          = url</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="279">
          <span class="hits">5</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="283">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="286">
          <span class="hits">1</span>
          
          <code class="ruby">    def init_projectdependency key, product</code>
        </li>
      
        <li class="covered" data-hits="69" data-linenumber="287">
          <span class="hits">69</span>
          
          <code class="ruby">      dependency          = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="69" data-linenumber="288">
          <span class="hits">69</span>
          
          <code class="ruby">      dependency.name     = key</code>
        </li>
      
        <li class="covered" data-hits="69" data-linenumber="289">
          <span class="hits">69</span>
          
          <code class="ruby">      dependency.language = Product::A_LANGUAGE_PHP</code>
        </li>
      
        <li class="covered" data-hits="69" data-linenumber="290">
          <span class="hits">69</span>
          
          <code class="ruby">      if product</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="291">
          <span class="hits">24</span>
          
          <code class="ruby">        dependency.prod_key        = product.prod_key</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="292">
          <span class="hits">24</span>
          
          <code class="ruby">        dependency.version_current = product.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="293">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="69" data-linenumber="294">
          <span class="hits">69</span>
          
          <code class="ruby">      dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">    # This method exist in CommonParser, too!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">    # This is just a copy with a different implementation for Composer!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">    #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="301">
          <span class="hits">1</span>
          
          <code class="ruby">    def update_requested_with_current dependency, product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="302">
          <span class="hits">1</span>
          
          <code class="ruby">      if product &amp;&amp; product.version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="303">
          <span class="hits">1</span>
          
          <code class="ruby">        dependency.version_requested = VersionService.newest_version_number( product.versions, dependency.stability )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="305">
          
          
          <code class="ruby">        dependency.version_requested = &quot;UNKNOWN&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="306">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="307">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="41e9f86a47a1d2716e800b4e51efb0920e3da82e">
  <div class="header">
    <h3>lib/versioneye/parsers/gemfile_parser.rb</h3>
    <h4><span class="yellow">89.31 %</span> covered</h4>
    <div>
      <b>159</b> relevant lines. 
      <span class="green"><b>142</b> lines covered</span> and
      <span class="red"><b>17</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class GemfileParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # Parser for Gemfile. For Ruby.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # http://gembundler.com/man/gemfile.5.html</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # http://guides.rubygems.org/patterns/#semantic_versioning</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse( url )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="10">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if url.nil? || url.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="12">
          <span class="hits">5</span>
          
          <code class="ruby">    gemfile = fetch_response_body( url )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="13">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if gemfile.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="15">
          <span class="hits">5</span>
          
          <code class="ruby">    parse_content( gemfile )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( gemfile )</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="23">
          <span class="hits">16</span>
          
          <code class="ruby">    return nil if gemfile.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="24">
          <span class="hits">16</span>
          
          <code class="ruby">    return nil if gemfile.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="26">
          <span class="hits">16</span>
          
          <code class="ruby">    project = init_project</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="27">
          <span class="hits">16</span>
          
          <code class="ruby">    gemfile.each_line do |line|</code>
        </li>
      
        <li class="covered" data-hits="446" data-linenumber="28">
          <span class="hits">446</span>
          
          <code class="ruby">      parse_line( line, project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="30">
          <span class="hits">16</span>
          
          <code class="ruby">    project.dep_number = project.dependencies.size</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="31">
          <span class="hits">16</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_line( line, project )</code>
        </li>
      
        <li class="covered" data-hits="446" data-linenumber="39">
          <span class="hits">446</span>
          
          <code class="ruby">    line_elements = fetch_line_elements( line )</code>
        </li>
      
        <li class="covered" data-hits="446" data-linenumber="40">
          <span class="hits">446</span>
          
          <code class="ruby">    gem_name      = fetch_gem_name( line_elements )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="446" data-linenumber="42">
          <span class="hits">446</span>
          
          <code class="ruby">    return nil if gem_name.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="289" data-linenumber="44">
          <span class="hits">289</span>
          
          <code class="ruby">    version    = fetch_version  ( line_elements )</code>
        </li>
      
        <li class="covered" data-hits="289" data-linenumber="45">
          <span class="hits">289</span>
          
          <code class="ruby">    product    = Product.fetch_product Product::A_LANGUAGE_RUBY, gem_name</code>
        </li>
      
        <li class="covered" data-hits="289" data-linenumber="46">
          <span class="hits">289</span>
          
          <code class="ruby">    dependency = init_dependency( product, gem_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="289" data-linenumber="48">
          <span class="hits">289</span>
          
          <code class="ruby">    parse_requested_version( version, dependency, product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="289" data-linenumber="50">
          <span class="hits">289</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="covered" data-hits="289" data-linenumber="51">
          <span class="hits">289</span>
          
          <code class="ruby">    project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="289" data-linenumber="52">
          <span class="hits">289</span>
          
          <code class="ruby">    project.unknown_number += 1 if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  # It is important that this method is not writing into the database!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version_number, dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="687" data-linenumber="57">
          <span class="hits">687</span>
          
          <code class="ruby">    if version_number.nil? || version_number.empty?</code>
        </li>
      
        <li class="covered" data-hits="87" data-linenumber="58">
          <span class="hits">87</span>
          
          <code class="ruby">      self.update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="87" data-linenumber="59">
          <span class="hits">87</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="600" data-linenumber="62">
          <span class="hits">600</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="567" data-linenumber="63">
          <span class="hits">567</span>
          
          <code class="ruby">      dependency.version_requested = version_number</code>
        </li>
      
        <li class="covered" data-hits="567" data-linenumber="64">
          <span class="hits">567</span>
          
          <code class="ruby">      dependency.version_label     = version_number</code>
        </li>
      
        <li class="covered" data-hits="567" data-linenumber="65">
          <span class="hits">567</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="68">
          <span class="hits">33</span>
          
          <code class="ruby">    version = String.new( version_number )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="33" data-linenumber="70">
          <span class="hits">33</span>
          
          <code class="ruby">    if version.match(/\A=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">      # Equals</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&#39;=&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label     = version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator        = &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="78">
          <span class="hits">32</span>
          
          <code class="ruby">    elsif version.match(/\A!=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">      # Not equal to version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">      version.gsub!(&#39;!=&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">      version.gsub!(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">      newest_version = VersionService.newest_but_not( product.versions, version)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">      dependency.version_requested = newest_version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">      dependency.comperator        = &#39;!=&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">      dependency.version_label     = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="87">
          <span class="hits">32</span>
          
          <code class="ruby">    elsif version.match(/\A&gt;=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      # Greater than or equal to</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="89">
          <span class="hits">5</span>
          
          <code class="ruby">      version.gsub!(&#39;&gt;=&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="90">
          <span class="hits">5</span>
          
          <code class="ruby">      version.gsub!(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="91">
          <span class="hits">5</span>
          
          <code class="ruby">      newest_version = VersionService.greater_than_or_equal( product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="92">
          <span class="hits">5</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="93">
          <span class="hits">5</span>
          
          <code class="ruby">      dependency.comperator        = &#39;&gt;=&#39;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="94">
          <span class="hits">5</span>
          
          <code class="ruby">      dependency.version_label     = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="96">
          <span class="hits">27</span>
          
          <code class="ruby">    elsif version.match(/\A&gt;/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      # Greater than version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&#39;&gt;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">      newest_version = VersionService.greater_than( product.versions, version )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator        = &quot;&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label     = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="105">
          <span class="hits">26</span>
          
          <code class="ruby">    elsif version.match(/\A&lt;=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">      # Less than or equal to</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot;&lt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">      newest_version = VersionService.smaller_than_or_equal( product.versions, version )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator        = &quot;&lt;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label     = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="114">
          <span class="hits">25</span>
          
          <code class="ruby">    elsif version.match(/\A\&lt;/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">      # Less than version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot;\&lt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">      newest_version = VersionService.smaller_than( product.versions, version )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator        = &quot;&lt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label     = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="123">
          <span class="hits">24</span>
          
          <code class="ruby">    elsif version.match(/\A~&gt;/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">      # Approximately greater than -&gt; Pessimistic Version Constraint</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="125">
          <span class="hits">10</span>
          
          <code class="ruby">      ver = version.gsub(&quot;~&gt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="126">
          <span class="hits">10</span>
          
          <code class="ruby">      ver = ver.gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="127">
          <span class="hits">10</span>
          
          <code class="ruby">      starter         = VersionService.version_approximately_greater_than_starter( ver )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="128">
          <span class="hits">10</span>
          
          <code class="ruby">      versions        = VersionService.versions_start_with( product.versions, starter )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="129">
          <span class="hits">10</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from( versions )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="130">
          <span class="hits">10</span>
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="131">
          <span class="hits">8</span>
          
          <code class="ruby">        dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="133">
          <span class="hits">2</span>
          
          <code class="ruby">        dependency.version_requested = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="135">
          <span class="hits">10</span>
          
          <code class="ruby">      dependency.comperator = &quot;~&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="136">
          <span class="hits">10</span>
          
          <code class="ruby">      dependency.version_label = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="138">
          <span class="hits">14</span>
          
          <code class="ruby">    elsif version.match(/^git:/) or version.match(/\A:git/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = &quot;GIT&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label     = &quot;GIT&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="141">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator        = &quot;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="143">
          <span class="hits">13</span>
          
          <code class="ruby">    elsif version.match(/^path:/) or version.match(/\A:path/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = &quot;PATH&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="145">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label     = &quot;PATH&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="146">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator        = &quot;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="149">
          <span class="hits">12</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="150">
          <span class="hits">12</span>
          
          <code class="ruby">      dependency.comperator        = &quot;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="151">
          <span class="hits">12</span>
          
          <code class="ruby">      dependency.version_label     = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="155">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_line_elements( line )</code>
        </li>
      
        <li class="covered" data-hits="456" data-linenumber="156">
          <span class="hits">456</span>
          
          <code class="ruby">    line = replace_comments( line )</code>
        </li>
      
        <li class="covered" data-hits="456" data-linenumber="157">
          <span class="hits">456</span>
          
          <code class="ruby">    line = line.strip</code>
        </li>
      
        <li class="covered" data-hits="456" data-linenumber="158">
          <span class="hits">456</span>
          
          <code class="ruby">    line.split(&quot;,&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="161">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_gem_name( line_elements )</code>
        </li>
      
        <li class="covered" data-hits="448" data-linenumber="162">
          <span class="hits">448</span>
          
          <code class="ruby">    gem_name = line_elements.first</code>
        </li>
      
        <li class="covered" data-hits="448" data-linenumber="163">
          <span class="hits">448</span>
          
          <code class="ruby">    return nil if gem_name.nil? || gem_name.empty?</code>
        </li>
      
        <li class="covered" data-hits="370" data-linenumber="164">
          <span class="hits">370</span>
          
          <code class="ruby">    return nil if gem_name.match(/^gem /).nil? # TODO check git as well !</code>
        </li>
      
        <li class="covered" data-hits="290" data-linenumber="165">
          <span class="hits">290</span>
          
          <code class="ruby">    gem_name.gsub!(&quot;gem &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="290" data-linenumber="166">
          <span class="hits">290</span>
          
          <code class="ruby">    gem_name = gem_name.strip</code>
        </li>
      
        <li class="covered" data-hits="290" data-linenumber="167">
          <span class="hits">290</span>
          
          <code class="ruby">    gem_name = gem_name.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="290" data-linenumber="168">
          <span class="hits">290</span>
          
          <code class="ruby">    gem_name = gem_name.gsub(&quot;&#39;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="290" data-linenumber="169">
          <span class="hits">290</span>
          
          <code class="ruby">    gem_name.split(&quot; &quot;).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="172">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_version( line_elements )</code>
        </li>
      
        <li class="covered" data-hits="295" data-linenumber="173">
          <span class="hits">295</span>
          
          <code class="ruby">    version = &quot;&quot;</code>
        </li>
      
        <li class="covered" data-hits="295" data-linenumber="174">
          <span class="hits">295</span>
          
          <code class="ruby">    line_elements.each_with_index do |element, index|</code>
        </li>
      
        <li class="covered" data-hits="571" data-linenumber="175">
          <span class="hits">571</span>
          
          <code class="ruby">      next if index == 0</code>
        </li>
      
        <li class="covered" data-hits="276" data-linenumber="176">
          <span class="hits">276</span>
          
          <code class="ruby">      element = element.strip</code>
        </li>
      
        <li class="covered" data-hits="276" data-linenumber="177">
          <span class="hits">276</span>
          
          <code class="ruby">      if element.match(/^require:/) or element.match(/\A:require/)</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="178">
          <span class="hits">44</span>
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby">      elsif element.match(/\A:group/) or element.match(/^group:/)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="180">
          <span class="hits">16</span>
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">      elsif element.match(/\A:development/) or element.match(/^development:/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="182">
          <span class="hits">1</span>
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">      elsif element.match(/\A:test/) or element.match(/^test:/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">      elsif element.match(/\A:platforms/) or element.match(/^platforms:/)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="186">
          <span class="hits">9</span>
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">      elsif element.match(/\A:engine/) or element.match(/^engine:/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="188">
          
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">      elsif element.match(/\A:engine_version/) or element.match(/^engine_version:/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="190">
          
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">      elsif element.match(/\A:branch/) or element.match(/^branch:/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="192">
          
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">      elsif element.match(/\A:tag/) or element.match(/^tag:/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">      elsif element.match(/\A:path/) or element.match(/^path:/)</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="196">
          <span class="hits">15</span>
          
          <code class="ruby">        version = element</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="197">
          <span class="hits">15</span>
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">      elsif element.match(/\A:git/) or element.match(/^git:/)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="199">
          <span class="hits">14</span>
          
          <code class="ruby">        version = element</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="200">
          <span class="hits">14</span>
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="177" data-linenumber="202">
          <span class="hits">177</span>
          
          <code class="ruby">        version = element</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="295" data-linenumber="205">
          <span class="hits">295</span>
          
          <code class="ruby">    version = version.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="295" data-linenumber="206">
          <span class="hits">295</span>
          
          <code class="ruby">    version.gsub(&quot;&#39;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="209">
          <span class="hits">1</span>
          
          <code class="ruby">  def replace_comments( value )</code>
        </li>
      
        <li class="covered" data-hits="457" data-linenumber="210">
          <span class="hits">457</span>
          
          <code class="ruby">    return nil unless value</code>
        </li>
      
        <li class="covered" data-hits="457" data-linenumber="211">
          <span class="hits">457</span>
          
          <code class="ruby">    comment = value.match(/#.*/)</code>
        </li>
      
        <li class="covered" data-hits="457" data-linenumber="212">
          <span class="hits">457</span>
          
          <code class="ruby">    if comment</code>
        </li>
      
        <li class="covered" data-hits="59" data-linenumber="213">
          <span class="hits">59</span>
          
          <code class="ruby">      value.gsub!(comment[0], &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="457" data-linenumber="215">
          <span class="hits">457</span>
          
          <code class="ruby">    value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_project( url = nil )</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="219">
          <span class="hits">21</span>
          
          <code class="ruby">    project = Project.new</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="220">
          <span class="hits">21</span>
          
          <code class="ruby">    project.project_type = Project::A_TYPE_RUBYGEMS</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="221">
          <span class="hits">21</span>
          
          <code class="ruby">    project.language     = Product::A_LANGUAGE_RUBY</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="222">
          <span class="hits">21</span>
          
          <code class="ruby">    project.url          = url</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="223">
          <span class="hits">21</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="226">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_dependency( product, gem_name )</code>
        </li>
      
        <li class="covered" data-hits="291" data-linenumber="227">
          <span class="hits">291</span>
          
          <code class="ruby">    dependency          = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="291" data-linenumber="228">
          <span class="hits">291</span>
          
          <code class="ruby">    dependency.name     = gem_name</code>
        </li>
      
        <li class="covered" data-hits="291" data-linenumber="229">
          <span class="hits">291</span>
          
          <code class="ruby">    dependency.language = Product::A_LANGUAGE_RUBY</code>
        </li>
      
        <li class="covered" data-hits="291" data-linenumber="230">
          <span class="hits">291</span>
          
          <code class="ruby">    if product</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="231">
          <span class="hits">17</span>
          
          <code class="ruby">      dependency.prod_key        = product.prod_key</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="232">
          <span class="hits">17</span>
          
          <code class="ruby">      dependency.version_current = product.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="291" data-linenumber="234">
          <span class="hits">291</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="60b0c89797783d0a154c52eb972c36500e262235">
  <div class="header">
    <h3>lib/versioneye/parsers/gemfilelock_parser.rb</h3>
    <h4><span class="yellow">87.76 %</span> covered</h4>
    <div>
      <b>49</b> relevant lines. 
      <span class="green"><b>43</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class GemfilelockParser &lt; GemfileParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # Parser for Gemfile.lock. For Ruby.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # http://gembundler.com/man/gemfile.5.html</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # http://docs.rubygems.org/read/chapter/16#page74</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse(url)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if url.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    content = self.fetch_response(url).body</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if content.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">    parse_content( content )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content(content)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="23">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if content.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="24">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if content.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="26">
          <span class="hits">4</span>
          
          <code class="ruby">    dependecies_matcher = /([\w|\d|\.|\-|\_]+) (\(.*\))/</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="28">
          <span class="hits">4</span>
          
          <code class="ruby">    matches = content.scan( dependecies_matcher )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="29">
          <span class="hits">4</span>
          
          <code class="ruby">    deps = self.build_dependencies(matches)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="30">
          <span class="hits">4</span>
          
          <code class="ruby">    project                     = init_project</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="31">
          <span class="hits">4</span>
          
          <code class="ruby">    project.projectdependencies = deps[:projectdependencies]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="32">
          <span class="hits">4</span>
          
          <code class="ruby">    project.unknown_number      = deps[:unknown_number]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="33">
          <span class="hits">4</span>
          
          <code class="ruby">    project.out_number          = deps[:out_number]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="34">
          <span class="hits">4</span>
          
          <code class="ruby">    project.dep_number          = project.dependencies.size</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="35">
          <span class="hits">4</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_dependencies(matches)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="43">
          <span class="hits">4</span>
          
          <code class="ruby">    unknowns, out_number = 0, 0</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="44">
          <span class="hits">4</span>
          
          <code class="ruby">    deps = Hash.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="46">
          <span class="hits">4</span>
          
          <code class="ruby">    matches.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="47">
          <span class="hits">387</span>
          
          <code class="ruby">      name = row[0]</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="48">
          <span class="hits">387</span>
          
          <code class="ruby">      version_match = row[1]</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="49">
          <span class="hits">387</span>
          
          <code class="ruby">      version = version_match.gsub(&#39;(&#39;, &#39;&#39;).gsub(&#39;)&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="50">
          <span class="hits">387</span>
          
          <code class="ruby">      dependency = Projectdependency.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="52">
          <span class="hits">387</span>
          
          <code class="ruby">      product = Product.fetch_product( Product::A_LANGUAGE_RUBY, name )</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="53">
          <span class="hits">387</span>
          
          <code class="ruby">      if product</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="54">
          <span class="hits">13</span>
          
          <code class="ruby">        dependency.prod_key = product.prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="374" data-linenumber="56">
          <span class="hits">374</span>
          
          <code class="ruby">        unknowns += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="58">
          <span class="hits">387</span>
          
          <code class="ruby">      dependency.name = name</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="59">
          <span class="hits">387</span>
          
          <code class="ruby">      dependency.language = Product::A_LANGUAGE_RUBY</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="60">
          <span class="hits">387</span>
          
          <code class="ruby">      parse_requested_version(version, dependency, product)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="62">
          <span class="hits">387</span>
          
          <code class="ruby">      dep = deps[name]</code>
        </li>
      
        <li class="covered" data-hits="387" data-linenumber="63">
          <span class="hits">387</span>
          
          <code class="ruby">      if dep.nil? or !dep.comperator.eql?(&#39;=&#39;)</code>
        </li>
      
        <li class="covered" data-hits="105" data-linenumber="64">
          <span class="hits">105</span>
          
          <code class="ruby">        deps[name] = dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="68">
          <span class="hits">4</span>
          
          <code class="ruby">    data = Array.new</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="69">
          <span class="hits">4</span>
          
          <code class="ruby">    deps.each do |k, v|</code>
        </li>
      
        <li class="covered" data-hits="104" data-linenumber="70">
          <span class="hits">104</span>
          
          <code class="ruby">      if ProjectdependencyService.outdated?( v )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">        out_number += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="104" data-linenumber="73">
          <span class="hits">104</span>
          
          <code class="ruby">      data.push v</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="76">
          <span class="hits">4</span>
          
          <code class="ruby">    {:unknown_number =&gt; unknowns, :out_number =&gt; out_number, :projectdependencies =&gt; data}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="27cfb10e2a35b1d64c5b5c929fcc9b449770068c">
  <div class="header">
    <h3>lib/versioneye/parsers/gradle_parser.rb</h3>
    <h4><span class="yellow">85.53 %</span> covered</h4>
    <div>
      <b>152</b> relevant lines. 
      <span class="green"><b>130</b> lines covered</span> and
      <span class="red"><b>22</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class GradleParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # Matches definitions like this;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # project.ext.springVersion = &#39;4.0.7.RELEASE&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  A_GLOBAL_VARS_MATCHER = /^\s*(\S*ext.\S*\s*\=\s*.*)/xi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # Matches definitions like this;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  # def tomcatVersion = &#39;7.0.54&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  A_GLOBAL_VARS_MATCHER_2 = /^\s*(def\s+\S+\s*=\s*[&quot;&#39;]\S*[&quot;&#39;]$)/xi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  # Matches this &#39;junit:junit-dep:4.0.0&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEP_SIMPLE_MATCHER = /[&quot;|&#39;]\s*([\w\.\-]+:[\w\.\-]+:[\w\.\-]+)\s*[&quot;|&#39;]/xi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  # (\w+) [\s|\(]?[\&#39;|\&quot;]+ ([\w|\.|\-|\_|\+]+)  :([\w|\.|\-|_|\+]+)  :([$\w|\.|\-|_|\+]+) [\@\S]* [\s|\(]?[\&#39;|\&quot;]+</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEP_SHORT_MATCHER = /</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      (\w+) #scope </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">      [\s|\(]?[\&#39;|\&quot;]+ #scope separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">        ([\w|\.|\-|\_|\+]+) #group_id </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">        :([\w|\.|\-|_|\+]+) #artifact </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">        :([$\w|\.|\-|_|\+]+) #version number</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">        [\@\S]*          #classifier</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">        [\s|\(]?[\&#39;|\&quot;]+ #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    /xi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  # ^[\s]* (\w+) [\s]* (\w+\:) [\s]*[\&#39;|\&quot;]+ ([\w|\d|\.|\-|\_]+) [\&#39;|\&quot;]+,[\s]* (\w+\:) [\s]*[\&#39;|\&quot;]+ ([\w|\d|\.|\-|\_]+) [\&#39;|\&quot;]+,[\s]* (\w+\:) [\s]*[\&#39;|\&quot;]+ ([\w|\d|\.|\-|\_]+)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEP_LONG_MATCHER = /</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">      ^[\s]*              #filter out comments</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      (\w+)               #scope</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">      [\s]*               #scope separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">      (\w+\:)             #group</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      [\s]*[\&#39;|\&quot;]+       #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">      ([\w|\d|\.|\-|\_]+) #group_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">      [\&#39;|\&quot;]+,[\s]*      #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">      (\w+\:)             #name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">      [\s]*[\&#39;|\&quot;]+       #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      ([\w|\d|\.|\-|\_]+) #artifact_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      [\&#39;|\&quot;]+,[\s]*      #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">      (\w+\:)             #version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">      [\s]*[\&#39;|\&quot;]+       #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">      ([\w|\d|\.|\-|\_]+) #version_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    /xi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  # (\[\w+\:)   [\s]*[\&#39;|\&quot;]+   ([\w|\d|\.|\-|\_]+)  [\&#39;|\&quot;]+,[\s]*  (\w+\:)  [\s]*[\&#39;|\&quot;]+   ([\w|\d|\.|\-|\_]+)  [\&#39;|\&quot;]+,[\s]*   (\w+\:)   [\s]*[\&#39;|\&quot;]*   ([\w|\d|\.|\-|\_]+)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEP_BR_MATCHER = /</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      (\[\w+\:)             #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">        [\s]*[\&#39;|\&quot;]+       #group</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">        ([\w|\d|\.|\-|\_]+) #group_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">        [\&#39;|\&quot;]+,[\s]*      #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">        (\w+\:)             #name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">        [\s]*[\&#39;|\&quot;]+       #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">        ([\w|\d|\.|\-|\_]+) #artifact_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">        [\&#39;|\&quot;]+,[\s]*      #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">        (\w+\:)             #version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">        [\s]*[\&#39;|\&quot;]*       #separator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">        ([\w|\d|\.|\-|\_]+) #version_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    /xi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse(url)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="63">
          <span class="hits">10</span>
          
          <code class="ruby">    return nil if url.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="65">
          <span class="hits">10</span>
          
          <code class="ruby">    content = self.fetch_response(url).body</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="66">
          <span class="hits">10</span>
          
          <code class="ruby">    parse_content( content )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( content )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="75">
          <span class="hits">10</span>
          
          <code class="ruby">    return nil if content.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="76">
          <span class="hits">10</span>
          
          <code class="ruby">    return nil if content.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="78">
          <span class="hits">10</span>
          
          <code class="ruby">    content = content.gsub(/\/\*.*?\*\//mxi, &quot;&quot;) # remove comments /* */ </code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="79">
          <span class="hits">10</span>
          
          <code class="ruby">    content = content.gsub(/\A\/\/.*$/xi, &quot;&quot;) # remove comments // </code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="80">
          <span class="hits">10</span>
          
          <code class="ruby">    content = content.gsub(/[^[https:][http:]]\/\/.*$/xi, &quot;&quot;) # remove comments // without http[s]</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="81">
          <span class="hits">10</span>
          
          <code class="ruby">    content = content.gsub(/.*classpath.*$/, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="83">
          <span class="hits">10</span>
          
          <code class="ruby">    vars = extract_vars content</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="84">
          <span class="hits">10</span>
          
          <code class="ruby">    vars.keys.each do |key|</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="85">
          <span class="hits">34</span>
          
          <code class="ruby">      val = vars[key]</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="86">
          <span class="hits">34</span>
          
          <code class="ruby">      content = content.gsub(&quot;${#{key}}&quot;, val)  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="89">
          <span class="hits">10</span>
          
          <code class="ruby">    matches_long = content.scan( A_DEP_LONG_MATCHER )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="90">
          <span class="hits">10</span>
          
          <code class="ruby">    deps_long    = self.build_dependencies_extd(matches_long, vars)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="91">
          <span class="hits">10</span>
          
          <code class="ruby">    content = content.gsub(A_DEP_LONG_MATCHER, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="93">
          <span class="hits">10</span>
          
          <code class="ruby">    matches_br = content.scan( A_DEP_BR_MATCHER )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="94">
          <span class="hits">10</span>
          
          <code class="ruby">    deps_br    = self.build_dependencies_br( matches_br, vars )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="95">
          <span class="hits">10</span>
          
          <code class="ruby">    content = content.gsub(A_DEP_BR_MATCHER, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="97">
          <span class="hits">10</span>
          
          <code class="ruby">    matches_short = content.scan( A_DEP_SHORT_MATCHER )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="98">
          <span class="hits">10</span>
          
          <code class="ruby">    deps_short    = self.build_dependencies(matches_short, vars)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="99">
          <span class="hits">10</span>
          
          <code class="ruby">    content = content.gsub(A_DEP_SHORT_MATCHER, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="102">
          <span class="hits">10</span>
          
          <code class="ruby">    matches_simple = content.scan( A_DEP_SIMPLE_MATCHER )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="103">
          <span class="hits">10</span>
          
          <code class="ruby">    deps_simple = self.build_dependencies_simple(matches_simple, vars)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="104">
          <span class="hits">10</span>
          
          <code class="ruby">    content = content.gsub(A_DEP_SIMPLE_MATCHER, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="106">
          <span class="hits">10</span>
          
          <code class="ruby">    if deps_short[:projectdependencies] &amp;&amp; !deps_short[:projectdependencies].empty?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="107">
          <span class="hits">10</span>
          
          <code class="ruby">      deps_short[:projectdependencies].each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="108">
          <span class="hits">110</span>
          
          <code class="ruby">        deps_long[:projectdependencies] &lt;&lt; dep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="111">
          <span class="hits">10</span>
          
          <code class="ruby">    if deps_br[:projectdependencies] &amp;&amp; !deps_br[:projectdependencies].empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">      deps_br[:projectdependencies].each do |dep|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">        deps_long[:projectdependencies] &lt;&lt; dep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="116">
          <span class="hits">10</span>
          
          <code class="ruby">    if deps_simple[:projectdependencies] &amp;&amp; !deps_simple[:projectdependencies].empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="117">
          <span class="hits">2</span>
          
          <code class="ruby">      deps_simple[:projectdependencies].each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="118">
          <span class="hits">6</span>
          
          <code class="ruby">        deps_long[:projectdependencies] &lt;&lt; dep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="122">
          <span class="hits">10</span>
          
          <code class="ruby">    project              = Project.new deps_long</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="123">
          <span class="hits">10</span>
          
          <code class="ruby">    project.project_type = Project::A_TYPE_GRADLE</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="124">
          <span class="hits">10</span>
          
          <code class="ruby">    project.language     = Product::A_LANGUAGE_JAVA</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="125">
          <span class="hits">10</span>
          
          <code class="ruby">    project.dep_number   = project.dependencies.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="127">
          <span class="hits">10</span>
          
          <code class="ruby">    project.dependencies.each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="128">
          <span class="hits">172</span>
          
          <code class="ruby">      project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="129">
          <span class="hits">172</span>
          
          <code class="ruby">      project.unknown_number += 1 if dependency.product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="132">
          <span class="hits">10</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">  def extract_vars content</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="141">
          <span class="hits">10</span>
          
          <code class="ruby">    vars = {}</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="142">
          <span class="hits">10</span>
          
          <code class="ruby">    matches = content.scan(A_GLOBAL_VARS_MATCHER)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="143">
          <span class="hits">10</span>
          
          <code class="ruby">    if matches &amp;&amp; !matches.empty?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="144">
          <span class="hits">6</span>
          
          <code class="ruby">      matches.each do |match|</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="145">
          <span class="hits">34</span>
          
          <code class="ruby">        mat = match.first</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="146">
          <span class="hits">34</span>
          
          <code class="ruby">        mat = mat.gsub(&quot;project.ext.&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="147">
          <span class="hits">34</span>
          
          <code class="ruby">        mat = mat.gsub(&quot;ext.&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="148">
          <span class="hits">34</span>
          
          <code class="ruby">        mat = mat.gsub(&quot; &quot;, &quot;&quot;).strip </code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="149">
          <span class="hits">34</span>
          
          <code class="ruby">        sps = mat.split(&quot;=&quot;)</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="150">
          <span class="hits">34</span>
          
          <code class="ruby">        var_key = sps[0]</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="151">
          <span class="hits">34</span>
          
          <code class="ruby">        var_val = sps[1].gsub(&quot;\&quot;&quot;, &quot;&quot;).gsub(&quot;&#39;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="152">
          <span class="hits">34</span>
          
          <code class="ruby">        var_val = var_val.gsub(&quot;System.getenv(GROOVY_VERSION)?:&quot;, &quot;&quot;).strip</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="153">
          <span class="hits">34</span>
          
          <code class="ruby">        vars[var_key] = var_val</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="157">
          <span class="hits">10</span>
          
          <code class="ruby">    matches = content.scan(A_GLOBAL_VARS_MATCHER_2)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="158">
          <span class="hits">10</span>
          
          <code class="ruby">    if matches &amp;&amp; !matches.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">      matches.each do |match|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">        mat = match.first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">        mat.gsub!(&quot;def&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">        sps = mat.split(&quot;=&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">        var_key = sps[0].gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="164">
          
          
          <code class="ruby">        var_val = sps[1].gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">        var_val = var_val.gsub(&quot;\&quot;&quot;, &quot;&quot;).gsub(&quot;&#39;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">        vars[var_key] = var_val</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="169">
          <span class="hits">10</span>
          
          <code class="ruby">    vars</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="173">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_dependencies( matches, vars )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">    # build and initiliaze array of dependencies.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">    # Arguments array of matches, should be [[scope, group_id, artifact_id, version],...]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">    # Returns map {:unknowns =&gt; 0 , dependencies =&gt; []}</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="177">
          <span class="hits">10</span>
          
          <code class="ruby">    data = []</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="178">
          <span class="hits">10</span>
          
          <code class="ruby">    matches.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="179">
          <span class="hits">110</span>
          
          <code class="ruby">      version = calc_version( row[3], vars )</code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="180">
          <span class="hits">110</span>
          
          <code class="ruby">      dependency = Projectdependency.new({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">        :scope =&gt; row[0],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">        :group_id =&gt; row[1],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">        :artifact_id =&gt; row[2],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">        :name =&gt; row[2],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">        :language =&gt; Product::A_LANGUAGE_JAVA,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">        :comperator =&gt; &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">      })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="110" data-linenumber="189">
          <span class="hits">110</span>
          
          <code class="ruby">      process_dep version, dependency, data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="192">
          <span class="hits">10</span>
          
          <code class="ruby">    {:projectdependencies =&gt; data}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="196">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_dependencies_simple( matches, vars )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">    # build and initiliaze array of dependencies.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">    # Arguments array of matches, should be [[scope, group_id, artifact_id, version],...]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">    # Returns map {:unknowns =&gt; 0 , dependencies =&gt; []}</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="200">
          <span class="hits">10</span>
          
          <code class="ruby">    data = []</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="201">
          <span class="hits">10</span>
          
          <code class="ruby">    matches.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="202">
          <span class="hits">6</span>
          
          <code class="ruby">      spliti = row.first.gsub(&quot;&#39;&quot;, &quot;&quot;).split(&quot;:&quot;)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="203">
          <span class="hits">6</span>
          
          <code class="ruby">      version = calc_version( spliti[2], vars )</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="204">
          <span class="hits">6</span>
          
          <code class="ruby">      dependency = Projectdependency.new({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">        :scope =&gt; &#39;compile&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">        :group_id =&gt; spliti[0],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">        :artifact_id =&gt; spliti[1],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">        :name =&gt; spliti[1],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">        :language =&gt; Product::A_LANGUAGE_JAVA,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">        :comperator =&gt; &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby">      })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="213">
          <span class="hits">6</span>
          
          <code class="ruby">      process_dep version, dependency, data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="216">
          <span class="hits">10</span>
          
          <code class="ruby">    {:projectdependencies =&gt; data}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="220">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_dependencies_extd( matches, vars )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="221">
          <span class="hits">10</span>
          
          <code class="ruby">    data = []</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="222">
          <span class="hits">10</span>
          
          <code class="ruby">    matches.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="223">
          <span class="hits">56</span>
          
          <code class="ruby">      version = calc_version( row[6], vars )</code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="224">
          <span class="hits">56</span>
          
          <code class="ruby">      dependency = Projectdependency.new({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">        :scope =&gt; row[0],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">        :group_id =&gt; row[2],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">        :artifact_id =&gt; row[4],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">        :name =&gt; row[4],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">        :language =&gt; Product::A_LANGUAGE_JAVA,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">        :comperator =&gt; &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">      })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="56" data-linenumber="233">
          <span class="hits">56</span>
          
          <code class="ruby">      process_dep version, dependency, data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="236">
          <span class="hits">10</span>
          
          <code class="ruby">    {:projectdependencies =&gt; data}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="240">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_dependencies_br( matches, vars )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="241">
          <span class="hits">10</span>
          
          <code class="ruby">    data = []</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="242">
          <span class="hits">10</span>
          
          <code class="ruby">    matches.each do |row|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="243">
          
          
          <code class="ruby">      version = calc_version( row[5], vars )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="244">
          
          
          <code class="ruby">      dependency = Projectdependency.new({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">        :scope =&gt; nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">        :group_id =&gt; row[1],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">        :artifact_id =&gt; row[3],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby">        :name =&gt; row[3],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby">        :language =&gt; Product::A_LANGUAGE_JAVA,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">        :comperator =&gt; &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">      })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">      process_dep version, dependency, data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="256">
          <span class="hits">10</span>
          
          <code class="ruby">    {:projectdependencies =&gt; data}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="260">
          <span class="hits">1</span>
          
          <code class="ruby">  def calc_version( version_string, vars )</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="261">
          <span class="hits">172</span>
          
          <code class="ruby">    return version_string if vars.nil? || vars.empty? || version_string.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="263">
          <span class="hits">88</span>
          
          <code class="ruby">    version_string = version_string.gsub(&quot;$&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="264">
          <span class="hits">88</span>
          
          <code class="ruby">    version_string = version_string.gsub(&quot;{&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="265">
          <span class="hits">88</span>
          
          <code class="ruby">    version_string = version_string.gsub(&quot;}&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="266">
          <span class="hits">88</span>
          
          <code class="ruby">    version_string = version_string.gsub(&quot;\&quot;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="267">
          <span class="hits">88</span>
          
          <code class="ruby">    version_string = version_string.gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="268">
          <span class="hits">88</span>
          
          <code class="ruby">    if vars.keys.include?( version_string )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="269">
          <span class="hits">2</span>
          
          <code class="ruby">      version_string = vars[version_string]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="88" data-linenumber="271">
          <span class="hits">88</span>
          
          <code class="ruby">    version_string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="275">
          <span class="hits">1</span>
          
          <code class="ruby">  def process_dep version, dependency, data</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="276">
          <span class="hits">172</span>
          
          <code class="ruby">    product = Product.find_by_group_and_artifact(dependency.group_id, dependency.artifact_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="278">
          <span class="hits">172</span>
          
          <code class="ruby">    dependency.prod_key = product.prod_key if product</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="279">
          <span class="hits">172</span>
          
          <code class="ruby">    parse_requested_version( version, dependency, product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="281">
          <span class="hits">172</span>
          
          <code class="ruby">    dependency.stability = VersionTagRecognizer.stability_tag_for version</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="282">
          <span class="hits">172</span>
          
          <code class="ruby">    VersionTagRecognizer.remove_minimum_stability version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="283">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="284">
          <span class="hits">172</span>
          
          <code class="ruby">    data &lt;&lt; dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="288">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version, dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="289">
          <span class="hits">172</span>
          
          <code class="ruby">    if version.nil? || version.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="290">
          
          
          <code class="ruby">      self.update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="291">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="293">
          <span class="hits">172</span>
          
          <code class="ruby">    version = version.to_s.strip</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="294">
          <span class="hits">172</span>
          
          <code class="ruby">    version = version.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="295">
          <span class="hits">172</span>
          
          <code class="ruby">    version = version.gsub(&quot;&#39;&quot;, &#39;&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="297">
          <span class="hits">172</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="148" data-linenumber="298">
          <span class="hits">148</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="148" data-linenumber="299">
          <span class="hits">148</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="301">
          <span class="hits">24</span>
          
          <code class="ruby">    elsif version.match(/\.\+\z/i) or version.match(/\.\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">      # Newest available static version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">      # http://www.gradle.org/docs/current/userguide/dependency_management.html#sec:dependency_resolution</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="304">
          <span class="hits">3</span>
          
          <code class="ruby">      ver = version.gsub(&#39;+&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="305">
          <span class="hits">3</span>
          
          <code class="ruby">      starter = ver.gsub(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="306">
          <span class="hits">3</span>
          
          <code class="ruby">      versions        = VersionService.versions_start_with( product.versions, starter )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="307">
          <span class="hits">3</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from( versions )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="308">
          <span class="hits">3</span>
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="309">
          <span class="hits">3</span>
          
          <code class="ruby">        dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">        dependency.version_requested = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="313">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="314">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_label = &quot;#{ver}+&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="317">
          <span class="hits">21</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="318">
          <span class="hits">21</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="319">
          <span class="hits">21</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="321">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby"></code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6a5431b23e0ce68ae6031c040234c40ec8077833">
  <div class="header">
    <h3>lib/versioneye/parsers/lein_parser.rb</h3>
    <h4><span class="red">70.83 %</span> covered</h4>
    <div>
      <b>72</b> relevant lines. 
      <span class="green"><b>51</b> lines covered</span> and
      <span class="red"><b>21</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class LeinParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse( url )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if url.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    response = self.fetch_response(url)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if response.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    content  = response.body</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if content.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    parse_content(content)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content(content)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if content.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if content.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">    xml_content = transform_to_xml content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    doc = Nokogiri::HTML(xml_content)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    dep_items = doc.xpath(&#39;//div[@attr=&quot;dependencies&quot;]&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">    deps = {:unknown_number =&gt; 0, :out_number =&gt; 0, :projectdependencies =&gt; []}</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    if dep_items &amp;&amp; !dep_items.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">      dep_items.each do |item| </code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="33">
          <span class="hits">6</span>
          
          <code class="ruby">        self.build_dependencies item.children, deps </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">    project              = Project.new deps</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">    project.project_type = Project::A_TYPE_LEIN</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">    project.language     = Product::A_LANGUAGE_CLOJURE</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">    project.dep_number   = project.dependencies.size</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def transform_to_xml(content)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    # transform to xml</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">    content = content.gsub /[\;]+.*/, &#39;&#39; # Remove clojure comments</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">    content = content.gsub /[\s]+/, &#39; &#39;  # Replace reduntant whitespaces</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="52">
          <span class="hits">2</span>
          
          <code class="ruby">    content = content.gsub /\[/, &#39;&lt;div&gt;&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="53">
          <span class="hits">2</span>
          
          <code class="ruby">    content = content.gsub /\]/, &#39;&lt;/div&gt;&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">    content = content.gsub /\{/, &#39;&lt;block&gt;&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">    content = content.gsub /\}/, &#39;&lt;/block&gt;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    # add attributes to tags</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">    while true</code>
        </li>
      
        <li class="covered" data-hits="100" data-linenumber="58">
          <span class="hits">100</span>
          
          <code class="ruby">      match = content.match(/\:(\S+)[\s]+\&lt;(\w+)\&gt;/)</code>
        </li>
      
        <li class="covered" data-hits="100" data-linenumber="59">
          <span class="hits">100</span>
          
          <code class="ruby">      break if match.nil?</code>
        </li>
      
        <li class="covered" data-hits="98" data-linenumber="60">
          <span class="hits">98</span>
          
          <code class="ruby">      content = &quot;#{match.pre_match} &lt;#{match.to_a[2]} attr=\&quot;#{match.to_a[1]}\&quot;&gt; #{match.post_match}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="62">
          <span class="hits">2</span>
          
          <code class="ruby">    &#39;&lt;project&gt;&#39; + content + &#39;&lt;/project&gt;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_dependencies(matches, deps)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="66">
          <span class="hits">6</span>
          
          <code class="ruby">    unknowns, out_number = 0, 0</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="67">
          <span class="hits">6</span>
          
          <code class="ruby">    matches.each do |item|</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="68">
          <span class="hits">24</span>
          
          <code class="ruby">      next if item.text.to_s.strip.empty? # If dependency element is empty</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="70">
          <span class="hits">12</span>
          
          <code class="ruby">      _, group_id, name, version = item.text.scan(/((\S+)\/)?(\S+)\s+\&quot;(\S+)\&quot;/)[0]</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="71">
          <span class="hits">12</span>
          
          <code class="ruby">      next if name.to_s.strip.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="73">
          <span class="hits">12</span>
          
          <code class="ruby">      group_id = name if group_id.to_s.empty? </code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="74">
          <span class="hits">12</span>
          
          <code class="ruby">      scope, _ = item.text.scan(/:scope\s+\&quot;(\S+)\&quot;/)[0]</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="75">
          <span class="hits">12</span>
          
          <code class="ruby">      dependency = Projectdependency.new({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">        :scope =&gt; scope,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">        :group_id =&gt; group_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">        :artifact_id =&gt; name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">        :name =&gt; name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">        :version_requested =&gt; version,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">        :version_label =&gt; version,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">        :comperator =&gt; &#39;=&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">        :language =&gt; Product::A_LANGUAGE_CLOJURE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">      })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="86">
          <span class="hits">12</span>
          
          <code class="ruby">      product = Product.find_by_group_and_artifact(dependency.group_id, dependency.artifact_id)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="87">
          <span class="hits">12</span>
          
          <code class="ruby">      if product</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">        dependency.prod_key = product.prod_key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">        dependency.version_current = product.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="91">
          <span class="hits">12</span>
          
          <code class="ruby">        deps[:unknown_number] += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="94">
          <span class="hits">12</span>
          
          <code class="ruby">      if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">        deps[:out_number] += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="98">
          <span class="hits">12</span>
          
          <code class="ruby">      deps[:projectdependencies] &lt;&lt; dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  # TODO use this method in this class to parse version strings</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version, dependency, product)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    if version.nil? || version.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      self.update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">    version = version.to_s.strip</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">    version = version.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">    version = version.gsub(&quot;&#39;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">    # TODO implement more cases</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0124750f369dd1868bd914fa2985de481e68cbff">
  <div class="header">
    <h3>lib/versioneye/parsers/package_parser.rb</h3>
    <h4><span class="green">91.63 %</span> covered</h4>
    <div>
      <b>203</b> relevant lines. 
      <span class="green"><b>186</b> lines covered</span> and
      <span class="red"><b>17</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;semverly&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class PackageParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # Parser for requirements.json from npm. NodeJS</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # https://github.com/isaacs/node-semver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # https://npmjs.org/doc/json.html</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  # http://wiki.commonjs.org/wiki/Packages/1.1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse ( url )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="12">
          <span class="hits">8</span>
          
          <code class="ruby">    return nil if url.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="14">
          <span class="hits">8</span>
          
          <code class="ruby">    body = self.fetch_response_body( url )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="15">
          <span class="hits">8</span>
          
          <code class="ruby">    parse_content body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( content )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="24">
          <span class="hits">8</span>
          
          <code class="ruby">    return nil if content.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="25">
          <span class="hits">8</span>
          
          <code class="ruby">    return nil if content.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="27">
          <span class="hits">8</span>
          
          <code class="ruby">    data = JSON.parse( content )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="28">
          <span class="hits">8</span>
          
          <code class="ruby">    return nil if data.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="30">
          <span class="hits">8</span>
          
          <code class="ruby">    project = init_project( data )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="32">
          <span class="hits">8</span>
          
          <code class="ruby">    dependencies = data[&#39;dependencies&#39;]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="33">
          <span class="hits">8</span>
          
          <code class="ruby">    if dependencies &amp;&amp; !dependencies.empty?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="34">
          <span class="hits">6</span>
          
          <code class="ruby">      parse_dependencies dependencies, project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="37">
          <span class="hits">8</span>
          
          <code class="ruby">    dev_dependencies = data[&#39;devDependencies&#39;]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="38">
          <span class="hits">8</span>
          
          <code class="ruby">    if dev_dependencies &amp;&amp; !dev_dependencies.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="39">
          <span class="hits">4</span>
          
          <code class="ruby">      parse_dependencies dev_dependencies, project, Dependency::A_SCOPE_DEVELOPMENT</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="42">
          <span class="hits">8</span>
          
          <code class="ruby">    bundledDependencies = data[&#39;bundledDependencies&#39;]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="43">
          <span class="hits">8</span>
          
          <code class="ruby">    if bundledDependencies &amp;&amp; !bundledDependencies.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">      parse_dependencies bundledDependencies, project, Dependency::A_SCOPE_BUNDLED</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="47">
          <span class="hits">8</span>
          
          <code class="ruby">    optionalDependencies = data[&#39;optionalDependencies&#39;]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="48">
          <span class="hits">8</span>
          
          <code class="ruby">    if optionalDependencies &amp;&amp; !optionalDependencies.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">      parse_dependencies optionalDependencies, project, Dependency::A_SCOPE_OPTIONAL</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="52">
          <span class="hits">8</span>
          
          <code class="ruby">    dependencies = project.dependencies</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="53">
          <span class="hits">8</span>
          
          <code class="ruby">    return nil if dependencies.nil? || dependencies.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="55">
          <span class="hits">8</span>
          
          <code class="ruby">    project.dep_number = project.dependencies.size</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="56">
          <span class="hits">8</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_dependencies dependencies, project, scope = Dependency::A_SCOPE_COMPILE</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="65">
          <span class="hits">10</span>
          
          <code class="ruby">    dependencies.each do |package_name, version_label|</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="66">
          <span class="hits">96</span>
          
          <code class="ruby">      parse_line( package_name, version_label, project, scope )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_line( package_name, version_label, project, scope = Dependency::A_SCOPE_COMPILE )</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="72">
          <span class="hits">96</span>
          
          <code class="ruby">    product    = Product.fetch_product( Product::A_LANGUAGE_NODEJS, package_name )</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="73">
          <span class="hits">96</span>
          
          <code class="ruby">    dependency = init_dependency( product, package_name )</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="74">
          <span class="hits">96</span>
          
          <code class="ruby">    dependency.scope = scope</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="75">
          <span class="hits">96</span>
          
          <code class="ruby">    parse_requested_version( version_label, dependency, product )</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="76">
          <span class="hits">96</span>
          
          <code class="ruby">    project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="77">
          <span class="hits">96</span>
          
          <code class="ruby">    project.unknown_number += 1 if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="78">
          <span class="hits">96</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  # It is important that this method is not writing int the database!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version, dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="108" data-linenumber="85">
          <span class="hits">108</span>
          
          <code class="ruby">    if version.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="86">
          <span class="hits">12</span>
          
          <code class="ruby">      self.update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="87">
          <span class="hits">12</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="90">
          <span class="hits">96</span>
          
          <code class="ruby">    version = version.to_s.strip</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="91">
          <span class="hits">96</span>
          
          <code class="ruby">    version = version.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="92">
          <span class="hits">96</span>
          
          <code class="ruby">    version = version.gsub(&quot;&#39;&quot;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="93">
          <span class="hits">96</span>
          
          <code class="ruby">    version = version.gsub(/x\.x/i, &quot;x&quot;)</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="94">
          <span class="hits">96</span>
          
          <code class="ruby">    if version.match(/\Av\d.*/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">      version = version[1..version.length]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="99">
          <span class="hits">96</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="100">
          <span class="hits">42</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="101">
          <span class="hits">42</span>
          
          <code class="ruby">      dependency.version_label     = version</code>
        </li>
      
        <li class="covered" data-hits="42" data-linenumber="102">
          <span class="hits">42</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="105">
          <span class="hits">54</span>
          
          <code class="ruby">    version = pre_process version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="54" data-linenumber="107">
          <span class="hits">54</span>
          
          <code class="ruby">    if version.match(/\|\|/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">      parsed_versions = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">      versions = version.split(&quot;||&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">      versions.each do |verso|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="111">
          <span class="hits">2</span>
          
          <code class="ruby">        proj_dep = init_dependency product, dependency.name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="112">
          <span class="hits">2</span>
          
          <code class="ruby">        parse_requested_version verso, proj_dep, product</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="113">
          <span class="hits">2</span>
          
          <code class="ruby">        parsed_versions &lt;&lt; proj_dep.version_requested</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from( parsed_versions )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = highest_version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &#39;||&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="53" data-linenumber="120">
          <span class="hits">53</span>
          
          <code class="ruby">    elsif version.match(/\A\*\z/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">      # Start Matching. Matches everything.</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="122">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_requested = product.version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="123">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_label = &#39;*&#39;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="124">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.comperator = &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="126">
          <span class="hits">50</span>
          
          <code class="ruby">    elsif version.match(/\A\*\z/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">      # Start Matching. Matches everything.</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">      dependency.version_requested = product.version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">      dependency.version_label = &#39;X&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">      dependency.comperator = &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="50" data-linenumber="132">
          <span class="hits">50</span>
          
          <code class="ruby">    elsif version.casecmp(&#39;latest&#39;) == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">      # Start Matching. Matches everything.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = product.version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label = &#39;latest&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="136">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="49" data-linenumber="138">
          <span class="hits">49</span>
          
          <code class="ruby">    elsif version.match(/\A=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">      # Equals</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="140">
          <span class="hits">3</span>
          
          <code class="ruby">      version.gsub!(&#39;=&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="141">
          <span class="hits">3</span>
          
          <code class="ruby">      version.gsub!(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="142">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="143">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="144">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.comperator = &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="46" data-linenumber="146">
          <span class="hits">46</span>
          
          <code class="ruby">    elsif version.match(/\A!=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">      # Not equal to version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&#39;!=&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="149">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">      newest_version = VersionService.newest_but_not(product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="151">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = newest_version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="152">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &#39;!=&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="153">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="155">
          <span class="hits">45</span>
          
          <code class="ruby">    elsif version.match(/\A&gt;=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">      # Greater than or equal to</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="157">
          <span class="hits">4</span>
          
          <code class="ruby">      version.gsub!(&#39;&gt;=&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="158">
          <span class="hits">4</span>
          
          <code class="ruby">      version.gsub!(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="159">
          <span class="hits">4</span>
          
          <code class="ruby">      newest_version = VersionService.greater_than_or_equal(product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="160">
          <span class="hits">4</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="161">
          <span class="hits">4</span>
          
          <code class="ruby">      dependency.comperator = &#39;&gt;=&#39;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="162">
          <span class="hits">4</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="164">
          <span class="hits">41</span>
          
          <code class="ruby">    elsif version.match(/\A&gt;/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">      # Greater than version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="166">
          <span class="hits">3</span>
          
          <code class="ruby">      version.gsub!(&#39;&gt;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="167">
          <span class="hits">3</span>
          
          <code class="ruby">      version.gsub!(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="168">
          <span class="hits">3</span>
          
          <code class="ruby">      newest_version = VersionService.greater_than(product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="169">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="170">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.comperator = &quot;&gt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="171">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="173">
          <span class="hits">38</span>
          
          <code class="ruby">    elsif version.match(/\A&lt;=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">      # Less than or equal to</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="175">
          <span class="hits">3</span>
          
          <code class="ruby">      version.gsub!(&quot;&lt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="176">
          <span class="hits">3</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="177">
          <span class="hits">3</span>
          
          <code class="ruby">      newest_version = VersionService.smaller_than_or_equal(product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="178">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="179">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.comperator = &quot;&lt;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="180">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="182">
          <span class="hits">35</span>
          
          <code class="ruby">    elsif version.match(/\A\&lt;/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">      # Less than version</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="184">
          <span class="hits">4</span>
          
          <code class="ruby">      version.gsub!(&quot;\&lt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="185">
          <span class="hits">4</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="186">
          <span class="hits">4</span>
          
          <code class="ruby">      newest_version = VersionService.smaller_than(product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="187">
          <span class="hits">4</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="188">
          <span class="hits">4</span>
          
          <code class="ruby">      dependency.comperator = &quot;&lt;&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="189">
          <span class="hits">4</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="31" data-linenumber="191">
          <span class="hits">31</span>
          
          <code class="ruby">    elsif version.match(/\A~/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">      # Tilde Version Ranges -&gt; Pessimistic Version Constraint</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">      # ~1.2.3 = &gt;=1.2.3 &lt;1.3.0</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="194">
          <span class="hits">5</span>
          
          <code class="ruby">      ver = version.gsub(&quot;\&gt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="195">
          <span class="hits">5</span>
          
          <code class="ruby">      ver = ver.gsub(&quot;~&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="196">
          <span class="hits">5</span>
          
          <code class="ruby">      ver = ver.gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="197">
          <span class="hits">5</span>
          
          <code class="ruby">      highest_version = VersionService.version_tilde_newest(product.versions, ver)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="198">
          <span class="hits">5</span>
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="199">
          <span class="hits">5</span>
          
          <code class="ruby">        dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">        dependency.version_requested = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="203">
          <span class="hits">5</span>
          
          <code class="ruby">      dependency.comperator = &quot;~&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="204">
          <span class="hits">5</span>
          
          <code class="ruby">      dependency.version_label = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="206">
          <span class="hits">26</span>
          
          <code class="ruby">    elsif version.match(/\A\^/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">      # Compatible with operator</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="208">
          <span class="hits">7</span>
          
          <code class="ruby">      dependency.comperator = &quot;^&quot;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="209">
          <span class="hits">7</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="211">
          <span class="hits">7</span>
          
          <code class="ruby">      ver = version.gsub(&quot;\&gt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="212">
          <span class="hits">7</span>
          
          <code class="ruby">      ver = ver.gsub(&quot;^&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="213">
          <span class="hits">7</span>
          
          <code class="ruby">      ver = ver.gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="214">
          <span class="hits">7</span>
          
          <code class="ruby">      ver = ver.gsub(/\.\*\z/i, &quot;.0&quot;)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="215">
          <span class="hits">7</span>
          
          <code class="ruby">      ver = ver.gsub(/\.x\z/i, &quot;.0&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="217">
          <span class="hits">7</span>
          
          <code class="ruby">      semver = SemVer.parse( ver )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="218">
          <span class="hits">7</span>
          
          <code class="ruby">      if semver.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="219">
          
          
          <code class="ruby">        dependency.version_requested = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="221">
          <span class="hits">7</span>
          
          <code class="ruby">        start = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="223">
          <span class="hits">7</span>
          
          <code class="ruby">        major = semver.major + 1</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="224">
          <span class="hits">7</span>
          
          <code class="ruby">        upper_range = &quot;#{major}.0.0&quot;</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="225">
          <span class="hits">7</span>
          
          <code class="ruby">        if start.match(/0\.\d+\.\d+\z/i)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="226">
          <span class="hits">5</span>
          
          <code class="ruby">          minor = semver.minor + 1</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="227">
          <span class="hits">5</span>
          
          <code class="ruby">          upper_range = &quot;0.#{minor}.0&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="230">
          <span class="hits">7</span>
          
          <code class="ruby">        version_range   = VersionService.version_range(product.versions, start, upper_range )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="231">
          <span class="hits">7</span>
          
          <code class="ruby">        version_range.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="232">
          <span class="hits">19</span>
          
          <code class="ruby">          version_range.delete version if version.to_s.eql?(upper_range)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="234">
          <span class="hits">7</span>
          
          <code class="ruby">        highest_version = VersionService.newest_version_from( version_range )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="235">
          <span class="hits">7</span>
          
          <code class="ruby">        if highest_version</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="236">
          <span class="hits">7</span>
          
          <code class="ruby">          dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="238">
          
          
          <code class="ruby">          dependency.version_requested = ver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="242">
          <span class="hits">19</span>
          
          <code class="ruby">    elsif version.match(/\.x\z/i) || version.match(/\.\*\z/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">      # X Version Ranges or .* version range</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="244">
          <span class="hits">13</span>
          
          <code class="ruby">      ver = version[0..version.length - 2]</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="245">
          <span class="hits">13</span>
          
          <code class="ruby">      versions = VersionService.versions_start_with( product.versions, ver )</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="246">
          <span class="hits">13</span>
          
          <code class="ruby">      versions &lt;&lt; version[0..version.length - 3]</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="247">
          <span class="hits">13</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from(versions)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="248">
          <span class="hits">13</span>
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="249">
          <span class="hits">13</span>
          
          <code class="ruby">        dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">        dependency.version_requested = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="253">
          <span class="hits">13</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="254">
          <span class="hits">13</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="256">
          <span class="hits">6</span>
          
          <code class="ruby">    elsif version.match(/ - /i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">      # Version Ranges</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="258">
          <span class="hits">3</span>
          
          <code class="ruby">      version_splitted = version.split(&quot; - &quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="259">
          <span class="hits">3</span>
          
          <code class="ruby">      start = version_splitted[0]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="260">
          <span class="hits">3</span>
          
          <code class="ruby">      stop = version_splitted[1]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="261">
          <span class="hits">3</span>
          
          <code class="ruby">      version_range   = VersionService.version_range(product.versions, start, stop)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="262">
          <span class="hits">3</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from( version_range )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="263">
          <span class="hits">3</span>
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="264">
          <span class="hits">3</span>
          
          <code class="ruby">        dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="266">
          
          
          <code class="ruby">        dependency.version_requested = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="268">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.comperator    = &quot;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="269">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="272">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="273">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.comperator        = &quot;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="274">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_label     = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="279">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_project( data )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="280">
          <span class="hits">8</span>
          
          <code class="ruby">    project = Project.new</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="281">
          <span class="hits">8</span>
          
          <code class="ruby">    project.project_type = Project::A_TYPE_NPM</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="282">
          <span class="hits">8</span>
          
          <code class="ruby">    project.language     = Product::A_LANGUAGE_NODEJS</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="283">
          <span class="hits">8</span>
          
          <code class="ruby">    project.name         = data[&#39;name&#39;]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="284">
          <span class="hits">8</span>
          
          <code class="ruby">    project.description  = data[&#39;description&#39;]</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="285">
          <span class="hits">8</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="289">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_dependency( product, name )</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="290">
          <span class="hits">96</span>
          
          <code class="ruby">    dependency          = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="291">
          <span class="hits">96</span>
          
          <code class="ruby">    dependency.name     = name</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="292">
          <span class="hits">96</span>
          
          <code class="ruby">    dependency.language = Product::A_LANGUAGE_NODEJS</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="293">
          <span class="hits">96</span>
          
          <code class="ruby">    if product</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="294">
          <span class="hits">48</span>
          
          <code class="ruby">      dependency.language        = product.language</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="295">
          <span class="hits">48</span>
          
          <code class="ruby">      dependency.prod_key        = product.prod_key</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="296">
          <span class="hits">48</span>
          
          <code class="ruby">      dependency.version_current = product.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="297">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="96" data-linenumber="298">
          <span class="hits">96</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="302">
          <span class="hits">1</span>
          
          <code class="ruby">  def pre_process version</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="303">
          <span class="hits">57</span>
          
          <code class="ruby">    if version.match(/\A\d*\z/) || version.match(/\A\d*\.\d*\z/)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="304">
          <span class="hits">8</span>
          
          <code class="ruby">      version = &quot;#{version}.*&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="306">
          <span class="hits">57</span>
          
          <code class="ruby">    version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="308">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e559a75d640bebad507f275c9f279bc207e668b8">
  <div class="header">
    <h3>lib/versioneye/parsers/parser_strategy.rb</h3>
    <h4><span class="yellow">88.46 %</span> covered</h4>
    <div>
      <b>26</b> relevant lines. 
      <span class="green"><b>23</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ParserStrategy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.parser_for( project_type, url )</code>
        </li>
      
        <li class="covered" data-hits="72" data-linenumber="4">
          <span class="hits">72</span>
          
          <code class="ruby">    case project_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">      when Project::A_TYPE_MAVEN2</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="6">
          <span class="hits">27</span>
          
          <code class="ruby">        if url.match(/pom.json/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">          return PomJsonParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="9">
          <span class="hits">26</span>
          
          <code class="ruby">          return PomParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">      when Project::A_TYPE_PIP</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">        if url.match(/requirements\S*.txt/) || url.match(/pip.log/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">          return RequirementsParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">          return PythonSetupParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      when Project::A_TYPE_COCOAPODS</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="20">
          <span class="hits">7</span>
          
          <code class="ruby">        if url.match(/Podfile.lock/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">          return PodfilelockParser.new</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="22">
          <span class="hits">6</span>
          
          <code class="ruby">        elsif url.match(/\.podspec/i)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">          return CocoapodsPodspecParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="25">
          <span class="hits">6</span>
          
          <code class="ruby">          return PodfileParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">      when Project::A_TYPE_NPM</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">        return PackageParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      when Project::A_TYPE_GRADLE</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">        return GradleParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">      when Project::A_TYPE_SBT</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">        return SbtParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">      when Project::A_TYPE_LEIN</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">        return LeinParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      when Project::A_TYPE_RUBYGEMS</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="41">
          <span class="hits">25</span>
          
          <code class="ruby">        if url.match(/Gemfile\.lock/)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="42">
          <span class="hits">3</span>
          
          <code class="ruby">          return GemfilelockParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="44">
          <span class="hits">22</span>
          
          <code class="ruby">          return GemfileParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">      when Project::A_TYPE_COMPOSER</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="48">
          <span class="hits">4</span>
          
          <code class="ruby">        if url.match(/composer\.lock/i)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">          return ComposerLockParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="51">
          <span class="hits">3</span>
          
          <code class="ruby">          return ComposerParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      when Project::A_TYPE_BOWER</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">        return BowerParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      when Project::A_TYPE_BIICODE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">        return BiicodeParser.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">        nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a75811ad5875645520d9a52f6da6524c3117b0e1">
  <div class="header">
    <h3>lib/versioneye/parsers/podfile_parser.rb</h3>
    <h4><span class="yellow">82.72 %</span> covered</h4>
    <div>
      <b>81</b> relevant lines. 
      <span class="green"><b>67</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/package_managers/cocoapods_package_manager&#39; # for Monkey patch Pod::Podfile.from_url( url )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;cocoapods-core&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># This parser parses the podfile for any CocoaPods project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"># and creates and stores a Project model in VersionEye</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"># use like this:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#    PodfileParser.new.parse &#39;https://raw.githubusercontent.com/CocoaPods/CocoaPods/master/spec/fixtures/Podfile&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"># or parse a single Podfile on the filesystem</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#    PodfileParser.new.parse_file &#39;/path/to/the/Podfile&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">class PodfileParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_file filename</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="20">
          <span class="hits">11</span>
          
          <code class="ruby">    pod_file = Pod::Podfile.from_file( filename )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="21">
          <span class="hits">11</span>
          
          <code class="ruby">    create_project pod_file</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse url</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if url.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    pod_file = Pod::Podfile.from_url( url )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    create_project pod_file, url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    log.error &quot;Cant&#39;parse #{url}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_project pod_file, url = nil</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="42">
          <span class="hits">13</span>
          
          <code class="ruby">    project = init_project url</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="43">
          <span class="hits">13</span>
          
          <code class="ruby">    create_dependencies project, pod_file</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="44">
          <span class="hits">13</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_project url</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="49">
          <span class="hits">13</span>
          
          <code class="ruby">    Project.new({project_type: Project::A_TYPE_COCOAPODS, language: Product::A_LANGUAGE_OBJECTIVEC, url: url})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_dependencies project, pod_file</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    # TODO make scopes out of the target definitions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    # target_def = @pod_hash[&quot;target_definitions&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="57">
          <span class="hits">13</span>
          
          <code class="ruby">    hash_array = pod_file.dependencies.map do |dep|</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="58">
          <span class="hits">71</span>
          
          <code class="ruby">      hash = {name: dep.name, version: dep.requirement.as_list}</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="59">
          <span class="hits">71</span>
          
          <code class="ruby">      hash[:spec], hash[:subspec] = CocoapodsPackageManager.spec_subspec( dep.name )</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="60">
          <span class="hits">71</span>
          
          <code class="ruby">      hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="84" data-linenumber="63">
          <span class="hits">84</span>
          
          <code class="ruby">    specs = ( hash_array.map { |hash| hash[:spec] } ).uniq</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="64">
          <span class="hits">13</span>
          
          <code class="ruby">    specs_and_versions = hash_array.inject({}) do |result,hash|</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="65">
          <span class="hits">71</span>
          
          <code class="ruby">      spec = hash[:spec]</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="66">
          <span class="hits">71</span>
          
          <code class="ruby">      if specs.member? spec</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="67">
          <span class="hits">70</span>
          
          <code class="ruby">        result[spec] = hash[:version]</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="68">
          <span class="hits">70</span>
          
          <code class="ruby">        specs.delete spec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="71" data-linenumber="70">
          <span class="hits">71</span>
          
          <code class="ruby">      result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="73">
          <span class="hits">13</span>
          
          <code class="ruby">    specs_and_versions.each_pair do |spec, version|</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="74">
          <span class="hits">70</span>
          
          <code class="ruby">      create_dependency(project, spec, version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="77">
          <span class="hits">13</span>
          
          <code class="ruby">    project.dep_number = project.projectdependencies.size</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="78">
          <span class="hits">13</span>
          
          <code class="ruby">    log.info &quot;Project has #{project.projectdependencies.count} dependencies&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_dependency project, dep_name, requirements</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="83">
          <span class="hits">70</span>
          
          <code class="ruby">    if dep_name.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">      log.debug &quot;Problem: don&#39;t know how to handle #{dep_name}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="88">
          <span class="hits">70</span>
          
          <code class="ruby">    product = load_product( dep_name )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">    # prod_key should be nil if there is no such product</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="91">
          <span class="hits">70</span>
          
          <code class="ruby">    prod_key = nil</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="92">
          <span class="hits">70</span>
          
          <code class="ruby">    prod_key ||= product.prod_key if product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="94">
          <span class="hits">70</span>
          
          <code class="ruby">    requirement = requirements.map do |req_version|</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="95">
          <span class="hits">70</span>
          
          <code class="ruby">      v_hash = version_hash(req_version, dep_name, product)</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="96">
          <span class="hits">70</span>
          
          <code class="ruby">      log.debug &quot;VERSION HASH IS #{v_hash}&quot;</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="97">
          <span class="hits">70</span>
          
          <code class="ruby">      v_hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="100">
          <span class="hits">70</span>
          
          <code class="ruby">    log.debug &quot;create_dependency &#39;#{dep_name}&#39; -- #{requirement}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="102">
          <span class="hits">70</span>
          
          <code class="ruby">    dependency = Projectdependency.new({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">      :language =&gt; Product::A_LANGUAGE_OBJECTIVEC,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">      :prod_key =&gt; prod_key,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">      :name     =&gt; dep_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">      :version_requested  =&gt; requirement.first[:version_requested],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">      :comperator         =&gt; requirement.first[:comperator],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">      :version_label      =&gt; requirement.first[:version_label]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">      })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="113">
          <span class="hits">70</span>
          
          <code class="ruby">    project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="114">
          <span class="hits">70</span>
          
          <code class="ruby">    project.unknown_number += 1 if dependency.prod_key.nil?</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="115">
          <span class="hits">70</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="116">
          <span class="hits">70</span>
          
          <code class="ruby">    dependency.save</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="117">
          <span class="hits">70</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">  def version_hash version_from_file, prod_name, product</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="122">
          <span class="hits">70</span>
          
          <code class="ruby">    if [:git, :head].member? version_from_file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">      log.debug &quot;WARNING dependency &#39;#{prod_name}&#39; requires GIT&quot; # TODO</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">      {:version_requested =&gt; &quot;GIT&quot;, :version_label =&gt; &quot;GIT&quot;, :comperator =&gt; &quot;=&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="126">
          <span class="hits">70</span>
          
          <code class="ruby">    elsif :path == version_from_file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">      log.debug &quot;WARNING dependency &#39;#{prod_name}&#39; requires PATH&quot; # TODO</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">      {:version_requested =&gt; &quot;PATH&quot;, :version_label =&gt; &quot;PATH&quot;, :comperator =&gt; &quot;=&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="131">
          <span class="hits">70</span>
          
          <code class="ruby">      comperator_version = CocoapodsPackageManager.parse_version_constraint( version_from_file )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">      # TODO copy composer for version ranges</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="135">
          <span class="hits">70</span>
          
          <code class="ruby">      comperator = comperator_version[:comperator]</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="136">
          <span class="hits">70</span>
          
          <code class="ruby">      version    = comperator_version[:version_requested]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="138">
          <span class="hits">70</span>
          
          <code class="ruby">      if product</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="139">
          <span class="hits">25</span>
          
          <code class="ruby">        version_requested = CocoapodsPackageManager.choose_version(comperator, version, product.versions)</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="140">
          <span class="hits">25</span>
          
          <code class="ruby">        return {:version_requested =&gt; version_requested, :version_label =&gt; version_from_file, :comperator =&gt; comperator}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="143">
          <span class="hits">45</span>
          
          <code class="ruby">      {:version_requested =&gt; version, :version_label =&gt; version_from_file, :comperator =&gt; comperator}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">  # It is important that this method is not writing into the database!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version_number, dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="151">
          <span class="hits">3</span>
          
          <code class="ruby">    CocoapodsPackageManager.parse_requested_version( version_number, dependency, product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="155">
          <span class="hits">1</span>
          
          <code class="ruby">  def load_product name</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="156">
          <span class="hits">70</span>
          
          <code class="ruby">    prod_key = name.downcase</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="157">
          <span class="hits">70</span>
          
          <code class="ruby">    products = Product.where({:language =&gt; Product::A_LANGUAGE_OBJECTIVEC, :prod_key =&gt; prod_key, })</code>
        </li>
      
        <li class="covered" data-hits="70" data-linenumber="158">
          <span class="hits">70</span>
          
          <code class="ruby">    return nil if products.nil? || products.empty?</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="159">
          <span class="hits">25</span>
          
          <code class="ruby">    if products.count &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">      log.error &quot;more than one Product found for (#{Product::A_LANGUAGE_OBJECTIVEC}, #{prod_key})&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="162">
          <span class="hits">25</span>
          
          <code class="ruby">    products.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e8ceb1f95691f0cf4bb60063116ea5acd7cd93c8">
  <div class="header">
    <h3>lib/versioneye/parsers/podfilelock_parser.rb</h3>
    <h4><span class="green">95.45 %</span> covered</h4>
    <div>
      <b>66</b> relevant lines. 
      <span class="green"><b>63</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/package_managers/cocoapods_package_manager&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;cocoapods-core&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># This parser parses Cocoapods Podfile.lock file</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"># TODO: implement Subspecs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">class PodfilelockParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  # these are the same for all projects parsed with this parser</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_reader :language, :project_type</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  # these are the inputs</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :lockfile_name, :url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  # these are the (intermediate) outputs</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  attr_accessor :project, :lockfile</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="22">
          <span class="hits">4</span>
          
          <code class="ruby">    @project_type = Project::A_TYPE_COCOAPODS</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="23">
          <span class="hits">4</span>
          
          <code class="ruby">    @language     = Product::A_LANGUAGE_OBJECTIVEC</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil unless url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    @url = url</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    @lockfile = Pod::Lockfile.from_url url # from_url is monkey patched. You find it in cocoapods_package_manager.rb</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    create_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_file filename</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil unless filename</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">    @lockfile_name  = filename</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">    pathname = Pathname.new filename</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">    @lockfile = Pod::Lockfile.from_file pathname</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    create_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_project</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="45">
          <span class="hits">3</span>
          
          <code class="ruby">    @project = init_project</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="46">
          <span class="hits">3</span>
          
          <code class="ruby">    log.info &quot;created project #{@project}&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="47">
          <span class="hits">3</span>
          
          <code class="ruby">    create_dependencies</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="48">
          <span class="hits">3</span>
          
          <code class="ruby">    @project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_project</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="52">
          <span class="hits">3</span>
          
          <code class="ruby">    Project.new \</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      project_type: project_type,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      language: language,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">      url: url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_dependencies</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="59">
          <span class="hits">3</span>
          
          <code class="ruby">    pod_names = lockfile.pod_names</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="61">
          <span class="hits">3</span>
          
          <code class="ruby">    hash_array = pod_names.map do |name|</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="62">
          <span class="hits">29</span>
          
          <code class="ruby">      hash = {name: name, version: lockfile.version(name)}</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="63">
          <span class="hits">29</span>
          
          <code class="ruby">      hash[:spec], hash[:subspec] = CocoapodsPackageManager.spec_subspec( name )</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="64">
          <span class="hits">29</span>
          
          <code class="ruby">      hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="67">
          <span class="hits">32</span>
          
          <code class="ruby">    specs = ( hash_array.map { |hash| hash[:spec] } ).uniq</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="68">
          <span class="hits">3</span>
          
          <code class="ruby">    specs_and_versions = hash_array.inject({}) do |result,hash|</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="69">
          <span class="hits">29</span>
          
          <code class="ruby">      spec = hash[:spec]</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="70">
          <span class="hits">29</span>
          
          <code class="ruby">      if specs.member? spec</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="71">
          <span class="hits">17</span>
          
          <code class="ruby">        result[spec] = hash[:version]</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="72">
          <span class="hits">17</span>
          
          <code class="ruby">        specs.delete spec</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="74">
          <span class="hits">29</span>
          
          <code class="ruby">      result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="77">
          <span class="hits">3</span>
          
          <code class="ruby">    specs_and_versions.each_pair do |spec, version|</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="78">
          <span class="hits">17</span>
          
          <code class="ruby">      create_dependency spec, version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="81">
          <span class="hits">3</span>
          
          <code class="ruby">    @project.dep_number = @project.projectdependencies.count</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="82">
          <span class="hits">3</span>
          
          <code class="ruby">    log.info &quot;Project has #{@project.projectdependencies.count} dependencies&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  # spec should now be the spec without subspec</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def create_dependency spec, dep_version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="88">
          <span class="hits">17</span>
          
          <code class="ruby">    unless spec</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">      log.debug &quot;Problem: try to create_dependency(nil)&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="93">
          <span class="hits">17</span>
          
          <code class="ruby">    log.debug &quot;create_dependency &#39;#{spec}&#39; -- #{dep_version}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="95">
          <span class="hits">17</span>
          
          <code class="ruby">    product  = load_product( spec )</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="96">
          <span class="hits">17</span>
          
          <code class="ruby">    prod_key = nil</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="97">
          <span class="hits">17</span>
          
          <code class="ruby">    prod_key ||= product.prod_key if product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="99">
          <span class="hits">17</span>
          
          <code class="ruby">    dependency = Projectdependency.new({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">      :language =&gt; language,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">      :prod_key =&gt; prod_key,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">      :name     =&gt; spec,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">      :version_requested  =&gt; dep_version,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">      :comperator         =&gt; &#39;=&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">      :version_label      =&gt; dep_version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">      })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="109">
          <span class="hits">17</span>
          
          <code class="ruby">    project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="110">
          <span class="hits">17</span>
          
          <code class="ruby">    project.unknown_number += 1 if dependency.prod_key.nil?</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="111">
          <span class="hits">17</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="112">
          <span class="hits">17</span>
          
          <code class="ruby">    dependency.save</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="113">
          <span class="hits">17</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">  def load_product name</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="117">
          <span class="hits">17</span>
          
          <code class="ruby">    prod_key = name.downcase</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="118">
          <span class="hits">17</span>
          
          <code class="ruby">    products = Product.where({:language =&gt; language, :prod_key =&gt; prod_key })</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="119">
          <span class="hits">17</span>
          
          <code class="ruby">    if products.nil? || products.empty?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="120">
          <span class="hits">9</span>
          
          <code class="ruby">      log.warn &quot;no product found for language #{language} prod_key #{prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="121">
          <span class="hits">9</span>
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">    elsif products.count &gt; 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">      log.error &quot;more than one Product found for (#{language}, #{prod_key})&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="126">
          <span class="hits">8</span>
          
          <code class="ruby">    products.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="95b728c17ade6748fb240506fc3d0787187354de">
  <div class="header">
    <h3>lib/versioneye/parsers/pom_json_parser.rb</h3>
    <h4><span class="green">93.33 %</span> covered</h4>
    <div>
      <b>45</b> relevant lines. 
      <span class="green"><b>42</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class PomJsonParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse(url)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if url.nil? || url.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    response = self.fetch_response( url )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    parse_content response.body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( content )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if content.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if content.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    pom_json = JSON.parse( content )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if pom_json.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    project = Project.new({:project_type =&gt; Project::A_TYPE_MAVEN2, :language =&gt; Product::A_LANGUAGE_JAVA })</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    pom_json[&#39;dependencies&#39;].each do |json_dep|</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="27">
          <span class="hits">27</span>
          
          <code class="ruby">      version     = json_dep[&#39;version&#39;]</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="28">
          <span class="hits">27</span>
          
          <code class="ruby">      name        = json_dep[&#39;name&#39;]</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="29">
          <span class="hits">27</span>
          
          <code class="ruby">      scope       = json_dep[&#39;scope&#39;]</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="30">
          <span class="hits">27</span>
          
          <code class="ruby">      scope       = &#39;compile&#39; if scope.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="31">
          <span class="hits">27</span>
          
          <code class="ruby">      spliti      = name.split(&#39;:&#39;)</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="32">
          <span class="hits">27</span>
          
          <code class="ruby">      group_id    = spliti[0].to_s.downcase</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="33">
          <span class="hits">27</span>
          
          <code class="ruby">      artifact_id = spliti[1].to_s.downcase</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="34">
          <span class="hits">27</span>
          
          <code class="ruby">      dependency  = init_dependency(name, group_id, artifact_id, version, scope)</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="35">
          <span class="hits">27</span>
          
          <code class="ruby">      product     = Product.find_by_group_and_artifact(dependency.group_id, dependency.artifact_id )</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="36">
          <span class="hits">27</span>
          
          <code class="ruby">      dependency.prod_key     = product.prod_key if product</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="37">
          <span class="hits">27</span>
          
          <code class="ruby">      project.unknown_number += 1 if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="38">
          <span class="hits">27</span>
          
          <code class="ruby">      project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="39">
          <span class="hits">27</span>
          
          <code class="ruby">      project.projectdependencies.push(dependency)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    project.dep_number = project.dependencies.size</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    project.name        = pom_json[&#39;name&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    project.group_id    = pom_json[&#39;group_id&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    project.artifact_id = pom_json[&#39;artifact_id&#39;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    project.allow_zero_deps = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_dependency name, group_id, artifact_id, version, scope</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="51">
          <span class="hits">27</span>
          
          <code class="ruby">    dependency             = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="52">
          <span class="hits">27</span>
          
          <code class="ruby">    dependency.language    = Product::A_LANGUAGE_JAVA</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="53">
          <span class="hits">27</span>
          
          <code class="ruby">    dependency.name        = name</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="54">
          <span class="hits">27</span>
          
          <code class="ruby">    dependency.group_id    = group_id</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="55">
          <span class="hits">27</span>
          
          <code class="ruby">    dependency.artifact_id = artifact_id</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="56">
          <span class="hits">27</span>
          
          <code class="ruby">    dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="57">
          <span class="hits">27</span>
          
          <code class="ruby">    dependency.version_label = version</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="58">
          <span class="hits">27</span>
          
          <code class="ruby">    dependency.scope       = scope</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="59">
          <span class="hits">27</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e5d3ca3821ff945a4bfbdb0bd7cac3cc8c4c8c9a">
  <div class="header">
    <h3>lib/versioneye/parsers/pom_parser.rb</h3>
    <h4><span class="green">94.06 %</span> covered</h4>
    <div>
      <b>101</b> relevant lines. 
      <span class="green"><b>95</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class PomParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # Parser for pom.xml file from Maven2/Maven3. Java.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # XPath: //project/dependencyManagement/dependencies/dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # XPath: //project/dependencies/dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse( url )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="10">
          <span class="hits">5</span>
          
          <code class="ruby">    response = self.fetch_response( url )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="11">
          <span class="hits">5</span>
          
          <code class="ruby">    parse_content response.body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( content )</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="19">
          <span class="hits">12</span>
          
          <code class="ruby">    return nil if content.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="20">
          <span class="hits">12</span>
          
          <code class="ruby">    return nil if content.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="22">
          <span class="hits">11</span>
          
          <code class="ruby">    doc        = fetch_xml( content )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="23">
          <span class="hits">11</span>
          
          <code class="ruby">    project    = init_project( doc )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="24">
          <span class="hits">11</span>
          
          <code class="ruby">    properties = fetch_properties( doc )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="25">
          <span class="hits">11</span>
          
          <code class="ruby">    doc.xpath(&#39;//dependencies/dependency&#39;).each do |node|</code>
        </li>
      
        <li class="covered" data-hits="82" data-linenumber="26">
          <span class="hits">82</span>
          
          <code class="ruby">      fetch_dependency(node, properties, project)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="28">
          <span class="hits">11</span>
          
          <code class="ruby">    doc.xpath(&#39;//plugins/plugin&#39;).each do |node|</code>
        </li>
      
        <li class="covered" data-hits="60" data-linenumber="29">
          <span class="hits">60</span>
          
          <code class="ruby">      dep = fetch_dependency(node, properties, project, &quot;plugin&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="31">
          <span class="hits">11</span>
          
          <code class="ruby">    project.dep_number = project.projectdependencies.size</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="32">
          <span class="hits">11</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_dependency(node, properties, project, scope = Dependency::A_SCOPE_COMPILE)</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="40">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="41">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency.language = Product::A_LANGUAGE_JAVA</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="42">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency.scope = scope</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="43">
          <span class="hits">142</span>
          
          <code class="ruby">    node.children.each do |child|</code>
        </li>
      
        <li class="covered" data-hits="1138" data-linenumber="44">
          <span class="hits">1138</span>
          
          <code class="ruby">      if child.name.casecmp(&#39;groupId&#39;) == 0</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="45">
          <span class="hits">140</span>
          
          <code class="ruby">        groupId_text = get_variable_value_from_pom(properties, child.text.strip)</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="46">
          <span class="hits">140</span>
          
          <code class="ruby">        dependency.group_id = groupId_text.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">      elsif child.name.casecmp(&#39;artifactId&#39;) == 0</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="48">
          <span class="hits">142</span>
          
          <code class="ruby">        artifactId_text = get_variable_value_from_pom(properties, child.text.strip)</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="49">
          <span class="hits">142</span>
          
          <code class="ruby">        dependency.artifact_id = artifactId_text.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">      elsif child.name.casecmp(&#39;version&#39;) == 0</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="51">
          <span class="hits">124</span>
          
          <code class="ruby">        version_text = get_variable_value_from_pom(properties, child.text.strip)</code>
        </li>
      
        <li class="covered" data-hits="124" data-linenumber="52">
          <span class="hits">124</span>
          
          <code class="ruby">        dependency.version_requested = version_text</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">      elsif child.name.casecmp(&#39;scope&#39;) == 0</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="54">
          <span class="hits">34</span>
          
          <code class="ruby">        scope_text = get_variable_value_from_pom(properties, child.text.strip)</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="55">
          <span class="hits">34</span>
          
          <code class="ruby">        dependency.scope = scope_text</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="58">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency.name = dependency.artifact_id</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="59">
          <span class="hits">142</span>
          
          <code class="ruby">    product = fetch_product dependency</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="60">
          <span class="hits">142</span>
          
          <code class="ruby">    parse_requested_version( dependency.version_requested, dependency, product )</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="61">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency.prod_key    = product.prod_key if product</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="62">
          <span class="hits">142</span>
          
          <code class="ruby">    project.unknown_number += 1 if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="63">
          <span class="hits">142</span>
          
          <code class="ruby">    project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="64">
          <span class="hits">142</span>
          
          <code class="ruby">    project.projectdependencies.push( dependency )</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="65">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_properties( doc )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="69">
          <span class="hits">11</span>
          
          <code class="ruby">    properties = Hash.new</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="70">
          <span class="hits">11</span>
          
          <code class="ruby">    doc.xpath(&#39;//project/properties&#39;).each do |node|</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="71">
          <span class="hits">14</span>
          
          <code class="ruby">      node.children.each do |child|</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="72">
          <span class="hits">62</span>
          
          <code class="ruby">        unless child.text.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="73">
          <span class="hits">24</span>
          
          <code class="ruby">          properties[child.name.downcase] = child.text.strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="77">
          <span class="hits">11</span>
          
          <code class="ruby">    project_version = doc.xpath(&#39;//project/version&#39;)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="78">
          <span class="hits">11</span>
          
          <code class="ruby">    if project_version</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="79">
          <span class="hits">11</span>
          
          <code class="ruby">      properties[&#39;project.version&#39;] = project_version.text.strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="81">
          <span class="hits">11</span>
          
          <code class="ruby">    properties</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_variable_value_from_pom( properties, val )</code>
        </li>
      
        <li class="covered" data-hits="445" data-linenumber="85">
          <span class="hits">445</span>
          
          <code class="ruby">    return val if !val.include?(&#39;${&#39;) || !val.include?(&#39;}&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="87">
          <span class="hits">27</span>
          
          <code class="ruby">    value = String.new val</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="88">
          <span class="hits">27</span>
          
          <code class="ruby">    val.scan(/\$\{([^\}]*)\}/xi).each do |match|</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="89">
          <span class="hits">27</span>
          
          <code class="ruby">      m_val = match[0]</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="90">
          <span class="hits">27</span>
          
          <code class="ruby">      replacement = properties[ m_val.downcase ]</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="91">
          <span class="hits">27</span>
          
          <code class="ruby">      next if replacement.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="93">
          <span class="hits">26</span>
          
          <code class="ruby">      value.gsub!(&quot;${#{ m_val }}&quot;, replacement)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="95">
          <span class="hits">27</span>
          
          <code class="ruby">    value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version_number, dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="99">
          <span class="hits">158</span>
          
          <code class="ruby">    if version_number.nil? || version_number.empty?</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="100">
          <span class="hits">18</span>
          
          <code class="ruby">      self.update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="101">
          <span class="hits">18</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="103">
          <span class="hits">140</span>
          
          <code class="ruby">    version = String.new(version_number)</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="104">
          <span class="hits">140</span>
          
          <code class="ruby">    version = version.to_s.strip</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="105">
          <span class="hits">140</span>
          
          <code class="ruby">    version = version.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="106">
          <span class="hits">140</span>
          
          <code class="ruby">    version = version.gsub(&quot;&#39;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="108">
          <span class="hits">140</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="117" data-linenumber="109">
          <span class="hits">117</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="117" data-linenumber="110">
          <span class="hits">117</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">    # TODO implement more cases</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="115">
          <span class="hits">23</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="116">
          <span class="hits">23</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="117">
          <span class="hits">23</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="122">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_project( doc )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="123">
          <span class="hits">11</span>
          
          <code class="ruby">    project              = Project.new</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="124">
          <span class="hits">11</span>
          
          <code class="ruby">    project.project_type = Project::A_TYPE_MAVEN2</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="125">
          <span class="hits">11</span>
          
          <code class="ruby">    project.language     = Product::A_LANGUAGE_JAVA</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="126">
          <span class="hits">11</span>
          
          <code class="ruby">    project.group_id     = doc.xpath(&#39;//project/groupId&#39;).text</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="127">
          <span class="hits">11</span>
          
          <code class="ruby">    project.artifact_id  = doc.xpath(&#39;//project/artifactId&#39;).text</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="128">
          <span class="hits">11</span>
          
          <code class="ruby">    project.name         = doc.xpath(&#39;//project/name&#39;).text</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="129">
          <span class="hits">11</span>
          
          <code class="ruby">    project.name         = doc.xpath(&#39;//project/artifactId&#39;).text if project.name.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="130">
          <span class="hits">11</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_xml( content )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="134">
          <span class="hits">11</span>
          
          <code class="ruby">    doc = Nokogiri::XML( content )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="135">
          <span class="hits">11</span>
          
          <code class="ruby">    return nil if doc.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="137">
          <span class="hits">11</span>
          
          <code class="ruby">    doc.remove_namespaces!</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="138">
          <span class="hits">11</span>
          
          <code class="ruby">    return nil if doc.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="140">
          <span class="hits">11</span>
          
          <code class="ruby">    doc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="143">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_product dependency</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="144">
          <span class="hits">142</span>
          
          <code class="ruby">    product = nil </code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="145">
          <span class="hits">142</span>
          
          <code class="ruby">    if dependency.group_id.to_s.empty? </code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="146">
          <span class="hits">2</span>
          
          <code class="ruby">      group_id = &#39;org.apache.maven.plugins&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="147">
          <span class="hits">2</span>
          
          <code class="ruby">      product = Product.find_by_group_and_artifact(group_id, dependency.artifact_id )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="148">
          <span class="hits">2</span>
          
          <code class="ruby">      dependency.group_id = group_id if product </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    else </code>
        </li>
      
        <li class="covered" data-hits="140" data-linenumber="150">
          <span class="hits">140</span>
          
          <code class="ruby">      product = Product.find_by_group_and_artifact(dependency.group_id, dependency.artifact_id )  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="152">
          <span class="hits">142</span>
          
          <code class="ruby">    product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="22c48755ea26765c55db3bda56cccde804a4512a">
  <div class="header">
    <h3>lib/versioneye/parsers/python_setup_parser.rb</h3>
    <h4><span class="yellow">89.09 %</span> covered</h4>
    <div>
      <b>55</b> relevant lines. 
      <span class="green"><b>49</b> lines covered</span> and
      <span class="red"><b>6</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/requirements_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class PythonSetupParser &lt; RequirementsParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse( url )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="6">
          <span class="hits">4</span>
          
          <code class="ruby">    response = fetch_response( url )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="7">
          <span class="hits">4</span>
          
          <code class="ruby">    parse_content( response.body )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content(doc)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="12">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if doc.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if doc.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="15">
          <span class="hits">4</span>
          
          <code class="ruby">    requirements = parse_requirements( doc )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    # extras       = parse_extras( doc )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="17">
          <span class="hits">4</span>
          
          <code class="ruby">    project      = Project.new({:project_type =&gt; Project::A_TYPE_PIP, :language =&gt; Product::A_LANGUAGE_PYTHON })</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="18">
          <span class="hits">4</span>
          
          <code class="ruby">    requirements.each do |requirement|</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="19">
          <span class="hits">20</span>
          
          <code class="ruby">      parse_line requirement, project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="21">
          <span class="hits">4</span>
          
          <code class="ruby">    project.dep_number = project.dependencies.size</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="22">
          <span class="hits">4</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_line requirement, project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    #requirement = requirement.to_s.strip.gsub(/\&quot;|\&#39;/, &#39;&#39;) #remove python&#39;s string literals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="29">
          <span class="hits">20</span>
          
          <code class="ruby">    return false if requirement.nil? or requirement.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="31">
          <span class="hits">20</span>
          
          <code class="ruby">    comparator = extract_comparator requirement</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="32">
          <span class="hits">20</span>
          
          <code class="ruby">    package, version = requirement.split comparator</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="33">
          <span class="hits">20</span>
          
          <code class="ruby">    version = version.to_s.strip</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="34">
          <span class="hits">20</span>
          
          <code class="ruby">    package = package.to_s.strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="36">
          <span class="hits">20</span>
          
          <code class="ruby">    product = Product.fetch_product(Product::A_LANGUAGE_PYTHON, package)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="38">
          <span class="hits">20</span>
          
          <code class="ruby">    if version.empty? &amp;&amp; !product.nil?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="39">
          <span class="hits">4</span>
          
          <code class="ruby">      version = product.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="42">
          <span class="hits">20</span>
          
          <code class="ruby">    comparator = &quot;==&quot; if comparator.nil?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="43">
          <span class="hits">20</span>
          
          <code class="ruby">    dependency = Projectdependency.new name: package.strip,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">                                       version_label: version,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">                                       comperator: comparator,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">                                       language: Product::A_LANGUAGE_PYTHON,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">                                       scope: Dependency::A_SCOPE_COMPILE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="49">
          <span class="hits">20</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">      project.unknown_number + 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="52">
          <span class="hits">19</span>
          
          <code class="ruby">      dependency.prod_key = product.prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="55">
          <span class="hits">20</span>
          
          <code class="ruby">    parse_requested_version(&quot;#{comparator}#{version}&quot;, dependency, product)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="57">
          <span class="hits">20</span>
          
          <code class="ruby">    if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">      project.out_number = project.out_number + 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="61">
          <span class="hits">20</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  def from_file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    doc_file = File.new &#39;test/files/setup.py&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    doc_file.read</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requirements(doc)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="72">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if doc.nil? or doc.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="73">
          <span class="hits">4</span>
          
          <code class="ruby">    req_text = slice_content doc, &#39;install_requires&#39;, &#39;[&#39;, &#39;]&#39;, false</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="74">
          <span class="hits">48</span>
          
          <code class="ruby">    req_text.split(/\&#39;|\&quot;/).keep_if {|item| item.strip.length &gt; 1}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_extras(doc)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    return nil if doc.nil? or doc.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    slice_content doc, &#39;extras_require&#39;, &#39;{&#39;, &#39;}&#39;, true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  #reads content between start_matcher and end_matcher</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def slice_content(doc, keyword, start_matcher, end_matcher, include_matchers = false)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="86">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if doc.nil? or doc.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="88">
          <span class="hits">4</span>
          
          <code class="ruby">    content_pos = doc.index keyword</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="89">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if content_pos.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="91">
          <span class="hits">4</span>
          
          <code class="ruby">    start_pos = doc.index start_matcher, content_pos</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="92">
          <span class="hits">4</span>
          
          <code class="ruby">    end_pos   =  doc.index end_matcher, content_pos</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="94">
          <span class="hits">4</span>
          
          <code class="ruby">    block_length = (end_pos - start_pos) + 1</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="95">
          <span class="hits">4</span>
          
          <code class="ruby">    if include_matchers</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">      req_txt = doc.slice start_pos, block_length</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="98">
          <span class="hits">4</span>
          
          <code class="ruby">      req_txt = doc.slice(start_pos + 1, block_length - 2)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">    #clean up</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="102">
          <span class="hits">4</span>
          
          <code class="ruby">    req_txt.gsub! /\#.*[^\n]$/, &quot; &quot; #remove python inline commens</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="103">
          <span class="hits">4</span>
          
          <code class="ruby">    req_txt.gsub! /\s+/, &quot; &quot; #remove redutant spacer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="105">
          <span class="hits">4</span>
          
          <code class="ruby">    req_txt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e87584721b5033c3b1861d811a02715fc28f6fe4">
  <div class="header">
    <h3>lib/versioneye/parsers/requirements_parser.rb</h3>
    <h4><span class="red">70.86 %</span> covered</h4>
    <div>
      <b>151</b> relevant lines. 
      <span class="green"><b>107</b> lines covered</span> and
      <span class="red"><b>44</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class RequirementsParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # Parser for requirements.txt files from pip. Python.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  # http://www.pip-installer.org/en/latest/requirements.html#the-requirements-file-format</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # http://www.pip-installer.org/en/latest/#requirements-files</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse( url )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="10">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if url.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="12">
          <span class="hits">4</span>
          
          <code class="ruby">    response = self.fetch_response(url)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    parse_content response.body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( txt )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="22">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if txt.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="23">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if txt.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="25">
          <span class="hits">4</span>
          
          <code class="ruby">    project = Project.new({:project_type =&gt; Project::A_TYPE_PIP, :language =&gt; Product::A_LANGUAGE_PYTHON })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="27">
          <span class="hits">4</span>
          
          <code class="ruby">    txt.each_line do |line|</code>
        </li>
      
        <li class="covered" data-hits="162" data-linenumber="28">
          <span class="hits">162</span>
          
          <code class="ruby">      parse_line line, project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="31">
          <span class="hits">4</span>
          
          <code class="ruby">    project.dep_number = project.dependencies.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="33">
          <span class="hits">4</span>
          
          <code class="ruby">    return project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_line( line, project )</code>
        </li>
      
        <li class="covered" data-hits="162" data-linenumber="42">
          <span class="hits">162</span>
          
          <code class="ruby">    return false if line.to_s.strip.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="44">
          <span class="hits">158</span>
          
          <code class="ruby">    sp = line.split(&quot;#&quot;) # Remove comments </code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="45">
          <span class="hits">158</span>
          
          <code class="ruby">    return false if sp.nil? || sp.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="47">
          <span class="hits">158</span>
          
          <code class="ruby">    line = sp.first</code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="48">
          <span class="hits">158</span>
          
          <code class="ruby">    return false if line.to_s.strip.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="154" data-linenumber="50">
          <span class="hits">154</span>
          
          <code class="ruby">    return false if line.match(/\A\-e /)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="52">
          <span class="hits">144</span>
          
          <code class="ruby">    comparator  = extract_comparator line</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="53">
          <span class="hits">144</span>
          
          <code class="ruby">    requirement = line.split(comparator)</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="54">
          <span class="hits">144</span>
          
          <code class="ruby">    package = requirement[0]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="56">
          <span class="hits">144</span>
          
          <code class="ruby">    return false if package.nil? || package.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="57">
          <span class="hits">144</span>
          
          <code class="ruby">    return false if package.match(/\Ahttp:\/\//)</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="58">
          <span class="hits">144</span>
          
          <code class="ruby">    return false if package.match(/\Ahttps:\/\//)</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="59">
          <span class="hits">142</span>
          
          <code class="ruby">    return false if package.match(/\A--/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="61">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency = init_dependency package, comparator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="63">
          <span class="hits">142</span>
          
          <code class="ruby">    version = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="64">
          <span class="hits">142</span>
          
          <code class="ruby">    if requirement.count &gt; 1</code>
        </li>
      
        <li class="covered" data-hits="138" data-linenumber="65">
          <span class="hits">138</span>
          
          <code class="ruby">      version = requirement[1]</code>
        </li>
      
        <li class="covered" data-hits="138" data-linenumber="66">
          <span class="hits">138</span>
          
          <code class="ruby">      dependency.version_label = version.strip</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="69">
          <span class="hits">142</span>
          
          <code class="ruby">    product = Product.fetch_product Product::A_LANGUAGE_PYTHON, package</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="70">
          <span class="hits">142</span>
          
          <code class="ruby">    if product</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="71">
          <span class="hits">6</span>
          
          <code class="ruby">      dependency.prod_key = product.prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="136" data-linenumber="73">
          <span class="hits">136</span>
          
          <code class="ruby">      project.unknown_number = project.unknown_number + 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="76">
          <span class="hits">142</span>
          
          <code class="ruby">    parse_requested_version(&quot;#{comparator}#{version}&quot;, dependency, product)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="78">
          <span class="hits">142</span>
          
          <code class="ruby">    if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="79">
          <span class="hits">3</span>
          
          <code class="ruby">      project.out_number = project.out_number + 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="81">
          <span class="hits">142</span>
          
          <code class="ruby">    project.projectdependencies.push dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">  # It is important that this method is not writing int the database!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version, dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="162" data-linenumber="88">
          <span class="hits">162</span>
          
          <code class="ruby">    if version.nil? || version.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="89">
          <span class="hits">4</span>
          
          <code class="ruby">      self.update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="90">
          <span class="hits">4</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="92">
          <span class="hits">158</span>
          
          <code class="ruby">    version = version.strip</code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="93">
          <span class="hits">158</span>
          
          <code class="ruby">    version = version.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="94">
          <span class="hits">158</span>
          
          <code class="ruby">    version = version.gsub(&quot;&#39;&quot;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="95">
          <span class="hits">158</span>
          
          <code class="ruby">    dependency.version_label = String.new(version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="158" data-linenumber="97">
          <span class="hits">158</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="134" data-linenumber="98">
          <span class="hits">134</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="134" data-linenumber="99">
          <span class="hits">134</span>
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="102">
          <span class="hits">24</span>
          
          <code class="ruby">    if version.match(/,/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">      # Version Ranges</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="104">
          <span class="hits">2</span>
          
          <code class="ruby">      version_splitted = version.split(&quot;,&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="105">
          <span class="hits">2</span>
          
          <code class="ruby">      prod = Product.new</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="106">
          <span class="hits">2</span>
          
          <code class="ruby">      prod.versions = product.versions</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="107">
          <span class="hits">2</span>
          
          <code class="ruby">      version_splitted.each do |verso|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="108">
          <span class="hits">4</span>
          
          <code class="ruby">        verso.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="109">
          <span class="hits">4</span>
          
          <code class="ruby">        if verso.match(/\A&gt;=/)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="110">
          <span class="hits">2</span>
          
          <code class="ruby">          verso.gsub!(&quot;&gt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="111">
          <span class="hits">2</span>
          
          <code class="ruby">          new_range = VersionService.greater_than_or_equal( product.versions, verso, true )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="112">
          <span class="hits">2</span>
          
          <code class="ruby">          prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">        elsif verso.match(/\A&gt;/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">          verso.gsub!(&quot;&gt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">          new_range = VersionService.greater_than( product.versions, verso, true )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">          prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">        elsif verso.match(/\A&lt;=/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">          verso.gsub!(&quot;&lt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">          new_range = VersionService.smaller_than_or_equal( product.versions, verso, true )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">          prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">        elsif verso.match(/\A&lt;/)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="122">
          <span class="hits">2</span>
          
          <code class="ruby">          verso.gsub!(&quot;&lt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="123">
          <span class="hits">2</span>
          
          <code class="ruby">          new_range = VersionService.smaller_than( product.versions, verso, true )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="124">
          <span class="hits">2</span>
          
          <code class="ruby">          prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">        elsif verso.match(/\A!=/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">          verso.gsub!(&quot;!=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">          new_range = VersionService.newest_but_not( product.versions, verso, true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">          prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="131">
          <span class="hits">2</span>
          
          <code class="ruby">      highest_version = VersionService.newest_version_from( prod.versions )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="132">
          <span class="hits">2</span>
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="133">
          <span class="hits">2</span>
          
          <code class="ruby">        dependency.version_requested = highest_version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">        dependency.version_requested = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="137">
          <span class="hits">2</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="140">
          <span class="hits">22</span>
          
          <code class="ruby">    elsif version.match(/.\*\z/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">      # WildCards. 1.0.* =&gt; 1.0.0 | 1.0.2 | 1.0.20</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">      ver = version.gsub(&quot;*&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">      ver = ver.gsub(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">      highest_version = VersionService.newest_version_from_wildcard( product.versions, ver, dependency.stability )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">      if highest_version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">        dependency.version_requested = highest_version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="148">
          
          
          <code class="ruby">        dependency.version_requested = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="150">
          
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="152">
          <span class="hits">22</span>
          
          <code class="ruby">    elsif version.empty? || version.match(/\A\*\z/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">      # This case is not allowed. But we handle it anyway. Because we are fucking awesome!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">      dependency.version_requested = VersionService.newest_version_number( product.versions, dependency.stability )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">      dependency.version_label = &quot;*&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="158">
          <span class="hits">22</span>
          
          <code class="ruby">    elsif version.match(/\A==/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">      # Equals</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="160">
          <span class="hits">19</span>
          
          <code class="ruby">      version.gsub!(&quot;==&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="161">
          <span class="hits">19</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="162">
          <span class="hits">19</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="163">
          <span class="hits">19</span>
          
          <code class="ruby">      dependency.comperator = &quot;==&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="165">
          <span class="hits">3</span>
          
          <code class="ruby">    elsif version.match(/\A!=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">      # Not equal to version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">      version.gsub!(&quot;!=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">      newest_version = VersionService.newest_but_not(product.versions, version)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="170">
          
          
          <code class="ruby">      dependency.version_requested = newest_version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">      dependency.comperator = &quot;!=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="173">
          <span class="hits">3</span>
          
          <code class="ruby">    elsif version.match(/\A&gt;=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">      # Greater than or equal to</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="175">
          <span class="hits">2</span>
          
          <code class="ruby">      version.gsub!(&quot;&gt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="176">
          <span class="hits">2</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="177">
          <span class="hits">2</span>
          
          <code class="ruby">      newest_version = VersionService.greater_than_or_equal(product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="178">
          <span class="hits">2</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="179">
          <span class="hits">2</span>
          
          <code class="ruby">      dependency.comperator = &quot;&gt;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="181">
          <span class="hits">1</span>
          
          <code class="ruby">    elsif version.match(/\A&gt;/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">      # Greater than version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">      version.gsub!(&quot;&gt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">      newest_version = VersionService.greater_than(product.versions, version)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="187">
          
          
          <code class="ruby">      dependency.comperator = &quot;&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="189">
          <span class="hits">1</span>
          
          <code class="ruby">    elsif version.match(/\A&lt;=/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">      # Less than or equal to</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot;&lt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="192">
          <span class="hits">1</span>
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="193">
          <span class="hits">1</span>
          
          <code class="ruby">      newest_version = VersionService.smaller_than_or_equal(product.versions, version)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="194">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="195">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.comperator = &quot;&lt;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="197">
          
          
          <code class="ruby">    elsif version.match(/\A\&lt;/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">      # Less than version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="199">
          
          
          <code class="ruby">      version.gsub!(&quot;&lt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">      version.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">      newest_version = VersionService.smaller_than(product.versions, version)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">      dependency.version_requested = newest_version.to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">      dependency.comperator = &quot;&lt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">      dependency.comperator = &quot;==&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="213">
          <span class="hits">1</span>
          
          <code class="ruby">  def init_dependency package, comparator</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="214">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="215">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency.name = package</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="216">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency.comperator = comparator</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="217">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency.scope = Dependency::A_SCOPE_COMPILE</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="218">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency.language = Product::A_LANGUAGE_PYTHON</code>
        </li>
      
        <li class="covered" data-hits="142" data-linenumber="219">
          <span class="hits">142</span>
          
          <code class="ruby">    dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="223">
          <span class="hits">1</span>
          
          <code class="ruby">  def extract_comparator line</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="224">
          <span class="hits">171</span>
          
          <code class="ruby">    comparator = nil</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="225">
          <span class="hits">171</span>
          
          <code class="ruby">    if line.match(/&gt;=/)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="226">
          <span class="hits">7</span>
          
          <code class="ruby">      comparator = &quot;&gt;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">    elsif line.match(/&gt;/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="228">
          <span class="hits">1</span>
          
          <code class="ruby">      comparator = &quot;&gt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby">    elsif line.match(/&lt;=/)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="230">
          <span class="hits">3</span>
          
          <code class="ruby">      comparator = &quot;&lt;=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">    elsif line.match(/&lt;/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="232">
          <span class="hits">1</span>
          
          <code class="ruby">      comparator = &quot;&lt;&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">    elsif line.match(/!=/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="234">
          <span class="hits">1</span>
          
          <code class="ruby">      comparator = &quot;!=&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">    elsif line.match(/==/)</code>
        </li>
      
        <li class="covered" data-hits="147" data-linenumber="236">
          <span class="hits">147</span>
          
          <code class="ruby">      comparator = &quot;==&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="238">
          <span class="hits">171</span>
          
          <code class="ruby">    comparator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="dde175fb037c3ddb9fc7bb8e4c3bfba9bf4c9134">
  <div class="header">
    <h3>lib/versioneye/parsers/sbt_parser.rb</h3>
    <h4><span class="green">91.21 %</span> covered</h4>
    <div>
      <b>91</b> relevant lines. 
      <span class="green"><b>83</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class SbtParser &lt; CommonParser</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # matches: val akkaVersion = &quot;2.3.11&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_VAL_MATCHER = /\s*val\s*(\S+)\s*=\s*\&quot;(\S+)\&quot;/xi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  # matches &quot;&lt;GROUP_ID&gt;&quot; %% &quot;&lt;ARTIFACT_ID&quot; % CONSTANT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEP_VAL_MATCHER = /\&quot;(\S+)\&quot;\s*\%+\s*\&quot;(\S+)\&quot;\s*\%+\s*(\S+)\s*[,\n]/xi </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  # matches &quot;&lt;GROUP_ID&gt;&quot; %% &quot;&lt;ARTIFACT_ID&quot; % &quot;VERSION&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEP_MATCHER = /\&quot;(\S+)\&quot;\s*\%+\s*\&quot;(\S+)\&quot;\s*\%+\s*\&quot;(\S+)\&quot;/xi  </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  # matches &quot;&lt;GROUP_ID&gt;&quot; %% &quot;&lt;ARTIFACT_ID&quot; % CONSTANT  % &quot;SCOPE&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  #         &quot;&lt;GROUP_ID&gt;&quot; %% &quot;&lt;ARTIFACT_ID&quot; % &quot;VERSION&quot; % &quot;SCOPE&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEP_SCOPE_MATCHER = /\&quot;(\S+)\&quot;\s*\%+\s*\&quot;(\S+)\&quot;\s*\%+\s*(\S+)\s*\%+\s*\&quot;(\S+)\&quot;/xi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  # matches </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  # A_DEP_SCOPE_MATCHER = /\&quot;(\S+)\&quot;\s*\%+\s*\&quot;(\S+)\&quot;\s*\%+\s*\&quot;(\S+)\&quot;\s*\%+\s*\&quot;(\S+)\&quot;/xi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse( url )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="23">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if url.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="25">
          <span class="hits">3</span>
          
          <code class="ruby">    content = self.fetch_response(url).body</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="26">
          <span class="hits">3</span>
          
          <code class="ruby">    parse_content( content )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_content( content )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="35">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if content.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if content.to_s.strip.eql?(&#39;Not Found&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="38">
          <span class="hits">3</span>
          
          <code class="ruby">    content = content.gsub(/\/\*.*?\*\//mxi, &quot;&quot;)              # remove comments /* */ </code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>
          
          <code class="ruby">    content = content.gsub(/\A\/\/.*$/xi, &quot;&quot;)                 # remove comments // </code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="40">
          <span class="hits">3</span>
          
          <code class="ruby">    content = content.gsub(/[^[https:][http:]]\/\/.*$/xi, &quot;&quot;) # remove comments // without http[s]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="42">
          <span class="hits">3</span>
          
          <code class="ruby">    vals = {}</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="43">
          <span class="hits">3</span>
          
          <code class="ruby">    val_matches = content.scan( A_VAL_MATCHER )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="44">
          <span class="hits">3</span>
          
          <code class="ruby">    content     = content.gsub( A_VAL_MATCHER, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="45">
          <span class="hits">3</span>
          
          <code class="ruby">    vals        = parse_vals(vals, val_matches)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="47">
          <span class="hits">3</span>
          
          <code class="ruby">    scope_matches = content.scan( A_DEP_SCOPE_MATCHER )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="48">
          <span class="hits">3</span>
          
          <code class="ruby">    content       = content.gsub( A_DEP_SCOPE_MATCHER, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="49">
          <span class="hits">3</span>
          
          <code class="ruby">    deps_scoped   = self.build_dependencies(scope_matches, vals)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="51">
          <span class="hits">3</span>
          
          <code class="ruby">    matches    = content.scan( A_DEP_MATCHER )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="52">
          <span class="hits">3</span>
          
          <code class="ruby">    content    = content.gsub( A_DEP_MATCHER, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="53">
          <span class="hits">3</span>
          
          <code class="ruby">    deps_short = self.build_dependencies(matches, vals)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="55">
          <span class="hits">3</span>
          
          <code class="ruby">    matches_c    = content.scan( A_DEP_VAL_MATCHER )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="56">
          <span class="hits">3</span>
          
          <code class="ruby">    content      = content.gsub( A_DEP_VAL_MATCHER, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="57">
          <span class="hits">3</span>
          
          <code class="ruby">    deps_short_c = self.build_dependencies(matches_c, vals)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="59">
          <span class="hits">3</span>
          
          <code class="ruby">    deps = {}</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="60">
          <span class="hits">3</span>
          
          <code class="ruby">    deps[:projectdependencies] = []</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="61">
          <span class="hits">3</span>
          
          <code class="ruby">    keys = {}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="63">
          <span class="hits">3</span>
          
          <code class="ruby">    fill_deps( deps_scoped, deps, keys )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="64">
          <span class="hits">3</span>
          
          <code class="ruby">    fill_deps( deps_short, deps, keys )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="65">
          <span class="hits">3</span>
          
          <code class="ruby">    fill_deps( deps_short_c, deps, keys )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="67">
          <span class="hits">3</span>
          
          <code class="ruby">    project              = Project.new deps</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="68">
          <span class="hits">3</span>
          
          <code class="ruby">    project.project_type = Project::A_TYPE_SBT</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="69">
          <span class="hits">3</span>
          
          <code class="ruby">    project.language     = Product::A_LANGUAGE_JAVA</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="70">
          <span class="hits">3</span>
          
          <code class="ruby">    project.dep_number   = project.dependencies.size</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="72">
          <span class="hits">3</span>
          
          <code class="ruby">    project.dependencies.each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="73">
          <span class="hits">80</span>
          
          <code class="ruby">      project.out_number     += 1 if ProjectdependencyService.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="74">
          <span class="hits">80</span>
          
          <code class="ruby">      project.unknown_number += 1 if dependency.product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="77">
          <span class="hits">3</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def fill_deps dependencies, deps, keys</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="86">
          <span class="hits">9</span>
          
          <code class="ruby">    return if dependencies.nil? || dependencies[:projectdependencies].nil? || dependencies[:projectdependencies].empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="88">
          <span class="hits">7</span>
          
          <code class="ruby">    dependencies[:projectdependencies].each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="89">
          <span class="hits">80</span>
          
          <code class="ruby">      key = &quot;#{dep.group_id}:#{dep.artifact_id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="90">
          <span class="hits">80</span>
          
          <code class="ruby">      deps[:projectdependencies] &lt;&lt; dep if keys[key].to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="91">
          <span class="hits">80</span>
          
          <code class="ruby">      keys[key] = dep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_vals( map, matches )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="97">
          <span class="hits">3</span>
          
          <code class="ruby">    matches.each do |row|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="98">
          <span class="hits">6</span>
          
          <code class="ruby">      map[row[0]] = row[1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="100">
          <span class="hits">3</span>
          
          <code class="ruby">    map </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">  def build_dependencies( matches, vals )</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="105">
          <span class="hits">9</span>
          
          <code class="ruby">    data = []</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="106">
          <span class="hits">9</span>
          
          <code class="ruby">    matches.each do |row|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="108">
          <span class="hits">80</span>
          
          <code class="ruby">      version = row[2]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="110">
          <span class="hits">80</span>
          
          <code class="ruby">      scope = row[3]</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="111">
          <span class="hits">80</span>
          
          <code class="ruby">      scope = &#39;compile&#39; if scope.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="113">
          <span class="hits">80</span>
          
          <code class="ruby">      dependency = Projectdependency.new({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">        :scope =&gt; scope,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">        :group_id =&gt; row[0],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">        :artifact_id =&gt; row[1],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">        :name =&gt; row[1],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">        :language =&gt; Product::A_LANGUAGE_JAVA,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">        :comperator =&gt; &#39;=&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">      })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="122">
          <span class="hits">80</span>
          
          <code class="ruby">      process_dep version, dependency, data, vals</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="125">
          <span class="hits">9</span>
          
          <code class="ruby">    {:projectdependencies =&gt; data}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="129">
          <span class="hits">1</span>
          
          <code class="ruby">  def process_dep version, dependency, data, vals</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="130">
          <span class="hits">80</span>
          
          <code class="ruby">    product = Product.find_by_group_and_artifact(dependency.group_id, dependency.artifact_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="132">
          <span class="hits">80</span>
          
          <code class="ruby">    dependency.prod_key = product.prod_key if product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="134">
          <span class="hits">80</span>
          
          <code class="ruby">    parse_requested_version( version, dependency, product, vals )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="136">
          <span class="hits">80</span>
          
          <code class="ruby">    dependency.stability = VersionTagRecognizer.stability_tag_for version</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="137">
          <span class="hits">80</span>
          
          <code class="ruby">    VersionTagRecognizer.remove_minimum_stability version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="139">
          <span class="hits">80</span>
          
          <code class="ruby">    data &lt;&lt; dependency</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="140">
          <span class="hits">80</span>
          
          <code class="ruby">    data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse_requested_version(version, dependency, product, vals)</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="145">
          <span class="hits">80</span>
          
          <code class="ruby">    if version.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">      self.update_requested_with_current(dependency, product)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="149">
          <span class="hits">80</span>
          
          <code class="ruby">    version = version.to_s.strip</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="150">
          <span class="hits">80</span>
          
          <code class="ruby">    version = version.gsub(/,\z/, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="151">
          <span class="hits">80</span>
          
          <code class="ruby">    version = version.gsub(&#39;&quot;&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="152">
          <span class="hits">80</span>
          
          <code class="ruby">    version = version.gsub(&quot;&#39;&quot;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="153">
          <span class="hits">80</span>
          
          <code class="ruby">    version = vals[version] if !vals[version].to_s.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="80" data-linenumber="155">
          <span class="hits">80</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="156">
          <span class="hits">77</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="157">
          <span class="hits">77</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="160">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_requested = version</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="161">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.comperator = &quot;=&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="162">
          <span class="hits">3</span>
          
          <code class="ruby">      dependency.version_label = version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5bd0c34ee50d67af59eebb5365f47bbf26d179bd">
  <div class="header">
    <h3>lib/versioneye/producers/common_producer.rb</h3>
    <h4><span class="yellow">84.62 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class CommonProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    queue   = channel.queue(&quot;common_purpose&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9ce03bb180842a21b9ebde87f35447384c16e225">
  <div class="header">
    <h3>lib/versioneye/producers/dependency_badge_producer.rb</h3>
    <h4><span class="yellow">84.62 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class DependencyBadgeProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    queue   = channel.queue(&quot;dependency_badge&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="cea85302e238fc64f2313a38e3c6d6d3a3cbbcdb">
  <div class="header">
    <h3>lib/versioneye/producers/git_repo_file_import_producer.rb</h3>
    <h4><span class="yellow">84.62 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class GitRepoFileImportProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="5">
          <span class="hits">4</span>
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="6">
          <span class="hits">4</span>
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="8">
          <span class="hits">4</span>
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="9">
          <span class="hits">4</span>
          
          <code class="ruby">    queue   = channel.queue(&quot;git_repo_file_import&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="11">
          <span class="hits">4</span>
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="13">
          <span class="hits">4</span>
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="14">
          <span class="hits">4</span>
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="15">
          <span class="hits">4</span>
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="17">
          <span class="hits">4</span>
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="92afb2ac2b69228409c500ff80deb03a05e55d65">
  <div class="header">
    <h3>lib/versioneye/producers/git_repo_import_producer.rb</h3>
    <h4><span class="red">15.38 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class GitRepoImportProducer  &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;git_repo_import&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="1a2a098df89aaadeca68a688356e7cd8d76c1722">
  <div class="header">
    <h3>lib/versioneye/producers/git_repos_import_producer.rb</h3>
    <h4><span class="red">15.38 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class GitReposImportProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;git_repos_import&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    log_msg = &quot; [x] Sent messag: &#39;#{msg}&#39; to queue: #{queue.name}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8b2c4799274c3c11c21d9b578764e956fc79d3a2">
  <div class="header">
    <h3>lib/versioneye/producers/language_daily_stats_producer.rb</h3>
    <h4><span class="red">15.38 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LanguageDailyStatsProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;language_daily_stats&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="7665c375e6802c2b5cc9f165ec996e041d68b7b9">
  <div class="header">
    <h3>lib/versioneye/producers/process_receipts_producer.rb</h3>
    <h4><span class="red">15.38 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProcessReceiptsProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;process_receipts&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d7057aae748271e96c1a247f66d75b4f540318c4">
  <div class="header">
    <h3>lib/versioneye/producers/producer.rb</h3>
    <h4><span class="red">76.92 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;bunny&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_connection</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="6">
          <span class="hits">12</span>
          
          <code class="ruby">    connection_url = &quot;amqp://#{Settings.instance.rabbitmq_addr}:#{Settings.instance.rabbitmq_port}&quot;</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="7">
          <span class="hits">12</span>
          
          <code class="ruby">    Bunny.new( connection_url )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.log</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def log</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="15">
          <span class="hits">12</span>
          
          <code class="ruby">    Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cache</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    Versioneye::Cache.instance.mc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def cache</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    Versioneye::Cache.instance.mc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0605095f2ffc99a4e014ccdc51f681125fd28581">
  <div class="header">
    <h3>lib/versioneye/producers/project_update_producer.rb</h3>
    <h4><span class="yellow">84.62 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectUpdateProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="4">
          <span class="hits">5</span>
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="5">
          <span class="hits">5</span>
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="7">
          <span class="hits">5</span>
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="8">
          <span class="hits">5</span>
          
          <code class="ruby">    queue   = channel.queue(&quot;project_update&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="10">
          <span class="hits">5</span>
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="12">
          <span class="hits">5</span>
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="13">
          <span class="hits">5</span>
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="14">
          <span class="hits">5</span>
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="16">
          <span class="hits">5</span>
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="97e95c4b38562b84324cf94a62ca232533f9832e">
  <div class="header">
    <h3>lib/versioneye/producers/send_notification_emails_producer.rb</h3>
    <h4><span class="red">15.38 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SendNotificationEmailsProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;send_notification_emails&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ef099a0fa570192b919614b0d9ba466c08a0ec2f">
  <div class="header">
    <h3>lib/versioneye/producers/sync_producer.rb</h3>
    <h4><span class="red">15.38 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SyncProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;sync_db&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    log_msg = &quot; [x] SyncProducer Sent #{msg}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="449fcacc6fef587831747f821a6c3573486f7f27">
  <div class="header">
    <h3>lib/versioneye/producers/update_index_producer.rb</h3>
    <h4><span class="red">15.38 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UpdateIndexProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;update_index&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a35868840e0ce2646fffaabd028a6bc1bb7d7200">
  <div class="header">
    <h3>lib/versioneye/producers/update_meta_data_producer.rb</h3>
    <h4><span class="red">15.38 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>2</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UpdateMetaDataProducer &lt; Producer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def initialize msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;update_meta_data&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    queue.publish(msg, :persistent =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log_msg = &quot; [x] Sent #{msg}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="25d98efada6fc761af2b08f0acab768f412d3b95">
  <div class="header">
    <h3>lib/versioneye/remote_api/me_client.rb</h3>
    <h4><span class="red">73.33 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class MeClient &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  A_API = &#39;https://www.versioneye.com/api&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_API_VERSION = &#39;/v2&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_API_ENDPOINT_PRODUCT = &#39;/me&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.show api_key</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if api_key.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    url = &quot;#{A_API}#{A_API_VERSION}#{A_API_ENDPOINT_PRODUCT}?api_key=#{api_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    json = fetch_json url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fetch_json url</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">      JSON.parse CommonParser.new.fetch_response_body( url )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">      err_msg = &quot;ERROR with #{url} .. #{e.message} &quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      p err_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      log.error err_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c43a76cdd611fe258f2ce58b489e976cc701c6a8">
  <div class="header">
    <h3>lib/versioneye/remote_api/product_client.rb</h3>
    <h4><span class="yellow">86.21 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines. 
      <span class="green"><b>25</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProductClient &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  A_API = &#39;https://www.versioneye.com/api&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_API_VERSION = &#39;/v2&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_API_ENDPOINT_PRODUCT = &#39;/products&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.show language, prod_key, version = nil</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="10">
          <span class="hits">169</span>
          
          <code class="ruby">    return nil if language.to_s.empty? || prod_key.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="12">
          <span class="hits">169</span>
          
          <code class="ruby">    encoded_language = encod_language language</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="13">
          <span class="hits">169</span>
          
          <code class="ruby">    encoded_prod_key = encode prod_key</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="14">
          <span class="hits">169</span>
          
          <code class="ruby">    url = &quot;#{A_API}#{A_API_VERSION}#{A_API_ENDPOINT_PRODUCT}/#{encoded_language}/#{encoded_prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="15">
          <span class="hits">169</span>
          
          <code class="ruby">    if version</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="16">
          <span class="hits">169</span>
          
          <code class="ruby">      url += &quot;?prod_version=#{version}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="18">
          <span class="hits">169</span>
          
          <code class="ruby">    json = fetch_json url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.versions language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="23">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if language.to_s.empty? || prod_key.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="25">
          <span class="hits">5</span>
          
          <code class="ruby">    encoded_language = encod_language language</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="26">
          <span class="hits">5</span>
          
          <code class="ruby">    encoded_prod_key = encode prod_key</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="27">
          <span class="hits">5</span>
          
          <code class="ruby">    url = &quot;#{A_API}#{A_API_VERSION}#{A_API_ENDPOINT_PRODUCT}/#{encoded_language}/#{encoded_prod_key}/versions&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="28">
          <span class="hits">5</span>
          
          <code class="ruby">    json = fetch_json url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fetch_json url</code>
        </li>
      
        <li class="covered" data-hits="174" data-linenumber="35">
          <span class="hits">174</span>
          
          <code class="ruby">      JSON.parse CommonParser.new.fetch_response_body( url )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">      err_msg = &quot;ERROR with #{url} .. #{e.message} &quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">      p err_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">      log.error err_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.encode value</code>
        </li>
      
        <li class="covered" data-hits="174" data-linenumber="44">
          <span class="hits">174</span>
          
          <code class="ruby">      value.gsub(&quot;/&quot;, &quot;:&quot;).gsub(&quot;.&quot;, &quot;~&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.encod_language language</code>
        </li>
      
        <li class="covered" data-hits="174" data-linenumber="48">
          <span class="hits">174</span>
          
          <code class="ruby">      language.gsub(&#39;.&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="63061edb23a391cb1afeebf41427286d1c6e9157">
  <div class="header">
    <h3>lib/versioneye/service.rb</h3>
    <h4><span class="green">96.88 %</span> covered</h4>
    <div>
      <b>128</b> relevant lines. 
      <span class="green"><b>124</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">module Versioneye</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">  class Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/log&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/cache&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/analytics_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/author_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/badge_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/badge_ref_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/bitbucket_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/stash_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/circle_element_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/dependency_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/git_hub_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/http_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/notification_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/newsletter_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/newest_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/product_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/project_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/project_import_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/project_update_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/project_batch_update_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/project_parse_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/projectdependency_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/receipt_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/statistic_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/submitted_url_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/user_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/admin_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/version_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/email_setting_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/reference_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/language_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/license_whitelist_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/license_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/lwl_pdf_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/sync_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/transfer_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/enterprise_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/project_collaborator_service&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services/scm_meta_data_service&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services_ext/bitbucket&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services_ext/stash&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services_ext/es_product&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services_ext/es_user&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services_ext/github&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services_ext/mongo_product&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services_ext/octokit_api&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services_ext/s3&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/services_ext/stripe_service&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/super_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/notification_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/feedback_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/newsletter_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/project_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/submitted_url_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/subscription_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/user_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/receipt_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/versioncomment_mailer&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/mailers/versioncommentreply_mailer&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/biicode_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/bower_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/common_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/composer_lock_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/composer_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/gemfile_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/gemfilelock_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/gradle_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/sbt_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/lein_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/package_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/parser_strategy&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/podfile_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/podfilelock_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/pom_json_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/pom_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/python_setup_parser&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/parsers/requirements_parser&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/updaters/update_strategy&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/updaters/common_updater&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/updaters/bitbucket_updater&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/updaters/github_updater&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/updaters/stash_updater&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/updaters/upload_updater&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/updaters/url_updater&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/remote_api/product_client&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/remote_api/me_client&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/migrations/versionlink_migration&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/migrations/product_migration&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/dependency_badge_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/git_repo_file_import_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/git_repos_import_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/git_repo_import_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/language_daily_stats_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/project_update_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/update_meta_data_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/update_index_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/send_notification_emails_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/process_receipts_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/common_producer.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/producers/sync_producer.rb&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/dependency_badge_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/git_repo_file_import_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/git_repos_import_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/git_repo_import_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/language_daily_stats_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/project_update_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/update_meta_data_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="122">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/update_index_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/send_notification_emails_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/process_receipts_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/common_worker.rb&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">    require &#39;versioneye/workers/sync_worker.rb&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.log</code>
        </li>
      
        <li class="covered" data-hits="150" data-linenumber="129">
          <span class="hits">150</span>
          
          <code class="ruby">      Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="132">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.logger</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">      Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="136">
          <span class="hits">1</span>
          
          <code class="ruby">    def log</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">      Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">    def logger</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">      Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.cache</code>
        </li>
      
        <li class="covered" data-hits="114" data-linenumber="145">
          <span class="hits">114</span>
          
          <code class="ruby">      Versioneye::Cache.instance.mc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">    def cache</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">      Versioneye::Cache.instance.mc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e4df02add37c24e49c4f793d1575e267138ea7df">
  <div class="header">
    <h3>lib/versioneye/services/admin_service.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>5</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class AdminService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_default_admin</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="4">
          <span class="hits">2</span>
          
          <code class="ruby">    admin = User.new({:username =&gt; &#39;admin&#39;, :fullname =&gt; &#39;admin&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">      :email =&gt; &#39;admin@admin.com&#39;, :password =&gt; &#39;admin&#39;, :terms =&gt; true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">      :datenerhebung =&gt; true })</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    admin[:admin] = true</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">    admin.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="3f83b7ead3f1f187d31697a3396095f253205294">
  <div class="header">
    <h3>lib/versioneye/services/analytics_service.rb</h3>
    <h4><span class="red">25.0 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>18</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class AnalyticsService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # this class provides business analytics services to find out which products our users really need</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.most_followed_products</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    Language.each do |lang|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">      most_followed_prods lang</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.most_followed_prods lang</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    puts &quot;Language #{lang.name}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    puts &#39;--------&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    Product.where({ :language =&gt; lang.name }).desc(:followers).limit(10).each do |p|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">      puts &quot;#{p.name} has #{p.followers} Followers - https://www.versioneye.com/#{p.language_esc}/#{p.to_param}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    puts &quot;\n\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.most_referenced_prods lang</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    puts &quot;Language #{lang.name}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    puts &#39;--------&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    Product.where({ :language =&gt; lang.name }).desc(:used_by_count).limit(10).each do |p|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      puts &quot;#{p.name} has #{p.used_by_count} References - https://www.versioneye.com/#{p.language_esc}/#{p.to_param}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    puts &quot;\n\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.most_used_dependencies_csv filename=&#39;most_used_dependencies.csv&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    # get all used dependencies and sort descending by count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    deps = used_dependencies.sort_by {|dep| -dep[&#39;value&#39;][&#39;count&#39;]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    # we map every record to csv format (csv is an array of records)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    csv = deps.map {|x| &quot;#{x[&#39;_id&#39;]}; #{x[&#39;value&#39;][&#39;count&#39;].to_int}&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    # open the file and write to it. (maybe don&#39;t join before writing but use csv.each or similar)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    File.open(filename, &#39;w&#39;) {|f| f.write(csv.join(&quot;\n&quot;))}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.used_dependencies</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    # we map all Projectdependencies to the language and prod_key the project depend upon</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    # key: &quot;&lt;language&gt;; &lt;prod_key&gt;&quot; (this is already csv format, maybe improve and make array or hash)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    # val: count=1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    map = %Q{</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">      function() {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">        emit(this.language + &quot;; &quot; + this.prod_key , { count: 1 });</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    # and then reduce by adding up all the counts for each key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    # result: count = how often is on product used in projects</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    reduce = %Q{</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">      function(key, values) {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">        var result = { count: 0 };</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">        values.forEach(function(value) {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">          result.count += value.count;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">        });</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">        return result;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    Projectdependency.all.map_reduce(map, reduce).out(inline: true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9d3d9b7319d56df873564d203bf58576c0bf456b">
  <div class="header">
    <h3>lib/versioneye/services/author_service.rb</h3>
    <h4><span class="green">98.0 %</span> covered</h4>
    <div>
      <b>50</b> relevant lines. 
      <span class="green"><b>49</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class AuthorService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_authors language</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="5">
          <span class="hits">3</span>
          
          <code class="ruby">    Developer.where(:language =&gt; language).any_of({:to_author =&gt; false}, {:to_author =&gt; nil}).each do |dev|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">      dev_to_author dev</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.dev_to_author dev</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="12">
          <span class="hits">8</span>
          
          <code class="ruby">    product = dev.product</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="13">
          <span class="hits">8</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">      log.error &quot;ERROR - developer #{dev.ids} without product!&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="18">
          <span class="hits">7</span>
          
          <code class="ruby">    author = fetch_author dev</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="19">
          <span class="hits">7</span>
          
          <code class="ruby">    if author.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">      log.error &quot; -- ERROR - could not fetch author for #{dev.ids} - #{dev.email}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="24">
          <span class="hits">6</span>
          
          <code class="ruby">    author.update_from dev</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="25">
          <span class="hits">6</span>
          
          <code class="ruby">    author.add_product product.ids, dev.language, dev.prod_key</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="26">
          <span class="hits">6</span>
          
          <code class="ruby">    if author.save</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="27">
          <span class="hits">6</span>
          
          <code class="ruby">      dev.update_attributes :to_author =&gt; true</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="28">
          <span class="hits">6</span>
          
          <code class="ruby">      log.info &quot;dev to author - #{author.name_id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="29">
          <span class="hits">6</span>
          
          <code class="ruby">      return author</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">      log.error &quot;ERROR - #{author.errors.full_messages.to_sentence}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_maintainers</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">    User.all.each do |user|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">      update_maintainer user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_maintainer user</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">    return if user.deleted_user == true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">    authors = Author.where(:emails =&gt; user.email)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">    return if authors.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="49">
          <span class="hits">2</span>
          
          <code class="ruby">    authors.each do |author|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">      author.products.each do |product|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">        if user.add_maintainer(product)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="52">
          <span class="hits">2</span>
          
          <code class="ruby">          p &quot;#{user.username} can edit #{product}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">    user.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.invite_users_to_edit</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    User.all.each do |user|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">      invite_user_to_edit user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.invite_user_to_edit user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    return if user.deleted_user == true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    authors = Author.where(:emails =&gt; user.email)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">    return if authors.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">    p &quot;invite user #{user.username} to edit&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">    UserMailer.invited_user_author( user, authors ).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_author dev</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="78">
          <span class="hits">11</span>
          
          <code class="ruby">    if dev.name.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="79">
          <span class="hits">4</span>
          
          <code class="ruby">      author = Author.where( :email =&gt; dev.email ).first</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="80">
          <span class="hits">4</span>
          
          <code class="ruby">      author = Author.where( :emails =&gt; dev.email ).first if author.nil?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="81">
          <span class="hits">4</span>
          
          <code class="ruby">      return author</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="83">
          <span class="hits">7</span>
          
          <code class="ruby">    name_id = Author.encode_name( dev.name )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="84">
          <span class="hits">7</span>
          
          <code class="ruby">    author = Author.where( :name_id =&gt; name_id ).first</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="85">
          <span class="hits">7</span>
          
          <code class="ruby">    author = Author.new({:name_id =&gt; name_id, :name =&gt; dev.name}) if author.nil?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="86">
          <span class="hits">7</span>
          
          <code class="ruby">    author</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="83b090d0db6e7ac415e577269b2823d4f20ae8ba">
  <div class="header">
    <h3>lib/versioneye/services/badge_ref_service.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class BadgeRefService &lt; BadgeService</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update( key )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    update_product_badge( key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_product_badge( key )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    badge = Badge.find_or_create_by( key: key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    splits = key.split(&quot;:::&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    language = splits[0]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    prod_key = splits[1]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">    version  = splits[2]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">    reference = ReferenceService.find_by language, prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">    if reference &amp;&amp; reference.ref_count &gt; 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.status       = reference.ref_count</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.badge_source = Badge::A_SOURCE_PRODUCT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.badge_type   = Badge::A_TYPE_REFERENCE</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.svg          = fetch_svg( badge )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">      cache.set( key, badge, A_TTL_24H )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">      return badge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    badge.status       = Badge::A_REF_0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    badge.svg          = Badge::A_REF_0_SVG</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    badge.badge_source = Badge::A_SOURCE_PRODUCT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    badge.badge_type   = Badge::A_TYPE_REFERENCE</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    badge.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    cache.set( key, badge, A_TTL_24H )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    return badge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_svg badge</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    return Badge::A_REF_0_SVG     if badge.status.eql?(Badge::A_REF_0_SVG)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    return Badge::A_REF_TEMPLATE_SVG.gsub(&quot;TMP&quot;, badge.status)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="cd06526fd9398de7d4ada659cf7d58b6a832e5e3">
  <div class="header">
    <h3>lib/versioneye/services/badge_service.rb</h3>
    <h4><span class="green">97.5 %</span> covered</h4>
    <div>
      <b>80</b> relevant lines. 
      <span class="green"><b>78</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class BadgeService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TTL_24H = 86400 # 24 hours</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TTL_12H = 43200 # 12 hours</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TTL_6H  = 21600 # 6 hours</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.badge_for( key )</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="10">
          <span class="hits">16</span>
          
          <code class="ruby">    badge = cache.get key</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="11">
          <span class="hits">16</span>
          
          <code class="ruby">    return badge if badge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="13">
          <span class="hits">15</span>
          
          <code class="ruby">    badge = Badge.where(:key =&gt; key).first</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="14">
          <span class="hits">15</span>
          
          <code class="ruby">    if badge</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="15">
          <span class="hits">4</span>
          
          <code class="ruby">      DependencyBadgeProducer.new(key) if badge.updated_at &lt; 1.day.ago</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="17">
          <span class="hits">11</span>
          
          <code class="ruby">      badge = update( key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="19">
          <span class="hits">15</span>
          
          <code class="ruby">    badge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    logger.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    Badge.new({:status =&gt; Badge::A_UP_TO_DATE})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update( key )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="27">
          <span class="hits">10</span>
          
          <code class="ruby">    if key.to_s.split(&quot;:::&quot;).size &gt; 1</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="28">
          <span class="hits">5</span>
          
          <code class="ruby">      update_product_badge( key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="30">
          <span class="hits">5</span>
          
          <code class="ruby">      update_project_badge( key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_project_badge( key )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="36">
          <span class="hits">5</span>
          
          <code class="ruby">    badge = Badge.find_or_create_by( key: key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="38">
          <span class="hits">5</span>
          
          <code class="ruby">    project = Project.find_by_id key.to_s</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="39">
          <span class="hits">5</span>
          
          <code class="ruby">    if project.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.status = Badge::A_UNKNOWN</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.svg    = fetch_svg( badge )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.badge_source = Badge::A_SOURCE_PROJECT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.badge_type   = Badge::A_TYPE_DEPENDENCY</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">      cache.set( key, badge, A_TTL_24H )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">      return badge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="49">
          <span class="hits">4</span>
          
          <code class="ruby">    outdated = ProjectService.outdated?( project )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="50">
          <span class="hits">4</span>
          
          <code class="ruby">    insecure = ProjectService.insecure?( project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="52">
          <span class="hits">4</span>
          
          <code class="ruby">    badge.status     = Badge::A_OUT_OF_DATE if outdated == true</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="53">
          <span class="hits">4</span>
          
          <code class="ruby">    badge.status     = Badge::A_UP_TO_DATE  if outdated == false</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="54">
          <span class="hits">4</span>
          
          <code class="ruby">    badge.status     = Badge::A_UPDATE      if insecure == true</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="55">
          <span class="hits">4</span>
          
          <code class="ruby">    badge_source     = Badge::A_SOURCE_PROJECT</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="56">
          <span class="hits">4</span>
          
          <code class="ruby">    badge.badge_type = Badge::A_TYPE_DEPENDENCY</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="57">
          <span class="hits">4</span>
          
          <code class="ruby">    badge.svg        = fetch_svg( badge )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="58">
          <span class="hits">4</span>
          
          <code class="ruby">    badge.save</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="59">
          <span class="hits">4</span>
          
          <code class="ruby">    cache.set( key, badge, A_TTL_6H )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="60">
          <span class="hits">4</span>
          
          <code class="ruby">    badge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_product_badge( key )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="65">
          <span class="hits">5</span>
          
          <code class="ruby">    badge = Badge.find_or_create_by( key: key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="67">
          <span class="hits">5</span>
          
          <code class="ruby">    splits = key.split(&quot;:::&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="68">
          <span class="hits">5</span>
          
          <code class="ruby">    language = splits[0]</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="69">
          <span class="hits">5</span>
          
          <code class="ruby">    prod_key = splits[1]</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="70">
          <span class="hits">5</span>
          
          <code class="ruby">    version  = splits[2]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="72">
          <span class="hits">5</span>
          
          <code class="ruby">    product = Product.fetch_product language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="73">
          <span class="hits">5</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.status       = Badge::A_UNKNOWN</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.badge_source = Badge::A_SOURCE_PRODUCT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.badge_type   = Badge::A_TYPE_DEPENDENCY</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.svg          = fetch_svg( badge )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">      cache.set( key, badge, A_TTL_24H )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">      return badge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="83">
          <span class="hits">4</span>
          
          <code class="ruby">    product.version = version if version</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="84">
          <span class="hits">4</span>
          
          <code class="ruby">    dependencies    = product.dependencies</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="85">
          <span class="hits">4</span>
          
          <code class="ruby">    if dependencies.nil? || dependencies.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.status       = Badge::A_NONE</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.badge_source = Badge::A_SOURCE_PRODUCT</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.badge_type   = Badge::A_TYPE_DEPENDENCY</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.svg          = fetch_svg( badge )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">      badge.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">      cache.set( key, badge, A_TTL_24H )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">      return badge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="95">
          <span class="hits">3</span>
          
          <code class="ruby">    outdated = DependencyService.dependencies_outdated?( dependencies, false )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="96">
          <span class="hits">3</span>
          
          <code class="ruby">    badge.status       = Badge::A_OUT_OF_DATE if outdated == true</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="97">
          <span class="hits">3</span>
          
          <code class="ruby">    badge.status       = Badge::A_UP_TO_DATE  if outdated == false</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="98">
          <span class="hits">3</span>
          
          <code class="ruby">    badge.badge_source = Badge::A_SOURCE_PRODUCT</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="99">
          <span class="hits">3</span>
          
          <code class="ruby">    badge.badge_type   = Badge::A_TYPE_DEPENDENCY</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="100">
          <span class="hits">3</span>
          
          <code class="ruby">    badge.svg          = fetch_svg( badge )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="101">
          <span class="hits">3</span>
          
          <code class="ruby">    badge.save</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="102">
          <span class="hits">3</span>
          
          <code class="ruby">    cache.set( key, badge, A_TTL_12H )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="103">
          <span class="hits">3</span>
          
          <code class="ruby">    badge</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_svg badge</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="108">
          <span class="hits">10</span>
          
          <code class="ruby">    return Badge::A_UPTODATE_SVG  if badge.status.eql?(Badge::A_UP_TO_DATE)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="109">
          <span class="hits">7</span>
          
          <code class="ruby">    return Badge::A_OUTOFDATE_SVG if badge.status.eql?(Badge::A_OUT_OF_DATE)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="110">
          <span class="hits">3</span>
          
          <code class="ruby">    return Badge::A_UPDATE_SVG    if badge.status.eql?(Badge::A_UPDATE)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="111">
          <span class="hits">3</span>
          
          <code class="ruby">    return Badge::A_NONE_SVG      if badge.status.eql?(Badge::A_NONE)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="112">
          <span class="hits">2</span>
          
          <code class="ruby">    return Badge::A_UNKNOWN_SVG   if badge.status.eql?(Badge::A_UNKNOWN)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="01a736e8c7eac96ef0660340c5fdcd6c788c4361">
  <div class="header">
    <h3>lib/versioneye/services/bitbucket_service.rb</h3>
    <h4><span class="red">45.24 %</span> covered</h4>
    <div>
      <b>84</b> relevant lines. 
      <span class="green"><b>38</b> lines covered</span> and
      <span class="red"><b>46</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;benchmark&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;dalli&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class BitbucketService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_NIL     = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_RUNNING = &#39;running&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_DONE    = &#39;done&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_TTL     = 600 # 600 seconds = 10 minutes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_repo_info(user, repo_fullname)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    current_repo = user.bitbucket_repos.where(fullname: repo_fullname).shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    if current_repo.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      log.error &quot;User #{user[:username]} has no such repo `#{repo_fullname}`&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    token  = user[:bitbucket_token]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    secret = user[:bitbucket_secret]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    repo = Bitbucket.update_branches      current_repo, token, secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    repo = Bitbucket.update_project_files current_repo, token, secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    repo.save</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cached_user_repos user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    user_task_key = &quot;#{user[:username]}-bitbucket&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    task_status = cache.get(user_task_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    if task_status == A_TASK_RUNNING || task_status == A_TASK_DONE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      log.debug &quot;Status for importing repos for #{user[:username]} from bitbucket =&gt; #{task_status}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      return task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    if user[:bitbucket_token] and user.bitbucket_repos.all.count == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">      task_status =  A_TASK_RUNNING</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      cache.set( user_task_key, task_status, A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">      GitReposImportProducer.new(&quot;bitbucket:::#{user.id.to_s}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      log.info &quot;Nothing to import - maybe clean user&#39;s repo?&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">      task_status = A_TASK_DONE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">    task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.status_for user, current_repo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    return A_TASK_DONE if current_repo.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    repo_task_key = &quot;bitbucket:::#{user.id.to_s}:::#{current_repo.id.to_s}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    task_status   = cache.get( repo_task_key )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    if task_status == A_TASK_RUNNING || task_status == A_TASK_DONE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">      repo_fullname = current_repo.fullname</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">      log.debug &quot;Status for importing branches and project files from `#{repo_fullname}.`: #{task_status}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">      return task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    if current_repo and ( current_repo.branches.nil? || current_repo.branches.empty? )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">      GitRepoImportProducer.new( repo_task_key )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">      task_status = A_TASK_RUNNING</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">      cache.set( repo_task_key, task_status, A_TASK_TTL )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">      log.info &#39;Nothing is changed - skipping update.&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">      task_status = A_TASK_DONE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cache_user_all_repos(user)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    puts &quot;Going to cache users repositories.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">    cache_repos( user, user[:bitbucket_id] )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    user_orgs = Bitbucket.user_orgs(user)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    user_orgs.each do |org|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">      self.cache_repos( user, org )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">    # Import missing invited repos</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">    cache_invited_repos(user)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cache_repos(user, owner_name)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="91">
          <span class="hits">2</span>
          
          <code class="ruby">    token  = user[:bitbucket_token]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="92">
          <span class="hits">2</span>
          
          <code class="ruby">    secret = user[:bitbucket_secret]</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="93">
          <span class="hits">2</span>
          
          <code class="ruby">    repos  = Bitbucket.read_repos(owner_name, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="94">
          <span class="hits">2</span>
          
          <code class="ruby">    persist user, repos</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="95">
          <span class="hits">2</span>
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cache_invited_repos( user )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">    token  = user[:bitbucket_token]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">    secret = user[:bitbucket_secret]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">    repos  = Bitbucket.read_repos_v1( token, secret )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">    if repos.nil? or repos.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">      log.error &quot;cache_invited_repos | didnt get any repos from APIv1.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">    user.reload</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    existing_repo_fullnames  = Set.new user.bitbucket_repos.map(&amp;:fullname)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="110">
          <span class="hits">5</span>
          
          <code class="ruby">    missing_repos = repos.keep_if {|repo| existing_repo_fullnames.include?(repo[:full_name]) == false}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>
          
          <code class="ruby">    invited_repos = missing_repos.delete_if do |repo|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">      # Remove other people forks</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">      repo.has_key?(:fork_of) and repo[:fork_of].is_a?(Hash) and repo[:fork_of][:owner] == user[:bitbucket_id]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">    # Add missing repos</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">    searched_repos = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">    invited_repos.each do |old_repo|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">      repo = Bitbucket.repo_info(old_repo[:full_name], token, secret) #fetch repo info from api2</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">      if repo.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">        log.error &quot;cache_invited_repos | didnt get repo info for `#{old_repo[:full_name]}`&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">      searched_repos &lt;&lt; repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">    persist user, searched_repos</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="127">
          <span class="hits">1</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="131">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.persist user, repos</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="132">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if repos.nil? || repos.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="134">
          <span class="hits">3</span>
          
          <code class="ruby">    repos.each do |repo|</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="135">
          <span class="hits">7</span>
          
          <code class="ruby">      BitbucketRepo.build_or_update user, repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="db23610fcc2f6aad9e36f486f439287afc11413c">
  <div class="header">
    <h3>lib/versioneye/services/circle_element_service.rb</h3>
    <h4><span class="red">43.62 %</span> covered</h4>
    <div>
      <b>94</b> relevant lines. 
      <span class="green"><b>41</b> lines covered</span> and
      <span class="red"><b>53</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class CircleElementService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # TODO refactor usage</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.dependency_circle(lang, prod_key, version, scope)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">    if scope.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="7">
          <span class="hits">3</span>
          
          <code class="ruby">      scope = Dependency.main_scope( lang )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="9">
          <span class="hits">3</span>
          
          <code class="ruby">    hash = Hash.new</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>
          
          <code class="ruby">    dependencies = Array.new</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>
          
          <code class="ruby">    if scope.eql?(&#39;all&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">      dependencies = Dependency.find_by_lang_key_and_version( lang, prod_key, version )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="14">
          <span class="hits">3</span>
          
          <code class="ruby">      dependencies = Dependency.find_by_lang_key_version_scope( lang, prod_key, version, scope )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="16">
          <span class="hits">3</span>
          
          <code class="ruby">    dependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">      next if dep.name.nil? || dep.name.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">      DependencyService.update_parsed_version( dep ) if dep.parsed_version.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">      element = CircleElement.new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">      element.init_arrays</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      element.dep_prod_key = dep.dep_prod_key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      element.version      = dep.parsed_version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">      element.level        = 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">      self.attach_label_to_element(element, dep)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">      hash[dep.dep_prod_key] = element</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="27">
          <span class="hits">3</span>
          
          <code class="ruby">    return self.fetch_deps(1, hash, Hash.new, lang)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_deps(deep, hash, parent_hash, lang)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="35">
          <span class="hits">4</span>
          
          <code class="ruby">    return hash if hash.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">    new_hash = Hash.new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    hash.each do |prod_key, element|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">      product = Product.find_by_lang_key( lang, prod_key )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">      if product.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">      valid_version = ( element.version &amp;&amp; !element.version.eql?(&quot;&quot;) &amp;&amp; !element.version.eql?(&quot;0&quot;) &amp;&amp; product.version_by_number( element.version ) )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">      product.version = element.version if valid_version</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">      dependencies = product.dependencies(nil)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">      dependencies.each do |dep|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">        if dep.name.nil? || dep.name.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">          next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">        DependencyService.update_parsed_version( dep ) if dep.parsed_version.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">        key = dep.dep_prod_key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">        ele = self.get_element_from_hash(new_hash, hash, parent_hash, key)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">        if ele</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">          ele.connections &lt;&lt; &quot;#{element.dep_prod_key}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">          new_element = CircleElement.new</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">          new_element.init_arrays</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">          new_element.dep_prod_key   = dep.dep_prod_key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">          new_element.level          = deep</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">          attach_label_to_element(new_element, dep)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">          new_element.connections    &lt;&lt; &quot;#{element.dep_prod_key}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">          new_element.version        = dep.parsed_version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">          new_hash[dep.dep_prod_key] = new_element</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">        element.connections  &lt;&lt; &quot;#{key}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">        element.dependencies &lt;&lt; &quot;#{key}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">    parent_merged = hash.merge(parent_hash)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    deep += 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">    rec_hash = self.fetch_deps(deep, new_hash, parent_merged, lang)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    merged_hash = parent_merged.merge(rec_hash)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">    return merged_hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.generate_json_for_circle_from_hash(circle)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    resp = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    circle.each do |key, dep|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">      resp += &quot;{&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">      resp += &quot;\&quot;connections\&quot;: [#{dep.connections_as_string}],&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">      resp += &quot;\&quot;dependencies\&quot;: [#{dep.dependencies_as_string}],&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">      resp += &quot;\&quot;text\&quot;: \&quot;#{dep.text}\&quot;,&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">      resp += &quot;\&quot;id\&quot;: \&quot;#{dep.dep_prod_key}\&quot;,&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">      resp += &quot;\&quot;version\&quot;: \&quot;#{dep.version}\&quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">      resp += &quot;},&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    end_point = resp.length - 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">    resp = resp[0..end_point]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">    resp</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.generate_json_for_circle_from_array(circle)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">    resp = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">    circle.each do |element|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">      resp += &quot;{&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">      resp += &quot;\&quot;connections\&quot;: [#{element.connections_string}],&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">      resp += &quot;\&quot;dependencies\&quot;: [#{element.dependencies_string}],&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      resp += &quot;\&quot;text\&quot;: \&quot;#{element.text}\&quot;,&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">      resp += &quot;\&quot;id\&quot;: \&quot;#{element.dep_prod_key}\&quot;,&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">      resp += &quot;\&quot;version\&quot;: \&quot;#{element.version}\&quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">      resp += &quot;},&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">    end_point = resp.length - 2</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">    resp = resp[0..end_point]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">    resp</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.attach_label_to_element(element, dep)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="116">
          <span class="hits">3</span>
          
          <code class="ruby">      return nil if !element or !dep</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="117">
          <span class="hits">2</span>
          
          <code class="ruby">      element.text = &quot;#{dep.name}:#{dep.version}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.get_element_from_hash(new_hash, hash, parent_hash, key)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">      element = new_hash[key]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">      return element if !element.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">      element = hash[key]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">      return element if !element.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">      element = parent_hash[key]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">      return element</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8d6c58693e33c375534ca6ea347f9a0aca97f28d">
  <div class="header">
    <h3>lib/versioneye/services/dependency_service.rb</h3>
    <h4><span class="red">65.09 %</span> covered</h4>
    <div>
      <b>106</b> relevant lines. 
      <span class="green"><b>69</b> lines covered</span> and
      <span class="red"><b>37</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class DependencyService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DAY = 86400 # 86400 seconds = 24 hours</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  A_FIVE_DAYS = 432000</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEPENDENCY_TTL = 432000</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.dependencies_outdated?( dependencies, cached = false )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="9">
          <span class="hits">5</span>
          
          <code class="ruby">    return false if dependencies.nil? || dependencies.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="11">
          <span class="hits">5</span>
          
          <code class="ruby">    dependencies.each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="12">
          <span class="hits">11</span>
          
          <code class="ruby">      outdated = out_of_date?( dependency, cached )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="13">
          <span class="hits">11</span>
          
          <code class="ruby">      return true if outdated == true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.out_of_date?( dependency, cached = true )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="20">
          <span class="hits">11</span>
          
          <code class="ruby">    return self.cache_outdated?( dependency ) if cached == true</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="21">
          <span class="hits">11</span>
          
          <code class="ruby">    return self.outdated?( dependency )       if cached == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cache_outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    key = &quot;#{dependency.id.to_s}_outdated?&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    outdated = cache.get( key )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    return outdated if !outdated.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">    outdated = self.outdated?( dependency )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    cache.set( key, outdated, A_DEPENDENCY_TTL )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    outdated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.outdated?( dependency, update_newest_version = true )</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="41">
          <span class="hits">25</span>
          
          <code class="ruby">    product = dependency.product</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="42">
          <span class="hits">25</span>
          
          <code class="ruby">    return false if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="44">
          <span class="hits">18</span>
          
          <code class="ruby">    if product.versions.nil? || product.versions.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">      dependency.outdated = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">      dependency.current_version = &#39;0.0.0+NA&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">      dependency.save</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="51">
          <span class="hits">18</span>
          
          <code class="ruby">    newest_product_version = product.version</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="52">
          <span class="hits">18</span>
          
          <code class="ruby">    if update_newest_version</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="53">
          <span class="hits">18</span>
          
          <code class="ruby">      newest_product_version = VersionService.newest_version_number( product.versions )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="55">
          <span class="hits">18</span>
          
          <code class="ruby">    dependency.current_version = newest_product_version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="57">
          <span class="hits">18</span>
          
          <code class="ruby">    soft_outdated?( dependency, product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.soft_outdated?( dependency, product = nil )</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="66">
          <span class="hits">20</span>
          
          <code class="ruby">    product = dependency.product if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="67">
          <span class="hits">20</span>
          
          <code class="ruby">    newest_product_version = dependency.current_version</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="68">
          <span class="hits">20</span>
          
          <code class="ruby">    self.update_parsed_version( dependency, product )</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="69">
          <span class="hits">20</span>
          
          <code class="ruby">    parsed_version = dependency.parsed_version</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="70">
          <span class="hits">20</span>
          
          <code class="ruby">    if newest_product_version.eql?(parsed_version) || VersionService.equal(newest_product_version, parsed_version)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="71">
          <span class="hits">13</span>
          
          <code class="ruby">      dependency.outdated = false</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="72">
          <span class="hits">13</span>
          
          <code class="ruby">      dependency.save</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="73">
          <span class="hits">13</span>
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    # This is for the case that the parsed version is higher than our newest version in the database!</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="77">
          <span class="hits">7</span>
          
          <code class="ruby">    newest_version = Naturalsorter::Sorter.sort_version([dependency.parsed_version, newest_product_version]).last</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="78">
          <span class="hits">7</span>
          
          <code class="ruby">    if VersionService.equal(newest_version, parsed_version)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.outdated = false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">      dependency.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="84">
          <span class="hits">6</span>
          
          <code class="ruby">    dependency.outdated = true</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="85">
          <span class="hits">6</span>
          
          <code class="ruby">    dependency.save</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="86">
          <span class="hits">6</span>
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_parsed_version dependency, product = nil</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="95">
          <span class="hits">30</span>
          
          <code class="ruby">    if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="96">
          <span class="hits">10</span>
          
          <code class="ruby">      product  = find_product( dependency.prod_type, dependency.language, dependency.dep_prod_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="99">
          <span class="hits">30</span>
          
          <code class="ruby">    if ( dependency.version.to_s.empty? || dependency.version.to_s.eql?(&quot;*&quot;) ) &amp;&amp; product</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">      dependency.parsed_version = product.version</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="104">
          <span class="hits">30</span>
          
          <code class="ruby">    dependency.set_prod_type_if_nil</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="105">
          <span class="hits">30</span>
          
          <code class="ruby">    parser   = ParserStrategy.parser_for( dependency.prod_type, &#39;&#39; )</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="106">
          <span class="hits">30</span>
          
          <code class="ruby">    proj_dep = Projectdependency.new</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="107">
          <span class="hits">30</span>
          
          <code class="ruby">    parser.parse_requested_version( dependency.version, proj_dep, product )</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="108">
          <span class="hits">30</span>
          
          <code class="ruby">    dependency.parsed_version = proj_dep.version_requested</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_product prod_type, language, dep_prod_key</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="113">
          <span class="hits">10</span>
          
          <code class="ruby">    if dep_prod_key.eql?(&quot;php/php&quot;) or dep_prod_key.eql?(&quot;php&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">      language = Product::A_LANGUAGE_C</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="116">
          <span class="hits">10</span>
          
          <code class="ruby">    if prod_type.eql?(Project::A_TYPE_BOWER)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">      return Product.fetch_bower dep_prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="119">
          <span class="hits">10</span>
          
          <code class="ruby">    Product.fetch_product( language, dep_prod_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_dependencies_global()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">    all_dependencies_paged do |dependencies|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">      update_dependencies_for( dependencies )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  # This method updates the dependencies of a product.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">  # It updates the parsed_version and the outdated field.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_dependencies( product, version = nil )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="136">
          <span class="hits">4</span>
          
          <code class="ruby">    deps = product.all_dependencies( version )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="137">
          <span class="hits">4</span>
          
          <code class="ruby">    return if deps.nil? || deps.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="139">
          <span class="hits">1</span>
          
          <code class="ruby">    update_dependencies_for deps</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">    product.update_attribute(:dep_count, deps.count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_dependencies_for deps</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">    deps.each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="149">
          <span class="hits">2</span>
          
          <code class="ruby">      cache_outdated?( dependency )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="154">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.all_dependencies_paged</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">    count = Dependency.count()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="156">
          
          
          <code class="ruby">    page = 1000</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">    iterations = count / page</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">    iterations += 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">    (0..iterations).each do |i|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">      skip = i * page</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">      dependencies = Dependency.all().skip(skip).limit(page)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">      yield dependencies</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">      co = i * page</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="166">
          
          
          <code class="ruby">      log_msg = &quot;all_dependencies_paged iteration: #{i} - dependencies processed: #{co}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">      p log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">      log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a5e5b8c1cf313ba57809bb745d724fae79257d26">
  <div class="header">
    <h3>lib/versioneye/services/email_setting_service.rb</h3>
    <h4><span class="yellow">88.24 %</span> covered</h4>
    <div>
      <b>17</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class EmailSettingService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.email_setting</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="4">
          <span class="hits">6</span>
          
          <code class="ruby">    emailsetting = EmailSetting.first</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="5">
          <span class="hits">6</span>
          
          <code class="ruby">    emailsetting = EmailSetting.create_default if emailsetting.nil?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">    emailsetting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_action_mailer_from_db</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    update_action_mailer email_setting</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_action_mailer emailSetting</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="14">
          <span class="hits">3</span>
          
          <code class="ruby">    settings = {:address  =&gt; emailSetting.address, :port  =&gt; emailSetting.port}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="16">
          <span class="hits">3</span>
          
          <code class="ruby">    settings[:user_name] = emailSetting.username if !emailSetting.username.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="17">
          <span class="hits">3</span>
          
          <code class="ruby">    settings[:password] = emailSetting.password if !emailSetting.password.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>
          
          <code class="ruby">    settings[:domain] = emailSetting.domain if !emailSetting.domain.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="19">
          <span class="hits">3</span>
          
          <code class="ruby">    settings[:authentication] = emailSetting.authentication if !emailSetting.authentication.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="20">
          <span class="hits">3</span>
          
          <code class="ruby">    settings[:enable_starttls_auto] = emailSetting.enable_starttls_auto if !emailSetting.enable_starttls_auto.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="22">
          <span class="hits">3</span>
          
          <code class="ruby">    ActionMailer::Base.smtp_settings = settings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">    log.error e.messages.join &#39;/n&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ef61b5f38ea512d60d50ac0278a1333c7a304a7a">
  <div class="header">
    <h3>lib/versioneye/services/enterprise_service.rb</h3>
    <h4><span class="yellow">86.36 %</span> covered</h4>
    <div>
      <b>22</b> relevant lines. 
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class EnterpriseService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.activated?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="4">
          <span class="hits">6</span>
          
          <code class="ruby">    env = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="5">
          <span class="hits">6</span>
          
          <code class="ruby">    return true if !env.eql?(&#39;enterprise&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="7">
          <span class="hits">5</span>
          
          <code class="ruby">    api_key    = GlobalSetting.get env, &#39;API_KEY&#39;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="8">
          <span class="hits">5</span>
          
          <code class="ruby">    e_projects = GlobalSetting.get env, &#39;E_PROJECTS&#39;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="9">
          <span class="hits">5</span>
          
          <code class="ruby">    return false if api_key.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if e_projects.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    return false if e_projects.to_i &lt;= 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.activate! api_key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    response = MeClient.show api_key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    return false if response.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    return false if !response[&quot;error&quot;].to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    env = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    GlobalSetting.set env, &#39;E_PROJECTS&#39;, response[&quot;enterprise_projects&quot;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    GlobalSetting.set env, &#39;API_KEY&#39;, api_key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    GlobalSetting.set env, &#39;ACTIVATION_DATE&#39;, Time.now.strftime(&quot;%Y-%m-%d&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    GlobalSetting.get( env, &#39;API_KEY&#39; ).eql?( api_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="468219498fcf60539b0c2fa153c9b270073ad865">
  <div class="header">
    <h3>lib/versioneye/services/git_hub_service.rb</h3>
    <h4><span class="red">24.18 %</span> covered</h4>
    <div>
      <b>91</b> relevant lines. 
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>69</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;benchmark&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;dalli&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class GitHubService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_NIL     = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_RUNNING = &#39;running&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_DONE    = &#39;done&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_TTL     = 1800 # 1800 seconds = 30 minutes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_all_repos</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    User.all(:timeout =&gt; true).live_users.where(:github_scope =&gt; &#39;repo&#39;).each do |user|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">      update_repos_for_user user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_repos_for_user user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    log.debug &quot;Fetch GitHub Repos for #{user.fullname}.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    user.github_repos.delete_all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    GitHubService.cached_user_repos user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    log.error &quot;Cant import repos for #{user.fullname} \n #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">=begin</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  Returns github repos for user;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  If user don&#39;t have yet any github repos</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">     or there&#39;s been any change on user&#39;s github account,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  then trys to read from github</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  else it returns cached results from GitHubRepos collection.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  NB! allows only one running task per user;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">=end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cached_user_repos user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    user_task_key = &quot;#{user[:username]}-#{user[:github_id]}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    task_status   = cache.get( user_task_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    if task_status == A_TASK_RUNNING || task_status == A_TASK_DONE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">      log.debug &quot;Status for importing repos for `#{user[:fullname]}.` from GitHub: #{task_status}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">      return task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    if user[:github_token] and user.github_repos.all.count == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">      task_status = A_TASK_RUNNING</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">      cache.set( user_task_key, task_status, A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">      GitReposImportProducer.new(&quot;github:::#{user.id.to_s}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      log.info &#39;Nothing is changed - skipping update.&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">      task_status = A_TASK_DONE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.status_for user, current_repo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    repo_fullname = current_repo.fullname</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    return A_TASK_DONE if current_repo.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    repo_task_key = &quot;github:::#{user.id.to_s}:::#{current_repo.id.to_s}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    task_status   = cache.get( repo_task_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    if task_status == A_TASK_RUNNING || task_status == A_TASK_DONE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">      log.debug &quot;Status for importing branches and project files for `#{repo_fullname}.` from GitHub: #{task_status}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">      return task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">    if current_repo and ( current_repo.branches.nil? || current_repo.branches.empty? )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">      task_status = A_TASK_RUNNING</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">      cache.set( repo_task_key, task_status, A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      GitRepoImportProducer.new( repo_task_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">      log.info &#39;Nothing is changed - skipping update.&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">      task_status = A_TASK_DONE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">    task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_repo_info user, repo_fullname</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">    current_repo = GithubRepo.by_user(user).by_fullname(repo_fullname).shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">    if current_repo.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">      log.error &quot;User #{user[:username]} has no such repo `#{repo_fullname}`.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    token = user[:github_token]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">    repo_info = Github.repo_info repo_fullname, token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">    git_repo  = GithubRepo.build_or_update user, repo_info</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">    git_repo  = Github.update_branches git_repo, token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">    git_repo  = Github.update_project_files git_repo, token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">    git_repo.user_id = user.id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">    git_repo.user_login = user.github_login</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    git_repo.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">    git_repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cache_user_all_repos(user, orga_names)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">    user_info = Github.user(user.github_token)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">    user[:user_login] = user_info[:login] if user_info.is_a?(Hash)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">    log.info &quot;reading user repos for user: #{user.fullname}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">    cache_user_repos(user)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">    orga_names.each do |orga_name|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">      log.info &quot;reading repos for orga: #{orga_name}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">      cache_user_orga_repos(user, orga_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.pure_text_from project_file</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="120">
          <span class="hits">9</span>
          
          <code class="ruby">    file_bin = project_file[:content]</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="121">
          <span class="hits">9</span>
          
          <code class="ruby">    Base64.decode64(file_bin)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">    &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.filename_from project_file</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="129">
          <span class="hits">9</span>
          
          <code class="ruby">    full_name = project_file[:name]</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="130">
          <span class="hits">9</span>
          
          <code class="ruby">    full_name.split(&quot;/&quot;).last</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">    &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="141">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.cache_user_repos( user )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">      url = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">        data = Github.user_repos(user, url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">        url = data[:paging][&quot;next&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">      end while not url.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.cache_user_orga_repos(user, orga_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="151">
          
          
          <code class="ruby">      url = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">      begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="153">
          
          
          <code class="ruby">        data = Github.user_orga_repos(user, orga_name, url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">        url = data[:paging][&quot;next&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">      end while not url.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4b7d3c389b07c951ae95d9e19119c769bd682b34">
  <div class="header">
    <h3>lib/versioneye/services/http_service.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>13</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class HttpService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_response url, timeout = 60</code>
        </li>
      
        <li class="covered" data-hits="230" data-linenumber="4">
          <span class="hits">230</span>
          
          <code class="ruby">    uri  = URI.parse url</code>
        </li>
      
        <li class="covered" data-hits="229" data-linenumber="5">
          <span class="hits">229</span>
          
          <code class="ruby">    http = Net::HTTP.new uri.host, uri.port</code>
        </li>
      
        <li class="covered" data-hits="229" data-linenumber="6">
          <span class="hits">229</span>
          
          <code class="ruby">    http.read_timeout = timeout # in seconds</code>
        </li>
      
        <li class="covered" data-hits="229" data-linenumber="7">
          <span class="hits">229</span>
          
          <code class="ruby">    if uri.port == 443</code>
        </li>
      
        <li class="covered" data-hits="226" data-linenumber="8">
          <span class="hits">226</span>
          
          <code class="ruby">      http.use_ssl = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="229" data-linenumber="10">
          <span class="hits">229</span>
          
          <code class="ruby">    path  = uri.path</code>
        </li>
      
        <li class="covered" data-hits="229" data-linenumber="11">
          <span class="hits">229</span>
          
          <code class="ruby">    query = uri.query</code>
        </li>
      
        <li class="covered" data-hits="229" data-linenumber="12">
          <span class="hits">229</span>
          
          <code class="ruby">    http.get(&quot;#{path}?#{query}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="13f39c00374f370dd1aaeacf29ebab45cea51e52">
  <div class="header">
    <h3>lib/versioneye/services/language_service.rb</h3>
    <h4><span class="red">75.86 %</span> covered</h4>
    <div>
      <b>29</b> relevant lines. 
      <span class="green"><b>22</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LanguageService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DISTINCT_LANGUAGES = [&quot;Java&quot;, &quot;PHP&quot;, &quot;CSS&quot;, &quot;Ruby&quot;, &quot;Python&quot;, &quot;Node.JS&quot;, &quot;CoffeeScript&quot;, &quot;HTML&quot;, &quot;JavaScript&quot;, &quot;Clojure&quot;, &quot;Objective-C&quot;, &quot;R&quot;, &quot;Biicode&quot;, &quot;PureScript&quot;, &quot;Go&quot;, &quot;Haskell&quot;, &quot;Perl&quot;, &quot;C#&quot;, &quot;TypeScript&quot;, &quot;Handlebars&quot;, &quot;Opa&quot;, &quot;C&quot;, &quot;none&quot;, &quot;Nix&quot;, &quot;Shell&quot;, &quot;wisp&quot;, &quot;LiveScript&quot;, &quot;Makefile&quot;, &quot;ApacheConf&quot;, &quot;C++&quot;, &quot;ActionScript&quot;, &quot;Scala&quot;, &quot;Processing&quot;, &quot;PowerShell&quot;, &quot;Dart&quot;, &quot;XSLT&quot;, &quot;Lua&quot;, &quot;XML&quot;, &quot;ASP&quot;, &quot;TeX&quot;, &quot;Liquid&quot;, &quot;Groovy&quot;, &quot;Gettext Catalog&quot;, &quot;Cirru&quot;, &quot;Smarty&quot;, &quot;Eagle&quot;, &quot;Puppet&quot;, &quot;SuperCollider&quot;]</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_KEY = &quot;distinct_languages&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.language_for lang_string</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    languages = distinct_languages</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    languages &lt;&lt; &#39;nodejs&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    languages.each do |lang|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="12">
          <span class="hits">10</span>
          
          <code class="ruby">      return lang if /\A#{lang}\z/i =~ lang_string || /\A#{lang}\/.*\z/i =~ lang_string</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="13">
          <span class="hits">8</span>
          
          <code class="ruby">      return lang if lang_string.match(/c\+\+/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.distinct_languages</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="20">
          <span class="hits">2</span>
          
          <code class="ruby">    languages = cached_languages A_KEY</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">    if languages.nil? || languages.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">      languages = A_DISTINCT_LANGUAGES</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="23">
          <span class="hits">2</span>
          
          <code class="ruby">      save_in_cache A_KEY, languages</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="24">
          <span class="hits">2</span>
          
          <code class="ruby">      CommonProducer.new &quot;update_distinct_languages&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    languages</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_distinct_languages</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    languages = Product.all.distinct(:language)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    save_in_cache A_KEY, languages</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    languages</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.cached_languages key</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">      cache.get key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.save_in_cache key, languages</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">      cache.set( key, languages )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="85e649118f2391815e03fe944504753dfeff2720">
  <div class="header">
    <h3>lib/versioneye/services/license_service.rb</h3>
    <h4><span class="red">11.86 %</span> covered</h4>
    <div>
      <b>59</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>52</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LicenseService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.search name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    result1 = SpdxLicense.where(:fullname =&gt; /#{name}/i)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    result2 = SpdxLicense.where(:identifier =&gt; /#{name}/i)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    keys = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    results = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    result1.map{|lic| results &lt;&lt; lic; keys &lt;&lt; lic.identifier } if result1 &amp;&amp; !result1.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    result2.map{|lic| results &lt;&lt; lic if !keys.include?(lic.identifier) } if result2 &amp;&amp; !result2.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from file_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    content = File.read(file_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    content.split(&quot;\r&quot;).each do |line|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">      cols = line.split(&quot;;&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      create_spdx_license cols[0], cols[1], cols[2]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_properties_file file_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    z = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    content = File.read(file_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    content.split(&quot;\n&quot;).each do |line|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      next if line.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      sps = line.split(&quot;=&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      gav = sps[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      lic = sps[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">      group_id     = gav.split(&quot;|&quot;)[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">      artifact_id  = gav.split(&quot;|&quot;)[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">      license_name = lic.split(&quot;|&quot;)[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      license_link = lic.split(&quot;|&quot;)[1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">      # p &quot;#{group_id}:#{artifact_id} - #{license_name} - #{license_link}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">      product = Product.find_by_group_and_artifact group_id.downcase, artifact_id.downcase</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      if product</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">        z +=1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">        p &quot;#{z} - #{license_name} - #{group_id}:#{artifact_id} - #{license_link}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">        product.versions.each do |version|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">          product.version = version.to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">          next if !product.licenses.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">          license = License.find_or_create product.language, product.prod_key, version.to_s, license_name, license_link</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">          p &quot; - created new license #{license.to_s}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">        # z +=1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">        # p &quot;#{z} - product not found for #{group_id}/#{artifact_id}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_websites_from_properties_file file_path</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    z = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    content = File.read(file_path)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    content.split(&quot;\n&quot;).each do |line|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">      next if line.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">      sps = line.split(&quot;=&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">      gav = sps[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">      link = sps[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">      group_id     = gav.split(&quot;|&quot;)[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">      artifact_id  = gav.split(&quot;|&quot;)[1]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">      product = Product.find_by_group_and_artifact group_id.downcase, artifact_id.downcase</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">      if product</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">        z +=1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">        p &quot;#{z} - #{group_id}:#{artifact_id} - #{link}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">        vl = Versionlink.create_project_link( product.language, product.prod_key, link, &quot;Website&quot; )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">        p &quot; - created new verisonlink #{vl.to_s}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">        # z +=1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">        # p &quot;#{z} - product not found for #{group_id}/#{artifact_id}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.create_spdx_license name, identifier, approved</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">      spdx = SpdxLicense.new :fullname =&gt; name, :identifier =&gt; identifier, :osi_approved =&gt; approved</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">      spdx.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">      p e.message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="c5b41e7978f05ddbf1ce0ff24219986e030b47e9">
  <div class="header">
    <h3>lib/versioneye/services/license_whitelist_service.rb</h3>
    <h4><span class="yellow">84.78 %</span> covered</h4>
    <div>
      <b>92</b> relevant lines. 
      <span class="green"><b>78</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LicenseWhitelistService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  A_ENV_ENTERPRISE = &quot;enterprise&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.index user</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="6">
          <span class="hits">23</span>
          
          <code class="ruby">    env  = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="7">
          <span class="hits">23</span>
          
          <code class="ruby">    list = index_enterprise() if env.eql?( A_ENV_ENTERPRISE )</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="8">
          <span class="hits">23</span>
          
          <code class="ruby">    list = index_for( user )  if not env.eql?( A_ENV_ENTERPRISE )</code>
        </li>
      
        <li class="covered" data-hits="23" data-linenumber="9">
          <span class="hits">23</span>
          
          <code class="ruby">    list</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_by user, name</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="13">
          <span class="hits">9</span>
          
          <code class="ruby">    env  = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="14">
          <span class="hits">9</span>
          
          <code class="ruby">    list = fetch_by_enterprise( name )      if env.eql?(A_ENV_ENTERPRISE)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="15">
          <span class="hits">9</span>
          
          <code class="ruby">    list = fetch_by_user_name( user, name ) if not env.eql?(A_ENV_ENTERPRISE)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="16">
          <span class="hits">9</span>
          
          <code class="ruby">    list</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create user, name</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="20">
          <span class="hits">15</span>
          
          <code class="ruby">    env = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="21">
          <span class="hits">15</span>
          
          <code class="ruby">    success = create_for_enterprise( user, name ) if env.eql?(A_ENV_ENTERPRISE)</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="22">
          <span class="hits">15</span>
          
          <code class="ruby">    success = create_for( user, name )            if not env.eql?(A_ENV_ENTERPRISE)</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="23">
          <span class="hits">15</span>
          
          <code class="ruby">    success</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.add user, list_name, license_name</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="27">
          <span class="hits">10</span>
          
          <code class="ruby">    env = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="28">
          <span class="hits">10</span>
          
          <code class="ruby">    success = add_license_for_enterprise( user, list_name, license_name ) if env.eql?(A_ENV_ENTERPRISE)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="29">
          <span class="hits">10</span>
          
          <code class="ruby">    success = add_license( user, list_name, license_name )                if not env.eql?(A_ENV_ENTERPRISE)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="30">
          <span class="hits">10</span>
          
          <code class="ruby">    success</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove user, list_name, license_name</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>
          
          <code class="ruby">    env = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="35">
          <span class="hits">3</span>
          
          <code class="ruby">    success = remove_license_for_enterprise( user, list_name, license_name ) if env.eql?(A_ENV_ENTERPRISE)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>
          
          <code class="ruby">    success = remove_license( user, list_name, license_name )                if not env.eql?(A_ENV_ENTERPRISE)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="37">
          <span class="hits">3</span>
          
          <code class="ruby">    success</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.default user, list_name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    list = index( user )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">    list.each do |lwl|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="43">
          <span class="hits">5</span>
          
          <code class="ruby">      if lwl.name.eql?( list_name )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">        lwl.default = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="46">
          <span class="hits">3</span>
          
          <code class="ruby">        lwl.default = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="48">
          <span class="hits">5</span>
          
          <code class="ruby">      lwl.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_default_id user</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="54">
          <span class="hits">19</span>
          
          <code class="ruby">    list = index( user )</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="55">
          <span class="hits">19</span>
          
          <code class="ruby">    list.each do |lwl|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">      return lwl.id.to_s if lwl.default == true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_project project, user, lwl_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    return false if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    lwl = fetch_by user, lwl_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    lwl_id = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    lwl_id = lwl.id.to_s if lwl</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">    project.license_whitelist_id = lwl_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">    ProjectService.update_license_numbers! project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    project.children.each do |child|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">      child.license_whitelist_id = lwl_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">      ProjectService.update_license_numbers! child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    ProjectService.update_sums project</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  # Returns true if user has permission to edit lwl for enterprise</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.enterprise_permission user</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="86">
          <span class="hits">13</span>
          
          <code class="ruby">    return false if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="87">
          <span class="hits">12</span>
          
          <code class="ruby">    return true  if user.admin == true</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="88">
          <span class="hits">5</span>
          
          <code class="ruby">    return true  if user.fetch_or_create_permissions.lwl == true</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="89">
          <span class="hits">4</span>
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.index_enterprise</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">      LicenseWhitelist.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.index_for user</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="99">
          <span class="hits">22</span>
          
          <code class="ruby">      LicenseWhitelist.by_user user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fetch_by_enterprise name</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="103">
          <span class="hits">4</span>
          
          <code class="ruby">      LicenseWhitelist.by_name( name ).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fetch_by_user_name user, name</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="107">
          <span class="hits">5</span>
          
          <code class="ruby">      LicenseWhitelist.fetch_by user, name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.create_for user, name</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="111">
          <span class="hits">14</span>
          
          <code class="ruby">      whitelist = LicenseWhitelist.new( {:name =&gt; name} )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="112">
          <span class="hits">14</span>
          
          <code class="ruby">      whitelist.user = user</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="113">
          <span class="hits">14</span>
          
          <code class="ruby">      whitelist.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.create_for_enterprise user, name</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="117">
          <span class="hits">4</span>
          
          <code class="ruby">      return false if enterprise_permission(user) == false</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="118">
          <span class="hits">3</span>
          
          <code class="ruby">      create_for user, name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="121">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.add_license user, list_name, license_name</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="122">
          <span class="hits">7</span>
          
          <code class="ruby">      license_whitelist = LicenseWhitelist.fetch_by user, list_name</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="123">
          <span class="hits">7</span>
          
          <code class="ruby">      license_whitelist.add_license_element license_name</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="124">
          <span class="hits">7</span>
          
          <code class="ruby">      license_whitelist.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="127">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.add_license_for_enterprise user, list_name, license_name</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="128">
          <span class="hits">3</span>
          
          <code class="ruby">      return false if enterprise_permission(user) == false</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="129">
          <span class="hits">2</span>
          
          <code class="ruby">      license_whitelist = LicenseWhitelist.by_name( list_name ).first</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="130">
          <span class="hits">2</span>
          
          <code class="ruby">      license_whitelist.add_license_element license_name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="131">
          <span class="hits">2</span>
          
          <code class="ruby">      license_whitelist.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.remove_license user, list_name, license_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">      license_whitelist = LicenseWhitelist.fetch_by user, list_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="136">
          <span class="hits">1</span>
          
          <code class="ruby">      license_whitelist.remove_license_element license_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>
          
          <code class="ruby">      license_whitelist.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="140">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.remove_license_for_enterprise user, list_name, license_name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="141">
          <span class="hits">2</span>
          
          <code class="ruby">      return false if enterprise_permission(user) == false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="142">
          <span class="hits">1</span>
          
          <code class="ruby">      license_whitelist = LicenseWhitelist.by_name( list_name ).first</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="143">
          <span class="hits">1</span>
          
          <code class="ruby">      license_whitelist.remove_license_element license_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">      license_whitelist.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="20d7776644fce76e8b5461f31d9ca12f76540691">
  <div class="header">
    <h3>lib/versioneye/services/lwl_pdf_service.rb</h3>
    <h4><span class="red">61.76 %</span> covered</h4>
    <div>
      <b>68</b> relevant lines. 
      <span class="green"><b>42</b> lines covered</span> and
      <span class="red"><b>26</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LwlPdfService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;pdfkit&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;ostruct&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process project, exclude_kids = false, flatten = true, write_to_disk = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    html = compile_html project, exclude_kids, flatten</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    kit  = new_kit html</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    write_pdf_to_disk(kit, project) if write_to_disk</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    kit.to_pdf</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.compile_html project, exclude_kids = false, flatten = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    fill_dto project, flatten</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    children = prepare_kids project, exclude_kids, flatten</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    namespace = OpenStruct.new(project: project, children: children)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    content_file = Settings.instance.lwl_pdf_content</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    erb = ERB.new(File.read(content_file))</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    html = erb.result( namespace.instance_eval { binding } )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    html = html.force_encoding(Encoding::UTF_8)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    html</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.new_kit html</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    footer_file = Settings.instance.lwl_pdf_footer</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    kit = PDFKit.new(html, :footer_html =&gt; footer_file, :page_size =&gt; &#39;A4&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    raise &quot;PDFKit.new returned nil!&quot; if kit.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    kit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.write_pdf_to_disk kit, project</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    date_string = DateTime.now.strftime(&quot;%d_%m_%Y&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    project_name = project.name.gsub(&quot;/&quot;, &quot;-&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    kit.to_file(&quot;#{ENV[&#39;HOME&#39;]}/#{date_string}_#{project_name}.pdf&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.prepare_kids project, exclude_kids = false, flatten</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    children = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">    return children if exclude_kids || flatten</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    if project.children &amp;&amp; !project.children.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      project.children.each do |sub_project|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">        fill_dto sub_project, false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">        children &lt;&lt; sub_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    children</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fill_dto project, flatten = false</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="63">
          <span class="hits">4</span>
          
          <code class="ruby">    uniq_array = []</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="64">
          <span class="hits">4</span>
          
          <code class="ruby">    dto = { :whitelisted =&gt; [], :unknown =&gt; [], :violated =&gt; [] }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="66">
          <span class="hits">4</span>
          
          <code class="ruby">    fill_dto_with project.dependencies, dto, uniq_array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="68">
          <span class="hits">4</span>
          
          <code class="ruby">    if flatten &amp;&amp; project.children &amp;&amp; !project.children.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="69">
          <span class="hits">2</span>
          
          <code class="ruby">      project.children.each do |child|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="70">
          <span class="hits">2</span>
          
          <code class="ruby">        fill_dto_with child.dependencies, dto, uniq_array</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="74">
          <span class="hits">8</span>
          
          <code class="ruby">    dto[:whitelisted].sort_by!{ |hsh| hsh[:component] }</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="75">
          <span class="hits">5</span>
          
          <code class="ruby">    dto[:unknown].sort_by!{ |hsh| hsh[:component] }</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="76">
          <span class="hits">4</span>
          
          <code class="ruby">    dto[:violated].sort_by!{ |hsh| hsh[:component] }</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="77">
          <span class="hits">4</span>
          
          <code class="ruby">    project.lwl_pdf_list = dto</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="78">
          <span class="hits">4</span>
          
          <code class="ruby">    dto</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fill_dto_with dependencies, dto, uniq_array</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="86">
          <span class="hits">6</span>
          
          <code class="ruby">      uvalue = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="87">
          <span class="hits">6</span>
          
          <code class="ruby">      dependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="88">
          <span class="hits">6</span>
          
          <code class="ruby">        line = build_line(dep)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="89">
          <span class="hits">6</span>
          
          <code class="ruby">        if dep.license_caches &amp;&amp; !dep.license_caches.empty?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="90">
          <span class="hits">5</span>
          
          <code class="ruby">          dep.license_caches.each do |lc|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="91">
          <span class="hits">5</span>
          
          <code class="ruby">            line[:license] = lc.name</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="92">
          <span class="hits">5</span>
          
          <code class="ruby">            uvalue = create_uniq_identifier(line)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="93">
          <span class="hits">5</span>
          
          <code class="ruby">            next if uniq_array.include?(uvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="95">
          <span class="hits">4</span>
          
          <code class="ruby">            dto[:whitelisted] &lt;&lt; line if lc.on_whitelist</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="96">
          <span class="hits">4</span>
          
          <code class="ruby">            dto[:violated]    &lt;&lt; line if !lc.on_whitelist</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">        else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">          line[:license] = &#39;UNKNOWN&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">          uvalue = create_uniq_identifier(line)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">          dto[:unknown] &lt;&lt; line if !uniq_array.include?(uvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="104">
          <span class="hits">6</span>
          
          <code class="ruby">        uniq_array &lt;&lt; uvalue if !uniq_array.include?(uvalue)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.create_uniq_identifier line</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="110">
          <span class="hits">6</span>
          
          <code class="ruby">      &quot;#{line[:component]}_#{line[:group_id]}_#{line[:version]}_#{line[:license]}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.build_line dep</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="115">
          <span class="hits">6</span>
          
          <code class="ruby">      dep_name = dep.name</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="116">
          <span class="hits">6</span>
          
          <code class="ruby">      dep_name = dep.artifact_id if !dep.artifact_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="117">
          <span class="hits">6</span>
          
          <code class="ruby">      {:component =&gt; dep_name, :group_id =&gt; dep.group_id, :version =&gt; dep.version_requested}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5bd4c6af78f82bfaab8b60136a8dda69e36cc7e3">
  <div class="header">
    <h3>lib/versioneye/services/newest_service.rb</h3>
    <h4><span class="yellow">81.67 %</span> covered</h4>
    <div>
      <b>120</b> relevant lines. 
      <span class="green"><b>98</b> lines covered</span> and
      <span class="red"><b>22</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class NewestService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_newest( product, version_number, logger = nil )</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="5">
          <span class="hits">171</span>
          
          <code class="ruby">    newest = Newest.fetch_newest( product.language, product.prod_key, version_number )</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="6">
          <span class="hits">171</span>
          
          <code class="ruby">    return nil if newest</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="8">
          <span class="hits">171</span>
          
          <code class="ruby">    newest = Newest.new</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="9">
          <span class="hits">171</span>
          
          <code class="ruby">    newest.name       = product.name</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="10">
          <span class="hits">171</span>
          
          <code class="ruby">    newest.language   = product.language</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="11">
          <span class="hits">171</span>
          
          <code class="ruby">    newest.prod_key   = product.prod_key</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="12">
          <span class="hits">171</span>
          
          <code class="ruby">    newest.version    = version_number</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="13">
          <span class="hits">171</span>
          
          <code class="ruby">    newest.prod_type  = product.prod_type</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="14">
          <span class="hits">171</span>
          
          <code class="ruby">    newest.product_id = product._id.to_s</code>
        </li>
      
        <li class="covered" data-hits="171" data-linenumber="15">
          <span class="hits">171</span>
          
          <code class="ruby">    newest.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    log_exception e, logger</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_notifications(product, version_number, logger = nil)</code>
        </li>
      
        <li class="covered" data-hits="170" data-linenumber="23">
          <span class="hits">170</span>
          
          <code class="ruby">    new_notifications = 0</code>
        </li>
      
        <li class="covered" data-hits="170" data-linenumber="24">
          <span class="hits">170</span>
          
          <code class="ruby">    subscribers = product.users</code>
        </li>
      
        <li class="covered" data-hits="170" data-linenumber="25">
          <span class="hits">170</span>
          
          <code class="ruby">    return new_notifications if subscribers.nil? || subscribers.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    subscribers.each do |subscriber|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">      success = create_notification( subscriber, product, version_number, logger )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">      new_notifications += 1 if success</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    new_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    log_exception e, logger</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_notification user, product, version_number, logger</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">    notification            = Notification.new</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">    notification.user       = user</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">    notification.product    = product</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    notification.version_id = version_number</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">    notification.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    log_exception e, logger</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.run_worker</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    loop do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">      post_process</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      update_nils</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">      multi_log &quot;sleep for a while&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">      sleep 60</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_nils</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    Dependency.where(:current_version =&gt; nil, :dep_prod_key.ne =&gt; nil, :known =&gt; true).each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">      DependencyService.outdated?( dep )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">      multi_log &quot;update #{dep.language}:#{dep.dep_prod_key}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.post_process</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="69">
          <span class="hits">2</span>
          
          <code class="ruby">    newests = Newest.any_of( {:processed =&gt; false}, {:processed =&gt; nil} )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="70">
          <span class="hits">2</span>
          
          <code class="ruby">    newests.each do |newest|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="71">
          <span class="hits">2</span>
          
          <code class="ruby">      process newest</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process newest</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="77">
          <span class="hits">2</span>
          
          <code class="ruby">    product = newest.product</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="78">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="80">
          <span class="hits">2</span>
          
          <code class="ruby">    multi_log &quot;---&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="81">
          <span class="hits">2</span>
          
          <code class="ruby">    multi_log &quot;update_meta_data for #{product.language}:#{product.prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="82">
          <span class="hits">2</span>
          
          <code class="ruby">    ProductService.update_meta_data product, false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">    multi_log &quot;update_dependencies for #{product.language}:#{product.prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="85">
          <span class="hits">2</span>
          
          <code class="ruby">    update_dependencies product, newest.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">    multi_log &quot;update_projectdependencies for #{product.language}:#{product.prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="88">
          <span class="hits">2</span>
          
          <code class="ruby">    update_projectdependencies product, newest.version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="90">
          <span class="hits">2</span>
          
          <code class="ruby">    newest.processed = true</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="91">
          <span class="hits">2</span>
          
          <code class="ruby">    newest.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_dependencies product, version</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="99">
          <span class="hits">2</span>
          
          <code class="ruby">    if !product.group_id.to_s.empty? &amp;&amp; !product.artifact_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">      update_current_version_maven product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">      update_outdated_maven( product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">      update_current_version( product )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">      update_outdated( product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="106">
          <span class="hits">2</span>
          
          <code class="ruby">    multi_log &quot;update product dependencies for #{product.language}:#{product.prod_key}:#{version}&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="107">
          <span class="hits">2</span>
          
          <code class="ruby">    DependencyService.update_dependencies product, version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="114">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_current_version_maven product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">    multi_log &quot;update_current_version_maven for #{product.language}:#{product.prod_key}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">    Dependency.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">      :group_id =&gt; product.group_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">      :artifact_id =&gt; product.artifact_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">      ).update_all(:current_version =&gt; product.version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_current_version product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">    multi_log &quot;update_current_version for #{product.language}:#{product.prod_key}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    Dependency.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">      :language =&gt; product.language,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">      :dep_prod_key =&gt; product.prod_key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="128">
          <span class="hits">1</span>
          
          <code class="ruby">      ).update_all(:current_version =&gt; product.version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="132">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_outdated_maven product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">    multi_log &quot;update_outdated_maven for #{product.language}:#{product.prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = Dependency.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">      :group_id =&gt; product.group_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">      :artifact_id =&gt; product.artifact_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies.each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">      DependencyService.soft_outdated?( dependency, product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="143">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_outdated product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="144">
          <span class="hits">1</span>
          
          <code class="ruby">    multi_log &quot;update_outdated for #{product.language}:#{product.prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="145">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = Dependency.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">      :language =&gt; product.language,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">      :dep_prod_key =&gt; product.prod_key)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies.each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="149">
          <span class="hits">1</span>
          
          <code class="ruby">      DependencyService.soft_outdated?( dependency, product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="154">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_projectdependencies product, version</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="155">
          <span class="hits">2</span>
          
          <code class="ruby">    if !product.group_id.to_s.empty? &amp;&amp; !product.artifact_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="156">
          <span class="hits">1</span>
          
          <code class="ruby">      update_current_version_maven_pd product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="157">
          <span class="hits">1</span>
          
          <code class="ruby">      update_outdated_maven_pd( product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>
          
          <code class="ruby">      update_current_for_pd product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="160">
          <span class="hits">1</span>
          
          <code class="ruby">      update_outdated_pd product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="164">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_current_version_maven_pd product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="165">
          <span class="hits">1</span>
          
          <code class="ruby">    multi_log &quot;update_current_version_maven for #{product.language}:#{product.prod_key}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">    Projectdependency.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby">      :group_id =&gt; product.group_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">      :artifact_id =&gt; product.artifact_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="169">
          <span class="hits">1</span>
          
          <code class="ruby">      ).update_all(:version_current =&gt; product.version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="172">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_outdated_maven_pd product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="173">
          <span class="hits">1</span>
          
          <code class="ruby">    multi_log &quot;update_outdated_maven for #{product.language}:#{product.prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = Projectdependency.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">      :group_id =&gt; product.group_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">      :artifact_id =&gt; product.artifact_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="177">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies.each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="178">
          <span class="hits">1</span>
          
          <code class="ruby">      ProjectdependencyService.update_outdated!( dependency )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="179">
          <span class="hits">1</span>
          
          <code class="ruby">      ProjectService.update_sums( dependency.project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="183">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_current_for_pd product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby">    Projectdependency.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="185">
          
          
          <code class="ruby">      :language =&gt; product.language,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">      :prod_key =&gt; product.prod_key</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="187">
          <span class="hits">1</span>
          
          <code class="ruby">      ).update_all(:version_current =&gt; product.version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="190">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_outdated_pd product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="191">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = Projectdependency.where(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">      :language =&gt; product.language,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">      :prod_key =&gt; product.prod_key)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="194">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies.each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="195">
          <span class="hits">1</span>
          
          <code class="ruby">      ProjectdependencyService.update_outdated!( dependency )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="196">
          <span class="hits">1</span>
          
          <code class="ruby">      ProjectService.update_sums( dependency.project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="201">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="204">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.multi_log msg</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="205">
          <span class="hits">17</span>
          
          <code class="ruby">      p msg</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="206">
          <span class="hits">17</span>
          
          <code class="ruby">      log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="210">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.log_exception e, logger = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">      if logger</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="212">
          
          
          <code class="ruby">        logger.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">        logger.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">        p e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="216">
          
          
          <code class="ruby">        p e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="217">
          
          
          <code class="ruby">        log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">        log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="90b3812379fd7f03292cd5521d25de6f4549bbc1">
  <div class="header">
    <h3>lib/versioneye/services/newsletter_service.rb</h3>
    <h4><span class="red">75.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>5</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class NewsletterService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.send_newsletter_features</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="5">
          <span class="hits">6</span>
          
          <code class="ruby">    count = 0</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">    UserService.all_users_paged do |users|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="7">
          <span class="hits">12</span>
          
          <code class="ruby">      users.each do |user|</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="8">
          <span class="hits">9</span>
          
          <code class="ruby">        next if user.deleted_user || user.email_inactive</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="10">
          <span class="hits">7</span>
          
          <code class="ruby">        uns = UserNotificationSetting.fetch_or_create_notification_setting( user )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="11">
          <span class="hits">7</span>
          
          <code class="ruby">        next if uns.newsletter_features.nil?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="12">
          <span class="hits">6</span>
          
          <code class="ruby">        next if uns.newsletter_features == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="14">
          <span class="hits">5</span>
          
          <code class="ruby">        count += self.send_email( user )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="17">
          <span class="hits">6</span>
          
          <code class="ruby">    count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.send_email( user )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="22">
          <span class="hits">5</span>
          
          <code class="ruby">    NewsletterMailer.newsletter_new_features_email( user ).deliver</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="23">
          <span class="hits">5</span>
          
          <code class="ruby">    log.info &quot;Sent new feature newsletter to #{user.fullname}&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="24">
          <span class="hits">5</span>
          
          <code class="ruby">    1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    user.email_send_error = e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    user.save</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="755ee258e42e91618efab9f0568815619744885d">
  <div class="header">
    <h3>lib/versioneye/services/notification_service.rb</h3>
    <h4><span class="yellow">87.32 %</span> covered</h4>
    <div>
      <b>71</b> relevant lines. 
      <span class="green"><b>62</b> lines covered</span> and
      <span class="red"><b>9</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class NotificationService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.send_notifications</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="5">
          <span class="hits">5</span>
          
          <code class="ruby">    count = 0</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="6">
          <span class="hits">5</span>
          
          <code class="ruby">    user_ids = Notification.all.distinct(:user_id)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="7">
          <span class="hits">5</span>
          
          <code class="ruby">    user_ids.each do |id|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="8">
          <span class="hits">8</span>
          
          <code class="ruby">      count += process_user( id )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    # NotificationMailer.status( count ).deliver_now</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="11">
          <span class="hits">5</span>
          
          <code class="ruby">    log.info &quot;Send out #{count} notification emails&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="12">
          <span class="hits">5</span>
          
          <code class="ruby">    count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process_user id</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="21">
          <span class="hits">8</span>
          
          <code class="ruby">    user = User.find_by_id( id )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="22">
          <span class="hits">8</span>
          
          <code class="ruby">    return 0 if user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="24">
          <span class="hits">8</span>
          
          <code class="ruby">    if user.deleted_user || user.email_inactive == true</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="25">
          <span class="hits">2</span>
          
          <code class="ruby">      self.remove_notifications user</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">      return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="29">
          <span class="hits">6</span>
          
          <code class="ruby">    return 1 if self.send_unsend_notifications( user )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    return 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.send_unsend_notifications user</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="39">
          <span class="hits">6</span>
          
          <code class="ruby">    uns = UserNotificationSetting.fetch_or_create_notification_setting user</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="40">
          <span class="hits">6</span>
          
          <code class="ruby">    if uns.notification_emails == false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">      self.disable_notifications user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="45">
          <span class="hits">5</span>
          
          <code class="ruby">    notifications = Notification.unsent_user_notifications user</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="46">
          <span class="hits">5</span>
          
          <code class="ruby">    return false if notifications.nil? || notifications.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="48">
          <span class="hits">5</span>
          
          <code class="ruby">    notis = uniq_products notifications</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="49">
          <span class="hits">11</span>
          
          <code class="ruby">    notis.sort_by {|notice| [notice.product.language]}</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="50">
          <span class="hits">5</span>
          
          <code class="ruby">    NotificationMailer.new_version_email( user, notis ).deliver_now</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="51">
          <span class="hits">5</span>
          
          <code class="ruby">    log.info &quot;Send notifications to user #{user.fullname}&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="52">
          <span class="hits">5</span>
          
          <code class="ruby">    mark_as_sent notifications</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="53">
          <span class="hits">5</span>
          
          <code class="ruby">    MailTrack.add user.ids, &#39;new_version_email&#39;, nil</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="54">
          <span class="hits">5</span>
          
          <code class="ruby">    return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove_notifications user</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="63">
          <span class="hits">4</span>
          
          <code class="ruby">    log.info &quot; ---- Remove notifications for #{user.username}&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="64">
          <span class="hits">4</span>
          
          <code class="ruby">    notifications = Notification.where( :user_id =&gt; user.id.to_s )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="65">
          <span class="hits">4</span>
          
          <code class="ruby">    notifications.each do |notification|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="66">
          <span class="hits">4</span>
          
          <code class="ruby">      notification.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.disable_notifications user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    log.info &quot; ---- Disable notifications for #{user.username}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">    notifications = Notification.by_user(user).all_not_sent</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">    notifications.each do |notification|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">      notification.sent_email = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">      notification.email_disabled = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">      notification.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.uniq_products notifications</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="81">
          <span class="hits">5</span>
          
          <code class="ruby">    hashi = Hash.new</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="82">
          <span class="hits">5</span>
          
          <code class="ruby">    notifications.each do |noti|</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="83">
          <span class="hits">7</span>
          
          <code class="ruby">      next if noti.nil? || noti.product_id.nil? || noti.version_id.nil?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="84">
          <span class="hits">7</span>
          
          <code class="ruby">      hashi[noti.product_id] = [] if hashi[noti.product_id].nil?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="85">
          <span class="hits">7</span>
          
          <code class="ruby">      hashi[noti.product_id] &lt;&lt; noti.version_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="88">
          <span class="hits">5</span>
          
          <code class="ruby">    hashi.each do |product_id, version_ids|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="89">
          <span class="hits">6</span>
          
          <code class="ruby">      if version_ids.count &gt; 1</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">        hashi[product_id] = [ VersionService.newest_version( version_ids ) ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="94">
          <span class="hits">5</span>
          
          <code class="ruby">    result = []</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="95">
          <span class="hits">5</span>
          
          <code class="ruby">    notifications.each do |noti|</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="96">
          <span class="hits">7</span>
          
          <code class="ruby">      version_id = hashi[noti.product_id].first</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="97">
          <span class="hits">7</span>
          
          <code class="ruby">      if version_id.eql?(noti.version_id)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="98">
          <span class="hits">6</span>
          
          <code class="ruby">        result &lt;&lt; noti</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="101">
          <span class="hits">5</span>
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="104">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.mark_as_sent notifications</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="105">
          <span class="hits">5</span>
          
          <code class="ruby">    notifications.each do |notification|</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="106">
          <span class="hits">7</span>
          
          <code class="ruby">      notification.sent_email = true</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="107">
          <span class="hits">7</span>
          
          <code class="ruby">      notification.email_disabled = false</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="108">
          <span class="hits">7</span>
          
          <code class="ruby">      notification.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="0eb156a04e157c09b276cbd07b17f1cde78ee9f3">
  <div class="header">
    <h3>lib/versioneye/services/product_service.rb</h3>
    <h4><span class="red">79.71 %</span> covered</h4>
    <div>
      <b>138</b> relevant lines. 
      <span class="green"><b>110</b> lines covered</span> and
      <span class="red"><b>28</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProductService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # Languages have to be an array of strings.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.search(q, group_id = nil, languages = nil, page_count = 1)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">    EsProduct.search(q, group_id, languages, page_count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    MongoProduct.find_by(q, &#39;&#39;, group_id, languages, 300).paginate(:page =&gt; page_count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  # This method fetches and product and initializes it for the UI.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_product( lang, prod_key, version = nil )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="16">
          <span class="hits">5</span>
          
          <code class="ruby">    product = Product.fetch_product lang, prod_key</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="17">
          <span class="hits">5</span>
          
          <code class="ruby">    if product.nil? &amp;&amp; lang.eql?( Product::A_LANGUAGE_CLOJURE )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">      product = Product.fetch_product Product::A_LANGUAGE_JAVA, prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="20">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="22">
          <span class="hits">4</span>
          
          <code class="ruby">    product.check_nil_version</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="23">
          <span class="hits">4</span>
          
          <code class="ruby">    product.version_newest = product.version</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="24">
          <span class="hits">4</span>
          
          <code class="ruby">    product.version = version if version</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="25">
          <span class="hits">4</span>
          
          <code class="ruby">    product.project_usage = ReferenceService.project_references( lang, prod_key ).count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="27">
          <span class="hits">4</span>
          
          <code class="ruby">    product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.follow language, prod_key, user</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="32">
          <span class="hits">10</span>
          
          <code class="ruby">    result = false</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="33">
          <span class="hits">10</span>
          
          <code class="ruby">    product = Product.fetch_product language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="34">
          <span class="hits">10</span>
          
          <code class="ruby">    product.users = Array.new if product &amp;&amp; product.users.nil?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="35">
          <span class="hits">10</span>
          
          <code class="ruby">    if product &amp;&amp; user &amp;&amp; !product.users.include?( user )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="36">
          <span class="hits">10</span>
          
          <code class="ruby">      product.users.push user</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="37">
          <span class="hits">10</span>
          
          <code class="ruby">      product.followers = 0 if product.followers.nil?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="38">
          <span class="hits">10</span>
          
          <code class="ruby">      product.followers += 1</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="39">
          <span class="hits">10</span>
          
          <code class="ruby">      result = product.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="41">
          <span class="hits">10</span>
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.unfollow language, prod_key, user</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="50">
          <span class="hits">3</span>
          
          <code class="ruby">    result = false</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="51">
          <span class="hits">3</span>
          
          <code class="ruby">    product = Product.fetch_product language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="52">
          <span class="hits">3</span>
          
          <code class="ruby">    product.users = Array.new if product &amp;&amp; product.users.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="53">
          <span class="hits">3</span>
          
          <code class="ruby">    if product &amp;&amp; user &amp;&amp; product.users.include?( user )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="54">
          <span class="hits">2</span>
          
          <code class="ruby">      product.users.delete(user)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="55">
          <span class="hits">2</span>
          
          <code class="ruby">      product.followers = 0 if product.followers.nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="56">
          <span class="hits">2</span>
          
          <code class="ruby">      product.followers -= 1</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="57">
          <span class="hits">2</span>
          
          <code class="ruby">      result = product.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="59">
          <span class="hits">3</span>
          
          <code class="ruby">    result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.all_products_paged</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="68">
          <span class="hits">5</span>
          
          <code class="ruby">    count = Product.count()</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="69">
          <span class="hits">5</span>
          
          <code class="ruby">    page = 100</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="70">
          <span class="hits">5</span>
          
          <code class="ruby">    iterations = count / page</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="71">
          <span class="hits">5</span>
          
          <code class="ruby">    iterations += 1</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="72">
          <span class="hits">5</span>
          
          <code class="ruby">    (0..iterations).each do |i|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="73">
          <span class="hits">10</span>
          
          <code class="ruby">      skip = i * page</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="74">
          <span class="hits">10</span>
          
          <code class="ruby">      products = Product.all().skip(skip).limit(page)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="76">
          <span class="hits">10</span>
          
          <code class="ruby">      yield products</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="78">
          <span class="hits">10</span>
          
          <code class="ruby">      co = i * page</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="79">
          <span class="hits">10</span>
          
          <code class="ruby">      log_msg = &quot;all_products_paged iteration: #{i} - products processed: #{co}&quot;</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="80">
          <span class="hits">10</span>
          
          <code class="ruby">      p log_msg</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="81">
          <span class="hits">10</span>
          
          <code class="ruby">      log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_meta_data_global</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    all_products_paged do |products|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="91">
          <span class="hits">2</span>
          
          <code class="ruby">      log.info &quot; - update_meta_data_global - &quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="92">
          <span class="hits">2</span>
          
          <code class="ruby">      update_products products</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_products products</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="98">
          <span class="hits">2</span>
          
          <code class="ruby">    products.each do |product|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="99">
          <span class="hits">3</span>
          
          <code class="ruby">      self.update_meta_data product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_meta_data product, update_used_by = true</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="108">
          <span class="hits">5</span>
          
          <code class="ruby">    self.update_version_data  product, false</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="109">
          <span class="hits">5</span>
          
          <code class="ruby">    if update_used_by == true</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="110">
          <span class="hits">3</span>
          
          <code class="ruby">      self.update_used_by_count product, false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="112">
          <span class="hits">5</span>
          
          <code class="ruby">    self.update_average_release_time product</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="113">
          <span class="hits">5</span>
          
          <code class="ruby">    self.update_followers_for product</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="114">
          <span class="hits">5</span>
          
          <code class="ruby">    product.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">  # Updates product.version with the newest version number from product.versions</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="122">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_version_data( product, persist = true )</code>
        </li>
      
        <li class="covered" data-hits="177" data-linenumber="123">
          <span class="hits">177</span>
          
          <code class="ruby">    return nil if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="177" data-linenumber="125">
          <span class="hits">177</span>
          
          <code class="ruby">    versions = product.versions</code>
        </li>
      
        <li class="covered" data-hits="177" data-linenumber="126">
          <span class="hits">177</span>
          
          <code class="ruby">    return nil if versions.nil? || versions.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="177" data-linenumber="128">
          <span class="hits">177</span>
          
          <code class="ruby">    newest_stable_version = VersionService.newest_version( versions )</code>
        </li>
      
        <li class="covered" data-hits="177" data-linenumber="129">
          <span class="hits">177</span>
          
          <code class="ruby">    return nil if newest_stable_version.to_s.eql?( product.version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="131">
          <span class="hits">51</span>
          
          <code class="ruby">    product.version = newest_stable_version.to_s</code>
        </li>
      
        <li class="covered" data-hits="51" data-linenumber="132">
          <span class="hits">51</span>
          
          <code class="ruby">    product.save if persist</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_newest_version product</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">    self.update_version_data product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="143">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_used_by_count product, persist = true</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="144">
          <span class="hits">12</span>
          
          <code class="ruby">    prod_keys = nil</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="145">
          <span class="hits">12</span>
          
          <code class="ruby">    if product.group_id &amp;&amp; product.artifact_id</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="146">
          <span class="hits">11</span>
          
          <code class="ruby">      prod_keys = Dependency.where(:group_id =&gt; product.group_id, :artifact_id =&gt; product.artifact_id).distinct(:prod_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="148">
          <span class="hits">1</span>
          
          <code class="ruby">      prod_keys = Dependency.where(:language =&gt; product.language, :dep_prod_key =&gt; product.prod_key).distinct(:prod_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="151">
          <span class="hits">12</span>
          
          <code class="ruby">    count = prod_keys.count</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="152">
          <span class="hits">12</span>
          
          <code class="ruby">    return nil if count == product.used_by_count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="154">
          <span class="hits">7</span>
          
          <code class="ruby">    prod_keys_sorted = []</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="155">
          <span class="hits">7</span>
          
          <code class="ruby">    Product.where(:prod_key.in =&gt; prod_keys).desc(:used_by_count).each do |prod|</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="156">
          <span class="hits">14</span>
          
          <code class="ruby">      prod_keys_sorted &lt;&lt; prod.prod_key if !prod_keys_sorted.include?( prod.prod_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="159">
          <span class="hits">7</span>
          
          <code class="ruby">    reference = Reference.find_or_create_by(:language =&gt; product.language, :prod_key =&gt; product.prod_key )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="160">
          <span class="hits">7</span>
          
          <code class="ruby">    reference.update_from prod_keys_sorted</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="161">
          <span class="hits">7</span>
          
          <code class="ruby">    if product.group_id &amp;&amp; product.artifact_id</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="162">
          <span class="hits">6</span>
          
          <code class="ruby">      reference.group_id = product.group_id</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="163">
          <span class="hits">6</span>
          
          <code class="ruby">      reference.artifact_id = product.artifact_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="165">
          <span class="hits">7</span>
          
          <code class="ruby">    reference.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="167">
          <span class="hits">7</span>
          
          <code class="ruby">    product.used_by_count = prod_keys_sorted.count</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="168">
          <span class="hits">7</span>
          
          <code class="ruby">    product.save if persist</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="170">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="176">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_average_release_time product</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="177">
          <span class="hits">7</span>
          
          <code class="ruby">    average_release_time = VersionService.average_release_time( product.versions )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="178">
          <span class="hits">7</span>
          
          <code class="ruby">    if average_release_time.nil?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="179">
          <span class="hits">6</span>
          
          <code class="ruby">      average_release_time = VersionService.estimated_average_release_time( product.versions )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="181">
          <span class="hits">7</span>
          
          <code class="ruby">    product.average_release_time = average_release_time</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="185">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_followers_for product</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="186">
          <span class="hits">8</span>
          
          <code class="ruby">    return nil if product.followers == product.user_ids.count</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="188">
          <span class="hits">1</span>
          
          <code class="ruby">    product.followers = product.user_ids.count</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="189">
          <span class="hits">1</span>
          
          <code class="ruby">    product.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="193">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_followers</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="194">
          <span class="hits">1</span>
          
          <code class="ruby">    products = Product.where( :&#39;user_ids.0&#39; =&gt; {&#39;$exists&#39; =&gt; true} )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="195">
          <span class="hits">1</span>
          
          <code class="ruby">    products.each do |product|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="196">
          <span class="hits">2</span>
          
          <code class="ruby">      self.update_followers_for product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="201">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove product</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="202">
          <span class="hits">1</span>
          
          <code class="ruby">    EsProduct.remove( product )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="204">
          <span class="hits">1</span>
          
          <code class="ruby">    archives = Versionarchive.where( :language =&gt; product.language, :prod_key =&gt; product.prod_key )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="205">
          <span class="hits">1</span>
          
          <code class="ruby">    if archives &amp;&amp; !archives.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="206">
          
          
          <code class="ruby">      archives.each do |archive|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">        archive.delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="211">
          <span class="hits">1</span>
          
          <code class="ruby">    links = Versionlink.where( :language =&gt; product.language, :prod_key =&gt; product.prod_key )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">    if links &amp;&amp; !links.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="213">
          
          
          <code class="ruby">      links.each do |link|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">        link.delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">    dependencies = Dependency.where( :language =&gt; product.language, :prod_key =&gt; product.prod_key )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="219">
          <span class="hits">1</span>
          
          <code class="ruby">    if dependencies &amp;&amp; !dependencies.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="220">
          
          
          <code class="ruby">      dependencies.each do |dependency|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="221">
          
          
          <code class="ruby">        dependency.delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>
          
          <code class="ruby">    product.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="229">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.most_referenced(language, page)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="230">
          
          
          <code class="ruby">    Product.by_language( language ).desc(:used_by_count).paginate(:page =&gt; page)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6a3a58acd9c2b082e4d540886fb821ffe34f50a2">
  <div class="header">
    <h3>lib/versioneye/services/project_batch_update_service.rb</h3>
    <h4><span class="green">93.65 %</span> covered</h4>
    <div>
      <b>63</b> relevant lines. 
      <span class="green"><b>59</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectBatchUpdateService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  A_EMAIL_TEMPLATE_1 = &#39;projectnotifications_email&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">=begin</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  This method iterates through all users and sends out</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  a project notification email to each user. The project notification email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  contains a status list with all projects of the user.  The list</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">  includes projects which belong to the user and projects where</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  the user is collaborator.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">=end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_all period</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="13">
          <span class="hits">6</span>
          
          <code class="ruby">    project_ids = []</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="14">
          <span class="hits">6</span>
          
          <code class="ruby">    UserService.all_users_paged do |users|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="15">
          <span class="hits">12</span>
          
          <code class="ruby">      update_for users, period, project_ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="17">
          <span class="hits">6</span>
          
          <code class="ruby">    project_ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_for users, period, project_ids = nil</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="25">
          <span class="hits">12</span>
          
          <code class="ruby">    return nil if users.nil? || users.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="27">
          <span class="hits">6</span>
          
          <code class="ruby">    users.each do |user|</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="28">
          <span class="hits">7</span>
          
          <code class="ruby">      process user, period, project_ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process user, period, project_ids = nil</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="34">
          <span class="hits">7</span>
          
          <code class="ruby">    return nil if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="35">
          <span class="hits">7</span>
          
          <code class="ruby">    return nil if user.deleted_user == true</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="36">
          <span class="hits">7</span>
          
          <code class="ruby">    return nil if user.email_inactive == true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="38">
          <span class="hits">7</span>
          
          <code class="ruby">    uns = UserNotificationSetting.fetch_or_create_notification_setting( user )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="39">
          <span class="hits">7</span>
          
          <code class="ruby">    return nil if uns.project_emails == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="41">
          <span class="hits">7</span>
          
          <code class="ruby">    return nil if MailTrack.send_already? user.ids, A_EMAIL_TEMPLATE_1, period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="43">
          <span class="hits">6</span>
          
          <code class="ruby">    perform_update user, period, project_ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="45">
          <span class="hits">6</span>
          
          <code class="ruby">    projects     = fetch_affected_projects user, period</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="46">
          <span class="hits">6</span>
          
          <code class="ruby">    col_projects = fetch_affected_collaboration_projects user, period</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="47">
          <span class="hits">6</span>
          
          <code class="ruby">    return nil if (projects.nil? || projects.empty?) &amp;&amp; (col_projects.nil? || col_projects.empty?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="49">
          <span class="hits">5</span>
          
          <code class="ruby">    ProjectMailer.projectnotifications_email( user, projects, col_projects, period ).deliver_now</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="50">
          <span class="hits">5</span>
          
          <code class="ruby">    MailTrack.add user.ids, A_EMAIL_TEMPLATE_1, period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  # Update the projects. Re parse the project files and update the numbers!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.perform_update user, period, project_ids = nil</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="59">
          <span class="hits">6</span>
          
          <code class="ruby">    projects     = fetch_projects user, period</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="60">
          <span class="hits">6</span>
          
          <code class="ruby">    col_projects = fetch_collaboration_projects user, period</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="61">
          <span class="hits">6</span>
          
          <code class="ruby">    return nil if (projects.nil? || projects.empty?) &amp;&amp; (col_projects.nil? || col_projects.empty?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="63">
          <span class="hits">6</span>
          
          <code class="ruby">    log.info &quot;process #{period} projects for #{user.fullname}&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="64">
          <span class="hits">6</span>
          
          <code class="ruby">    update_projects projects, false, project_ids</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="65">
          <span class="hits">6</span>
          
          <code class="ruby">    update_projects col_projects, false, project_ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_projects projects, send_email = false, project_ids = nil</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="70">
          <span class="hits">12</span>
          
          <code class="ruby">    return nil if projects.nil? || projects.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="72">
          <span class="hits">6</span>
          
          <code class="ruby">    projects.each do |project|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="73">
          <span class="hits">6</span>
          
          <code class="ruby">      next if project_ids &amp;&amp; project_ids.include?(project.ids)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="75">
          <span class="hits">5</span>
          
          <code class="ruby">      ProjectUpdateService.update project, send_email</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="76">
          <span class="hits">5</span>
          
          <code class="ruby">      project_ids.push(project.ids) if project_ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="84">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fetch_projects user, period</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="85">
          <span class="hits">6</span>
          
          <code class="ruby">      return [] if user.projects.nil? || user.projects.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="87">
          <span class="hits">5</span>
          
          <code class="ruby">      user.projects.by_period( period ).parents</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fetch_affected_projects user, period</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="91">
          <span class="hits">6</span>
          
          <code class="ruby">      return [] if user.projects.nil? || user.projects.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="93">
          <span class="hits">5</span>
          
          <code class="ruby">      user.projects.by_period( period ).parents.any_of({:out_number_sum.gt =&gt; 0},{:licenses_red_sum.gt =&gt; 0})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="96">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fetch_collaboration_projects user, period</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="97">
          <span class="hits">12</span>
          
          <code class="ruby">      collaborations = ProjectCollaborator.by_user( user ).where(:period =&gt; period)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="98">
          <span class="hits">12</span>
          
          <code class="ruby">      projects = []</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="99">
          <span class="hits">12</span>
          
          <code class="ruby">      collaborations.each do |collab|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="100">
          <span class="hits">3</span>
          
          <code class="ruby">        if collab.project.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">          collab.remove</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">          next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="104">
          <span class="hits">2</span>
          
          <code class="ruby">        projects &lt;&lt; collab.project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="106">
          <span class="hits">12</span>
          
          <code class="ruby">      projects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fetch_affected_collaboration_projects user, period</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="110">
          <span class="hits">6</span>
          
          <code class="ruby">      projects = []</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="111">
          <span class="hits">6</span>
          
          <code class="ruby">      pros = fetch_collaboration_projects user, period</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="112">
          <span class="hits">6</span>
          
          <code class="ruby">      pros.each do |project|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">        projects &lt;&lt; project if project.licenses_red_sum &gt; 0 || project.out_number_sum &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="115">
          <span class="hits">6</span>
          
          <code class="ruby">      projects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="b089dffcf89f5eb38ab71389853c1ad767df5df6">
  <div class="header">
    <h3>lib/versioneye/services/project_collaborator_service.rb</h3>
    <h4><span class="green">93.94 %</span> covered</h4>
    <div>
      <b>33</b> relevant lines. 
      <span class="green"><b>31</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectCollaboratorService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">  # collaborator_info is either a username or a email address!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.add_new project, caller_user, collaborator_info</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="6">
          <span class="hits">5</span>
          
          <code class="ruby">    user = User.find_by_username( collaborator_info )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="7">
          <span class="hits">5</span>
          
          <code class="ruby">    user = by_email( collaborator_info ) if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="8">
          <span class="hits">5</span>
          
          <code class="ruby">    if user &amp;&amp; ProjectCollaborator.collaborator?(project[:_id].to_s, user[:_id].to_s)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">      raise &quot;#{user[:fullname]} is already a collaborator in your project.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="12">
          <span class="hits">4</span>
          
          <code class="ruby">    new_collaborator = ProjectCollaborator.new project_id: project[:_id].to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">                                               caller_id: caller_user[:_id].to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">                                               owner_id: project[:user_id].to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">                                               period: project.period</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="17">
          <span class="hits">4</span>
          
          <code class="ruby">    if user</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="18">
          <span class="hits">3</span>
          
          <code class="ruby">      add_existing_user( project, new_collaborator, user )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">      invite_user( project, new_collaborator, collaborator_info )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="23">
          <span class="hits">4</span>
          
          <code class="ruby">    new_collaborator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.add_existing_user project, new_collaborator, user</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="28">
          <span class="hits">3</span>
          
          <code class="ruby">    new_collaborator[:active]  = true</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="29">
          <span class="hits">3</span>
          
          <code class="ruby">    new_collaborator[:user_id] = user[:_id].to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="31">
          <span class="hits">3</span>
          
          <code class="ruby">    if new_collaborator.save == false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      raise &quot;Failure: can&#39;t add new collaborator - #{new_collaborator.errors.full_messages.to_sentence}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="35">
          <span class="hits">3</span>
          
          <code class="ruby">    project.collaborators &lt;&lt; new_collaborator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="37">
          <span class="hits">3</span>
          
          <code class="ruby">    UserMailer.new_collaboration(new_collaborator).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.invite_user project, new_collaborator, collaborator_info</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    new_collaborator[:invitation_email] = collaborator_info</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    new_collaborator[:invitation_code] = UserService.create_random_token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    if new_collaborator.save == false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">      raise &quot;Failure: can&#39;t add new collaborator - #{new_collaborator.errors.full_messages.to_sentence}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    project.collaborators &lt;&lt; new_collaborator</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    if collaborator_info.to_s.match( User::A_EMAIL_REGEX )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">      UserMailer.collaboration_invitation( new_collaborator ).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.by_email email</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="60">
          <span class="hits">4</span>
          
          <code class="ruby">      user = User.find_by_email( email )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="61">
          <span class="hits">4</span>
          
          <code class="ruby">      if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="62">
          <span class="hits">3</span>
          
          <code class="ruby">        ue = UserEmail.find_by_email( email )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="63">
          <span class="hits">3</span>
          
          <code class="ruby">        user = ue.user if ue &amp;&amp; ue.verified?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="65">
          <span class="hits">4</span>
          
          <code class="ruby">      user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="69afb924e0948edda2509576aed3fb325e7fd478">
  <div class="header">
    <h3>lib/versioneye/services/project_import_service.rb</h3>
    <h4><span class="yellow">82.39 %</span> covered</h4>
    <div>
      <b>176</b> relevant lines. 
      <span class="green"><b>145</b> lines covered</span> and
      <span class="red"><b>31</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectImportService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  A_ENV_ENTERPRISE = &quot;enterprise&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_RUNNING = &#39;running&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_TTL     = 60 # 60 seconds = 1 minute</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_github_async user, repo_name, filename, branch = &#39;master&#39;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="9">
          <span class="hits">3</span>
          
          <code class="ruby">    key = &quot;github:::#{user.username}:::#{repo_name}:::#{filename}:::#{branch}&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="10">
          <span class="hits">4</span>
          
          <code class="ruby">    task_status( key ){ GitRepoFileImportProducer.new( key ) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_github_multi user, repo_name, filename, branch = &#39;master&#39;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="14">
          <span class="hits">3</span>
          
          <code class="ruby">    private_project = Github.private_repo? user.github_token, repo_name</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>
          
          <code class="ruby">    check_permission_for_github_repo user, repo_name, private_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="17">
          <span class="hits">3</span>
          
          <code class="ruby">    project = import_from_github user, repo_name, filename, branch, false, private_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="19">
          <span class="hits">3</span>
          
          <code class="ruby">    lock_file = ProjectService.corresponding_file filename</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="20">
          <span class="hits">3</span>
          
          <code class="ruby">    if lock_file</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      key = &quot;github_child:::#{user.username}:::#{repo_name}:::#{lock_file}:::#{branch}:::#{project.id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">      GitRepoFileImportProducer.new( key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="25">
          <span class="hits">3</span>
          
          <code class="ruby">    ProjectService.update_sums( project )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="26">
          <span class="hits">3</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_child_from_github user, repo_name, lock_file, branch, project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    child = import_from_github user, repo_name, lock_file, branch, false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    child.parent_id = project.id.to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">    child.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    ProjectService.update_sums( child.parent )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_github user, repo_name, filename, branch = &#39;master&#39;, check_permission = true, private_project = nil</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="40">
          <span class="hits">8</span>
          
          <code class="ruby">    if private_project.nil?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="41">
          <span class="hits">8</span>
          
          <code class="ruby">      private_project = Github.private_repo? user.github_token, repo_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="43">
          <span class="hits">8</span>
          
          <code class="ruby">    if check_permission</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="44">
          <span class="hits">4</span>
          
          <code class="ruby">      check_permission_for_github_repo user, repo_name, private_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="47">
          <span class="hits">7</span>
          
          <code class="ruby">    project_file = Github.fetch_project_file_from_branch(repo_name, filename, branch, user[:github_token] )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="48">
          <span class="hits">7</span>
          
          <code class="ruby">    if project_file.nil?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">      log.error &quot; Can&#39;t import project file `#{filename}` from #{repo_name} branch #{branch} &quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">      raise &quot; Didn&#39;t find any project file of a supported package manager.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="53">
          <span class="hits">6</span>
          
          <code class="ruby">    file_txt  = GitHubService.pure_text_from project_file</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="54">
          <span class="hits">6</span>
          
          <code class="ruby">    file_name = GitHubService.filename_from project_file</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="55">
          <span class="hits">6</span>
          
          <code class="ruby">    parser    = ProjectParseService.parser_for file_name</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="56">
          <span class="hits">6</span>
          
          <code class="ruby">    project   = ProjectParseService.parse_content parser, file_txt, file_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="58">
          <span class="hits">6</span>
          
          <code class="ruby">    project.update_attributes({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">      name: repo_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">      project_type: project_file[:type],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">      user_id: user.id.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">      source: Project::A_SOURCE_GITHUB,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">      private_project: private_project,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      scm_fullname: repo_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">      scm_branch: branch,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">      s3_filename: filename,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">      url: project_file[:url],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">      period: Settings.instance.default_project_period,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">      public: Settings.instance.default_project_public</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="72">
          <span class="hits">6</span>
          
          <code class="ruby">    ProjectService.store( project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_bitbucket_async user, repo_name, filename, branch = &#39;master&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="77">
          <span class="hits">2</span>
          
          <code class="ruby">    key = &quot;bitbucket:::#{user.username}:::#{repo_name}:::#{filename}:::#{branch}&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="78">
          <span class="hits">3</span>
          
          <code class="ruby">    task_status( key ){ GitRepoFileImportProducer.new( key ) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_bitbucket_multi user, repo_name, filename, branch = &#39;master&#39;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="82">
          <span class="hits">3</span>
          
          <code class="ruby">    repo = BitbucketRepo.by_user(user).by_fullname(repo_name).shift</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="83">
          <span class="hits">3</span>
          
          <code class="ruby">    private_project = repo[:private]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="84">
          <span class="hits">3</span>
          
          <code class="ruby">    check_permission_for_bitbucket_repo user, private_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="86">
          <span class="hits">3</span>
          
          <code class="ruby">    project = import_from_bitbucket user, repo_name, filename, branch, false, repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="88">
          <span class="hits">3</span>
          
          <code class="ruby">    lock_file = ProjectService.corresponding_file filename</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="89">
          <span class="hits">3</span>
          
          <code class="ruby">    if lock_file</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">      key = &quot;bitbucket_child:::#{user.username}:::#{repo_name}:::#{lock_file}:::#{branch}:::#{project.id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">      GitRepoFileImportProducer.new( key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="94">
          <span class="hits">3</span>
          
          <code class="ruby">    ProjectService.update_sums( project )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="95">
          <span class="hits">3</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_child_from_bitbucket user, repo_name, lock_file, branch, project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">    child = import_from_bitbucket user, repo_name, lock_file, branch, false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">    child.parent_id = project.id.to_s</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="101">
          <span class="hits">1</span>
          
          <code class="ruby">    child.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">    ProjectService.update_sums( project )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">    child</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_bitbucket(user, repo_name, filename, branch = &quot;master&quot;, check_permission = true, repo = nil)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="109">
          <span class="hits">6</span>
          
          <code class="ruby">    if repo.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="110">
          <span class="hits">3</span>
          
          <code class="ruby">      repo = BitbucketRepo.by_user(user).by_fullname(repo_name).shift</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="112">
          <span class="hits">6</span>
          
          <code class="ruby">    private_project = repo[:private]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="114">
          <span class="hits">6</span>
          
          <code class="ruby">    if check_permission</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="115">
          <span class="hits">2</span>
          
          <code class="ruby">      check_permission_for_bitbucket_repo user, private_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="118">
          <span class="hits">6</span>
          
          <code class="ruby">    project_file = Bitbucket.fetch_project_file_from_branch(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">      repo_name, branch, filename,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">      user[:bitbucket_token], user[:bitbucket_secret]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">    )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="123">
          <span class="hits">6</span>
          
          <code class="ruby">    if project_file.nil? || project_file == &quot;error&quot; || project_file.eql?(&quot;Not Found&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">      log.error &quot; Can&#39;t import project file `#{filename}` from #{repo_name} branch #{branch} &quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">      return &quot; Didn&#39;t find any project file of a supported package manager.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="128">
          <span class="hits">5</span>
          
          <code class="ruby">    project_type = ProjectService.type_by_filename filename</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="129">
          <span class="hits">5</span>
          
          <code class="ruby">    file_name = filename.split(&quot;/&quot;).last</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="130">
          <span class="hits">5</span>
          
          <code class="ruby">    parser  = ProjectParseService.parser_for file_name</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="131">
          <span class="hits">5</span>
          
          <code class="ruby">    project = ProjectParseService.parse_content parser, project_file, file_name</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="132">
          <span class="hits">5</span>
          
          <code class="ruby">    revision = BitbucketRepo.revision_for user, repo_name, branch, filename</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="134">
          <span class="hits">5</span>
          
          <code class="ruby">    project.update_attributes({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby">      name: repo_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">      project_type: project_type,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">      user_id: user.id.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">      source: Project::A_SOURCE_BITBUCKET,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">      scm_fullname: repo_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">      scm_branch: branch,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">      scm_revision: revision,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">      private_project: private_project,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby">      s3_filename: filename,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">      url: nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">      period: Settings.instance.default_project_period,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">      public: Settings.instance.default_project_public</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="149">
          <span class="hits">5</span>
          
          <code class="ruby">    ProjectService.store( project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="153">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_stash_async user, repo_name, filename, branch = &#39;master&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">    key = &quot;stash:::#{user.username}:::#{repo_name}:::#{filename}:::#{branch}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">    task_status( key ){ GitRepoFileImportProducer.new( key ) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_stash_multi user, repo_name, filename, branch = &#39;master&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">    project = import_from_stash user, repo_name, filename, branch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">    lock_file = ProjectService.corresponding_file filename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">    if lock_file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">      import_child_from_stash user, repo_name, lock_file, branch, project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="164">
          
          
          <code class="ruby">    ProjectService.update_sums( project )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="167">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="168">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_child_from_stash user, repo_name, lock_file, branch, project</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">    child = import_from_stash user, repo_name, lock_file, branch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="170">
          
          
          <code class="ruby">    child.parent_id = project.id.to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">    child.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="176">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_stash(user, repo_name, filename, branch = &quot;master&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">    repo = StashRepo.by_user(user).by_fullname(repo_name).shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="178">
          
          
          <code class="ruby">    private_project = !repo[:public_repo]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">    unless allowed_to_add_project?(user, private_project)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="180">
          
          
          <code class="ruby">      return &quot;Please upgrade your plan to monitor the selected project.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="183">
          
          
          <code class="ruby">    project_file = StashService.fetch_file_from_stash(user, repo, filename, branch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">    if project_file.nil? || project_file.empty? || project_file == &quot;error&quot; || project_file.eql?(&quot;Not Found&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">      log.error &quot; Can&#39;t import project file `#{filename}` from #{repo_name} branch #{branch} &quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="186">
          
          
          <code class="ruby">      return &quot; Didn&#39;t find any project file of a supported package manager.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">    project_type = ProjectService.type_by_filename filename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="190">
          
          
          <code class="ruby">    content = StashService.pure_text_from project_file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">    project = StashService.parse_content content, filename</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">    project.update_attributes({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby">      name: repo_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">      project_type: project_type,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">      user_id: user.id.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">      source: Project::A_SOURCE_STASH,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">      scm_fullname: repo_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">      scm_branch: branch,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby">      private_project: private_project,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      s3_filename: filename,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">      url: nil,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">      period: Settings.instance.default_project_period,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">      public: Settings.instance.default_project_public</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="207">
          
          
          <code class="ruby">    ProjectService.store( project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="211">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_url( url, project_name, user )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="212">
          <span class="hits">2</span>
          
          <code class="ruby">    project = build_from_url( url )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="213">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="215">
          <span class="hits">2</span>
          
          <code class="ruby">    if project.name.nil? || project.name.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="216">
          <span class="hits">2</span>
          
          <code class="ruby">      project.name = project_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="218">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="219">
          <span class="hits">2</span>
          
          <code class="ruby">    project.update_attributes({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">      user_id: user.id.to_s,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">      source: Project::A_SOURCE_URL,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">      s3_filename: project_name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">      url: url,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="224">
          
          
          <code class="ruby">      period: Settings.instance.default_project_period,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">      public: Settings.instance.default_project_public</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="228">
          <span class="hits">2</span>
          
          <code class="ruby">    project = ProjectService.store( project )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="229">
          <span class="hits">2</span>
          
          <code class="ruby">    ProjectService.update_sums( project )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="230">
          <span class="hits">2</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">  # This is currently used by the VersionEye API project and the file upload in the Web UI.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="235">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.import_from_upload file, user = nil, api_created = false</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="236">
          <span class="hits">3</span>
          
          <code class="ruby">    project_name = file[&#39;datafile&#39;].original_filename</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="237">
          <span class="hits">3</span>
          
          <code class="ruby">    project = ProjectParseService.project_from file</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="239">
          <span class="hits">3</span>
          
          <code class="ruby">    if project.name.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="240">
          <span class="hits">3</span>
          
          <code class="ruby">      project_name = file[&#39;datafile&#39;].original_filename</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="241">
          <span class="hits">3</span>
          
          <code class="ruby">      project.s3_filename = project_name</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="242">
          <span class="hits">3</span>
          
          <code class="ruby">      project.name        = project_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="244">
          <span class="hits">3</span>
          
          <code class="ruby">    project.source      = Project::A_SOURCE_UPLOAD</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="245">
          <span class="hits">3</span>
          
          <code class="ruby">    project.source      = Project::A_SOURCE_API if api_created</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="246">
          <span class="hits">3</span>
          
          <code class="ruby">    project.user        = user</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="247">
          <span class="hits">3</span>
          
          <code class="ruby">    project.period      = Settings.instance.default_project_period</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="248">
          <span class="hits">3</span>
          
          <code class="ruby">    project.public      = Settings.instance.default_project_public</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="249">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="250">
          <span class="hits">3</span>
          
          <code class="ruby">    project = ProjectService.store( project )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="251">
          <span class="hits">3</span>
          
          <code class="ruby">    ProjectService.update_sums( project )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="252">
          <span class="hits">3</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="256">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.check_permission_for_github_repo user, repo_name, private_project = nil</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="257">
          <span class="hits">7</span>
          
          <code class="ruby">    if private_project.nil?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="258">
          <span class="hits">5</span>
          
          <code class="ruby">      private_project = Github.private_repo? user.github_token, repo_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="260">
          <span class="hits">7</span>
          
          <code class="ruby">    if allowed_to_add_project?(user, private_project) == false</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="261">
          <span class="hits">1</span>
          
          <code class="ruby">      raise &quot;The selected project file is in a private repository. Please upgrade your plan to monitor the selected project.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="263">
          <span class="hits">6</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="267">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.check_permission_for_bitbucket_repo user, private_project</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="268">
          <span class="hits">5</span>
          
          <code class="ruby">    if allowed_to_add_project?(user, private_project) == false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="269">
          
          
          <code class="ruby">      raise &quot;The selected project file is in a private repository. Please upgrade your plan to monitor the selected project.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="271">
          <span class="hits">5</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="272">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="273">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="275">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.allowed_to_add_project?( user, private_project )</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="276">
          <span class="hits">20</span>
          
          <code class="ruby">    env = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="277">
          <span class="hits">20</span>
          
          <code class="ruby">    return allowed_to_add_e_project?() if env.eql?( A_ENV_ENTERPRISE )</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="278">
          <span class="hits">18</span>
          
          <code class="ruby">    return allowed_to_add?( user, private_project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="279">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="282">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.task_status( key )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="283">
          <span class="hits">5</span>
          
          <code class="ruby">    task_status = cache.get( key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">    if task_status &amp;&amp;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">      ( task_status.to_s == A_TASK_RUNNING ||</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">        task_status.to_s.match(/\Adone_/)  ||</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="287">
          <span class="hits">5</span>
          
          <code class="ruby">        task_status.to_s.match(/\Aerror_/) )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="288">
          <span class="hits">3</span>
          
          <code class="ruby">      log.debug &quot;status for #{key} is #{task_status}&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="289">
          <span class="hits">3</span>
          
          <code class="ruby">      return task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="292">
          <span class="hits">2</span>
          
          <code class="ruby">    task_status = A_TASK_RUNNING</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="293">
          <span class="hits">2</span>
          
          <code class="ruby">    cache.set( key, task_status, A_TASK_TTL )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="294">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="295">
          <span class="hits">2</span>
          
          <code class="ruby">    yield</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="296">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="297">
          <span class="hits">2</span>
          
          <code class="ruby">    task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="298">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="299">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="301">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby">    # Allowed to add Enterprise project?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="305">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.allowed_to_add_e_project?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="306">
          <span class="hits">2</span>
          
          <code class="ruby">      env        = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="307">
          <span class="hits">2</span>
          
          <code class="ruby">      e_projects = GlobalSetting.get env, &#39;e_projects&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="308">
          <span class="hits">2</span>
          
          <code class="ruby">      return false if e_projects.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="309">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="310">
          <span class="hits">2</span>
          
          <code class="ruby">      project_count = Project.count</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="311">
          <span class="hits">2</span>
          
          <code class="ruby">      return false if project_count.to_i &gt;= e_projects.to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="313">
          <span class="hits">1</span>
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="315">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="316">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="317">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.allowed_to_add?( user, private_project )</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="318">
          <span class="hits">18</span>
          
          <code class="ruby">      return true if private_project == false || private_project.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="320">
          <span class="hits">7</span>
          
          <code class="ruby">      private_project_count = Project.private_project_count_by_user( user.id )</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="321">
          <span class="hits">7</span>
          
          <code class="ruby">      max = user.free_private_projects</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="322">
          <span class="hits">7</span>
          
          <code class="ruby">      if user.plan</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="323">
          <span class="hits">5</span>
          
          <code class="ruby">        max += user.plan.private_projects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="325">
          <span class="hits">7</span>
          
          <code class="ruby">      return false if private_project_count &gt;= max</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="326">
          <span class="hits">4</span>
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="327">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="330">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.build_from_url(url, project_type = nil)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="331">
          <span class="hits">2</span>
          
          <code class="ruby">      project_type = ProjectService.type_by_filename(url) if project_type.nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="332">
          <span class="hits">2</span>
          
          <code class="ruby">      parser       = ParserStrategy.parser_for( project_type, url )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="333">
          <span class="hits">2</span>
          
          <code class="ruby">      parser.parse url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="335">
          
          
          <code class="ruby">      log.error &quot;Error in build_from_url( #{url} ) -&gt; #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="336">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="339">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5ba26566392b08d32526f7168e2629f1eecab10c">
  <div class="header">
    <h3>lib/versioneye/services/project_parse_service.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>20</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectParseService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.project_from file</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="5">
          <span class="hits">6</span>
          
          <code class="ruby">    project_name = file[&#39;datafile&#39;].original_filename</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="6">
          <span class="hits">6</span>
          
          <code class="ruby">    content      = file[&#39;datafile&#39;].read</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="8">
          <span class="hits">6</span>
          
          <code class="ruby">    parser  = parser_for project_name</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="9">
          <span class="hits">6</span>
          
          <code class="ruby">    parse_content parser, content, project_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.parser_for file_name</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="14">
          <span class="hits">25</span>
          
          <code class="ruby">    type   = ProjectService.type_by_filename file_name</code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="15">
          <span class="hits">25</span>
          
          <code class="ruby">    parser = ParserStrategy.parser_for type, file_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.parse_content parser, content, file_name</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="20">
          <span class="hits">22</span>
          
          <code class="ruby">    return nil if parser.nil? || content.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="22">
          <span class="hits">21</span>
          
          <code class="ruby">    if parser.respond_to? &quot;parse_content&quot;</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="23">
          <span class="hits">19</span>
          
          <code class="ruby">      return parser.parse_content content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="26">
          <span class="hits">2</span>
          
          <code class="ruby">    file_path = write_to_file file_name, content</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="27">
          <span class="hits">2</span>
          
          <code class="ruby">    parser.parse_file file_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.write_to_file file_name, content</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    rnd = SecureRandom.urlsafe_base64(7)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">    file_path = &quot;/tmp/#{rnd}_#{file_name}&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="34">
          <span class="hits">4</span>
          
          <code class="ruby">    File.open(file_path, &#39;w&#39;) { |file| file.write( content ) }</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">    file_path</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e49694cbd703d3299a9c701b73e40d769fe5ec90">
  <div class="header">
    <h3>lib/versioneye/services/project_service.rb</h3>
    <h4><span class="green">95.09 %</span> covered</h4>
    <div>
      <b>285</b> relevant lines. 
      <span class="green"><b>271</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.type_by_filename filename</code>
        </li>
      
        <li class="covered" data-hits="105" data-linenumber="4">
          <span class="hits">105</span>
          
          <code class="ruby">    return nil if filename.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="104" data-linenumber="5">
          <span class="hits">104</span>
          
          <code class="ruby">    return nil if filename.to_s.match(/\/node_modules\//) # Skip workirectory of NPM.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="104" data-linenumber="7">
          <span class="hits">104</span>
          
          <code class="ruby">    trimmed_name = filename.split(&#39;?&#39;)[0]</code>
        </li>
      
        <li class="covered" data-hits="104" data-linenumber="8">
          <span class="hits">104</span>
          
          <code class="ruby">    return Project::A_TYPE_RUBYGEMS  if (!(/Gemfile\z/ =~ trimmed_name).nil?)        or (!(/Gemfile.lock\z/  =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="75" data-linenumber="9">
          <span class="hits">75</span>
          
          <code class="ruby">    return Project::A_TYPE_COMPOSER  if (!(/composer.json\z/ =~ trimmed_name).nil?)  or (!(/composer.lock\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="69" data-linenumber="10">
          <span class="hits">69</span>
          
          <code class="ruby">    return Project::A_TYPE_PIP       if (!(/requirements\S*.txt\z/ =~ trimmed_name).nil?)  or (!(/setup.py\z/ =~ trimmed_name).nil?) or (!(/pip.log\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="66" data-linenumber="11">
          <span class="hits">66</span>
          
          <code class="ruby">    return Project::A_TYPE_NPM       if (!(/package.json\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="12">
          <span class="hits">62</span>
          
          <code class="ruby">    return Project::A_TYPE_GRADLE    if (!(/.gradle\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="13">
          <span class="hits">58</span>
          
          <code class="ruby">    return Project::A_TYPE_SBT       if (!(/.sbt\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="14">
          <span class="hits">58</span>
          
          <code class="ruby">    return Project::A_TYPE_MAVEN2    if (!(/pom.xml\z/ =~ trimmed_name).nil?)  or (!(/pom.json\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="38" data-linenumber="15">
          <span class="hits">38</span>
          
          <code class="ruby">    return Project::A_TYPE_LEIN      if (!(/project.clj\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="16">
          <span class="hits">34</span>
          
          <code class="ruby">    return Project::A_TYPE_BOWER     if (!(/bower.json\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="17">
          <span class="hits">32</span>
          
          <code class="ruby">    return Project::A_TYPE_BIICODE   if (!(/biicode.conf\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="covered" data-hits="32" data-linenumber="18">
          <span class="hits">32</span>
          
          <code class="ruby">    return Project::A_TYPE_COCOAPODS if (!(/Podfile\z/ =~ trimmed_name).nil?)  or (!(/.podfile\z/ =~ trimmed_name).nil?) or (!(/Podfile.lock\z/ =~ trimmed_name).nil?)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.corresponding_file filename</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="24">
          <span class="hits">10</span>
          
          <code class="ruby">    return nil if filename.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="25">
          <span class="hits">10</span>
          
          <code class="ruby">    trimmed_name = filename.split(&#39;?&#39;)[0]</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="26">
          <span class="hits">10</span>
          
          <code class="ruby">    return &#39;Gemfile.lock&#39;  if (/Gemfile\z/ =~ trimmed_name) == 0</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="27">
          <span class="hits">7</span>
          
          <code class="ruby">    return &#39;composer.lock&#39; if (/composer.json\z/ =~ trimmed_name) == 0</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="28">
          <span class="hits">6</span>
          
          <code class="ruby">    return &#39;Podfile.lock&#39;  if (/Podfile\z/ =~ trimmed_name) == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.index( user, filter = {}, sort = nil)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="34">
          <span class="hits">7</span>
          
          <code class="ruby">    filter_options            = {:parent_id =&gt; nil}</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="35">
          <span class="hits">7</span>
          
          <code class="ruby">    filter_options[:language] = filter[:language]  if filter[:language] &amp;&amp; !filter[:language].to_s.eql?(&#39;ALL&#39;)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="36">
          <span class="hits">7</span>
          
          <code class="ruby">    filter_options[:name]     = /#{filter[:name]}/i if filter[:name] &amp;&amp; !filter[:name].to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="37">
          <span class="hits">7</span>
          
          <code class="ruby">    if filter[:scope].to_s == &#39;all_public&#39;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="38">
          <span class="hits">3</span>
          
          <code class="ruby">      filter_options[:public] = true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    elsif filter[:scope].to_s == &#39;all&#39; &amp;&amp; user.admin == true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">      # Do nothing. Admin can see ALL projects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="42">
          <span class="hits">4</span>
          
          <code class="ruby">      filter_options[:user_id] = user.ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="45">
          <span class="hits">7</span>
          
          <code class="ruby">    case sort</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">    when &#39;out_dated&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">      Project.where( filter_options ).desc(:out_number_sum).asc(:name_downcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">    when &#39;license_violations&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">      Project.where( filter_options ).desc(:licenses_red_sum).asc(:name_downcase)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="51">
          <span class="hits">6</span>
          
          <code class="ruby">      Project.where( filter_options ).asc(:name_downcase).desc(:licenses_red_sum)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find id</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="57">
          <span class="hits">10</span>
          
          <code class="ruby">    Project.find_by_id( id )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_child parent_id, child_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    Project.where( :id =&gt; child_id, :parent_id =&gt; parent_id ).first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.summary project_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">    map = {}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">    project = find project_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">    summary_single project, map</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">    project.children.each do |child|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">      summary_single child, map</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="79">
          <span class="hits">3</span>
          
          <code class="ruby">    Hash[map.sort_by {|dep| -dep.last[:dependencies].count}]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.summary_single project, map = {}</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="83">
          <span class="hits">2</span>
          
          <code class="ruby">    name = project.filename</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">    name = project.name if name.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="85">
          <span class="hits">2</span>
          
          <code class="ruby">    map[project.ids] = {:id =&gt; project.ids,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">      :name =&gt; name,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">      :dep_number =&gt; project.dep_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      :dep_number_sum =&gt; project.dep_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">      :out_number =&gt; project.out_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">      :out_number_sum =&gt; project.out_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">      :unknown_number =&gt; project.unknown_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">      :unknown_number_sum =&gt; project.unknown_number,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">      :muted_dependencies_count =&gt; project.muted_dependencies_count,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">      :licenses_red =&gt; project.licenses_red,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">      :licenses_red_sum =&gt; project.licenses_red_sum,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">      :licenses_unknown =&gt; project.licenses_unknown,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">      :licenses_unknown_sum =&gt; project.licenses_unknown_sum,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      :sv_count =&gt; project.sv_count,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">      :sv_count_sum =&gt; project.sv_count_sum,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">      :dependencies =&gt; [],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">      :licenses =&gt; [],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">      :sv =&gt; [] }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">    Projectdependency.any_of(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">      {:project_id =&gt; project.ids, :outdated =&gt; true},</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="106">
          <span class="hits">2</span>
          
          <code class="ruby">      {:project_id =&gt; project.ids, :prod_key =&gt; nil} ).each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">      map[project.ids][:dependencies].push dep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    Projectdependency.any_of(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">      {:project_id =&gt; project.ids, :lwl_violation =&gt; &#39;true&#39;},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">      {:project_id =&gt; project.ids, :license_caches =&gt; nil},</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="113">
          <span class="hits">2</span>
          
          <code class="ruby">      {:project_id =&gt; project.ids, :license_caches.with_size =&gt; 0} ).each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="114">
          <span class="hits">3</span>
          
          <code class="ruby">      map[project.ids][:licenses].push dep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="117">
          <span class="hits">2</span>
          
          <code class="ruby">    fill_sv project, map</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="119">
          <span class="hits">2</span>
          
          <code class="ruby">    map</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.store project</code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="124">
          <span class="hits">18</span>
          
          <code class="ruby">    raise &quot;project is nil.&quot; if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="18" data-linenumber="126">
          <span class="hits">18</span>
          
          <code class="ruby">    if project.allow_zero_deps != true &amp;&amp; (project.dependencies.nil? || project.dependencies.empty?)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="127">
          <span class="hits">1</span>
          
          <code class="ruby">      raise &quot;Could not find a single dependency in the project.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="130">
          <span class="hits">17</span>
          
          <code class="ruby">    ensure_unique_ga( project )</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="131">
          <span class="hits">17</span>
          
          <code class="ruby">    ensure_unique_scm( project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="133">
          <span class="hits">17</span>
          
          <code class="ruby">    default_lwl_id = LicenseWhitelistService.fetch_default_id project.user</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="134">
          <span class="hits">17</span>
          
          <code class="ruby">    project.license_whitelist_id = default_lwl_id</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="135">
          <span class="hits">17</span>
          
          <code class="ruby">    project.make_project_key!</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="136">
          <span class="hits">17</span>
          
          <code class="ruby">    if project.save</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="137">
          <span class="hits">17</span>
          
          <code class="ruby">      project.save_dependencies</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="138">
          <span class="hits">17</span>
          
          <code class="ruby">      update_license_numbers!( project )</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="139">
          <span class="hits">17</span>
          
          <code class="ruby">      ProjectdependencyService.update_security project</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="140">
          <span class="hits">17</span>
          
          <code class="ruby">      SyncService.sync_project_async project # For Enterprise environment only!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="142">
          
          
          <code class="ruby">      err_msg = &quot;Can&#39;t save project: #{project.errors.full_messages.to_json}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">      log.error err_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">      raise err_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="146">
          <span class="hits">17</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ensure_unique_ga project</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="151">
          <span class="hits">20</span>
          
          <code class="ruby">    return true if Settings.instance.projects_unique_ga == false</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="152">
          <span class="hits">2</span>
          
          <code class="ruby">    return true if project.group_id.to_s.empty? &amp;&amp; project.artifact_id.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="154">
          <span class="hits">2</span>
          
          <code class="ruby">    project = Project.find_by_ga( project.group_id, project.artifact_id )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="155">
          <span class="hits">2</span>
          
          <code class="ruby">    return true if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="157">
          <span class="hits">1</span>
          
          <code class="ruby">    err_msg = &quot;A project with same GroupId and ArtifactId exist already. Project ID: #{project.id.to_s}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="158">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error err_msg</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>
          
          <code class="ruby">    raise err_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="163">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.ensure_unique_scm project</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="164">
          <span class="hits">20</span>
          
          <code class="ruby">    return true if Settings.instance.projects_unique_scm == false</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="165">
          <span class="hits">2</span>
          
          <code class="ruby">    return true if project.scm_fullname.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="167">
          <span class="hits">2</span>
          
          <code class="ruby">    project = Project.where(:source =&gt; project.source, :scm_fullname =&gt; project.scm_fullname, :scm_branch =&gt; project.scm_branch, :s3_filename =&gt; project.s3_filename).first</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="168">
          <span class="hits">2</span>
          
          <code class="ruby">    return true if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="170">
          <span class="hits">1</span>
          
          <code class="ruby">    err_msg = &quot;The project file is already monitored by VersionEye. Project ID: #{project.id.to_s}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="171">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error err_msg</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="172">
          <span class="hits">1</span>
          
          <code class="ruby">    raise err_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="176">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.merge_by_ga group_id, artifact_id, subproject_id, user_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="177">
          <span class="hits">1</span>
          
          <code class="ruby">    parent = Project.by_user_id(user_id).find_by_ga(group_id, artifact_id)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="178">
          <span class="hits">1</span>
          
          <code class="ruby">    resp = merge( parent.id.to_s, subproject_id, user_id )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="179">
          <span class="hits">1</span>
          
          <code class="ruby">    update_sums parent</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="180">
          <span class="hits">1</span>
          
          <code class="ruby">    resp</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="184">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.merge project_id, subproject_id, user_id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="185">
          <span class="hits">3</span>
          
          <code class="ruby">    project    = find project_id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="186">
          <span class="hits">3</span>
          
          <code class="ruby">    subproject = find subproject_id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="187">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if project.nil? || subproject.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="188">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if subproject.parent_id        # subproject has already a parent project!</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="189">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if project.parent_id           # project is already a subproject!</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="190">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if !subproject.children.empty? # subproject is a parent project!</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="191">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if project.id.to_s.eql?(subproject.id.to_s) # project &amp; subproject are the same!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="193">
          <span class="hits">3</span>
          
          <code class="ruby">    user = User.find user_id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="194">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="196">
          <span class="hits">3</span>
          
          <code class="ruby">    if !project.collaborator?(user)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="197">
          <span class="hits">1</span>
          
          <code class="ruby">      raise &quot;User has no permission to merge this project!&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="200">
          <span class="hits">2</span>
          
          <code class="ruby">    subproject.parent_id = project.id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="201">
          <span class="hits">2</span>
          
          <code class="ruby">    subproject.license_whitelist_id = project.license_whitelist_id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="202">
          <span class="hits">2</span>
          
          <code class="ruby">    subproject.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="204">
          <span class="hits">2</span>
          
          <code class="ruby">    reset_badge project</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="205">
          <span class="hits">2</span>
          
          <code class="ruby">    reset_badge subproject</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="207">
          <span class="hits">2</span>
          
          <code class="ruby">    ProjectUpdateService.update_async project</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="208">
          <span class="hits">2</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="212">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.unmerge project_id, subproject_id, user_id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="213">
          <span class="hits">2</span>
          
          <code class="ruby">    project    = find project_id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="214">
          <span class="hits">2</span>
          
          <code class="ruby">    subproject = Project.where( :id =&gt; subproject_id, :parent_id =&gt; project_id ).first</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="215">
          <span class="hits">2</span>
          
          <code class="ruby">    return false if project.nil? || subproject.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="217">
          <span class="hits">2</span>
          
          <code class="ruby">    user = User.find user_id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="218">
          <span class="hits">2</span>
          
          <code class="ruby">    return false if user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="219">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="220">
          <span class="hits">2</span>
          
          <code class="ruby">    if !project.collaborator?(user)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>
          
          <code class="ruby">      raise &quot;User has no permission to unmerge this project!&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>
          
          <code class="ruby">    subproject.parent_id = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="225">
          <span class="hits">1</span>
          
          <code class="ruby">    subproject.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="227">
          <span class="hits">1</span>
          
          <code class="ruby">    reset_badge project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="228">
          <span class="hits">1</span>
          
          <code class="ruby">    reset_badge subproject</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="230">
          <span class="hits">1</span>
          
          <code class="ruby">    ProjectUpdateService.update_async project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="231">
          <span class="hits">1</span>
          
          <code class="ruby">    ProjectUpdateService.update_async subproject</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="232">
          <span class="hits">1</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="236">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.destroy_by user, project_id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="237">
          <span class="hits">3</span>
          
          <code class="ruby">    project = Project.find_by_id( project_id )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="238">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="240">
          <span class="hits">3</span>
          
          <code class="ruby">    if project.collaborator?( user ) || user.admin == true</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="241">
          <span class="hits">2</span>
          
          <code class="ruby">      destroy project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="242">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="243">
          <span class="hits">1</span>
          
          <code class="ruby">      raise &quot;User has no permission to delete this project!&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="245">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="248">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.destroy project</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="249">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="250">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="251">
          <span class="hits">3</span>
          
          <code class="ruby">    project.children.each do |child_project|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="252">
          <span class="hits">1</span>
          
          <code class="ruby">      destroy_single child_project.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="254">
          <span class="hits">3</span>
          
          <code class="ruby">    destroy_single project.id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="258">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.destroy_single project_id</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="259">
          <span class="hits">5</span>
          
          <code class="ruby">    project = Project.find_by_id( project_id )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="260">
          <span class="hits">5</span>
          
          <code class="ruby">    return false if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="262">
          <span class="hits">5</span>
          
          <code class="ruby">    project.remove_dependencies</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="263">
          <span class="hits">5</span>
          
          <code class="ruby">    project.remove_collaborators</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="264">
          <span class="hits">5</span>
          
          <code class="ruby">    project.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">  # Returns a map with</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">  #  - :key =&gt; &quot;language_prod_key&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby">  #  - :value =&gt; &quot;Array of project IDs where the prod_key is used&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="271">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.user_product_index_map user, add_collaborated = true</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="272">
          <span class="hits">8</span>
          
          <code class="ruby">    indexes = Hash.new</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="273">
          <span class="hits">8</span>
          
          <code class="ruby">    projects = user.projects</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="274">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="275">
          <span class="hits">8</span>
          
          <code class="ruby">    if projects</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="276">
          <span class="hits">8</span>
          
          <code class="ruby">      project_prod_index projects, indexes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="277">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="278">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="279">
          <span class="hits">8</span>
          
          <code class="ruby">    return indexes if add_collaborated == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="281">
          <span class="hits">8</span>
          
          <code class="ruby">    collaborated_projects = Project.by_collaborator(user)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="282">
          <span class="hits">8</span>
          
          <code class="ruby">    if collaborated_projects</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="283">
          <span class="hits">8</span>
          
          <code class="ruby">      project_prod_index collaborated_projects, indexes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="286">
          <span class="hits">8</span>
          
          <code class="ruby">    indexes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="289">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.project_prod_index projects, indexes</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="290">
          <span class="hits">16</span>
          
          <code class="ruby">    projects.each do |project|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="291">
          <span class="hits">3</span>
          
          <code class="ruby">      next if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="292">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="293">
          <span class="hits">3</span>
          
          <code class="ruby">      project.dependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="294">
          <span class="hits">5</span>
          
          <code class="ruby">        next if dep.nil? or dep.product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="295">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="296">
          <span class="hits">5</span>
          
          <code class="ruby">        product = dep.product</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="297">
          <span class="hits">5</span>
          
          <code class="ruby">        prod_id = &quot;#{product.language_esc}_#{product.prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="298">
          <span class="hits">5</span>
          
          <code class="ruby">        indexes[prod_id] = [] unless indexes.has_key?(prod_id)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="299">
          <span class="hits">5</span>
          
          <code class="ruby">        indexes[prod_id] &lt;&lt; {:project_id =&gt; project[:_id].to_s, :version_requested =&gt; dep.version_requested}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="301">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="302">
          <span class="hits">16</span>
          
          <code class="ruby">    indexes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="305">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="306">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.insecure?( project )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="307">
          <span class="hits">4</span>
          
          <code class="ruby">    return true if insecure_single?( project )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="308">
          <span class="hits">4</span>
          
          <code class="ruby">    project.children.each do |child_project|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="309">
          
          
          <code class="ruby">      return true if insecure_single?( child_project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="310">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="311">
          <span class="hits">4</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="312">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="315">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.insecure_single?( project )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="316">
          <span class="hits">4</span>
          
          <code class="ruby">    return false if project.language.eql?(Product::A_LANGUAGE_PHP) &amp;&amp; !project.filename.eql?(&#39;composer.lock&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="317">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="318">
          <span class="hits">4</span>
          
          <code class="ruby">    project.projectdependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="319">
          <span class="hits">4</span>
          
          <code class="ruby">      return true if !dep.sv_ids.to_a.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="321">
          <span class="hits">4</span>
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="322">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="323">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="324">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="325">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.outdated?( project )</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="326">
          <span class="hits">12</span>
          
          <code class="ruby">    return true if outdated_single?( project )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="327">
          <span class="hits">4</span>
          
          <code class="ruby">    project.children.each do |child_project|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="328">
          
          
          <code class="ruby">      return true if outdated_single?( child_project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="330">
          <span class="hits">4</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="332">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="333">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.outdated_single?( project )</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="334">
          <span class="hits">12</span>
          
          <code class="ruby">    project.projectdependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="335">
          <span class="hits">12</span>
          
          <code class="ruby">      next if dep.scope.to_s.eql?(Dependency::A_SCOPE_DEVELOPMENT)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="336">
          <span class="hits">12</span>
          
          <code class="ruby">      next if dep.scope.to_s.eql?(Dependency::A_SCOPE_TEST)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="337">
          <span class="hits">12</span>
          
          <code class="ruby">      return true if ProjectdependencyService.outdated?( dep )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="338">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="339">
          <span class="hits">4</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="342">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="343">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.outdated_dependencies( project, force_update = false )</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="344">
          <span class="hits">6</span>
          
          <code class="ruby">    outdated_dependencies = Array.new</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="345">
          <span class="hits">6</span>
          
          <code class="ruby">    project.projectdependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="346">
          <span class="hits">15</span>
          
          <code class="ruby">      ProjectdependencyService.update_outdated!( dep ) if force_update</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="347">
          <span class="hits">15</span>
          
          <code class="ruby">      outdated_dependencies &lt;&lt; dep if ProjectdependencyService.outdated?( dep )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="348">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="349">
          <span class="hits">6</span>
          
          <code class="ruby">    outdated_dependencies</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="350">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="353">
          
          
          <code class="ruby">  # Returns the projectdependencies which have unknown licenses</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="354">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.unknown_licenses( project )</code>
        </li>
      
        <li class="covered" data-hits="64" data-linenumber="355">
          <span class="hits">64</span>
          
          <code class="ruby">    unknown = Array.new</code>
        </li>
      
        <li class="covered" data-hits="64" data-linenumber="356">
          <span class="hits">64</span>
          
          <code class="ruby">    return unknown if project.nil? || project.projectdependencies.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="358">
          <span class="hits">62</span>
          
          <code class="ruby">    project.projectdependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="608" data-linenumber="359">
          <span class="hits">608</span>
          
          <code class="ruby">      product = dep.product</code>
        </li>
      
        <li class="covered" data-hits="608" data-linenumber="360">
          <span class="hits">608</span>
          
          <code class="ruby">      if product.nil?</code>
        </li>
      
        <li class="covered" data-hits="550" data-linenumber="361">
          <span class="hits">550</span>
          
          <code class="ruby">        unknown &lt;&lt; dep</code>
        </li>
      
        <li class="covered" data-hits="550" data-linenumber="362">
          <span class="hits">550</span>
          
          <code class="ruby">        next</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="363">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="364">
          <span class="hits">58</span>
          
          <code class="ruby">      product.version = dep.version_requested</code>
        </li>
      
        <li class="covered" data-hits="58" data-linenumber="365">
          <span class="hits">58</span>
          
          <code class="ruby">      unknown &lt;&lt; dep if product.licenses.nil? || product.licenses.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="366">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="367">
          <span class="hits">62</span>
          
          <code class="ruby">    unknown</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="370">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="371">
          
          
          <code class="ruby">  # Returns the projectdependencies which violate the license whitelist.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="372">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.red_licenses( project )</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="373">
          <span class="hits">63</span>
          
          <code class="ruby">    red = []</code>
        </li>
      
        <li class="covered" data-hits="63" data-linenumber="374">
          <span class="hits">63</span>
          
          <code class="ruby">    return red if project.nil? || project.projectdependencies.empty? || project.license_whitelist_id.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="375">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="376">
          <span class="hits">12</span>
          
          <code class="ruby">    whitelist = project.license_whitelist</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="377">
          <span class="hits">12</span>
          
          <code class="ruby">    return red if whitelist.nil?</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="378">
          <span class="hits">12</span>
          
          <code class="ruby">    return red if whitelist.license_elements.nil? || whitelist.license_elements.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="380">
          <span class="hits">12</span>
          
          <code class="ruby">    project.projectdependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="381">
          <span class="hits">34</span>
          
          <code class="ruby">      product = dep.product</code>
        </li>
      
        <li class="covered" data-hits="34" data-linenumber="382">
          <span class="hits">34</span>
          
          <code class="ruby">      next if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="384">
          <span class="hits">22</span>
          
          <code class="ruby">      product.version = dep.version_requested</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="385">
          <span class="hits">22</span>
          
          <code class="ruby">      licenses = product.licenses</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="386">
          <span class="hits">22</span>
          
          <code class="ruby">      next if licenses.nil? || licenses.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="387">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="388">
          <span class="hits">12</span>
          
          <code class="ruby">      on_white_list = on_whitelist?( licenses, whitelist )</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="389">
          <span class="hits">12</span>
          
          <code class="ruby">      red &lt;&lt; dep if !on_white_list</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="390">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="391">
          <span class="hits">12</span>
          
          <code class="ruby">    red</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="392">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="393">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="394">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="395">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_license_numbers!( project )</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="396">
          <span class="hits">29</span>
          
          <code class="ruby">    return nil if project.nil? || project.projectdependencies.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="397">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="398">
          <span class="hits">29</span>
          
          <code class="ruby">    ProjectdependencyService.update_licenses project</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="399">
          <span class="hits">29</span>
          
          <code class="ruby">    project.licenses_unknown = unknown_licenses( project ).count</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="400">
          <span class="hits">29</span>
          
          <code class="ruby">    project.licenses_red = red_licenses( project ).count</code>
        </li>
      
        <li class="covered" data-hits="29" data-linenumber="401">
          <span class="hits">29</span>
          
          <code class="ruby">    project.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="402">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="403">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="405">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_sums( project )</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="406">
          <span class="hits">44</span>
          
          <code class="ruby">    return if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="407">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="408">
          <span class="hits">44</span>
          
          <code class="ruby">    if project.children.empty?</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="409">
          <span class="hits">30</span>
          
          <code class="ruby">      project.sum_own!</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="410">
          <span class="hits">30</span>
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="412">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="413">
          <span class="hits">14</span>
          
          <code class="ruby">    dep_hash = {}</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="414">
          <span class="hits">14</span>
          
          <code class="ruby">    project.sum_reset!</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="415">
          <span class="hits">14</span>
          
          <code class="ruby">    project.children.each do |child_project|</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="416">
          <span class="hits">14</span>
          
          <code class="ruby">      update_numbers_for project, child_project, dep_hash</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="417">
          <span class="hits">14</span>
          
          <code class="ruby">      child_project.sum_own!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="418">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="419">
          <span class="hits">14</span>
          
          <code class="ruby">    update_numbers_for project, project, dep_hash</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="420">
          <span class="hits">14</span>
          
          <code class="ruby">    project.save</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="421">
          <span class="hits">14</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="422">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="423">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="424">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="425">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.reset_badge project</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="426">
          <span class="hits">19</span>
          
          <code class="ruby">    cache.delete project.id.to_s</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="427">
          <span class="hits">19</span>
          
          <code class="ruby">    Badge.where(:key =&gt; project.id.to_s ).delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="428">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="430">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="431">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="432">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="433">
          
          
          <code class="ruby">    # TODO optimize this by only loading affected deps.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="434">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fill_sv project, map</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="435">
          
          
          <code class="ruby">      # id = Moped::BSON::ObjectId.from_string(project.ids)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="436">
          
          
          <code class="ruby">      # id = project.ids</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby">      # deps = Projectdependency.collection.find(:project_id =&gt; id, &#39;sv_ids&#39; =&gt; {&#39;$not&#39; =&gt; {&#39;$size&#39; =&gt; 0} } )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="438">
          <span class="hits">2</span>
          
          <code class="ruby">      deps = Projectdependency.where(:project_id =&gt; project.ids )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="439">
          <span class="hits">2</span>
          
          <code class="ruby">      deps.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="440">
          <span class="hits">3</span>
          
          <code class="ruby">        map[project.ids][:sv].push dep if !dep.sv_ids.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="442">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="443">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="444">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="445">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="446">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="447">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="448">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.update_numbers_for project, child_project, dep_hash = {}</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="449">
          <span class="hits">28</span>
          
          <code class="ruby">      lwl = project.license_whitelist</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="450">
          <span class="hits">28</span>
          
          <code class="ruby">      child_project.projectdependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="213" data-linenumber="451">
          <span class="hits">213</span>
          
          <code class="ruby">        key = &quot;#{dep.language}:#{dep.possible_prod_key}:#{dep.version_requested}&quot;</code>
        </li>
      
        <li class="covered" data-hits="213" data-linenumber="452">
          <span class="hits">213</span>
          
          <code class="ruby">        next if dep_hash.include? key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="453">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="207" data-linenumber="454">
          <span class="hits">207</span>
          
          <code class="ruby">        product = dep.product</code>
        </li>
      
        <li class="covered" data-hits="207" data-linenumber="455">
          <span class="hits">207</span>
          
          <code class="ruby">        dep_hash[key] = dep</code>
        </li>
      
        <li class="covered" data-hits="207" data-linenumber="456">
          <span class="hits">207</span>
          
          <code class="ruby">        project.dep_number_sum       += 1</code>
        </li>
      
        <li class="covered" data-hits="207" data-linenumber="457">
          <span class="hits">207</span>
          
          <code class="ruby">        project.out_number_sum       += 1 if dep.outdated</code>
        </li>
      
        <li class="covered" data-hits="207" data-linenumber="458">
          <span class="hits">207</span>
          
          <code class="ruby">        project.unknown_number_sum   += 1 if dep.unknown?</code>
        </li>
      
        <li class="covered" data-hits="207" data-linenumber="459">
          <span class="hits">207</span>
          
          <code class="ruby">        project.licenses_unknown_sum += 1 if product.nil? || product.licenses.nil? || product.licenses.empty?</code>
        </li>
      
        <li class="covered" data-hits="207" data-linenumber="460">
          <span class="hits">207</span>
          
          <code class="ruby">        if lwl &amp;&amp; red_license?( dep, lwl )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="461">
          <span class="hits">3</span>
          
          <code class="ruby">          project.licenses_red_sum += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="462">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="207" data-linenumber="463">
          <span class="hits">207</span>
          
          <code class="ruby">        project.sv_count_sum += dep.sv_ids.count if !dep.sv_ids.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="464">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="28" data-linenumber="465">
          <span class="hits">28</span>
          
          <code class="ruby">      dep_hash</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="466">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="467">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="468">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="469">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.red_license? projectdependency, whitelist</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="470">
          <span class="hits">13</span>
          
          <code class="ruby">      lcs = projectdependency.license_caches</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="471">
          <span class="hits">13</span>
          
          <code class="ruby">      return false if lcs.nil? || lcs.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="473">
          <span class="hits">4</span>
          
          <code class="ruby">      if whitelist.pessimistic_mode == true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="474">
          <span class="hits">1</span>
          
          <code class="ruby">        lcs.each do |lc|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="475">
          <span class="hits">1</span>
          
          <code class="ruby">          return true if lc.on_whitelist == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="476">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="477">
          
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="478">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="479">
          <span class="hits">3</span>
          
          <code class="ruby">        lcs.each do |lc|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="480">
          <span class="hits">3</span>
          
          <code class="ruby">          return false if lc.on_whitelist == true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="481">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="482">
          <span class="hits">2</span>
          
          <code class="ruby">        return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="483">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="484">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="485">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="486">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="487">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.on_whitelist?( licenses, whitelist )</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="488">
          <span class="hits">12</span>
          
          <code class="ruby">      if whitelist.pessimistic_mode == true</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="489">
          <span class="hits">2</span>
          
          <code class="ruby">        licenses.each do |license|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="490">
          <span class="hits">2</span>
          
          <code class="ruby">          on_whitelist = whitelist.include_license_substitute?( license.name_substitute )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="491">
          <span class="hits">2</span>
          
          <code class="ruby">          return false if on_whitelist == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="492">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="493">
          
          
          <code class="ruby">        return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="494">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="495">
          <span class="hits">10</span>
          
          <code class="ruby">        licenses.each do |license|</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="496">
          <span class="hits">10</span>
          
          <code class="ruby">          on_whitelist = whitelist.include_license_substitute?( license.name_substitute )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="497">
          <span class="hits">10</span>
          
          <code class="ruby">          return true if on_whitelist</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="498">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="499">
          <span class="hits">5</span>
          
          <code class="ruby">        return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="500">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="501">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="502">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="503">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="504">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4c9f310a875adbab340e9fc6e7c0b4827738ecd8">
  <div class="header">
    <h3>lib/versioneye/services/project_update_service.rb</h3>
    <h4><span class="yellow">87.5 %</span> covered</h4>
    <div>
      <b>64</b> relevant lines. 
      <span class="green"><b>56</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectUpdateService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_RUNNING = &#39;running&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_DONE    = &#39;done&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_TTL     = 420 # 420 seconds = 7 minutes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_async project, send_email = false</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="8">
          <span class="hits">6</span>
          
          <code class="ruby">    return nil if not_updateable?( project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="10">
          <span class="hits">6</span>
          
          <code class="ruby">    task_key    = &quot;task_#{project.ids}&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="11">
          <span class="hits">6</span>
          
          <code class="ruby">    task_status = cache.get( task_key )</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="12">
          <span class="hits">6</span>
          
          <code class="ruby">    if task_status.to_s.eql?(A_TASK_RUNNING)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">      log.debug &quot;project #{project.ids} is still processed&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">      return task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="17">
          <span class="hits">5</span>
          
          <code class="ruby">    task_status = A_TASK_RUNNING</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="18">
          <span class="hits">5</span>
          
          <code class="ruby">    cache.set( task_key, task_status, A_TASK_TTL )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="20">
          <span class="hits">5</span>
          
          <code class="ruby">    msg = &quot;project_#{project.ids}:::#{send_email}&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="21">
          <span class="hits">5</span>
          
          <code class="ruby">    ProjectUpdateProducer.new( msg )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="23">
          <span class="hits">5</span>
          
          <code class="ruby">    task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.status_for project_id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="28">
          <span class="hits">3</span>
          
          <code class="ruby">    task_key    = &quot;task_#{project_id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="29">
          <span class="hits">3</span>
          
          <code class="ruby">    task_status = cache.get( task_key )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="30">
          <span class="hits">3</span>
          
          <code class="ruby">    task_status = A_TASK_DONE if task_status.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="31">
          <span class="hits">3</span>
          
          <code class="ruby">    task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update project, send_email = false</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="36">
          <span class="hits">19</span>
          
          <code class="ruby">    return nil if not_updateable?( project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="38">
          <span class="hits">15</span>
          
          <code class="ruby">    project = update_single project, send_email</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="39">
          <span class="hits">15</span>
          
          <code class="ruby">    project.children.each do |child_project|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="40">
          <span class="hits">5</span>
          
          <code class="ruby">      child_project.license_whitelist_id = project.license_whitelist_id</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="41">
          <span class="hits">5</span>
          
          <code class="ruby">      child_project.save</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="42">
          <span class="hits">5</span>
          
          <code class="ruby">      update_single child_project, send_email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="44">
          <span class="hits">15</span>
          
          <code class="ruby">    ProjectService.update_sums( project )</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="45">
          <span class="hits">15</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_single project, send_email = false</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="54">
          <span class="hits">20</span>
          
          <code class="ruby">    return nil if not_updateable?( project )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="56">
          <span class="hits">20</span>
          
          <code class="ruby">    project.parsing_errors = []</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="57">
          <span class="hits">20</span>
          
          <code class="ruby">    updater = UpdateStrategy.updater_for project.source</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="58">
          <span class="hits">20</span>
          
          <code class="ruby">    updater.update project, send_email</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="59">
          <span class="hits">20</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_from_upload project, file, user = nil, api_created = false</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="68">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="70">
          <span class="hits">3</span>
          
          <code class="ruby">    new_project = ProjectParseService.project_from file</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="71">
          <span class="hits">3</span>
          
          <code class="ruby">    cache.delete( new_project.id.to_s )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="72">
          <span class="hits">3</span>
          
          <code class="ruby">    cache.delete( project.id.to_s )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="73">
          <span class="hits">3</span>
          
          <code class="ruby">    project.update_from new_project</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="74">
          <span class="hits">3</span>
          
          <code class="ruby">    project.source = Project::A_SOURCE_API if api_created</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="75">
          <span class="hits">3</span>
          
          <code class="ruby">    ProjectService.update_license_numbers! project</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="76">
          <span class="hits">3</span>
          
          <code class="ruby">    update_numbers project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="78">
          <span class="hits">3</span>
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.update_numbers project</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="86">
          <span class="hits">3</span>
          
          <code class="ruby">      if !project.parent_id.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">        ProjectService.update_sums project.parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="89">
          <span class="hits">2</span>
          
          <code class="ruby">        ProjectService.update_sums project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.not_updateable?( project )</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="98">
          <span class="hits">45</span>
          
          <code class="ruby">      return true if project.nil?</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="99">
          <span class="hits">41</span>
          
          <code class="ruby">      return true if project.user_id.nil? || project.user.nil?</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="100">
          <span class="hits">41</span>
          
          <code class="ruby">      return true if project.user.deleted_user == true</code>
        </li>
      
        <li class="covered" data-hits="41" data-linenumber="101">
          <span class="hits">41</span>
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="78295a205a70e9491b99368b45f308579d234c8c">
  <div class="header">
    <h3>lib/versioneye/services/projectdependency_service.rb</h3>
    <h4><span class="green">90.07 %</span> covered</h4>
    <div>
      <b>141</b> relevant lines. 
      <span class="green"><b>127</b> lines covered</span> and
      <span class="red"><b>14</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectdependencyService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;naturalsorter&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_SECONDS_PER_DAY = 24 * 60 * 60 # 24h * 60min * 60s = 86400</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  # Updates projectdependency.license_caches for each projectdependency of the project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_licenses project</code>
        </li>
      
        <li class="covered" data-hits="30" data-linenumber="9">
          <span class="hits">30</span>
          
          <code class="ruby">    project.projectdependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="403" data-linenumber="10">
          <span class="hits">403</span>
          
          <code class="ruby">      product = dep.find_or_init_product</code>
        </li>
      
        <li class="covered" data-hits="403" data-linenumber="11">
          <span class="hits">403</span>
          
          <code class="ruby">      update_licenses_for project, dep, product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_licenses_for project, dep, product, save_dep = true</code>
        </li>
      
        <li class="covered" data-hits="597" data-linenumber="19">
          <span class="hits">597</span>
          
          <code class="ruby">    dep.license_caches.clear</code>
        </li>
      
        <li class="covered" data-hits="597" data-linenumber="20">
          <span class="hits">597</span>
          
          <code class="ruby">    dep.lwl_violation = nil</code>
        </li>
      
        <li class="covered" data-hits="597" data-linenumber="21">
          <span class="hits">597</span>
          
          <code class="ruby">    product.version = dep.version_requested</code>
        </li>
      
        <li class="covered" data-hits="597" data-linenumber="22">
          <span class="hits">597</span>
          
          <code class="ruby">    licenses = product.licenses</code>
        </li>
      
        <li class="covered" data-hits="597" data-linenumber="23">
          <span class="hits">597</span>
          
          <code class="ruby">    if licenses &amp;&amp; !licenses.empty?</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="24">
          <span class="hits">11</span>
          
          <code class="ruby">      fill_license_cache project, dep, licenses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="597" data-linenumber="26">
          <span class="hits">597</span>
          
          <code class="ruby">    dep.save if save_dep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  # Updates projectdependency.sv_ids for each projectdependency of the project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_security project</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="32">
          <span class="hits">19</span>
          
          <code class="ruby">    project.update_attribute(:sv_count, 0)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="33">
          <span class="hits">19</span>
          
          <code class="ruby">    project.update_attribute(:sv_count_sum, 0)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="34">
          <span class="hits">19</span>
          
          <code class="ruby">    project.projectdependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="341" data-linenumber="35">
          <span class="hits">341</span>
          
          <code class="ruby">      product = dep.find_or_init_product</code>
        </li>
      
        <li class="covered" data-hits="341" data-linenumber="36">
          <span class="hits">341</span>
          
          <code class="ruby">      update_security_for project, dep, product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_security_for project, dep, product, save_dep = true</code>
        </li>
      
        <li class="covered" data-hits="535" data-linenumber="44">
          <span class="hits">535</span>
          
          <code class="ruby">    version = product.version_by_number dep.version_requested</code>
        </li>
      
        <li class="covered" data-hits="535" data-linenumber="45">
          <span class="hits">535</span>
          
          <code class="ruby">    return nil if version.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="47">
          <span class="hits">9</span>
          
          <code class="ruby">    dep.sv_ids = version.sv_ids</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="48">
          <span class="hits">9</span>
          
          <code class="ruby">    dep.save if save_dep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="50">
          <span class="hits">9</span>
          
          <code class="ruby">    if !version.sv_ids.empty?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="51">
          <span class="hits">6</span>
          
          <code class="ruby">      new_count = project.sv_count + version.sv_ids.size</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="52">
          <span class="hits">6</span>
          
          <code class="ruby">      project.update_attribute(:sv_count, new_count)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_licenses_security project</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="58">
          <span class="hits">27</span>
          
          <code class="ruby">    project.update_attribute(:sv_count, 0)</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="59">
          <span class="hits">27</span>
          
          <code class="ruby">    project.update_attribute(:sv_count_sum, 0)</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="60">
          <span class="hits">27</span>
          
          <code class="ruby">    Projectdependency.where(:project_id =&gt; project.id).each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="61">
          <span class="hits">194</span>
          
          <code class="ruby">      product = dep.find_or_init_product</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="62">
          <span class="hits">194</span>
          
          <code class="ruby">      update_licenses_for project, dep, product, false</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="63">
          <span class="hits">194</span>
          
          <code class="ruby">      update_security_for project, dep, product, false</code>
        </li>
      
        <li class="covered" data-hits="194" data-linenumber="64">
          <span class="hits">194</span>
          
          <code class="ruby">      dep.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.mute! project_id, dependency_id, mute_status, mute_message = nil</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="73">
          <span class="hits">6</span>
          
          <code class="ruby">    project = Project.find_by_id( project_id )</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="74">
          <span class="hits">6</span>
          
          <code class="ruby">    return false if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="76">
          <span class="hits">5</span>
          
          <code class="ruby">    dependency = Projectdependency.find_by_id dependency_id</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="77">
          <span class="hits">5</span>
          
          <code class="ruby">    return false if dependency.nil?</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="78">
          <span class="hits">4</span>
          
          <code class="ruby">    return false if !dependency.project_id.to_s.eql? project_id</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="79">
          <span class="hits">4</span>
          
          <code class="ruby">    return false if dependency.project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="81">
          <span class="hits">4</span>
          
          <code class="ruby">    dependency.muted = mute_status</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="82">
          <span class="hits">4</span>
          
          <code class="ruby">    if mute_status == true</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="83">
          <span class="hits">2</span>
          
          <code class="ruby">      dependency.outdated = false</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">      dependency.outdated_updated_at = DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="85">
          <span class="hits">2</span>
          
          <code class="ruby">      dependency.mute_message = mute_message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">      update_outdated! dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="89">
          <span class="hits">4</span>
          
          <code class="ruby">    update_project_numbers dependency, project</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="90">
          <span class="hits">4</span>
          
          <code class="ruby">    saved = dependency.save</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="91">
          <span class="hits">4</span>
          
          <code class="ruby">    up = project</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="92">
          <span class="hits">4</span>
          
          <code class="ruby">    up = project.parent if project.parent_id</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="93">
          <span class="hits">4</span>
          
          <code class="ruby">    ProjectService.update_sums up</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="94">
          <span class="hits">4</span>
          
          <code class="ruby">    ProjectService.reset_badge up</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="95">
          <span class="hits">4</span>
          
          <code class="ruby">    saved</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.release?( projectdependency )</code>
        </li>
      
        <li class="covered" data-hits="280" data-linenumber="100">
          <span class="hits">280</span>
          
          <code class="ruby">    return nil if projectdependency.nil? || projectdependency.version_current.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="278" data-linenumber="102">
          <span class="hits">278</span>
          
          <code class="ruby">    projectdependency.release = VersionTagRecognizer.release? projectdependency.version_current</code>
        </li>
      
        <li class="covered" data-hits="278" data-linenumber="103">
          <span class="hits">278</span>
          
          <code class="ruby">    projectdependency.save</code>
        </li>
      
        <li class="covered" data-hits="278" data-linenumber="104">
          <span class="hits">278</span>
          
          <code class="ruby">    projectdependency.release</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="108">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.outdated?( projectdependency )</code>
        </li>
      
        <li class="covered" data-hits="1423" data-linenumber="109">
          <span class="hits">1423</span>
          
          <code class="ruby">    return nil if projectdependency.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1422" data-linenumber="111">
          <span class="hits">1422</span>
          
          <code class="ruby">    return update_outdated!(projectdependency) if projectdependency.outdated.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="123" data-linenumber="113">
          <span class="hits">123</span>
          
          <code class="ruby">    last_update_ago = DateTime.now.to_i - projectdependency.outdated_updated_at.to_i</code>
        </li>
      
        <li class="covered" data-hits="123" data-linenumber="114">
          <span class="hits">123</span>
          
          <code class="ruby">    return projectdependency.outdated if last_update_ago &lt; A_SECONDS_PER_DAY</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">    update_outdated!( projectdependency )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_outdated!( projectdependency )</code>
        </li>
      
        <li class="covered" data-hits="1334" data-linenumber="121">
          <span class="hits">1334</span>
          
          <code class="ruby">    update_version_current( projectdependency )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">    if ( projectdependency.prod_key.nil? &amp;&amp; projectdependency.version_current.nil? ) ||</code>
        </li>
      
        <li class="covered" data-hits="1334" data-linenumber="124">
          <span class="hits">1334</span>
          
          <code class="ruby">       ( projectdependency.version_requested.eql?( &#39;GIT&#39; ) || projectdependency.version_requested.eql?(&#39;PATH&#39;) ) ||</code>
        </li>
      
        <li class="covered" data-hits="274" data-linenumber="125">
          <span class="hits">274</span>
          
          <code class="ruby">       ( projectdependency.muted == true ) ||</code>
        </li>
      
        <li class="covered" data-hits="273" data-linenumber="126">
          <span class="hits">273</span>
          
          <code class="ruby">       ( projectdependency.version_requested.eql?( projectdependency.version_current) )</code>
        </li>
      
        <li class="covered" data-hits="1245" data-linenumber="127">
          <span class="hits">1245</span>
          
          <code class="ruby">      return update_outdated( projectdependency, false )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="89" data-linenumber="130">
          <span class="hits">89</span>
          
          <code class="ruby">    newest_version = Naturalsorter::Sorter.sort_version([projectdependency.version_current, projectdependency.version_requested]).last</code>
        </li>
      
        <li class="covered" data-hits="89" data-linenumber="131">
          <span class="hits">89</span>
          
          <code class="ruby">    outdated = !newest_version.eql?( projectdependency.version_requested)</code>
        </li>
      
        <li class="covered" data-hits="89" data-linenumber="132">
          <span class="hits">89</span>
          
          <code class="ruby">    update_outdated( projectdependency, outdated )</code>
        </li>
      
        <li class="covered" data-hits="89" data-linenumber="133">
          <span class="hits">89</span>
          
          <code class="ruby">    projectdependency.outdated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_outdated( projectdependency, out_value )</code>
        </li>
      
        <li class="covered" data-hits="1334" data-linenumber="138">
          <span class="hits">1334</span>
          
          <code class="ruby">    projectdependency.outdated = out_value</code>
        </li>
      
        <li class="covered" data-hits="1334" data-linenumber="139">
          <span class="hits">1334</span>
          
          <code class="ruby">    projectdependency.outdated_updated_at = DateTime.now</code>
        </li>
      
        <li class="covered" data-hits="1334" data-linenumber="140">
          <span class="hits">1334</span>
          
          <code class="ruby">    if !projectdependency.version_current.nil?</code>
        </li>
      
        <li class="covered" data-hits="276" data-linenumber="141">
          <span class="hits">276</span>
          
          <code class="ruby">      self.release? projectdependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1334" data-linenumber="143">
          <span class="hits">1334</span>
          
          <code class="ruby">    projectdependency.save</code>
        </li>
      
        <li class="covered" data-hits="1334" data-linenumber="144">
          <span class="hits">1334</span>
          
          <code class="ruby">    projectdependency.outdated</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="148">
          
          
          <code class="ruby">    out_value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="152">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_version_current( projectdependency )</code>
        </li>
      
        <li class="covered" data-hits="1340" data-linenumber="153">
          <span class="hits">1340</span>
          
          <code class="ruby">    if projectdependency.prod_key.nil?</code>
        </li>
      
        <li class="covered" data-hits="1058" data-linenumber="154">
          <span class="hits">1058</span>
          
          <code class="ruby">      update_prod_key projectdependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1340" data-linenumber="157">
          <span class="hits">1340</span>
          
          <code class="ruby">    product = projectdependency.product</code>
        </li>
      
        <li class="covered" data-hits="1340" data-linenumber="158">
          <span class="hits">1340</span>
          
          <code class="ruby">    return false if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="160">
          <span class="hits">279</span>
          
          <code class="ruby">    newest_version = VersionService.newest_version_number( product.versions, projectdependency.stability )</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="161">
          <span class="hits">279</span>
          
          <code class="ruby">    return false if newest_version.nil? || newest_version.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="163">
          <span class="hits">279</span>
          
          <code class="ruby">    version_current = projectdependency.version_current</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="164">
          <span class="hits">279</span>
          
          <code class="ruby">    if version_current.to_s.empty? || !version_current.eql?( newest_version )</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="165">
          <span class="hits">144</span>
          
          <code class="ruby">      projectdependency.version_current = newest_version</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="166">
          <span class="hits">144</span>
          
          <code class="ruby">      projectdependency.release = VersionTagRecognizer.release? projectdependency.version_current</code>
        </li>
      
        <li class="covered" data-hits="144" data-linenumber="167">
          <span class="hits">144</span>
          
          <code class="ruby">      projectdependency.muted = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="169">
          <span class="hits">279</span>
          
          <code class="ruby">    if projectdependency.version_requested.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="170">
          <span class="hits">9</span>
          
          <code class="ruby">      projectdependency.version_requested = newest_version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="172">
          <span class="hits">279</span>
          
          <code class="ruby">    if projectdependency.version_label.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="173">
          <span class="hits">20</span>
          
          <code class="ruby">      projectdependency.version_label = projectdependency.version_requested</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="174">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="279" data-linenumber="175">
          <span class="hits">279</span>
          
          <code class="ruby">    projectdependency.save()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="177">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="178">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="179">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="183">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_prod_key dependency</code>
        </li>
      
        <li class="covered" data-hits="1058" data-linenumber="184">
          <span class="hits">1058</span>
          
          <code class="ruby">    product = dependency.find_or_init_product</code>
        </li>
      
        <li class="covered" data-hits="1058" data-linenumber="185">
          <span class="hits">1058</span>
          
          <code class="ruby">    return nil if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1058" data-linenumber="187">
          <span class="hits">1058</span>
          
          <code class="ruby">    dependency.prod_key = product.prod_key</code>
        </li>
      
        <li class="covered" data-hits="1058" data-linenumber="188">
          <span class="hits">1058</span>
          
          <code class="ruby">    dependency.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="192">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_prod_keys</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">    Projectdependency.all.each do |dependency|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">      update_prod_key dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="199">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="202">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.update_project_numbers dependency, project</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="203">
          <span class="hits">4</span>
          
          <code class="ruby">      if dependency.outdated</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="204">
          <span class="hits">2</span>
          
          <code class="ruby">        project.out_number = project.out_number.to_i + 1</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="205">
          <span class="hits">2</span>
          
          <code class="ruby">        project.out_number_sum = project.out_number_sum.to_i + 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="207">
          <span class="hits">2</span>
          
          <code class="ruby">        project.out_number = project.out_number.to_i - 1</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="208">
          <span class="hits">2</span>
          
          <code class="ruby">        project.out_number_sum = project.out_number_sum.to_i - 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="210">
          <span class="hits">4</span>
          
          <code class="ruby">      project.out_number = 0 if project.out_number &lt; 0</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="211">
          <span class="hits">4</span>
          
          <code class="ruby">      project.out_number_sum = 0 if project.out_number_sum &lt; 0</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="212">
          <span class="hits">4</span>
          
          <code class="ruby">      project.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="216">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.fill_license_cache project, dependency, licenses</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="217">
          <span class="hits">11</span>
          
          <code class="ruby">      licenses.each do |license|</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="218">
          <span class="hits">14</span>
          
          <code class="ruby">        licenseCach = LicenseCach.new({:name =&gt; license.name_substitute, :url =&gt; license.link} )</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="219">
          <span class="hits">14</span>
          
          <code class="ruby">        if project.license_whitelist</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="220">
          <span class="hits">12</span>
          
          <code class="ruby">          licenseCach.on_whitelist = project.license_whitelist.include_license_substitute?( license.name_substitute )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="222">
          <span class="hits">14</span>
          
          <code class="ruby">        licenseCach.license_id = license.id.to_s</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="223">
          <span class="hits">14</span>
          
          <code class="ruby">        dependency.license_caches.push licenseCach</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="224">
          <span class="hits">14</span>
          
          <code class="ruby">        dependency.lwl_violation = &#39;true&#39; if licenseCach.on_whitelist == false</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="225">
          <span class="hits">14</span>
          
          <code class="ruby">        licenseCach.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="228">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="229">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9ddcbac774057fef4db218be6fbb4e03cb320e05">
  <div class="header">
    <h3>lib/versioneye/services/receipt_service.rb</h3>
    <h4><span class="green">91.14 %</span> covered</h4>
    <div>
      <b>79</b> relevant lines. 
      <span class="green"><b>72</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ReceiptService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;pdfkit&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process_receipts</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="8">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if Settings.instance.environment.eql?(&quot;enterprise&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>
          
          <code class="ruby">    count = User.where(:plan_id.ne =&gt; nil).count</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="11">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if count == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="13">
          <span class="hits">2</span>
          
          <code class="ruby">    per_page = 10</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    skip = 0</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">    iterations = count / per_page</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    iterations += 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    (0..iterations).each do</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="19">
          <span class="hits">4</span>
          
          <code class="ruby">      users = User.where(:plan_id.ne =&gt; nil).skip(skip).limit(per_page)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="20">
          <span class="hits">4</span>
          
          <code class="ruby">      handle_users( users )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="21">
          <span class="hits">4</span>
          
          <code class="ruby">      skip += per_page</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.handle_users( users )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="30">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if users.nil? || users.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    users.each do |user|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="33">
          <span class="hits">2</span>
          
          <code class="ruby">      next if user.nil?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="34">
          <span class="hits">2</span>
          
          <code class="ruby">      next if user.plan.name_id.eql?(Plan::A_PLAN_TRIAL_0)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="35">
          <span class="hits">2</span>
          
          <code class="ruby">      next if user.stripe_token.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="36">
          <span class="hits">2</span>
          
          <code class="ruby">      next if user.stripe_customer_id.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">      handle_user( user )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.handle_user( user )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">    customer = StripeService.fetch_customer user.stripe_customer_id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="45">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if customer.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">    invoices = customer.invoices</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if invoices.nil? || invoices.count == 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="50">
          <span class="hits">2</span>
          
          <code class="ruby">    invoices.each do |invoice|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">      handle_invoice user, invoice</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.handle_invoice user, invoice</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="60">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if invoice[:paid].to_s.casecmp(&#39;true&#39;)   != 0 # return if paid   = false</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="61">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if invoice[:closed].to_s.casecmp(&#39;true&#39;) != 0 # return if closed = false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    # Early exit if receipt exist already in db</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="64">
          <span class="hits">2</span>
          
          <code class="ruby">    receipt = Receipt.where(:invoice_id =&gt; invoice[:id]).shift</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="65">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if !receipt.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    receipt = new_receipt user, invoice</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    html    = compile_html_invoice receipt</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">    pdf     = compile_pdf_invoice html</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    upload( receipt, pdf )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">    if receipt.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">      email receipt, pdf</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">      log.error &quot;Could not persist receipt for user &#39;#{user.id}&#39; and invoice &#39;#{invoice[:id]}&#39; - #{receipt.errors.full_messages}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">    receipt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    log.error &quot;#{user.username} - #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.new_receipt user, invoice</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">    receipt = Receipt.new</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="87">
          <span class="hits">1</span>
          
          <code class="ruby">    receipt.update_from_billing_address user.billing_address</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="88">
          <span class="hits">1</span>
          
          <code class="ruby">    receipt.update_from_invoice invoice</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">    receipt.receipt_nr = next_receipt_nr</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="90">
          <span class="hits">1</span>
          
          <code class="ruby">    receipt.user = user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">    receipt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.next_receipt_nr</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="96">
          <span class="hits">11</span>
          
          <code class="ruby">    nr = Receipt.max(:receipt_nr)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="97">
          <span class="hits">11</span>
          
          <code class="ruby">    nr = 1000 if nr.nil?</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="98">
          <span class="hits">11</span>
          
          <code class="ruby">    nr += 1</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="99">
          <span class="hits">11</span>
          
          <code class="ruby">    nr</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.compile_html_invoice receipt, compile_pdf = false</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="104">
          <span class="hits">7</span>
          
          <code class="ruby">    content_file = Settings.instance.receipt_content</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="105">
          <span class="hits">7</span>
          
          <code class="ruby">    erb = ERB.new(File.read(content_file))</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="106">
          <span class="hits">7</span>
          
          <code class="ruby">    html = erb.result(receipt.get_binding)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="107">
          <span class="hits">7</span>
          
          <code class="ruby">    html = html.force_encoding(Encoding::UTF_8)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="109">
          <span class="hits">7</span>
          
          <code class="ruby">    if compile_pdf</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="110">
          <span class="hits">6</span>
          
          <code class="ruby">      compile_pdf_invoice html, receipt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="113">
          <span class="hits">7</span>
          
          <code class="ruby">    html</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby">  # Note for me.. kit.to_file(&#39;/Users/robertreiz/invoice.pdf&#39;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.compile_pdf_invoice html, receipt = nil</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="119">
          <span class="hits">7</span>
          
          <code class="ruby">    footer_file = Settings.instance.receipt_footer</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="120">
          <span class="hits">7</span>
          
          <code class="ruby">    kit = PDFKit.new(html, :footer_html =&gt; footer_file, :page_size =&gt; &#39;A4&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="122">
          <span class="hits">7</span>
          
          <code class="ruby">    raise &quot;PDFKit.new returned nil!&quot; if kit.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="124">
          <span class="hits">7</span>
          
          <code class="ruby">    if receipt</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="125">
          <span class="hits">6</span>
          
          <code class="ruby">      kit.to_file(&quot;#{ENV[&#39;HOME&#39;]}/#{receipt.filename}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="128">
          <span class="hits">7</span>
          
          <code class="ruby">    kit.to_pdf</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="132">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.upload receipt, pdf</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">    S3.store_in_receipt_bucket receipt.filename, pdf</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.email receipt, pdf</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="138">
          <span class="hits">1</span>
          
          <code class="ruby">    ReceiptMailer.receipt_email(receipt, pdf).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="989b570050923b35cfba548928598ac0fbe7b8e3">
  <div class="header">
    <h3>lib/versioneye/services/reference_service.rb</h3>
    <h4><span class="red">78.57 %</span> covered</h4>
    <div>
      <b>14</b> relevant lines. 
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ReferenceService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="5">
          <span class="hits">4</span>
          
          <code class="ruby">    if Settings.instance.respond_to? &quot;references_live_update&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="6">
          <span class="hits">4</span>
          
          <code class="ruby">      self.update_reference language, prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="9">
          <span class="hits">4</span>
          
          <code class="ruby">    Reference.find_by language, prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_reference language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="14">
          <span class="hits">5</span>
          
          <code class="ruby">    return if Settings.instance.references_live_update == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="16">
          <span class="hits">5</span>
          
          <code class="ruby">    product = Product.fetch_product language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="17">
          <span class="hits">5</span>
          
          <code class="ruby">    ProductService.update_used_by_count product, true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.project_references language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="25">
          <span class="hits">4</span>
          
          <code class="ruby">    return [] if !Settings.instance.environment.to_s.eql?(&quot;enterprise&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    Projectdependency.where(:language =&gt; language, :prod_key =&gt; prod_key).distinct(:project_id)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6063bee9eb4bc2c8d8de629b1f0c1e9f4bf09bb5">
  <div class="header">
    <h3>lib/versioneye/services/scm_meta_data_service.rb</h3>
    <h4><span class="red">16.67 %</span> covered</h4>
    <div>
      <b>36</b> relevant lines. 
      <span class="green"><b>6</b> lines covered</span> and
      <span class="red"><b>30</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ScmMetaDataService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_all_users</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    UserService.all_users_paged do |users|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">      users.each do |user|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">        update_for user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_for user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.info &quot;update smc meta data for #{user.username}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    update_github_repos_for user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    update_bitbucket_repos_for user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    update_stash_repos_for user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_github_repos_for user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">    return if user.github_token.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    GithubRepo.by_user( user ).delete_all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    user_task_key = &quot;#{user[:username]}-#{user[:github_id]}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    GitHubService.cache.delete( user_task_key )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    GitHubService.cached_user_repos user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_bitbucket_repos_for user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    return if user.bitbucket_token.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    BitbucketRepo.by_user( user ).delete_all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    user_task_key = &quot;#{user[:username]}-bitbucket&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    BitbucketService.cache.delete( user_task_key )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    BitbucketService.cached_user_repos user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_stash_repos_for user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    return if user.stash_token.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    StashRepo.by_user( user ).delete_all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    user_task_key = &quot;#{user[:username]}-stash&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    StashService.cache.delete( user_task_key )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    StashService.cached_user_repos user</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e00df85ff7d3422d334ac4f2bf0b06fec606e195">
  <div class="header">
    <h3>lib/versioneye/services/stash_service.rb</h3>
    <h4><span class="red">17.05 %</span> covered</h4>
    <div>
      <b>88</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>73</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class StashService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_NIL     = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_RUNNING = &#39;running&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_DONE    = &#39;done&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_TTL     = 600 # 600 seconds = 10 minutes</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_TTL_DONE = 180 # 180 seconds = 3 minutes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cached_user_repos user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    user_task_key = &quot;#{user[:username]}-stash&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    task_status = cache.get(user_task_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    if task_status == A_TASK_RUNNING || task_status == A_TASK_DONE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      log.debug &quot;Status for #{user[:username]} from stash is -&gt; #{task_status}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">      return task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    if user[:stash_token] and user.stash_repos.all.count == 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">      GitReposImportProducer.new(&quot;stash:::#{user.id.to_s}&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">      task_status =  A_TASK_RUNNING</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      log.info &quot;Nothing to import - maybe clean user&#39;s repo?&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      task_status = A_TASK_DONE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    cache.set( user_task_key, task_status, A_TASK_TTL_DONE )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cache_user_all_repos( user )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    puts &quot;Going to cache users repositories.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    repos = Stash.all_repos user.stash_token, user.stash_secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    return nil if repos.nil? || repos.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    repos.each do |repo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">      StashRepo.build_or_update user, repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.status_for user, current_repo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    return A_TASK_DONE if current_repo.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">    repo_task_key = &quot;stash:::#{user.id.to_s}:::#{current_repo.id.to_s}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    task_status   = cache.get( repo_task_key )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    if task_status == A_TASK_RUNNING || task_status == A_TASK_DONE</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">      repo_fullname = current_repo.fullname</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">      log.debug &quot;Status for importing branches and project files for `#{repo_fullname}.` is -&gt; : #{task_status}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">      return task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    if current_repo and ( current_repo.branches.nil? || current_repo.branches.empty? )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">      task_status = A_TASK_RUNNING</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">      cache.set( repo_task_key, task_status, A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">      GitRepoImportProducer.new( repo_task_key )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">      log.info &#39;Nothing is changed - skipping update.&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">      task_status = A_TASK_DONE</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    task_status</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_branches user, repo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">    project_key = repo.project_key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">    slug = repo.slug</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    token = user.stash_token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    secret = user.stash_secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">    repo.branches = Stash.branch_names project_key, slug, token, secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    repo.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_project_files user, repo</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    return if repo.branches.to_a.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    project_files = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">    project_key = repo.project_key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">    repo_name = repo.slug</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">    token = user.stash_token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    secret = user.stash_secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">    repo.branches.each do |branch_name|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">      files = Stash.files( project_key, repo_name, branch_name, token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">      supported = filter_supported files[:values]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">      next if supported.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">      branch_key = Stash.encode_db_key( branch_name )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">      project_files[branch_key] = supported</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="94">
          
          
          <code class="ruby">    repo.project_files = project_files</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">    repo.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.filter_supported files</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    supported = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    files.each do |file|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">      type = ProjectService.type_by_filename file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">      next if type.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      supported &lt;&lt; {&quot;path&quot; =&gt; file}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">    supported</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  # Returns the file as JSON.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  # Use the `pure_text_from` method to get the text content.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_file_from_stash( user, repo, filename, branch )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">    token       = user.stash_token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">    secret      = user.stash_secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">    project_key = repo.project_key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">    slug        = repo.slug</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">    revision    = &quot;refs/heads/#{branch}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">    Stash.content( project_key, slug, filename, revision, token, secret )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="123">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.pure_text_from project_file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">    content = &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">    project_file[:lines].each do |line|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">      content += line[:text]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">      content += &quot;\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">    content</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby">  # Parses the content of a project file and returns a</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">  # project created out of the project file content!</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.parse_content content, filename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">    project_type = ProjectService.type_by_filename filename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">    file_name    = filename.split(&quot;/&quot;).last</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="138">
          
          
          <code class="ruby">    parser       = ProjectParseService.parser_for file_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">    project      = ProjectParseService.parse_content parser, content, file_name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="8642528e0c9dffbcbeb40cd0747bdc6fc13044d7">
  <div class="header">
    <h3>lib/versioneye/services/statistic_service.rb</h3>
    <h4><span class="red">19.61 %</span> covered</h4>
    <div>
      <b>51</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>41</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class StatisticService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  A_STAT_LANGUAGES = [</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby">      Product::A_LANGUAGE_RUBY,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">      Product::A_LANGUAGE_PYTHON,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">      Product::A_LANGUAGE_NODEJS,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">      Product::A_LANGUAGE_PHP,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">      Product::A_LANGUAGE_JAVA,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">      Product::A_LANGUAGE_R,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">      Product::A_LANGUAGE_CLOJURE,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">      Product::A_LANGUAGE_OBJECTIVEC</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    ]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.language_project_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    json_cache = JsonCache.language_project_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    if json_cache</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">      return eval json_cache.json_string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">      self.language_project_count_current</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.language_project_trend</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    json_cache = JsonCache.language_project_trend</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">    if json_cache</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      return eval json_cache.json_string</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">      self.language_project_trend_current</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    self.update_language_project_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    self.update_language_project_trend</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_language_project_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    json_cache = JsonCache.language_project_count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    if json_cache.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      json_cache = JsonCache.new({:name =&gt; JsonCache::A_LANGUAGE_PROJECT_COUNT})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">    json_cache.json_string = self.language_project_count_current().inspect()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    json_cache.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_language_project_trend</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">    json_cache = JsonCache.language_project_trend</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    if json_cache.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">      json_cache = JsonCache.new({:name =&gt; JsonCache::A_LANGUAGE_PROJECT_TREND})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    json_cache.json_string = self.language_project_trend_current().inspect()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    json_cache.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.language_project_count_current()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    data = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    A_STAT_LANGUAGES.each do |lang|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">      count = Product.where(language: lang).count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">      data &lt;&lt; [lang, count]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.language_project_trend_current(start_date = nil, end_date =  nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">    # returns cumulative trend of languages of given period,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    # which by default is from 4th april to end of current month</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">    # Arguments have to Date object</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    start_date = Date.new(2012, 4) if (start_date.nil? or not start_date.instance_of? Date)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">    end_date = Date.today if (end_date.nil? or not end_date.instance_of? Date)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    results = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    n_months = StatisticService.diff_in_months(start_date, end_date)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">    n_months.times do |i|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">      curr_date = start_date &gt;&gt; i</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">      stats = { date: curr_date.strftime(&#39;%Y-%m-%d&#39;)}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">      A_STAT_LANGUAGES.each do |lang|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">        ncount = Product.where(language: lang, created_at: {&#39;$lt&#39; =&gt; curr_date}).count</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">        encoded_lang = Product.encode_language(lang).to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">        stats.merge!({encoded_lang =&gt; ncount})</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">      results &lt;&lt; stats</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">    return results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.diff_in_months(date1, date2)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">    (date2.year*12+date2.month) - (date1.year*12+date1.month)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="24c17185ed488c996d2ce2a64393d6f08ac60b1d">
  <div class="header">
    <h3>lib/versioneye/services/submitted_url_service.rb</h3>
    <h4><span class="green">90.48 %</span> covered</h4>
    <div>
      <b>21</b> relevant lines. 
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SubmittedUrlService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_integration_statuses()</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">    SubmittedUrl.as_not_integrated.each do |submitted_url|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="5">
          <span class="hits">3</span>
          
          <code class="ruby">      update_integration_status submitted_url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_integration_status( submitted_url )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="13">
          <span class="hits">8</span>
          
          <code class="ruby">    resource = submitted_url.product_resource</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="14">
          <span class="hits">7</span>
          
          <code class="ruby">    return false if resource.nil? || resource.prod_key.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="16">
          <span class="hits">3</span>
          
          <code class="ruby">    product = Product.fetch_product( resource.language, resource.prod_key )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="17">
          <span class="hits">3</span>
          
          <code class="ruby">    return false if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="19">
          <span class="hits">3</span>
          
          <code class="ruby">    submitted_url.integrated = true</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="20">
          <span class="hits">3</span>
          
          <code class="ruby">    if submitted_url.save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="21">
          <span class="hits">2</span>
          
          <code class="ruby">      SubmittedUrlMailer.integrated_url_email(submitted_url, product).deliver_now</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="22">
          <span class="hits">2</span>
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error &quot;Failed to update integration status for submittedUrl.#{submitted_url._id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error submitted_url.errors.full_messages.to_sentence</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="637244e36651162b658c459c74e15b7ef76e885e">
  <div class="header">
    <h3>lib/versioneye/services/sync_service.rb</h3>
    <h4><span class="yellow">83.95 %</span> covered</h4>
    <div>
      <b>162</b> relevant lines. 
      <span class="green"><b>136</b> lines covered</span> and
      <span class="red"><b>26</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SyncService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.sync</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">    sync_projectdependencies Projectdependency.all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.sync_all_products skip_known_versions = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    log.info &quot;START sync ALL products&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    ProductService.all_products_paged do |products|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">      sync_products products, skip_known_versions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log.info &quot;STOP sync ALL products&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.sync_products products, skip_known_versions = true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    products.each do |product|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">      sync_product product.language, product.prod_key, skip_known_versions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.sync_project project</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    sync_projectdependencies project.dependencies</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.sync_project_async project</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="31">
          <span class="hits">44</span>
          
          <code class="ruby">    env = Settings.instance.environment</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="32">
          <span class="hits">44</span>
          
          <code class="ruby">    return nil if !env.to_s.eql?(&quot;enterprise&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    project_id = project.id.to_s</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    SyncProducer.new &quot;project::#{project_id}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.sync_projectdependencies dependencies</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="40">
          <span class="hits">2</span>
          
          <code class="ruby">    lang_prod_keys = []</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="41">
          <span class="hits">2</span>
          
          <code class="ruby">    dependencies.each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="42">
          <span class="hits">4</span>
          
          <code class="ruby">      sync_projectdependency dependency, lang_prod_keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="44">
          <span class="hits">2</span>
          
          <code class="ruby">    log.info &quot;-- sync done for projectdependencies --&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.sync_projectdependency dependency, lang_prod_keys = []</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="49">
          <span class="hits">4</span>
          
          <code class="ruby">    prod_key = dependency.possible_prod_key</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="50">
          <span class="hits">4</span>
          
          <code class="ruby">    lang_key = &quot;#{dependency.language}::#{prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="51">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if lang_prod_keys.include?(lang_key)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="53">
          <span class="hits">4</span>
          
          <code class="ruby">    lang_prod_keys &lt;&lt; lang_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="55">
          <span class="hits">4</span>
          
          <code class="ruby">    key      = prod_key</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="56">
          <span class="hits">4</span>
          
          <code class="ruby">    language = dependency.language</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="57">
          <span class="hits">4</span>
          
          <code class="ruby">    if dependency.project &amp;&amp; dependency.project.project_type.to_s.eql?(Project::A_TYPE_BOWER)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">      key      = dependency.name</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">      language = &#39;Bower&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="61">
          <span class="hits">4</span>
          
          <code class="ruby">    sync_product language, key, false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="63">
          <span class="hits">4</span>
          
          <code class="ruby">    product = Product.fetch_product dependency.language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="64">
          <span class="hits">4</span>
          
          <code class="ruby">    return nil if product.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="66">
          <span class="hits">4</span>
          
          <code class="ruby">    dependency.prod_key = prod_key</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="67">
          <span class="hits">4</span>
          
          <code class="ruby">    ProjectdependencyService.update_outdated!( dependency )</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="68">
          <span class="hits">4</span>
          
          <code class="ruby">    log.info dependency.to_s</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="69">
          <span class="hits">4</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.sync_product language, prod_key, skip_known_versions = true</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="78">
          <span class="hits">5</span>
          
          <code class="ruby">    json = ProductClient.versions language, prod_key</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="79">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if json.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="81">
          <span class="hits">5</span>
          
          <code class="ruby">    json.deep_symbolize_keys!</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="82">
          <span class="hits">5</span>
          
          <code class="ruby">    return nil if json[:versions].nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="84">
          <span class="hits">5</span>
          
          <code class="ruby">    product_preload = Product.fetch_product language, prod_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="86">
          <span class="hits">5</span>
          
          <code class="ruby">    json[:versions].each do |ver|</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="87">
          <span class="hits">169</span>
          
          <code class="ruby">      new_version = product_preload.nil? || product_preload.version_by_number(ver[:version]).nil?</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="88">
          <span class="hits">169</span>
          
          <code class="ruby">      next if new_version == false &amp;&amp; skip_known_versions == true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="90">
          <span class="hits">169</span>
          
          <code class="ruby">      product = sync_version( language, prod_key, ver[:version] )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="92">
          <span class="hits">169</span>
          
          <code class="ruby">      if product &amp;&amp; new_version == true</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="93">
          <span class="hits">169</span>
          
          <code class="ruby">        NewestService.create_newest( product, ver[:version] )</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="94">
          <span class="hits">169</span>
          
          <code class="ruby">        NewestService.create_notifications(product, ver[:version])</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="97">
          <span class="hits">5</span>
          
          <code class="ruby">    log.info &quot;synced #{language}:#{prod_key}&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="98">
          <span class="hits">5</span>
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.sync_version language, prod_key, version</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="107">
          <span class="hits">169</span>
          
          <code class="ruby">    json = ProductClient.show language, prod_key, version</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="108">
          <span class="hits">169</span>
          
          <code class="ruby">    return nil if json.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="110">
          <span class="hits">169</span>
          
          <code class="ruby">    json.deep_symbolize_keys!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="112">
          <span class="hits">169</span>
          
          <code class="ruby">    product = create_product_if_not_exist json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="114">
          <span class="hits">169</span>
          
          <code class="ruby">    handle_licenses json</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="115">
          <span class="hits">169</span>
          
          <code class="ruby">    handle_links json</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="116">
          <span class="hits">169</span>
          
          <code class="ruby">    handle_archives json</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="117">
          <span class="hits">169</span>
          
          <code class="ruby">    handle_dependencies json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="119">
          <span class="hits">169</span>
          
          <code class="ruby">    product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_product_if_not_exist json</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="127">
          <span class="hits">169</span>
          
          <code class="ruby">    return nil if json.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="129">
          <span class="hits">169</span>
          
          <code class="ruby">    language = Product.decode_language json[:language]</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="130">
          <span class="hits">169</span>
          
          <code class="ruby">    product = Product.fetch_product language, json[:prod_key]</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="131">
          <span class="hits">169</span>
          
          <code class="ruby">    if product</code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="132">
          <span class="hits">166</span>
          
          <code class="ruby">      product.add_version json[:version], {:released_at =&gt; parsed_date(json[:released_at]) }</code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="133">
          <span class="hits">166</span>
          
          <code class="ruby">      product.save</code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="134">
          <span class="hits">166</span>
          
          <code class="ruby">      ProductService.update_version_data product, true</code>
        </li>
      
        <li class="covered" data-hits="166" data-linenumber="135">
          <span class="hits">166</span>
          
          <code class="ruby">      return product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="138">
          <span class="hits">3</span>
          
          <code class="ruby">    product = Product.new</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="139">
          <span class="hits">3</span>
          
          <code class="ruby">    product.language      = language</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="140">
          <span class="hits">3</span>
          
          <code class="ruby">    product.prod_key      = json[:prod_key]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="141">
          <span class="hits">3</span>
          
          <code class="ruby">    product.name          = json[:name]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="142">
          <span class="hits">3</span>
          
          <code class="ruby">    product.name_downcase = product.name.to_s.downcase</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="143">
          <span class="hits">3</span>
          
          <code class="ruby">    product.prod_type     = json[:prod_type]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="144">
          <span class="hits">3</span>
          
          <code class="ruby">    product.version       = json[:version]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="145">
          <span class="hits">3</span>
          
          <code class="ruby">    product.group_id      = json[:group_id]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="146">
          <span class="hits">3</span>
          
          <code class="ruby">    product.artifact_id   = json[:artifact_id]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="147">
          <span class="hits">3</span>
          
          <code class="ruby">    product.description   = json[:description]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="148">
          <span class="hits">3</span>
          
          <code class="ruby">    product.save</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="149">
          <span class="hits">3</span>
          
          <code class="ruby">    product.add_version json[:version], {:released_at =&gt; parsed_date(json[:released_at]) }</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="150">
          <span class="hits">3</span>
          
          <code class="ruby">    product.save</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="151">
          <span class="hits">3</span>
          
          <code class="ruby">    ProductService.update_version_data product, true</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="152">
          <span class="hits">3</span>
          
          <code class="ruby">    product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="157">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="159">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.handle_licenses json</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="160">
          <span class="hits">169</span>
          
          <code class="ruby">    return nil if json[:licenses].nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="162">
          <span class="hits">169</span>
          
          <code class="ruby">    json[:licenses].each do |license|</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="163">
          <span class="hits">141</span>
          
          <code class="ruby">      license.deep_symbolize_keys!</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="164">
          <span class="hits">141</span>
          
          <code class="ruby">      create_license_if_not_exist json, license[:name], license[:url]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="172">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_license_if_not_exist json, name, url</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="173">
          <span class="hits">141</span>
          
          <code class="ruby">    language = Product.decode_language json[:language]</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="174">
          <span class="hits">141</span>
          
          <code class="ruby">    prod_key = json[:prod_key]</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="175">
          <span class="hits">141</span>
          
          <code class="ruby">    version = json[:version]</code>
        </li>
      
        <li class="covered" data-hits="141" data-linenumber="176">
          <span class="hits">141</span>
          
          <code class="ruby">    License.find_or_create language, prod_key, version, name, url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="180">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="181">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.handle_links json</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="182">
          <span class="hits">169</span>
          
          <code class="ruby">    return nil if json[:links].nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="184">
          <span class="hits">169</span>
          
          <code class="ruby">    json[:links].each do |link|</code>
        </li>
      
        <li class="covered" data-hits="1740" data-linenumber="185">
          <span class="hits">1740</span>
          
          <code class="ruby">      link.deep_symbolize_keys!</code>
        </li>
      
        <li class="covered" data-hits="1740" data-linenumber="186">
          <span class="hits">1740</span>
          
          <code class="ruby">      create_link_if_not_exist json, link[:name], link[:link]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="190">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="194">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_link_if_not_exist json, name, link</code>
        </li>
      
        <li class="covered" data-hits="1740" data-linenumber="195">
          <span class="hits">1740</span>
          
          <code class="ruby">    language = Product.decode_language json[:language]</code>
        </li>
      
        <li class="covered" data-hits="1740" data-linenumber="196">
          <span class="hits">1740</span>
          
          <code class="ruby">    prod_key = json[:prod_key]</code>
        </li>
      
        <li class="covered" data-hits="1740" data-linenumber="197">
          <span class="hits">1740</span>
          
          <code class="ruby">    version = json[:version]</code>
        </li>
      
        <li class="covered" data-hits="1740" data-linenumber="198">
          <span class="hits">1740</span>
          
          <code class="ruby">    Versionlink.create_versionlink language, prod_key, version, link, name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="200">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="203">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.handle_archives json</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="204">
          <span class="hits">169</span>
          
          <code class="ruby">    return nil if json[:archives].nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="206">
          <span class="hits">169</span>
          
          <code class="ruby">    json[:archives].each do |archive|</code>
        </li>
      
        <li class="covered" data-hits="227" data-linenumber="207">
          <span class="hits">227</span>
          
          <code class="ruby">      archive.deep_symbolize_keys!</code>
        </li>
      
        <li class="covered" data-hits="227" data-linenumber="208">
          <span class="hits">227</span>
          
          <code class="ruby">      create_archive_if_not_exist json, archive[:name], archive[:link]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="211">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="213">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="215">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_archive_if_not_exist json, name, link</code>
        </li>
      
        <li class="covered" data-hits="227" data-linenumber="216">
          <span class="hits">227</span>
          
          <code class="ruby">    language = Product.decode_language json[:language]</code>
        </li>
      
        <li class="covered" data-hits="227" data-linenumber="217">
          <span class="hits">227</span>
          
          <code class="ruby">    prod_key = json[:prod_key]</code>
        </li>
      
        <li class="covered" data-hits="227" data-linenumber="218">
          <span class="hits">227</span>
          
          <code class="ruby">    version  = json[:version]</code>
        </li>
      
        <li class="covered" data-hits="227" data-linenumber="219">
          <span class="hits">227</span>
          
          <code class="ruby">    archive  = Versionarchive.new({:language =&gt; language, :prod_key =&gt; prod_key, :version_id =&gt; version, :link =&gt; link, :name =&gt; name})</code>
        </li>
      
        <li class="covered" data-hits="227" data-linenumber="220">
          <span class="hits">227</span>
          
          <code class="ruby">    Versionarchive.create_archive_if_not_exist archive</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="224">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.handle_dependencies json</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="225">
          <span class="hits">169</span>
          
          <code class="ruby">    return nil if json[:dependencies].nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="226">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="227">
          <span class="hits">169</span>
          
          <code class="ruby">    json[:dependencies].each do |dependency|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="228">
          <span class="hits">6</span>
          
          <code class="ruby">      dependency.deep_symbolize_keys!</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="229">
          <span class="hits">6</span>
          
          <code class="ruby">      create_dependency_if_not_exist json, dependency</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="232">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="233">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="236">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_dependency_if_not_exist json, dependency</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="237">
          <span class="hits">6</span>
          
          <code class="ruby">    language = Product.decode_language json[:language]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="238">
          <span class="hits">6</span>
          
          <code class="ruby">    prod_key = json[:prod_key]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="239">
          <span class="hits">6</span>
          
          <code class="ruby">    prod_version = json[:version]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="241">
          <span class="hits">6</span>
          
          <code class="ruby">    dep_prod_key = dependency[:dep_prod_key]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="242">
          <span class="hits">6</span>
          
          <code class="ruby">    dep_version = dependency[:version]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="244">
          <span class="hits">6</span>
          
          <code class="ruby">    dependencies = Dependency.where(language: language, prod_key: prod_key, prod_version: prod_version, dep_prod_key: dep_prod_key, version: dep_version)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="245">
          <span class="hits">6</span>
          
          <code class="ruby">    return nil if dependencies &amp;&amp; dependencies.count &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="247">
          <span class="hits">6</span>
          
          <code class="ruby">    new_dep = Dependency.new({language: language, prod_key: prod_key, prod_version: prod_version, dep_prod_key: dep_prod_key, version: dep_version})</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="248">
          <span class="hits">6</span>
          
          <code class="ruby">    new_dep.prod_type      = json[:prod_type]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="249">
          <span class="hits">6</span>
          
          <code class="ruby">    new_dep.scope          = dependency[:scope]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="250">
          <span class="hits">6</span>
          
          <code class="ruby">    new_dep.name           = dependency[:name]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="251">
          <span class="hits">6</span>
          
          <code class="ruby">    new_dep.group_id       = dependency[:group_id]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="252">
          <span class="hits">6</span>
          
          <code class="ruby">    new_dep.artifact_id    = dependency[:artifact_id]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="253">
          <span class="hits">6</span>
          
          <code class="ruby">    new_dep.parsed_version = dependency[:parsed_version]</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="254">
          <span class="hits">6</span>
          
          <code class="ruby">    new_dep.save</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="255">
          <span class="hits">6</span>
          
          <code class="ruby">    DependencyService.outdated? new_dep</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="258">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="259">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="262">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.parsed_date released_at</code>
        </li>
      
        <li class="covered" data-hits="169" data-linenumber="263">
          <span class="hits">169</span>
          
          <code class="ruby">      DateTime.parse( released_at )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="265">
          <span class="hits">3</span>
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="00afbf990e9ead950b7b0f24420766c39296400b">
  <div class="header">
    <h3>lib/versioneye/services/transfer_service.rb</h3>
    <h4><span class="red">13.64 %</span> covered</h4>
    <div>
      <b>22</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>19</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class TransferService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;pdfkit&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.process limit = 10000</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    transfers = Stripe::Transfer.all(:limit =&gt; limit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    transfers.each do |tr|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">      currency = tr.currency.upcase</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">      gross = tr.summary.charge_gross.to_f / 100</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">      fees  = tr.summary.charge_fees.to_f / 100</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">      net   = tr.amount.to_f / 100</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">      datef = Time.at(tr.date).strftime(&quot;%d.%m.%Y&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">      p &quot;&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">      p &quot;#{datef} Charged: #{&#39;%.02f&#39; % gross} #{currency} - Fee: #{&#39;%.02f&#39; % fees} #{currency} - Transfered: #{&#39;%.02f&#39; % net} #{currency}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">      tr.transactions.each do |tx|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">        charge = Stripe::Charge.retrieve(tx.id)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">        receipt_nr = &#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">        receipt = Receipt.where(:invoice_id =&gt; charge.invoice).first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">        if receipt</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">          receipt_nr = receipt.receipt_nr # Rechnungsnummer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">        amount = tx.amount.to_f / 100</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">        fee = tx.fee.to_f / 100</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">        net = tx.net.to_f / 100</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">        p &quot; -&gt; #{tx.customer_details} (#{receipt_nr}) - Charged: #{amount} #{currency} - Fee: #{fee} #{currency} - Net: #{net} #{currency}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="fcd363f7b0a3c6b5c9e3e7cd99895ca138f50451">
  <div class="header">
    <h3>lib/versioneye/services/user_service.rb</h3>
    <h4><span class="red">73.96 %</span> covered</h4>
    <div>
      <b>96</b> relevant lines. 
      <span class="green"><b>71</b> lines covered</span> and
      <span class="red"><b>25</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UserService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.search(term)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    EsUser.search( term )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    return []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.valid_user?(user, flash)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    unless User.email_valid?(user.email)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      flash[:error] = &#39;page_signup_error_email&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    if user.fullname.nil? || user.fullname.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">      flash[:error] = &#39;page_signup_error_fullname&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">    elsif user.password.nil? || user.password.empty? || user.password.size &lt; 5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">      flash[:error] = &#39;page_signup_error_password&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">    elsif !user.terms</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      flash[:error] = &#39;page_signup_error_terms&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.reset_password user</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="33">
          <span class="hits">3</span>
          
          <code class="ruby">    random_value = create_random_value</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>
          
          <code class="ruby">    user.password = random_value # prevents using old password</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="35">
          <span class="hits">3</span>
          
          <code class="ruby">    user.verification = create_random_token</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>
          
          <code class="ruby">    user.encrypt_password</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="37">
          <span class="hits">3</span>
          
          <code class="ruby">    user.save</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="38">
          <span class="hits">3</span>
          
          <code class="ruby">    UserMailer.reset_password( user ).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.delete user, why = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    NotificationService.remove_notifications user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    collaborators = ProjectCollaborator.by_user user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">    if !collaborators.nil? &amp;&amp; !collaborators.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">      collaborators.each do |project_collaborator|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">        project_collaborator.remove</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">    emails = user.emails</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    if emails &amp;&amp; !emails.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">      emails.each do |email|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">        email.delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">    StripeService.delete user.stripe_customer_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">    random              = create_random_value</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">    user.deleted_user   = true</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">    user.email          = &quot;#{random}_#{user.email}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">    user.prev_fullname  = user.fullname</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    user.fullname       = &#39;Deleted&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">    user.username       = &quot;#{random}_#{user.username}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    user.github_id      = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    user.github_login   = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">    user.github_token   = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    user.github_scope   = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    user.bitbucket_id     = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">    user.bitbucket_token  = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">    user.bitbucket_secret = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">    user.billing_address = nil</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">    user.products.clear</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">    if user.save</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">      notify_rob( user, why )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">      return true</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.active_users</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="84">
          <span class="hits">6</span>
          
          <code class="ruby">    User.all.select do |user|</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="85">
          <span class="hits">36</span>
          
          <code class="ruby">      ( (!user[&#39;product_ids&#39;].nil? &amp;&amp; user[&#39;product_ids&#39;].count &gt; 0) or</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="86">
          <span class="hits">36</span>
          
          <code class="ruby">       Versioncomment.where(user_id: user.id).exists? or</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">       Project.where(user_id: user.id).exists?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_languages</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="94">
          <span class="hits">3</span>
          
          <code class="ruby">    User.all.each do |user|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="95">
          <span class="hits">3</span>
          
          <code class="ruby">      products = user.products</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="96">
          <span class="hits">3</span>
          
          <code class="ruby">      if products.nil? || products.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="97">
          <span class="hits">2</span>
          
          <code class="ruby">        user.languages = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">        user.languages = user.products.distinct(:language)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="101">
          <span class="hits">3</span>
          
          <code class="ruby">      user.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.all_users_paged</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="111">
          <span class="hits">12</span>
          
          <code class="ruby">    count = User.count()</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="112">
          <span class="hits">12</span>
          
          <code class="ruby">    page = 100</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="113">
          <span class="hits">12</span>
          
          <code class="ruby">    iterations = count / page</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="114">
          <span class="hits">12</span>
          
          <code class="ruby">    iterations += 1</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="115">
          <span class="hits">12</span>
          
          <code class="ruby">    (0..iterations).each do |i|</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="116">
          <span class="hits">24</span>
          
          <code class="ruby">      skip = i * page</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="117">
          <span class="hits">24</span>
          
          <code class="ruby">      users = User.all().skip(skip).limit(page)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="119">
          <span class="hits">24</span>
          
          <code class="ruby">      yield users</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="121">
          <span class="hits">24</span>
          
          <code class="ruby">      co = i * page</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="122">
          <span class="hits">24</span>
          
          <code class="ruby">      log_msg = &quot;all_users_paged iteration: #{i} - users processed: #{co}&quot;</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="123">
          <span class="hits">24</span>
          
          <code class="ruby">      p log_msg</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="124">
          <span class="hits">24</span>
          
          <code class="ruby">      log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="132">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.notify_rob user, why</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">      UserMailer.deleted( user, why ).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="138">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="142">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.create_random_token(length = 25)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="143">
          <span class="hits">4</span>
          
          <code class="ruby">      SecureRandom.urlsafe_base64(length)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="145">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="147">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.create_random_value</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="148">
          <span class="hits">4</span>
          
          <code class="ruby">      chars = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="149">
          <span class="hits">4</span>
          
          <code class="ruby">      value = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="44" data-linenumber="150">
          <span class="hits">44</span>
          
          <code class="ruby">      10.times { value &lt;&lt; chars[rand(chars.size)] }</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="151">
          <span class="hits">4</span>
          
          <code class="ruby">      value</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="db3e86cba480773ee0c8ec365a015601c0acb188">
  <div class="header">
    <h3>lib/versioneye/services/version_service.rb</h3>
    <h4><span class="green">94.35 %</span> covered</h4>
    <div>
      <b>177</b> relevant lines. 
      <span class="green"><b>167</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class VersionService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.equal(ver_1, ver_2)</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="5">
          <span class="hits">17</span>
          
          <code class="ruby">    return true if ver_1.to_s.eql?( ver_2.to_s )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="7">
          <span class="hits">15</span>
          
          <code class="ruby">    sem_1 = SemVer.parse( ver_1 )</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="8">
          <span class="hits">15</span>
          
          <code class="ruby">    sem_2 = SemVer.parse( ver_2 )</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="9">
          <span class="hits">15</span>
          
          <code class="ruby">    if sem_1 &amp;&amp; sem_2</code>
        </li>
      
        <li class="covered" data-hits="15" data-linenumber="10">
          <span class="hits">15</span>
          
          <code class="ruby">      return sem_1 == sem_2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.newest_version(versions, stability = &#39;stable&#39;)</code>
        </li>
      
        <li class="covered" data-hits="644" data-linenumber="18">
          <span class="hits">644</span>
          
          <code class="ruby">    return nil if versions.nil? || versions.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="644" data-linenumber="20">
          <span class="hits">644</span>
          
          <code class="ruby">    filtered = Array.new</code>
        </li>
      
        <li class="covered" data-hits="644" data-linenumber="21">
          <span class="hits">644</span>
          
          <code class="ruby">    versions.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="5192" data-linenumber="22">
          <span class="hits">5192</span>
          
          <code class="ruby">      next if version.to_s.eql?(&#39;dev-master&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5183" data-linenumber="24">
          <span class="hits">5183</span>
          
          <code class="ruby">      if VersionTagRecognizer.does_it_fit_stability? version.to_s, stability</code>
        </li>
      
        <li class="covered" data-hits="4676" data-linenumber="25">
          <span class="hits">4676</span>
          
          <code class="ruby">        filtered &lt;&lt; version</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="644" data-linenumber="28">
          <span class="hits">644</span>
          
          <code class="ruby">    filtered = versions if filtered.empty?</code>
        </li>
      
        <li class="covered" data-hits="644" data-linenumber="29">
          <span class="hits">644</span>
          
          <code class="ruby">    if filtered.size &gt; 1</code>
        </li>
      
        <li class="covered" data-hits="386" data-linenumber="30">
          <span class="hits">386</span>
          
          <code class="ruby">      sorted = Naturalsorter::Sorter.sort_version_by_method( filtered, &#39;to_s&#39;, false )</code>
        </li>
      
        <li class="covered" data-hits="386" data-linenumber="31">
          <span class="hits">386</span>
          
          <code class="ruby">      return sorted.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="258" data-linenumber="33">
          <span class="hits">258</span>
          
          <code class="ruby">    return filtered.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    versions.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.versions_by_whitelist(versions, whitelist)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="42">
          <span class="hits">5</span>
          
          <code class="ruby">    whitelist = Set.new whitelist.to_a</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="43">
          <span class="hits">14</span>
          
          <code class="ruby">    versions.keep_if {|ver| whitelist.include? ver[:version]}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.newest_version_number( versions, stability = &#39;stable&#39;)</code>
        </li>
      
        <li class="covered" data-hits="325" data-linenumber="48">
          <span class="hits">325</span>
          
          <code class="ruby">    version = newest_version( versions, stability )</code>
        </li>
      
        <li class="covered" data-hits="325" data-linenumber="49">
          <span class="hits">325</span>
          
          <code class="ruby">    return nil if version.nil?</code>
        </li>
      
        <li class="covered" data-hits="325" data-linenumber="50">
          <span class="hits">325</span>
          
          <code class="ruby">    return version.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.newest_version_from( versions, stability = &#39;stable&#39;)</code>
        </li>
      
        <li class="covered" data-hits="121" data-linenumber="55">
          <span class="hits">121</span>
          
          <code class="ruby">    return nil if !versions || versions.empty?</code>
        </li>
      
        <li class="covered" data-hits="118" data-linenumber="56">
          <span class="hits">118</span>
          
          <code class="ruby">    VersionService.newest_version( versions, stability )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.newest_version_from_wildcard( versions, version_start, stability = &#39;stable&#39;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="61">
          <span class="hits">5</span>
          
          <code class="ruby">    version_start.gsub!(/x/i, &quot;*&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="62">
          <span class="hits">5</span>
          
          <code class="ruby">    versions_filtered = versions_start_with( versions, version_start )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="63">
          <span class="hits">5</span>
          
          <code class="ruby">    return newest_version_number( versions_filtered, stability )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  # http://guides.rubygems.org/patterns/#semantic_versioning</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  # http://robots.thoughtbot.com/rubys-pessimistic-operator</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.version_approximately_greater_than_starter(value)</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="70">
          <span class="hits">24</span>
          
          <code class="ruby">    ar      = value.split(&#39;.&#39;)</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="71">
          <span class="hits">24</span>
          
          <code class="ruby">    new_end = ar.length - 2</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="72">
          <span class="hits">24</span>
          
          <code class="ruby">    new_end = 0 if new_end &lt; 0</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="73">
          <span class="hits">24</span>
          
          <code class="ruby">    arr     = ar[0..new_end]</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="74">
          <span class="hits">24</span>
          
          <code class="ruby">    starter = arr.join(&#39;.&#39;)</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="75">
          <span class="hits">24</span>
          
          <code class="ruby">    return &quot;#{starter}.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.version_tilde_newest( versions, value )</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="80">
          <span class="hits">16</span>
          
          <code class="ruby">    return nil if value.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="82">
          <span class="hits">16</span>
          
          <code class="ruby">    value = value.gsub(&#39;~&#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="83">
          <span class="hits">16</span>
          
          <code class="ruby">    value = value.gsub(&#39; &#39;, &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="84">
          <span class="hits">16</span>
          
          <code class="ruby">    upper_border = self.tile_border( value )</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="85">
          <span class="hits">16</span>
          
          <code class="ruby">    greater_than = self.greater_than_or_equal( versions, value, true  )</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="86">
          <span class="hits">16</span>
          
          <code class="ruby">    range = self.smaller_than( greater_than, upper_border, true )</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="87">
          <span class="hits">16</span>
          
          <code class="ruby">    VersionService.newest_version_from( range )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.tile_border( value )</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="92">
          <span class="hits">22</span>
          
          <code class="ruby">    if value.is_a? Integer</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">      return value + 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="95">
          <span class="hits">21</span>
          
          <code class="ruby">    if value.match(/\./).nil? &amp;&amp; value.match(/^[0-9\-\_a-zA-Z]*\z/)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="96">
          <span class="hits">2</span>
          
          <code class="ruby">      return value.to_i + 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">    elsif value.match(/\./) &amp;&amp; value.match(/^[0-9]+\.[0-9\-\_a-zA-Z]*\z/)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="98">
          <span class="hits">12</span>
          
          <code class="ruby">      nums  = value.split(&#39;.&#39;)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="99">
          <span class="hits">12</span>
          
          <code class="ruby">      up    = nums.first.to_i + 1</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="100">
          <span class="hits">12</span>
          
          <code class="ruby">      return &quot;#{up}.0&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">    elsif value.match(/\./) &amp;&amp; value.match(/^[0-9]+\.[0-9]+\.[0-9\-\_a-zA-Z]*\z/)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="102">
          <span class="hits">7</span>
          
          <code class="ruby">      nums = value.split(&#39;.&#39;)</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="103">
          <span class="hits">7</span>
          
          <code class="ruby">      up   = nums[1].to_i + 1</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="104">
          <span class="hits">7</span>
          
          <code class="ruby">      return &quot;#{nums[0]}.#{up}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  # Get all versions from range ( &gt;=start &lt;=stop )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="111">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.version_range( versions, start, stop)</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="112">
          <span class="hits">12</span>
          
          <code class="ruby">    range = Array.new</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="113">
          <span class="hits">12</span>
          
          <code class="ruby">    versions.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="114">
          <span class="hits">57</span>
          
          <code class="ruby">      fits_stop  = Naturalsorter::Sorter.smaller_or_equal?( version.to_s, stop  )</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="115">
          <span class="hits">57</span>
          
          <code class="ruby">      fits_start = Naturalsorter::Sorter.bigger_or_equal?(  version.to_s, start )</code>
        </li>
      
        <li class="covered" data-hits="57" data-linenumber="116">
          <span class="hits">57</span>
          
          <code class="ruby">      if fits_start &amp;&amp; fits_stop</code>
        </li>
      
        <li class="covered" data-hits="37" data-linenumber="117">
          <span class="hits">37</span>
          
          <code class="ruby">        range.push(version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="120">
          <span class="hits">12</span>
          
          <code class="ruby">    range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="124">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.versions_start_with( versions, val )</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="125">
          <span class="hits">45</span>
          
          <code class="ruby">    return [] if versions.nil? || versions.empty?</code>
        </li>
      
        <li class="covered" data-hits="195" data-linenumber="126">
          <span class="hits">195</span>
          
          <code class="ruby">    versions.dup.keep_if {|ver| ver[:version].to_s.match(/^#{val}/)}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="127">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="130">
          
          
          <code class="ruby">    []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="133">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="134">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.newest_but_not( versions, value, range=false, stability = &quot;stable&quot;)</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="135">
          <span class="hits">20</span>
          
          <code class="ruby">    filtered_versions = versions.dup.keep_if {|version| version.to_s.match(/^#{value}/i).nil?}</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="136">
          <span class="hits">5</span>
          
          <code class="ruby">    return filtered_versions if range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="138">
          <span class="hits">3</span>
          
          <code class="ruby">    newest = VersionService.newest_version_from(filtered_versions, stability)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="139">
          <span class="hits">3</span>
          
          <code class="ruby">    return get_newest_or_value(newest, value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="140">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="143">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.greater_than( versions, value, range = false, stability = &quot;stable&quot;)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="144">
          <span class="hits">8</span>
          
          <code class="ruby">    filtered_versions = Array.new</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="145">
          <span class="hits">8</span>
          
          <code class="ruby">    versions.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="146">
          <span class="hits">24</span>
          
          <code class="ruby">      if Naturalsorter::Sorter.bigger?(version.to_s, value)</code>
        </li>
      
        <li class="covered" data-hits="14" data-linenumber="147">
          <span class="hits">14</span>
          
          <code class="ruby">        filtered_versions.push(version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="150">
          <span class="hits">8</span>
          
          <code class="ruby">    return filtered_versions if range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="152">
          <span class="hits">6</span>
          
          <code class="ruby">    newest = VersionService.newest_version_from(filtered_versions, stability)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="153">
          <span class="hits">6</span>
          
          <code class="ruby">    return get_newest_or_value(newest, value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="155">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="157">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.greater_than_or_equal( versions, value, range = false, stability = &quot;stable&quot;)</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="158">
          <span class="hits">48</span>
          
          <code class="ruby">    filtered_versions = Array.new</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="159">
          <span class="hits">48</span>
          
          <code class="ruby">    versions.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="172" data-linenumber="160">
          <span class="hits">172</span>
          
          <code class="ruby">      if Naturalsorter::Sorter.bigger_or_equal?(version.to_s, value)</code>
        </li>
      
        <li class="covered" data-hits="139" data-linenumber="161">
          <span class="hits">139</span>
          
          <code class="ruby">        filtered_versions.push(version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="162">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="48" data-linenumber="164">
          <span class="hits">48</span>
          
          <code class="ruby">    return filtered_versions if range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="166">
          <span class="hits">22</span>
          
          <code class="ruby">    newest = VersionService.newest_version_from(filtered_versions, stability)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="167">
          <span class="hits">22</span>
          
          <code class="ruby">    return get_newest_or_value(newest, value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="171">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.smaller_than( versions, value, range = false, stability = &quot;stable&quot;)</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="172">
          <span class="hits">36</span>
          
          <code class="ruby">    filtered_versions = Array.new</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="173">
          <span class="hits">36</span>
          
          <code class="ruby">    versions.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="125" data-linenumber="174">
          <span class="hits">125</span>
          
          <code class="ruby">      if Naturalsorter::Sorter.smaller?(version.to_s, value.to_s)</code>
        </li>
      
        <li class="covered" data-hits="77" data-linenumber="175">
          <span class="hits">77</span>
          
          <code class="ruby">        filtered_versions.push(version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="178">
          <span class="hits">36</span>
          
          <code class="ruby">    return filtered_versions if range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="180">
          <span class="hits">8</span>
          
          <code class="ruby">    newest = VersionService.newest_version_from(filtered_versions, stability)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="181">
          <span class="hits">8</span>
          
          <code class="ruby">    return get_newest_or_value(newest, value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="185">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.smaller_than_or_equal( versions, value, range = false, stability = &quot;stable&quot;)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="186">
          <span class="hits">9</span>
          
          <code class="ruby">    filtered_versions = Array.new</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="187">
          <span class="hits">9</span>
          
          <code class="ruby">    versions.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="188">
          <span class="hits">24</span>
          
          <code class="ruby">      if Naturalsorter::Sorter.smaller_or_equal?(version.to_s, value)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="189">
          <span class="hits">19</span>
          
          <code class="ruby">        filtered_versions.push(version)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="192">
          <span class="hits">9</span>
          
          <code class="ruby">    return filtered_versions if range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="194">
          <span class="hits">8</span>
          
          <code class="ruby">    newest = VersionService.newest_version_from(filtered_versions, stability)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="195">
          <span class="hits">8</span>
          
          <code class="ruby">    return get_newest_or_value(newest, value)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="199">
          
          
          <code class="ruby">  # Returns a sub range from a version range string</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="200">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.from_ranges( versions, version_string )</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="201">
          <span class="hits">13</span>
          
          <code class="ruby">    version_splitted = version_string.split(&quot;,&quot;)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="202">
          <span class="hits">13</span>
          
          <code class="ruby">    prod = Product.new</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="203">
          <span class="hits">13</span>
          
          <code class="ruby">    prod.versions = []</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="204">
          <span class="hits">13</span>
          
          <code class="ruby">    version_splitted.each do |verso|</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="205">
          <span class="hits">26</span>
          
          <code class="ruby">      verso.gsub!(&quot; &quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="206">
          <span class="hits">26</span>
          
          <code class="ruby">      stability = VersionTagRecognizer.stability_tag_for verso</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="207">
          <span class="hits">26</span>
          
          <code class="ruby">      if verso.match(/\A&gt;=/)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="208">
          <span class="hits">8</span>
          
          <code class="ruby">        verso.gsub!(&quot;&gt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="209">
          <span class="hits">8</span>
          
          <code class="ruby">        version_array = prod.versions.empty? ? versions : prod.versions</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="210">
          <span class="hits">8</span>
          
          <code class="ruby">        new_range = VersionService.greater_than_or_equal( version_array, verso, true, stability )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="211">
          <span class="hits">8</span>
          
          <code class="ruby">        prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby">      elsif verso.match(/\A&gt;/)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="213">
          <span class="hits">2</span>
          
          <code class="ruby">        verso.gsub!(&quot;&gt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="214">
          <span class="hits">2</span>
          
          <code class="ruby">        version_array = prod.versions.empty? ? versions : prod.versions</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="215">
          <span class="hits">2</span>
          
          <code class="ruby">        new_range = VersionService.greater_than( version_array, verso, true, stability )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="216">
          <span class="hits">2</span>
          
          <code class="ruby">        prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby">      elsif verso.match(/\A&lt;=/)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="218">
          <span class="hits">1</span>
          
          <code class="ruby">        verso.gsub!(&quot;&lt;=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="219">
          <span class="hits">1</span>
          
          <code class="ruby">        version_array = prod.versions.empty? ? versions : prod.versions</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="220">
          <span class="hits">1</span>
          
          <code class="ruby">        new_range = VersionService.smaller_than_or_equal( version_array, verso, true, stability )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="221">
          <span class="hits">1</span>
          
          <code class="ruby">        prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="222">
          
          
          <code class="ruby">      elsif verso.match(/\A&lt;/)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="223">
          <span class="hits">10</span>
          
          <code class="ruby">        verso.gsub!(&quot;&lt;&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="224">
          <span class="hits">10</span>
          
          <code class="ruby">        version_array = prod.versions.empty? ? versions : prod.versions</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="225">
          <span class="hits">10</span>
          
          <code class="ruby">        new_range = VersionService.smaller_than( version_array, verso, true, stability )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="226">
          <span class="hits">10</span>
          
          <code class="ruby">        prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="227">
          
          
          <code class="ruby">      elsif verso.match(/\A!=/)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="228">
          <span class="hits">2</span>
          
          <code class="ruby">        verso.gsub!(&quot;!=&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="229">
          <span class="hits">2</span>
          
          <code class="ruby">        version_array = prod.versions.empty? ? versions : prod.versions</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="230">
          <span class="hits">2</span>
          
          <code class="ruby">        new_range = VersionService.newest_but_not( version_array, verso, true, stability)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="231">
          <span class="hits">2</span>
          
          <code class="ruby">        prod.versions = new_range</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby">      elsif verso.match(/\A=/) || verso.match(/\A\w/)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="233">
          <span class="hits">3</span>
          
          <code class="ruby">        versions.each do |version|</code>
        </li>
      
        <li class="covered" data-hits="21" data-linenumber="234">
          <span class="hits">21</span>
          
          <code class="ruby">          prod.versions &lt;&lt; version if version.to_s.eql?(verso)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="236">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="237">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="238">
          <span class="hits">13</span>
          
          <code class="ruby">    prod.versions</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="242">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.average_release_time( versions )</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="243">
          <span class="hits">13</span>
          
          <code class="ruby">    return nil if versions.nil? || versions.empty? || versions.size == 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="244">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="25" data-linenumber="245">
          <span class="hits">25</span>
          
          <code class="ruby">    released_versions = versions.find_all{ |version| version.released_at }</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="246">
          <span class="hits">7</span>
          
          <code class="ruby">    return nil if released_versions.nil? || released_versions.empty? || released_versions.size &lt; 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="248">
          <span class="hits">9</span>
          
          <code class="ruby">    sorted_versions = released_versions.sort! { |a,b| a.released_at &lt;=&gt; b.released_at }</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="249">
          <span class="hits">3</span>
          
          <code class="ruby">    first = sorted_versions.first.released_at</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="250">
          <span class="hits">3</span>
          
          <code class="ruby">    last  = sorted_versions.last.released_at</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="251">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if first.nil? || last.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="253">
          <span class="hits">3</span>
          
          <code class="ruby">    diff = last.to_i - first.to_i</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="254">
          <span class="hits">3</span>
          
          <code class="ruby">    diff_days = diff / 60 / 60 / 24</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="255">
          <span class="hits">3</span>
          
          <code class="ruby">    average = diff_days / sorted_versions.size</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="256">
          <span class="hits">3</span>
          
          <code class="ruby">    average</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="259">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="260">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="264">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.estimated_average_release_time( versions )</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="265">
          <span class="hits">11</span>
          
          <code class="ruby">    return nil if versions.nil? || versions.empty? || versions.size == 1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="267">
          <span class="hits">13</span>
          
          <code class="ruby">    sorted_versions = versions.sort! { |a,b| a.created_at &lt;=&gt; b.created_at }</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="268">
          <span class="hits">3</span>
          
          <code class="ruby">    first = sorted_versions.first.created_at</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="269">
          <span class="hits">3</span>
          
          <code class="ruby">    last  = sorted_versions.last.created_at</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="270">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if first.nil? || last.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="272">
          <span class="hits">3</span>
          
          <code class="ruby">    diff = last.to_i - first.to_i</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="273">
          <span class="hits">3</span>
          
          <code class="ruby">    diff_days = diff / 60 / 60 / 24</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="274">
          <span class="hits">3</span>
          
          <code class="ruby">    average = diff_days / sorted_versions.size</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="275">
          <span class="hits">3</span>
          
          <code class="ruby">    average</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="277">
          <span class="hits">2</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="278">
          <span class="hits">2</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="279">
          <span class="hits">2</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="280">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="283">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="285">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.get_newest_or_value(newest, value)</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="286">
          <span class="hits">47</span>
          
          <code class="ruby">      return Version.new({:version =&gt; value}) if newest.nil?</code>
        </li>
      
        <li class="covered" data-hits="47" data-linenumber="287">
          <span class="hits">47</span>
          
          <code class="ruby">      return newest</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="288">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d3fdc4a01e058687c104d4179b94be4944f64b5d">
  <div class="header">
    <h3>lib/versioneye/services_ext/bitbucket.rb</h3>
    <h4><span class="red">64.47 %</span> covered</h4>
    <div>
      <b>152</b> relevant lines. 
      <span class="green"><b>98</b> lines covered</span> and
      <span class="red"><b>54</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;oauth&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class Bitbucket &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_API_V2_PATH = &quot;/api/2.0&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">  A_API_V1_PATH = &quot;/api/1.0&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEFAULT_HEADERS = {&quot;User-Agent&quot; =&gt; &quot;Chrome28 (contact@versioneye.com)&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="11">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.consumer_key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">   Settings.instance.bitbucket_token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.init_oauth_client</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="17">
          <span class="hits">27</span>
          
          <code class="ruby">    OAuth::Consumer.new(Settings.instance.bitbucket_token, Settings.instance.bitbucket_secret,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">                       site: Settings.instance.bitbucket_base_url,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">                       request_token_path: &quot;/api/1.0/oauth/request_token&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">                       access_token_path:  &quot;/api/1.0/oauth/access_token&quot;,  # &quot;/site/oauth2/access_token&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">                       authorize_path:     &quot;/api/1.0/oauth/authenticate&quot;)  # &quot;/site/oauth2/authorize&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.request_token(callback_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    oauth = init_oauth_client</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    oauth.get_request_token(oauth_callback: callback_url)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  # Returns user information for authorized user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.user(token, secret)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/user&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">    response = get_json(path, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    response[:user] if  response.is_a?(Hash)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">  # Returns bitbuckets&#39; profile info for username</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.user_info(user_name, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    return if user_name.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    path = &quot;#{A_API_V2_PATH}/users/#{user_name}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    get_json(path, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.user_orgs(user)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/user/privileges&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    data = get_json(path, user[:bitbucket_token], user[:bitbucket_secret])</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">    return if data.to_a.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    data[:teams].keys</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.read_repos(user_name, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="56">
          <span class="hits">3</span>
          
          <code class="ruby">    path = &quot;#{A_API_V2_PATH}/repositories/#{user_name}&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="57">
          <span class="hits">3</span>
          
          <code class="ruby">    repos = []</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="58">
          <span class="hits">3</span>
          
          <code class="ruby">    while true do</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="59">
          <span class="hits">3</span>
          
          <code class="ruby">      data = get_json(path, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="60">
          <span class="hits">3</span>
          
          <code class="ruby">      if data.nil? || data.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">        log.error &quot;data is nil for #{path}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">        break</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="65">
          <span class="hits">3</span>
          
          <code class="ruby">      repos.concat(data[:values]) if data.has_key?(:values)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="67">
          <span class="hits">3</span>
          
          <code class="ruby">      break if !data.has_key?(:next) or data[:next].to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">      path = data[:next]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="70">
          <span class="hits">3</span>
          
          <code class="ruby">    repos</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">  # Returns all the repo user has at least read access</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby">  # NB! it has own data format and it just used to find out invited projects</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.read_repos_v1(token, secret)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/user/repositories&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">    repos = get_json(path, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">    if repos.is_a?(Array)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="80">
          <span class="hits">5</span>
          
          <code class="ruby">      repos.each {|repo| repo[:full_name] = &quot;#{repo[:owner]}/#{repo[:slug]}&quot; }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="82">
          <span class="hits">1</span>
          
          <code class="ruby">    repos</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_info(repo_name, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">    path = &quot;#{A_API_V2_PATH}/repositories/#{repo_name}&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="88">
          <span class="hits">2</span>
          
          <code class="ruby">    get_json(path, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="92">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_branches(repo_name, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="93">
          <span class="hits">2</span>
          
          <code class="ruby">    path  = &quot;#{A_API_V1_PATH}/repositories/#{repo_name}/branches&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="94">
          <span class="hits">2</span>
          
          <code class="ruby">    data = get_json(path, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="95">
          <span class="hits">2</span>
          
          <code class="ruby">    return if data.nil? or not data.is_a?(Hash)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="97">
          <span class="hits">2</span>
          
          <code class="ruby">    branches = []</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="98">
          <span class="hits">2</span>
          
          <code class="ruby">    data.keys.each do |key|</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="99">
          <span class="hits">6</span>
          
          <code class="ruby">      branches.push key.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="101">
          <span class="hits">2</span>
          
          <code class="ruby">    branches</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_project_files(repo_name, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="106">
          <span class="hits">1</span>
          
          <code class="ruby">    branches = repo_branches(repo_name, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">    return if branches.to_a.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="109">
          <span class="hits">1</span>
          
          <code class="ruby">    files = {}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="110">
          <span class="hits">1</span>
          
          <code class="ruby">    branches.each do |branch|</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="111">
          <span class="hits">3</span>
          
          <code class="ruby">      project_files = project_files_from_branch(repo_name, branch, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="112">
          <span class="hits">3</span>
          
          <code class="ruby">      branch_name   = encode_db_key(branch)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="113">
          <span class="hits">3</span>
          
          <code class="ruby">      files[branch_name] = project_files if project_files</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="114">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="115">
          <span class="hits">1</span>
          
          <code class="ruby">    files</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_branch_tree(repo_name, branch, token, secret, directory = &#39;&#39;)</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="120">
          <span class="hits">6</span>
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/repositories/#{repo_name}/src/#{branch}/#{directory}&quot;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="121">
          <span class="hits">6</span>
          
          <code class="ruby">    get_json(path, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="122">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.project_files_from_branch(repo_name, branch, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="126">
          <span class="hits">4</span>
          
          <code class="ruby">    branch_tree = repo_branch_tree(repo_name, branch, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="127">
          <span class="hits">4</span>
          
          <code class="ruby">    if branch_tree.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">      log.error &quot;Didnt get branch tree for #{repo_name}/#{branch}.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="132">
          <span class="hits">4</span>
          
          <code class="ruby">    project_files = branch_tree[:files].keep_if do |file_info|</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="133">
          <span class="hits">16</span>
          
          <code class="ruby">      ProjectService.type_by_filename(file_info[:path]) != nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="134">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="135">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="136">
          <span class="hits">4</span>
          
          <code class="ruby">    if !branch_tree[:directories].to_a.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="137">
          <span class="hits">1</span>
          
          <code class="ruby">      project_files_recursive repo_name, branch, token, secret, &#39;&#39;, branch_tree[:directories], project_files, 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="140">
          <span class="hits">11</span>
          
          <code class="ruby">    project_files.each {|file| file[:uuid] = SecureRandom.hex }</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="141">
          <span class="hits">4</span>
          
          <code class="ruby">    project_files</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="143">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">    log.error e.backtrace.join(&#39;/n&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="149">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.project_files_recursive repo_name, branch, token, secret, path = &quot;&quot;, directories = nil, project_files = [], deepnes = 0</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="150">
          <span class="hits">1</span>
          
          <code class="ruby">    directories.to_a.each do |dir_info|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="151">
          <span class="hits">1</span>
          
          <code class="ruby">      tree_path = dir_info</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="152">
          <span class="hits">1</span>
          
          <code class="ruby">      tree_path = &quot;#{path}/#{dir_info}&quot; if !path.to_s.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="153">
          <span class="hits">1</span>
          
          <code class="ruby">      tree_path = tree_path.gsub(&quot;//&quot;, &quot;/&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="154">
          <span class="hits">1</span>
          
          <code class="ruby">      branch_tree = repo_branch_tree(repo_name, branch, token, secret, tree_path)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="155">
          <span class="hits">1</span>
          
          <code class="ruby">      next if branch_tree.nil? || branch_tree.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">      branch_tree[:files].to_a.each do |file_info|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">        project_files &lt;&lt; file_info if ProjectService.type_by_filename(file_info[:path]) != nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="159">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">      if !branch_tree[:directories].to_a.empty? &amp;&amp; deepnes.to_i &lt; 5</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">        path = branch_tree[:path]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">        deepnes += 1</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="163">
          
          
          <code class="ruby">        project_files_recursive repo_name, branch, token, secret, path, branch_tree[:directories], project_files, deepnes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="165">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="168">
          
          
          <code class="ruby">    log.error e.backtrace.join(&#39;/n&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="171">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="172">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_project_file_from_branch(repo_name, branch, filename, token, secret)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="173">
          <span class="hits">10</span>
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/repositories/#{repo_name}/raw/#{branch}/#{filename}&quot;</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="174">
          <span class="hits">10</span>
          
          <code class="ruby">    get_json(path, token, secret, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="178">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_json(path, token, secret, raw = false, params = {}, headers = {})</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="179">
          <span class="hits">27</span>
          
          <code class="ruby">    url = URI.encode &quot;#{Settings.instance.bitbucket_base_url}#{path}&quot;</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="180">
          <span class="hits">27</span>
          
          <code class="ruby">    oauth = init_oauth_client</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="181">
          <span class="hits">27</span>
          
          <code class="ruby">    token_obj = OAuth::AccessToken.new(oauth, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">    # oauth_params = {consumer: oauth, token: token, request_uri: url}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="185">
          <span class="hits">27</span>
          
          <code class="ruby">    request_headers = A_DEFAULT_HEADERS</code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="186">
          <span class="hits">27</span>
          
          <code class="ruby">    request_headers.merge! headers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="27" data-linenumber="188">
          <span class="hits">27</span>
          
          <code class="ruby">    response = token_obj.get(path, request_headers)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">    # if response.code.to_i != 200</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="191">
          
          
          <code class="ruby">    #   TODO</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="192">
          
          
          <code class="ruby">    # end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="194">
          <span class="hits">26</span>
          
          <code class="ruby">    if raw == true</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="195">
          <span class="hits">10</span>
          
          <code class="ruby">      return response.body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="198">
          <span class="hits">16</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="199">
          <span class="hits">16</span>
          
          <code class="ruby">      JSON.parse(response.body, symbolize_names: true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="200">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="201">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="202">
          
          
          <code class="ruby">      log.error &quot;Got status: #{response.code} #{response.message} body: #{response.body} for path: #{path}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="203">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="204">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="207">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error &quot;ERROR in get_json for #{path} - #{e.message}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="208">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="209">
          <span class="hits">1</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="211">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="212">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="213">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_branches repo, token, secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="214">
          
          
          <code class="ruby">    repo = repo.deep_symbolize_keys if repo.respond_to? &quot;deep_symbolize_keys&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="215">
          
          
          <code class="ruby">    fullname = repo[:full_name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="216">
          
          
          <code class="ruby">    fullname = repo[:fullname] if fullname.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="217">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="218">
          
          
          <code class="ruby">    branch_docs = Bitbucket.repo_branches( fullname, token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="219">
          
          
          <code class="ruby">    if branch_docs &amp;&amp; !branch_docs.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="220">
          
          
          <code class="ruby">      repo[:branches] = branch_docs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="221">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="222">
          
          
          <code class="ruby">      repo[:branches] = [&quot;master&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="223">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="224">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="225">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="226">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="227">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="228">
          
          
          <code class="ruby">    repo[:branches] = [&quot;master&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="229">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="230">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="232">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="233">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_project_files repo, token, secret, try_n = 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="234">
          
          
          <code class="ruby">    project_files = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="235">
          
          
          <code class="ruby">    repo = repo.deep_symbolize_keys if repo.respond_to? &quot;deep_symbolize_keys&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="236">
          
          
          <code class="ruby">    fullname = repo[:full_name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="237">
          
          
          <code class="ruby">    fullname = repo[:fullname] if fullname.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="238">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">    # Adds project files</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="240">
          
          
          <code class="ruby">    try_n.times do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="241">
          
          
          <code class="ruby">      project_files = Bitbucket.repo_project_files( fullname, token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="242">
          
          
          <code class="ruby">      break unless project_files.nil? or project_files.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="243">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="244">
          
          
          <code class="ruby">      log.info &quot;Trying to read `#{fullname}` again&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="245">
          
          
          <code class="ruby">      sleep 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="246">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="248">
          
          
          <code class="ruby">    if project_files.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="249">
          
          
          <code class="ruby">      msg = &quot;Cant read project files for repo `#{fullname}`. Tried to read #{try_n} ntimes.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="250">
          
          
          <code class="ruby">      log.error msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="251">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="253">
          
          
          <code class="ruby">    repo[:project_files] = project_files</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="254">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="255">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="256">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="257">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="258">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="259">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="261">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="262">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.encode_db_key(key_val)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="263">
          <span class="hits">3</span>
          
          <code class="ruby">    URI.escape(key_val.to_s, /\.|\$/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="267">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.decode_db_key(key_val)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="268">
          
          
          <code class="ruby">    URI.unescape key_val.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="269">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="270">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="271">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ffc0e94f679bc5a454d0b3876cd94d3f1ab530fa">
  <div class="header">
    <h3>lib/versioneye/services_ext/es_product.rb</h3>
    <h4><span class="yellow">82.86 %</span> covered</h4>
    <div>
      <b>70</b> relevant lines. 
      <span class="green"><b>58</b> lines covered</span> and
      <span class="red"><b>12</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class EsProduct &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_index_with_mappings</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="4">
          <span class="hits">20</span>
          
          <code class="ruby">    Tire.index Settings.instance.elasticsearch_product_index do</code>
        </li>
      
        <li class="covered" data-hits="20" data-linenumber="5">
          <span class="hits">20</span>
          
          <code class="ruby">      create :settings =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">          :number_of_shards =&gt; 1,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">          :number_of_replicas =&gt; 1,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">          :analysis =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">            :filter =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">              :name_ngrams =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">                :side =&gt; &#39;front&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">                :type =&gt; &#39;edgeNGram&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">                :max_gram =&gt; 100,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">                :min_gram =&gt; 2</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">              },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">              :whole_words =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">                :type =&gt; &#39;word_delimiter&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">                :generate_word_parts =&gt; false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">                :generate_number_parts =&gt; false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">                :split_on_case_change =&gt; false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">                :split_on_numerics =&gt; false,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">                :preserve_original =&gt; true # maybe not needed anymore with all the changes from above</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">              }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">            },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">            :analyzer =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">              :product_name =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">                :filter =&gt; [&#39;standard&#39;, &#39;lowercase&#39;, &#39;asciifolding&#39;, &#39;whole_words&#39;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">                :type =&gt; &#39;custom&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">                :tokenizer =&gt; &#39;standard&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">              },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">              :ngram_name =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">                :filter =&gt; [&#39;standard&#39;, &#39;lowercase&#39;, &#39;asciifolding&#39;, &#39;whole_words&#39;, &#39;name_ngrams&#39;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">                :type =&gt; &#39;custom&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">                :tokenizer =&gt; &#39;standard&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">              }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">            }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">        },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">      :mappings =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">        :product =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">          :properties =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">            :_id  =&gt; { :type =&gt; &#39;string&#39;, :analyzer =&gt; &#39;keyword&#39;, :include_in_all =&gt; false },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">            :name =&gt; { :type =&gt; &#39;multi_field&#39;, :fields =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby">                :name    =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">                  :type =&gt; &#39;string&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">                  :analyzer =&gt; &#39;product_name&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">                  :include_in_all =&gt; false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">                },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">                :partial =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">                  :search_analyzer =&gt; &#39;product_name&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">                  :index_analyzer  =&gt; &#39;ngram_name&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">                  :type =&gt; &#39;string&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">                  :include_in_all =&gt; true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">                  :boost =&gt; 10</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">                }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">              }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">            },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">            :followers          =&gt; { :type =&gt; &#39;integer&#39;, :include_in_all =&gt; true},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">            :used_by_count      =&gt; { :type =&gt; &#39;integer&#39;, :include_in_all =&gt; true},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby">            :description        =&gt; { :type =&gt; &#39;string&#39;, :analyzer =&gt; &#39;snowball&#39; },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">            :description_manual =&gt; { :type =&gt; &#39;string&#39;, :analyzer =&gt; &#39;snowball&#39; },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">            :language           =&gt; { :type =&gt; &#39;string&#39;, :analyzer =&gt; &#39;keyword&#39;  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.clean_all</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="70">
          <span class="hits">24</span>
          
          <code class="ruby">    Tire.index( Settings.instance.elasticsearch_product_index ).delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="73">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.reset</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="74">
          <span class="hits">19</span>
          
          <code class="ruby">    self.clean_all</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="75">
          <span class="hits">19</span>
          
          <code class="ruby">    self.create_index_with_mappings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="78">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.index_all</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="79">
          <span class="hits">4</span>
          
          <code class="ruby">    ProductService.all_products_paged do |products|</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="80">
          <span class="hits">8</span>
          
          <code class="ruby">      bulk_index products</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="82">
          <span class="hits">4</span>
          
          <code class="ruby">    self.refresh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.bulk_index products</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="86">
          <span class="hits">8</span>
          
          <code class="ruby">    Tire.index Settings.instance.elasticsearch_product_index do</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="87">
          <span class="hits">45</span>
          
          <code class="ruby">      json_product = products.map{|product| product.to_indexed_json}</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="88">
          <span class="hits">8</span>
          
          <code class="ruby">      import json_product</code>
        </li>
      
        <li class="covered" data-hits="45" data-linenumber="89">
          <span class="hits">45</span>
          
          <code class="ruby">      products.map{|product| product.update_attribute(:reindex, false) }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="93">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.index( product )</code>
        </li>
      
        <li class="covered" data-hits="218" data-linenumber="94">
          <span class="hits">218</span>
          
          <code class="ruby">    Tire.index Settings.instance.elasticsearch_product_index do</code>
        </li>
      
        <li class="covered" data-hits="218" data-linenumber="95">
          <span class="hits">218</span>
          
          <code class="ruby">      store product.to_indexed_json</code>
        </li>
      
        <li class="covered" data-hits="218" data-linenumber="96">
          <span class="hits">218</span>
          
          <code class="ruby">      product.update_attribute(:reindex, false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="103">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.refresh</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="104">
          <span class="hits">6</span>
          
          <code class="ruby">    Tire.index( Settings.instance.elasticsearch_product_index ).refresh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="107">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.index_and_refresh( product )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">    self.index product</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">    self.refresh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="112">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.index_newest</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">    Product.where(reindex: true).each do |product|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="114">
          <span class="hits">12</span>
          
          <code class="ruby">      index product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="116">
          <span class="hits">1</span>
          
          <code class="ruby">    self.refresh</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="117">
          <span class="hits">1</span>
          
          <code class="ruby">    Product.where(reindex: nil).each do |product|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="118">
          
          
          <code class="ruby">      index product</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="120">
          <span class="hits">1</span>
          
          <code class="ruby">    self.refresh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="125">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="126">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.remove( product )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="127">
          <span class="hits">1</span>
          
          <code class="ruby">    Tire.index( Settings.instance.elasticsearch_product_index ).remove( product.id )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="128">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="129">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">  # langs: need to be an Array !</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">  # page_count: has to start by 1. Not by 0!</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="132">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="133">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.search(q, group_id = nil, langs = Array.new, page_count = 1)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="134">
          <span class="hits">13</span>
          
          <code class="ruby">    if (q.nil? || q.empty?) &amp;&amp; (group_id.nil? || group_id.empty?)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="135">
          <span class="hits">1</span>
          
          <code class="ruby">      raise ArgumentError, &quot;query and group_id are both empty! This is not allowed&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="136">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="138">
          <span class="hits">12</span>
          
          <code class="ruby">    page_count = 1 if page_count.nil? || page_count.to_i &lt; 1</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="139">
          <span class="hits">12</span>
          
          <code class="ruby">    results_per_page = 30</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="140">
          <span class="hits">12</span>
          
          <code class="ruby">    from = results_per_page * (page_count.to_i - 1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="141">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="142">
          <span class="hits">12</span>
          
          <code class="ruby">    group_id = &quot;&quot; if !group_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="144">
          <span class="hits">12</span>
          
          <code class="ruby">    q = &quot;*&quot; if !q || q.empty?</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="145">
          <span class="hits">12</span>
          
          <code class="ruby">    q.downcase</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="147">
          <span class="hits">12</span>
          
          <code class="ruby">    s = Tire.search( Settings.instance.elasticsearch_product_index,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby">                      load: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="149">
          
          
          <code class="ruby">                      from: from,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">                      search_type: &quot;dfs_query_and_fetch&quot;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">                      per_page: results_per_page,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby">                      size: results_per_page) do |search|</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="154">
          <span class="hits">12</span>
          
          <code class="ruby">      if langs and !langs.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="155">
          <span class="hits">2</span>
          
          <code class="ruby">        decoded_langs = []</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="156">
          <span class="hits">2</span>
          
          <code class="ruby">        langs.each do |lang|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="157">
          <span class="hits">2</span>
          
          <code class="ruby">          decoded_langs &lt;&lt; Product.decode_language(lang)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="158">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="159">
          <span class="hits">2</span>
          
          <code class="ruby">        search.filter :terms, :language =&gt; decoded_langs</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="160">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="161">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="162">
          <span class="hits">12</span>
          
          <code class="ruby">      search.query do |query|</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="163">
          <span class="hits">12</span>
          
          <code class="ruby">        if q != &#39;*&#39; and !group_id.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby">          # when user search by name and group_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="165">
          <span class="hits">1</span>
          
          <code class="ruby">          query.boolean do</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="166">
          <span class="hits">2</span>
          
          <code class="ruby">            must {string &#39;name.partial:&#39; + q}</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="167">
          <span class="hits">2</span>
          
          <code class="ruby">            must {string &#39;group_id:&#39; + group_id + &quot;*&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="169">
          
          
          <code class="ruby">        elsif q != &#39;*&#39; and group_id.empty?</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="170">
          <span class="hits">10</span>
          
          <code class="ruby">          query.custom_score :script =&gt; &quot;(_score &gt; 0.95 ? _score + doc[&#39;followers&#39;].value : _score )&quot; do</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="171">
          <span class="hits">10</span>
          
          <code class="ruby">            string &quot;name.partial:&quot; + q</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="172">
          
          
          <code class="ruby">          end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="173">
          
          
          <code class="ruby">        elsif q == &#39;*&#39; and !group_id.empty?</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="174">
          <span class="hits">1</span>
          
          <code class="ruby">          query.string &quot;group_id:&quot; + group_id + &quot;*&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">        end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="177">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="178">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="179">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="180">
          <span class="hits">12</span>
          
          <code class="ruby">    s.results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="181">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="182">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="183">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.autocomplete(term, results_per_page = 10)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="184">
          
          
          <code class="ruby">    q = term || &quot;*&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="185">
          
          
          <code class="ruby">    s = Tire.search(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="186">
          
          
          <code class="ruby">          Settings.instance.elasticsearch_product_index,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby">          load: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="188">
          
          
          <code class="ruby">          search_type: &#39;dfs_query_and_fetch&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="189">
          
          
          <code class="ruby">          size: results_per_page</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby">    ) do |search|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">        search.query { |query| query.string &quot;name.partial:#{q}&quot;}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="192">
          
          
          <code class="ruby">        search.sort {by :followers, &#39;desc&#39;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="193">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="194">
          
          
          <code class="ruby">    s.results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="195">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="6d316dcf642d6c5f6c0eb68cf003c07aa95efec7">
  <div class="header">
    <h3>lib/versioneye/services_ext/es_user.rb</h3>
    <h4><span class="red">25.0 %</span> covered</h4>
    <div>
      <b>40</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>30</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class EsUser &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_index_with_mappings</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    Tire.index(Settings.instance.elasticsearch_user_index) do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">      create :mappings =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">        :user =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">          :properties =&gt; {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">            :_id =&gt; {type: &#39;string&#39;, analyzer: &#39;keyword&#39;, include_in_all: false},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">            :fullname =&gt; {type: &#39;string&#39;, analyzer: &#39;snowball&#39;, boost: 1},</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">            :username =&gt; {type: &#39;string&#39;, analyzer: &#39;snowball&#39;, boost: 100}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">          }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">        }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  #-- search</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.search(term, results_per_page = 10)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    q = term || &#39;*&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    s = Tire.search(Settings.instance.elasticsearch_user_index,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">                    load: true,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">                    search_type: &#39;dfs_query_and_fetch&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">                    size: results_per_page) do |search|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      search.query do |query|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">        query.string &quot;#{ q }*&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    s.results</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  #--  admin funcs</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.clean_all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    Tire.index( Settings.instance.elasticsearch_user_index ).delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.reset</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    self.clean_all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    self.create_index_with_mappings</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="45">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.refresh</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    Tire.index( Settings.instance.elasticsearch_user_index ).refresh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.index_all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">    UserService.all_users_paged do |users|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">      bulk_index users</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    self.refresh</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="59">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.reindex_all</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    self.reset</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    self.index_all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.bulk_index users</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    Tire.index Settings.instance.elasticsearch_user_index do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">      json_users = users.map{|user| user.to_indexed_json}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">      import json_users</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="74">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.index(user)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    log.info &quot;indexing: #{user[:username]}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    Tire.index Settings.instance.elasticsearch_user_index do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">      store user.to_indexed_json</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="01e836c5be6be12982db113a3361913334660b2a">
  <div class="header">
    <h3>lib/versioneye/services_ext/github.rb</h3>
    <h4><span class="red">45.76 %</span> covered</h4>
    <div>
      <b>271</b> relevant lines. 
      <span class="green"><b>124</b> lines covered</span> and
      <span class="red"><b>147</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="never" data-hits="" data-linenumber="1">
          
          
          <code class="ruby">#------------------------------------------------------------------------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"># Github - helper functions to manage Github&#39;s data.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># NB! For consistancy: every function that returns hash-map, should have</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"># symbolized keys. For that you can use 2 helpers function:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">#  * {&#39;a&#39; =&gt; 1}.deep_symbolize_keys - encodes keys recursively</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">#  * JSON.parse(json_string, symbolize_names: true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"># If you&#39;re going to add simple get-request function, then use `get_json`.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"># This function builds correct headers and handles Github exceptions.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">#</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">#------------------------------------------------------------------------------</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;uri&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;httparty&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;persistent_httparty&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">class Github &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">  A_WORKERS_COUNT = 4</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">  A_USER_AGENT = &#39;Chrome/28(www.versioneye.com, contact@versioneye.com)&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEFAULT_HEADERS = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">    &#39;Accept&#39; =&gt; &#39;application/vnd.github.v3+json&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    &#39;User-Agent&#39; =&gt; A_USER_AGENT,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    &#39;Connection&#39; =&gt; &#39;Keep-Alive&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  include HTTParty</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  persistent_connection_adapter({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">    name: &#39;versioneye_github_client&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    pool_size: 30,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    keep_alive: 30</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.token code</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">    response = Octokit.exchange_code_for_token code, Settings.instance.github_client_id, Settings.instance.github_client_secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">    response.access_token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.user token</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="43">
          <span class="hits">3</span>
          
          <code class="ruby">    client = OctokitApi.client token</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="44">
          <span class="hits">3</span>
          
          <code class="ruby">    client.user.to_hash </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="46">
          <span class="hits">2</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="47">
          <span class="hits">2</span>
          
          <code class="ruby">    log.error e.backtrace.join( &quot;\n&quot; )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="48">
          <span class="hits">2</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.emails token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    client = OctokitApi.client token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    client.emails</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    log.error e.backtrace.join( &quot;\n&quot; )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.oauth_scopes token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    client = OctokitApi.client token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    client.scopes token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">    log.error e.backtrace.join( &quot;\n&quot; )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">    &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  # Returns how many repos user has. NB! doesnt count orgs</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.count_user_repos(user_info)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    n = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    return n if user_info[:github_token].nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    user_info = get_json(&quot;#{Settings.instance.github_api_url}/user&quot;, user_info[:github_token])</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    if user_info</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      n = user_info[:public_repos].to_i + user_info[:total_private_repos].to_i</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">    n</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="81">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.user_repos user, url = nil, page = 1, per_page = 30</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">    url = &quot;#{Settings.instance.github_api_url}/user/repos?page=#{page}&amp;per_page=#{per_page}&amp;access_token=#{user.github_token}&quot; if url.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">    persist_repos(user, url, page, per_page)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="86">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.user_orga_repos user, orga_name, url = nil, page = 1, per_page = 30</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">    url = &quot;#{Settings.instance.github_api_url}/orgs/#{orga_name}/repos?access_token=#{user.github_token}&amp;page=#{page}&amp;per_page=#{per_page}&quot; if url.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">    persist_repos(user, url, page, per_page)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="91">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_info(repo_fullname, token, raw = false, updated_since = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">    get_json(&quot;#{Settings.instance.github_api_url}/repos/#{repo_fullname}&quot;, token, raw, updated_since)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_tags(repository, token)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">    get_json(&quot;#{Settings.instance.github_api_url}/repos/#{repository}/tags&quot;, token)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_tags_all(repository, token)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">    tags = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    url = &quot;#{Settings.instance.github_api_url}/repos/#{repository}/tags&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">      request_headers = build_request_headers token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">      response = get(url, headers: request_headers)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      content  = JSON.parse( response.body, symbolize_names: true )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">      data     = catch_github_exception( content )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">      tags     += data if data</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">      paging   = paging_for response</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">      url      = paging[:paging][&quot;next&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">    end while not url.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="111">
          
          
          <code class="ruby">    tags = nil if tags.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">    tags</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="118">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.read_repo_data repo, token, try_n = 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="119">
          
          
          <code class="ruby">    return nil if repo.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">    self.update_branches repo, token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">    self.update_project_files repo, token, try_n</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="123">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="124">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="125">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_project_files repo, token, try_n = 3</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="126">
          
          
          <code class="ruby">    project_files = nil</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">    repo = repo.deep_symbolize_keys if repo.respond_to? &quot;deep_symbolize_keys&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">    fullname = repo[:full_name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">    fullname = repo[:fullname] if fullname.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby">    # Adds project files</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">    try_n.times do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">      project_files = repo_project_files(fullname, token, nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">      break unless project_files.nil? or project_files.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">      log.info &quot;Trying to read `#{fullname}` again&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">      sleep 3</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="137">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="139">
          
          
          <code class="ruby">    if project_files.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">      msg = &quot;Cant read project files for repo `#{fullname}`. Tried to read #{try_n} ntimes.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">      log.error msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="144">
          
          
          <code class="ruby">    repo[:project_files] = project_files</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="145">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="146">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="147">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="148">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="149">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="150">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="152">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_branches repo, token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="153">
          
          
          <code class="ruby">    repo = repo.deep_symbolize_keys if repo.respond_to? &quot;deep_symbolize_keys&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="154">
          
          
          <code class="ruby">    fullname = repo[:full_name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="155">
          
          
          <code class="ruby">    fullname = repo[:fullname] if fullname.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="156">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="157">
          
          
          <code class="ruby">    branch_docs = self.repo_branches(fullname, token)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="158">
          
          
          <code class="ruby">    if branch_docs</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="159">
          
          
          <code class="ruby">      branches = [] </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="160">
          
          
          <code class="ruby">      branch_docs.each do |branch| </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="161">
          
          
          <code class="ruby">        next if branch[:name].to_s.eql?(&#39;gh-pages&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="162">
          
          
          <code class="ruby">        branches &lt;&lt; branch[:name]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="163">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="164">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="165">
          
          
          <code class="ruby">      repo[:branches] = branches</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="166">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="167">
          
          
          <code class="ruby">      repo[:branches] = [&quot;master&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="168">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="169">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="170">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="171">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="172">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="173">
          
          
          <code class="ruby">    repo[:branches] = [&quot;master&quot;]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="174">
          
          
          <code class="ruby">    repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="175">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="176">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="177">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.persist_repos user, url, page = 1, per_page = 30</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="178">
          <span class="hits">2</span>
          
          <code class="ruby">    response = get(url, headers: A_DEFAULT_HEADERS)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="179">
          <span class="hits">2</span>
          
          <code class="ruby">    content  = JSON.parse(response.body, symbolize_names: true)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="180">
          <span class="hits">2</span>
          
          <code class="ruby">    data     = catch_github_exception( content )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="181">
          <span class="hits">2</span>
          
          <code class="ruby">    create_or_update_repos user, data</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="182">
          <span class="hits">2</span>
          
          <code class="ruby">    paging_for response</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="183">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="184">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="185">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_or_update_repos user, data</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="186">
          <span class="hits">2</span>
          
          <code class="ruby">    return nil if data.nil? || data.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="187">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="188">
          
          
          <code class="ruby">    data.each do |repo|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="189">
          
          
          <code class="ruby">      next if repo.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="190">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="191">
          
          
          <code class="ruby">      fullname = repo[:full_name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="192">
          
          
          <code class="ruby">      fullname = repo[:fullname] if fullname.to_s.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="193">
          
          
          <code class="ruby">      next if fullname.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="194">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="195">
          
          
          <code class="ruby">      GithubRepo.build_or_update user, repo</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="196">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="197">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="198">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="199">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.paging_for response, page = 1, per_page = 30</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="200">
          <span class="hits">5</span>
          
          <code class="ruby">    paging = {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="201">
          
          
          <code class="ruby">      paging: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="202">
          
          
          <code class="ruby">        start: page,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="203">
          
          
          <code class="ruby">        per_page: per_page</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="204">
          
          
          <code class="ruby">      },</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="205">
          
          
          <code class="ruby">      etag: response.headers[&quot;etag&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="206">
          
          
          <code class="ruby">      ratelimit: {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="207">
          
          
          <code class="ruby">        limit: response.headers[&quot;x-ratelimit-limit&quot;],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="208">
          
          
          <code class="ruby">        remaining: response.headers[&quot;x-ratelimit-remaining&quot;]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="209">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="210">
          
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="211">
          <span class="hits">5</span>
          
          <code class="ruby">    paging_links = parse_paging_links(response.headers)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="212">
          <span class="hits">5</span>
          
          <code class="ruby">    paging[:paging].merge! paging_links unless paging_links.nil?</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="213">
          <span class="hits">5</span>
          
          <code class="ruby">    paging</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="214">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="215">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="216">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="217">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_branches repo_name, token</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="218">
          <span class="hits">3</span>
          
          <code class="ruby">    branches = []</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="219">
          <span class="hits">3</span>
          
          <code class="ruby">    url = &quot;#{Settings.instance.github_api_url}/repos/#{repo_name}/branches&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="220">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="221">
          <span class="hits">3</span>
          
          <code class="ruby">      request_headers = build_request_headers token</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="222">
          <span class="hits">3</span>
          
          <code class="ruby">      response = get(url, headers: request_headers)</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="223">
          <span class="hits">3</span>
          
          <code class="ruby">      content  = JSON.parse( response.body, symbolize_names: true )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="224">
          <span class="hits">3</span>
          
          <code class="ruby">      data     = catch_github_exception( content )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="225">
          <span class="hits">3</span>
          
          <code class="ruby">      branches += data if data</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="226">
          <span class="hits">3</span>
          
          <code class="ruby">      paging   = paging_for response</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="227">
          <span class="hits">3</span>
          
          <code class="ruby">      url      = paging[:paging][&quot;next&quot;]</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="228">
          <span class="hits">3</span>
          
          <code class="ruby">    end while not url.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="229">
          <span class="hits">3</span>
          
          <code class="ruby">    branches = nil if branches.empty?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="230">
          <span class="hits">3</span>
          
          <code class="ruby">    branches</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="231">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="232">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="233">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="234">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="235">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="236">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_branch_info repo_name, branch = &quot;master&quot;, token = nil</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="237">
          <span class="hits">16</span>
          
          <code class="ruby">    url = &quot;#{Settings.instance.github_api_url}/repos/#{repo_name}/branches/#{branch}&quot;</code>
        </li>
      
        <li class="covered" data-hits="16" data-linenumber="238">
          <span class="hits">16</span>
          
          <code class="ruby">    get_json(url, token)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="239">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="240">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="241">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="242">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_project_file_from_branch repo_name, filename, branch = &quot;master&quot;, token = nil</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="243">
          <span class="hits">13</span>
          
          <code class="ruby">    branch_info = Github.repo_branch_info repo_name, branch, token</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="244">
          <span class="hits">13</span>
          
          <code class="ruby">    if branch_info.nil? || branch_info[:commit].nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="245">
          <span class="hits">3</span>
          
          <code class="ruby">      log.error &quot;fetch_project_file_from_branch - can&#39;t read branch info for [repo_name: #{repo_name}, branch: #{branch}, token: #{token}] - branch_info: #{branch_info}&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="246">
          <span class="hits">3</span>
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="247">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="248">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="249">
          <span class="hits">10</span>
          
          <code class="ruby">    file_info = Github.project_file_info( repo_name, filename, branch_info[:commit][:sha], token)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="250">
          <span class="hits">10</span>
          
          <code class="ruby">    if file_info.nil? || file_info.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="251">
          
          
          <code class="ruby">      log.error %Q{</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="252">
          
          
          <code class="ruby">        fetch_project_file_from_branch | can&#39;t read info about project&#39;s file.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="253">
          
          
          <code class="ruby">        repo: #{repo_name} , filename: `#{filename}` , branch_info: #{branch_info}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="254">
          
          
          <code class="ruby">      }</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="255">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="256">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="257">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="258">
          <span class="hits">10</span>
          
          <code class="ruby">    file_content = fetch_file(file_info[:url], token)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="259">
          <span class="hits">10</span>
          
          <code class="ruby">    return nil if file_content.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="260">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="261">
          <span class="hits">10</span>
          
          <code class="ruby">    file_info.merge({</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="262">
          
          
          <code class="ruby">      branch: branch,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="263">
          
          
          <code class="ruby">      content: file_content[:content]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="264">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="265">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="266">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="267">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="268">
          
          
          <code class="ruby">  # TODO: add tests</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="269">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.project_file_info(git_project, filename, sha, token)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="270">
          <span class="hits">10</span>
          
          <code class="ruby">    url   = &quot;#{Settings.instance.github_api_url}/repos/#{git_project}/git/trees/#{sha}?recursive=1&quot;</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="271">
          <span class="hits">10</span>
          
          <code class="ruby">    tree = get_json(url, token)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="272">
          <span class="hits">10</span>
          
          <code class="ruby">    if tree.nil? || !tree.has_key?(:tree)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="273">
          
          
          <code class="ruby">      log.error &quot;No file tree for #{url}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="274">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="275">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="276">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="974" data-linenumber="277">
          <span class="hits">974</span>
          
          <code class="ruby">    matching_files = tree[:tree].keep_if {|blob| blob[:path] == filename}</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="278">
          <span class="hits">10</span>
          
          <code class="ruby">    if matching_files.nil? or matching_files.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="279">
          
          
          <code class="ruby">      log.error &quot;No file matches #{filename}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="280">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="281">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="282">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="283">
          <span class="hits">10</span>
          
          <code class="ruby">    file = matching_files.first</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="284">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="285">
          
          
          <code class="ruby">      name: file[:path],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="286">
          
          
          <code class="ruby">      url:  file[:url],</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="287">
          
          
          <code class="ruby">      type: ProjectService.type_by_filename(file[:path])</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="288">
          <span class="hits">10</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="289">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="290">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="291">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="292">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_branch_tree(repo_name, token, branch_sha, recursive = false)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="293">
          
          
          <code class="ruby">    rec_val = recursive ? 1 : 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="294">
          
          
          <code class="ruby">    url = &quot;#{Settings.instance.github_api_url}/repos/#{repo_name}/git/trees/#{branch_sha}?access_token=#{token}&amp;recursive=#{rec_val}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="295">
          
          
          <code class="ruby">    response = get(url, headers: A_DEFAULT_HEADERS )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="296">
          
          
          <code class="ruby">    if response.code != 200</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="297">
          
          
          <code class="ruby">      msg = &quot;Can&#39;t fetch repo tree for `#{repo_name}` from #{url}: #{response.code} #{response.body}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="298">
          
          
          <code class="ruby">      log.error msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="299">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="300">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="301">
          
          
          <code class="ruby">    JSON.parse(response.body, symbolize_names: false)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="302">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="303">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="304">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="305">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.project_files_from_branch(repo_name, token, branch_sha, branch = &quot;master&quot;, try_n = 3)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="306">
          
          
          <code class="ruby">    branch_tree = nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="307">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="308">
          
          
          <code class="ruby">    try_n.times do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="309">
          
          
          <code class="ruby">      branch_tree = repo_branch_tree(repo_name, token, branch_sha)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="310">
          
          
          <code class="ruby">      break unless branch_tree.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="311">
          
          
          <code class="ruby">      log.error &quot;Going to read tree of branch `#{branch}` for #{repo_name} again after little pause.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="312">
          
          
          <code class="ruby">      sleep 1 # it&#39;s required to prevent bombing Github&#39;s api after our request got rejected</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="313">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="314">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="315">
          
          
          <code class="ruby">    if branch_tree.nil? or !branch_tree.has_key?(&#39;tree&#39;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="316">
          
          
          <code class="ruby">      msg = &quot;Can&#39;t read tree for repo `#{repo_name}` on branch `#{branch}`.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="317">
          
          
          <code class="ruby">      log.error msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="318">
          
          
          <code class="ruby">      return nil </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="319">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="320">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="321">
          
          
          <code class="ruby">    project_files = branch_tree[&#39;tree&#39;].keep_if {|file| ProjectService.type_by_filename(file[&#39;path&#39;].to_s) != nil}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="322">
          
          
          <code class="ruby">    project_files.each do |file|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="323">
          
          
          <code class="ruby">      file.deep_symbolize_keys!</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="324">
          
          
          <code class="ruby">      file[:uuid] = SecureRandom.hex</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="325">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="326">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="327">
          
          
          <code class="ruby">    project_files</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="328">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="329">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="330">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="331">
          
          
          <code class="ruby">  # Returns all project files in the given repos grouped by branches</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="332">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_project_files(repo_name, token, branch_docs = nil)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="333">
          
          
          <code class="ruby">    return nil if repo_name.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="334">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="335">
          
          
          <code class="ruby">    branches = branch_docs ? branch_docs : repo_branches(repo_name, token)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="336">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="337">
          
          
          <code class="ruby">    if branches.nil? or branches.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="338">
          
          
          <code class="ruby">      msg = &quot;Repo #{repo_name} doesnt have any branches.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="339">
          
          
          <code class="ruby">      log.error(msg) and return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="340">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="341">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="342">
          
          
          <code class="ruby">    project_files = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="343">
          
          
          <code class="ruby">    branches.each do |branch|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="344">
          
          
          <code class="ruby">      branch_name  = branch[:name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="345">
          
          
          <code class="ruby">      next if branch_name.to_s.eql?(&#39;gh-pages&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="346">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="347">
          
          
          <code class="ruby">      branch_key   = encode_db_key(branch_name)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="348">
          
          
          <code class="ruby">      branch_sha   = branch[:commit][:sha]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="349">
          
          
          <code class="ruby">      branch_files = project_files_from_branch(repo_name, token, branch_sha)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="350">
          
          
          <code class="ruby">      project_files[branch_key] = branch_files unless branch_files.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="351">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="352">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="353">
          
          
          <code class="ruby">    project_files</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="354">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="355">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="356">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="357">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="358">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="359">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_file( url, token )</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="360">
          <span class="hits">10</span>
          
          <code class="ruby">    return nil if url.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="361">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="362">
          <span class="hits">10</span>
          
          <code class="ruby">    uri = URI(url)</code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="363">
          <span class="hits">10</span>
          
          <code class="ruby">    get_json(uri.path, token)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="364">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="365">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="366">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="367">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="368">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="369">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="370">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.orga_names( github_token )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="371">
          <span class="hits">3</span>
          
          <code class="ruby">    url = &quot;#{Settings.instance.github_api_url}/user/orgs?access_token=#{github_token}&quot;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="372">
          <span class="hits">3</span>
          
          <code class="ruby">    response = get(url, :headers =&gt; A_DEFAULT_HEADERS )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="373">
          <span class="hits">3</span>
          
          <code class="ruby">    organisations = catch_github_exception JSON.parse(response.body, symbolize_names: true )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="374">
          <span class="hits">3</span>
          
          <code class="ruby">    names = Array.new</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="375">
          <span class="hits">3</span>
          
          <code class="ruby">    return names if organisations.nil? || organisations.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="376">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="377">
          <span class="hits">2</span>
          
          <code class="ruby">    names = organisations.map {|x| x[:login]}</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="378">
          <span class="hits">1</span>
          
          <code class="ruby">    names</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="379">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="380">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="381">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="382">
          
          
          <code class="ruby">    []</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="383">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="384">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="385">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.private_repo?( github_token, name )</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="386">
          <span class="hits">19</span>
          
          <code class="ruby">    url = &quot;#{Settings.instance.github_api_url}/repos/#{name}?access_token=#{github_token}&quot;</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="387">
          <span class="hits">19</span>
          
          <code class="ruby">    response = get(url, :headers =&gt; A_DEFAULT_HEADERS )</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="388">
          <span class="hits">19</span>
          
          <code class="ruby">    repo = catch_github_exception JSON.parse(response.body)</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="389">
          <span class="hits">19</span>
          
          <code class="ruby">    return repo[&#39;private&#39;] unless repo.nil? and !repo.is_a?(Hash)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="390">
          
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="391">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="392">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="393">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="394">
          
          
          <code class="ruby">    return false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="395">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="396">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="397">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.repo_sha(repository, token)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="398">
          
          
          <code class="ruby">    url = &quot;#{Settings.instance.github_api_url}/repos/#{repository}/git/refs/heads&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="399">
          
          
          <code class="ruby">    heads = get_json(url, token)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="400">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="401">
          
          
          <code class="ruby">    heads.to_a.each do |head|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="402">
          
          
          <code class="ruby">      return head[:object][:sha] if head[:url].match(/heads\/master\z/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="403">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="404">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="405">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="406">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="407">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_json(url, token = nil, raw = false, updated_at = nil)</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="408">
          <span class="hits">36</span>
          
          <code class="ruby">    request_headers = build_request_headers token, updated_at</code>
        </li>
      
        <li class="covered" data-hits="36" data-linenumber="409">
          <span class="hits">36</span>
          
          <code class="ruby">    response = get(url, headers: request_headers)</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="410">
          <span class="hits">35</span>
          
          <code class="ruby">    return response if raw</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="411">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="412">
          <span class="hits">35</span>
          
          <code class="ruby">    content = JSON.parse(response.body, symbolize_names: true)</code>
        </li>
      
        <li class="covered" data-hits="35" data-linenumber="413">
          <span class="hits">35</span>
          
          <code class="ruby">    catch_github_exception( content )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="414">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="415">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error &quot;ERROR in get_json( #{url} )&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="416">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="417">
          <span class="hits">1</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="418">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="419">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="420">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.build_request_headers token, updated_at = nil</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="421">
          <span class="hits">39</span>
          
          <code class="ruby">    request_headers = A_DEFAULT_HEADERS</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="422">
          <span class="hits">39</span>
          
          <code class="ruby">    if token</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="423">
          <span class="hits">9</span>
          
          <code class="ruby">      request_headers[&quot;Authorization&quot;] = &quot; token #{token}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="424">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="425">
          <span class="hits">39</span>
          
          <code class="ruby">    if updated_at.is_a?(Date) or updated_at.is_a?(DateTime)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="426">
          
          
          <code class="ruby">      request_headers[&quot;If-Modified-Since&quot;] = updated_at.to_datetime.rfc822</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="427">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="39" data-linenumber="428">
          <span class="hits">39</span>
          
          <code class="ruby">    request_headers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="429">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="430">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="431">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.encode_db_key(key_val)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="432">
          
          
          <code class="ruby">    URI.escape(key_val.to_s, /\.|\$/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="433">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="434">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="435">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.decode_db_key(key_val)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="436">
          
          
          <code class="ruby">    URI.unescape key_val.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="437">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="438">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="439">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="440">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="441">
          
          
          <code class="ruby">=begin</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="442">
          
          
          <code class="ruby">  Method that checks does Github sent error message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="443">
          
          
          <code class="ruby">  If yes, then it&#39;ll log it and return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="444">
          
          
          <code class="ruby">  Otherwise it sends object itself</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="445">
          
          
          <code class="ruby">  Github responses for client errors:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="446">
          
          
          <code class="ruby">  {&quot;message&quot;: &quot;Problems parsing JSON&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="447">
          
          
          <code class="ruby">=end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="448">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.catch_github_exception(data)</code>
        </li>
      
        <li class="covered" data-hits="62" data-linenumber="449">
          <span class="hits">62</span>
          
          <code class="ruby">      if data.is_a?(Hash) and data.has_key?(:message)</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="450">
          <span class="hits">9</span>
          
          <code class="ruby">        log.error &quot;Catched exception in response from Github API: #{data}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="451">
          
          
          <code class="ruby">        return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="452">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="53" data-linenumber="453">
          <span class="hits">53</span>
          
          <code class="ruby">        return data</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="454">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="455">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="456">
          
          
          <code class="ruby">      # by default here should be no message or nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="457">
          
          
          <code class="ruby">      # We expect that everything is ok and there is no error message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="458">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="459">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="460">
          
          
          <code class="ruby">      nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="461">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="462">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="463">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.parse_paging_links( headers )</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="464">
          <span class="hits">5</span>
          
          <code class="ruby">      return nil unless headers.has_key? &quot;link&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="465">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="466">
          <span class="hits">1</span>
          
          <code class="ruby">      links = []</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="467">
          <span class="hits">1</span>
          
          <code class="ruby">      headers[&quot;link&quot;].split(&quot;,&quot;).each do |link_token|</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="468">
          <span class="hits">2</span>
          
          <code class="ruby">        matches = link_token.strip.match /&lt;([\w|\/|\.|:|=|?|\&amp;]+)&gt;;\s+rel=\&quot;(\w+)\&quot;/m</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="469">
          <span class="hits">2</span>
          
          <code class="ruby">        links &lt;&lt; [matches[2], matches[1]]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="470">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="471">
          <span class="hits">1</span>
          
          <code class="ruby">      Hash[*links.flatten]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="472">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="473">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="474">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="95a22b81ce71dc61fa01280d469506bd530e595f">
  <div class="header">
    <h3>lib/versioneye/services_ext/mongo_product.rb</h3>
    <h4><span class="red">63.49 %</span> covered</h4>
    <div>
      <b>63</b> relevant lines. 
      <span class="green"><b>40</b> lines covered</span> and
      <span class="red"><b>23</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class MongoProduct &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  # This class handles the product search on MongoDB.</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">  # languages have to be an array of strings.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by(query, description = nil, group_id = nil, languages=nil, limit=300)</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="7">
          <span class="hits">13</span>
          
          <code class="ruby">    searched_name = nil</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="8">
          <span class="hits">13</span>
          
          <code class="ruby">    if query</code>
        </li>
      
        <li class="covered" data-hits="12" data-linenumber="9">
          <span class="hits">12</span>
          
          <code class="ruby">      searched_name = String.new( query.gsub(&#39; &#39;, &#39;-&#39;) )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="11">
          <span class="hits">13</span>
          
          <code class="ruby">    result1 = find_all(searched_name, description, group_id, languages, limit, nil)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="13" data-linenumber="13">
          <span class="hits">13</span>
          
          <code class="ruby">    if searched_name.nil? || searched_name.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">      return result1</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="17">
          <span class="hits">11</span>
          
          <code class="ruby">    prod_keys = Array.new</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="18">
          <span class="hits">11</span>
          
          <code class="ruby">    if result1 &amp;&amp; !result1.empty?</code>
        </li>
      
        <li class="covered" data-hits="17" data-linenumber="19">
          <span class="hits">17</span>
          
          <code class="ruby">      prod_keys = result1.map{|w| &quot;#{w.prod_key}&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="21">
          <span class="hits">11</span>
          
          <code class="ruby">    result2 = find_all(searched_name, description, group_id, languages, limit, prod_keys)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="22">
          <span class="hits">11</span>
          
          <code class="ruby">    result = result1 + result2</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="23">
          <span class="hits">11</span>
          
          <code class="ruby">    return result</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    return empty_criteria</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  # languages have to be an array of strings.</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_all(searched_name, description, group_id, languages=nil, limit=300, exclude_keys)</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="32">
          <span class="hits">24</span>
          
          <code class="ruby">    query = empty_criteria</code>
        </li>
      
        <li class="covered" data-hits="24" data-linenumber="33">
          <span class="hits">24</span>
          
          <code class="ruby">    if searched_name &amp;&amp; !searched_name.empty?</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="34">
          <span class="hits">22</span>
          
          <code class="ruby">      if exclude_keys</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="35">
          <span class="hits">11</span>
          
          <code class="ruby">        query = find_by_name_exclude(searched_name, exclude_keys)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">      else</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="37">
          <span class="hits">11</span>
          
          <code class="ruby">        query = find_by_name(searched_name)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    elsif group_id &amp;&amp; !group_id.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      return Product.where(group_id: /^#{group_id}/).desc(:followers).asc(:name).limit(limit)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="42">
          <span class="hits">2</span>
          
          <code class="ruby">      return empty_criteria</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="44">
          <span class="hits">22</span>
          
          <code class="ruby">    query = add_to_query(query, group_id, languages)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="45">
          <span class="hits">22</span>
          
          <code class="ruby">    query = query.desc(:followers).asc(:name).limit(limit)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="46">
          <span class="hits">22</span>
          
          <code class="ruby">    return query</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">    return empty_criteria</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_name(searched_name)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="54">
          <span class="hits">11</span>
          
          <code class="ruby">    if searched_name.nil? || searched_name.strip.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="57">
          <span class="hits">11</span>
          
          <code class="ruby">    Product.where(name_downcase: /^#{searched_name}/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">    return empty_criteria</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_name_exclude(searched_name, prod_keys)</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="65">
          <span class="hits">11</span>
          
          <code class="ruby">    if searched_name.nil? || searched_name.strip == &#39;&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="68">
          <span class="hits">11</span>
          
          <code class="ruby">    Product.where(name_downcase: /#{searched_name}/, :prod_key.nin =&gt; prod_keys)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.find_by_description(description)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">    if description.nil? || description.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">      return empty_criteria</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    query = Product.where(:description =&gt; /#{description}/i).or(:description_manual =&gt; /#{description}/i)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">    query</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">    return empty_criteria</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="85">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.add_to_query(query, group_id, languages)</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="86">
          <span class="hits">22</span>
          
          <code class="ruby">      if group_id &amp;&amp; !group_id.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="87">
          
          
          <code class="ruby">        query = query.where(group_id: /^#{group_id}/i)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="89">
          <span class="hits">22</span>
          
          <code class="ruby">      if languages &amp;&amp; !languages.empty?</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="90">
          <span class="hits">6</span>
          
          <code class="ruby">        query = query.in(language: languages)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="covered" data-hits="22" data-linenumber="92">
          <span class="hits">22</span>
          
          <code class="ruby">      query</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.add_description_to_query(query, description)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">      if description &amp;&amp; !description.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">        query = query.where(&quot;$or&quot; =&gt; [ {:description =&gt; /#{description}/i}, {:description_manual =&gt; /#{description}/i} ] )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">      query</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="102">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.empty_criteria()</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="103">
          <span class="hits">26</span>
          
          <code class="ruby">      Mongoid::Criteria.new(Product).where(:prod_key =&gt; &quot;-1-1&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="105">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="106">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="84eacefc3c9c04d5979cdbb2edb0a073ebd170b2">
  <div class="header">
    <h3>lib/versioneye/services_ext/octokit_api.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;octokit&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class OctokitApi</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.application_authentication</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">      :client_id     =&gt; Settings.instance.github_client_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">      :client_secret =&gt; Settings.instance.github_client_secret,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby">      :api_endpoint  =&gt; Settings.instance.github_api_url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="10">
          <span class="hits">3</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.token_authentication token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">      :access_token =&gt; token,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">      :api_endpoint =&gt; Settings.instance.github_api_url</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="17">
          <span class="hits">2</span>
          
          <code class="ruby">    }</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.client token = nil</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="21">
          <span class="hits">3</span>
          
          <code class="ruby">    auth = self.application_authentication</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="22">
          <span class="hits">3</span>
          
          <code class="ruby">    auth = self.token_authentication( token ) if token</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="23">
          <span class="hits">3</span>
          
          <code class="ruby">    Octokit::Client.new( auth )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="5319a17e185d25268b7d5a197c8b132104eb8c41">
  <div class="header">
    <h3>lib/versioneye/services_ext/s3.rb</h3>
    <h4><span class="yellow">82.26 %</span> covered</h4>
    <div>
      <b>62</b> relevant lines. 
      <span class="green"><b>51</b> lines covered</span> and
      <span class="red"><b>11</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;aws-sdk&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class S3 &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.set_aws_crendentials</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    Aws.config[:credentials] = Aws::Credentials.new(Settings.instance.aws_access_key_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">                                                    Settings.instance.aws_secret_access_key)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    Aws.config[:region] = &#39;eu-west-1&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    Aws.config</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.url_for object, region = &#39;eu-west-1&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if object.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">    encoded_name = &#39;&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    bucket_name  = &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    encoded_name = URI.encode( object.to_s )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    bucket_name  = Settings.instance.s3_projects_bucket</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    bucket_name  = Settings.instance.s3_receipt_bucke if object.is_a? Receipt</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">    s3 = Aws::S3::Resource.new(:region =&gt; region)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">    bucket = s3.bucket( bucket_name )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">    obj = bucket.object( encoded_name )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">    obj.public_url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="34">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.infographic_url_for filename, region = &#39;eu-west-1&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if filename.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">    encoded_name = URI.encode( filename )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">    s3 = Aws::S3::Resource.new(:region =&gt; region)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">    bucket = s3.bucket( Settings.instance.s3_infographics_bucket )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    obj = bucket.object( encoded_name )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">    obj.public_url</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.delete filename, bucket_name = Settings.instance.s3_projects_bucket, region = &#39;eu-west-1&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    return nil if filename.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="51">
          <span class="hits">1</span>
          
          <code class="ruby">    s3 = Aws::S3::Resource.new(:region =&gt; region)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="52">
          <span class="hits">1</span>
          
          <code class="ruby">    bucket = s3.bucket( bucket_name )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">    obj = bucket.object( filename )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">    obj.delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.upload_fileupload file_up, region = &#39;eu-west-1&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="62">
          <span class="hits">1</span>
          
          <code class="ruby">    orig_filename = file_up[&#39;datafile&#39;].original_filename</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">    fname         = self.sanitize_filename(orig_filename)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="64">
          <span class="hits">1</span>
          
          <code class="ruby">    random        = Project.create_random_value</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    filename      = &quot;#{random}_#{fname}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">    self.store_in_project_bucket filename, file_up[&#39;datafile&#39;].read, region</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="67">
          <span class="hits">1</span>
          
          <code class="ruby">    filename</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">    log.error &quot;Exception in S3.upload_fileupload(file_up) #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="70">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="75">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.store_in_project_bucket filename, bin, region = &#39;eu-west-1&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="76">
          <span class="hits">1</span>
          
          <code class="ruby">    self.store Settings.instance.s3_projects_bucket, filename, bin, region</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="79">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.store_in_receipt_bucket filename, bin, region = &#39;eu-west-1&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">    self.store Settings.instance.s3_receipt_bucket, filename, bin, region</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.store bucket_name, filename, bin, region = &#39;eu-west-1&#39;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="84">
          <span class="hits">2</span>
          
          <code class="ruby">    s3 = Aws::S3::Resource.new(:region =&gt; region)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="85">
          <span class="hits">2</span>
          
          <code class="ruby">    bucket = s3.bucket( bucket_name )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="86">
          <span class="hits">2</span>
          
          <code class="ruby">    obj = bucket.object( filename )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="87">
          <span class="hits">2</span>
          
          <code class="ruby">    obj.put(body: bin)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="88">
          <span class="hits">2</span>
          
          <code class="ruby">    obj.etag</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="89">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    log.error &quot;Error in store_in_project_bucket: #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">    log.error e.backtrace.join &quot;\n&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="95">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="98">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.sanitize_filename file_name</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="99">
          <span class="hits">1</span>
          
          <code class="ruby">      just_filename = File.basename(file_name)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">      just_filename.sub(/[^\w\.\-]/,&#39;_&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="101">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="9071d9e46ea6d607da5746683b9ac12aa04ea47b">
  <div class="header">
    <h3>lib/versioneye/services_ext/stash.rb</h3>
    <h4><span class="red">23.17 %</span> covered</h4>
    <div>
      <b>82</b> relevant lines. 
      <span class="green"><b>19</b> lines covered</span> and
      <span class="red"><b>63</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;oauth&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">class Stash &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  A_API_V1_PATH = &quot;/rest/api/1.0&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_DEFAULT_HEADERS = {&quot;User-Agent&quot; =&gt; &quot;Chrome28 (contact@versioneye.com)&quot;}</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.consumer_key</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">   Settings.instance.stash_consumer_key</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.init_oauth_client</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    private_rsa_key = Settings.instance.stash_private_rsa</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    OAuth::Consumer.new(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">      consumer_key,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">      OpenSSL::PKey::RSA.new( private_rsa_key ),</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">      {</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">      :site =&gt; Settings.instance.stash_base_url,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      :signature_method =&gt; &#39;RSA-SHA1&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      :scheme =&gt; :header,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      :http_method =&gt; :post,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">      :request_token_path=&gt; &#39;/plugins/servlet/oauth/request-token&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">      :access_token_path =&gt; &#39;/plugins/servlet/oauth/access-token&#39;,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">      :authorize_path =&gt; &#39;/plugins/servlet/oauth/authorize&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    })</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.request_token(callback_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    consumer = init_oauth_client()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    request_token = consumer.get_request_token(:oauth_callback =&gt; callback_url)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    request_token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  # Returns user information for authorized user</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="39">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.user(token, secret)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">    path = &quot;/plugins/servlet/applinks/whoami&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    username = get_json(path, token, secret, true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/users/#{username}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    response = get_json(path, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    response</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="50">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.projects_all( token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    projects = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">    start = 0</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    limit = 25</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    response = {}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">    response[:isLastPage] = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">    while response[:isLastPage] == false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">      response = self.projects(token, secret, start, limit)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="58">
          
          
          <code class="ruby">      projects &lt;&lt; response[:values]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">      start += limit</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">      limit += limit</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    projects.flatten</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.projects( token, secret, start = 0, limit = 1000 )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/projects?start=#{start}&amp;limit=#{limit}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">    get_json(path, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="72">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.all_repos( token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">    repos = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="74">
          
          
          <code class="ruby">    projects = self.projects_all( token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">    projects.each do |project|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      reps = project_repos( project[:key], token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="77">
          
          
          <code class="ruby">      repos &lt;&lt; reps[:values] if reps[:values] &amp;&amp; !reps[:values].empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">    repos.flatten</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="80">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="83">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.project_repos( projectKey, token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/projects/#{projectKey}/repos&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">    get_json(path, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="86">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="88">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="89">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.branches( projectKey, repo, token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/projects/#{projectKey}/repos/#{repo}/branches&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">    get_json(path, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="92">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="93">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="94">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.branch_names( projectKey, repo, token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">    names = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/projects/#{projectKey}/repos/#{repo}/branches?start=0&amp;limit=10000&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="97">
          
          
          <code class="ruby">    response = get_json(path, token, secret)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">    response[:values].each do |branch|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="99">
          
          
          <code class="ruby">       names &lt;&lt; branch[:displayId]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="100">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">    names</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="103">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="104">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="105">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.files( projectKey, repo, branch = &#39;master&#39;, token = &#39;&#39;, secret = &#39;&#39;, limit = &#39;100000&#39; )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/projects/#{projectKey}/repos/#{repo}/files?at=#{branch}&amp;start=0&amp;limit=#{limit}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">    get_json(path, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="109">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby">  # path = Path to file. For example &quot;Gemfile&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby">  # revision = &quot;refs/heads/&lt;BRANCH&gt;&quot; -&gt; &quot;refs/heads/feature/nine&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="113">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.content( projectKey, repo, path, revision, token, secret )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">    path = &quot;#{A_API_V1_PATH}/projects/#{projectKey}/repos/#{repo}/browse/#{path}?at=#{revision}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="115">
          
          
          <code class="ruby">    get_json(path, token, secret)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="116">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="117">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="119">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_json(path, token, secret, raw = false, params = {}, headers = {})</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="120">
          
          
          <code class="ruby">    url = &quot;#{Settings.instance.stash_base_url}#{path}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="121">
          
          
          <code class="ruby">    oauth = init_oauth_client</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="122">
          
          
          <code class="ruby">    token = OAuth::AccessToken.new(oauth, token, secret)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="123">
          
          
          <code class="ruby">    oauth_params = {consumer: oauth, token: token, request_uri: url}</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="124">
          
          
          <code class="ruby">    request_headers = A_DEFAULT_HEADERS</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="125">
          
          
          <code class="ruby">    request_headers.merge! headers</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="126">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="127">
          
          
          <code class="ruby">    response = token.get(path, request_headers)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="128">
          
          
          <code class="ruby">    if raw == true</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="129">
          
          
          <code class="ruby">      return response.body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="130">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="131">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="132">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="133">
          
          
          <code class="ruby">      JSON.parse(response.body, symbolize_names: true)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="134">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="135">
          
          
          <code class="ruby">      log.error &quot;Got status: #{response.code} #{response.message} body: #{response.body}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="136">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="137">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="138">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="139">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="140">
          
          
          <code class="ruby">    log.error &quot;Fuck up in get_json - #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="141">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="142">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="143">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="144">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="145">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.encode_db_key(key_val)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="146">
          
          
          <code class="ruby">    URI.escape(key_val.to_s, /\.|\$/)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="147">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="148">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="149">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.decode_db_key(key_val)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="150">
          
          
          <code class="ruby">    URI.unescape key_val.to_s</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="151">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="152">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="153">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="154">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ce504371b3f33f5e79e227462f22cd633e7bd3c6">
  <div class="header">
    <h3>lib/versioneye/services_ext/stripe_service.rb</h3>
    <h4><span class="green">100.0 %</span> covered</h4>
    <div>
      <b>39</b> relevant lines. 
      <span class="green"><b>39</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class StripeService &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;stripe&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.fetch_customer customer_id, api_key = nil</code>
        </li>
      
        <li class="covered" data-hits="11" data-linenumber="6">
          <span class="hits">11</span>
          
          <code class="ruby">    return Stripe::Customer.retrieve(customer_id, api_key) if !api_key.to_s.empty? </code>
        </li>
      
        <li class="covered" data-hits="10" data-linenumber="7">
          <span class="hits">10</span>
          
          <code class="ruby">    return Stripe::Customer.retrieve customer_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_customer stripe_token, plan_name_id, email</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="16">
          <span class="hits">9</span>
          
          <code class="ruby">    Stripe::Customer.create(</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">        :card =&gt; stripe_token,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby">        :plan =&gt; plan_name_id,</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">        :email =&gt; email)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="23">
          <span class="hits">1</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.update_customer user, stripe_token, plan_name_id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="28">
          <span class="hits">2</span>
          
          <code class="ruby">    customer = self.fetch_customer user.stripe_customer_id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="29">
          <span class="hits">2</span>
          
          <code class="ruby">    customer.card = stripe_token</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="30">
          <span class="hits">2</span>
          
          <code class="ruby">    customer.save</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="31">
          <span class="hits">2</span>
          
          <code class="ruby">    customer.update_subscription( :plan =&gt; plan_name_id )</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="32">
          <span class="hits">2</span>
          
          <code class="ruby">    customer</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.create_or_update_customer user, stripe_token, plan_name_id</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="37">
          <span class="hits">3</span>
          
          <code class="ruby">    if user.stripe_customer_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">      return self.update_customer user, stripe_token, plan_name_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    self.create_customer stripe_token, plan_name_id, user.email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="42">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.delete customer_id</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="49">
          <span class="hits">4</span>
          
          <code class="ruby">    return false if customer_id.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="51">
          <span class="hits">2</span>
          
          <code class="ruby">    customer = self.fetch_customer customer_id</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="52">
          <span class="hits">2</span>
          
          <code class="ruby">    customer.delete</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="54">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="55">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="56">
          <span class="hits">1</span>
          
          <code class="ruby">    false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="60">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.get_invoice invoice_id, api_key = nil</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="61">
          <span class="hits">3</span>
          
          <code class="ruby">    return Stripe::Invoice.retrieve(invoice_id, api_key) if !api_key.to_s.empty? </code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="62">
          <span class="hits">3</span>
          
          <code class="ruby">    return Stripe::Invoice.retrieve invoice_id </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="64">
          <span class="hits">2</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="65">
          <span class="hits">2</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="66">
          <span class="hits">2</span>
          
          <code class="ruby">    nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f4e9b8253a7894598caa862e8f1acb2b19bddc42">
  <div class="header">
    <h3>lib/versioneye/updaters/bitbucket_updater.rb</h3>
    <h4><span class="red">71.43 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>8</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class BitbucketUpdater &lt; CommonUpdater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def update project, send_email = false</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="5">
          <span class="hits">2</span>
          
          <code class="ruby">    project.parsing_errors = []</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="6">
          <span class="hits">2</span>
          
          <code class="ruby">    project_file = fetch_project_file project</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="7">
          <span class="hits">2</span>
          
          <code class="ruby">    if project_file.to_s.empty? || project_file.match(&quot;you&#39;ve found a dead link&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      message = &quot;Project could not be parsed from the Bitbucket API. Please make sure that the credentials are still valid and the repository still exists.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">      log.error message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">      store_parsing_errors project, message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    new_project = parse project_file, project.filename</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">    update_old_with_new project, new_project, send_email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    log.error &quot;ERROR occured by parsing project from Bitbucket API - #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    message = &quot;Project could not be parsed from the Bitbucket API. Please make sure that the credentials are still valid and the repository still exists. - #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    store_parsing_errors project, message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_project_file project</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="25">
          <span class="hits">3</span>
          
          <code class="ruby">    user = project.user</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="26">
          <span class="hits">3</span>
          
          <code class="ruby">    filename = project.filename</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="27">
          <span class="hits">3</span>
          
          <code class="ruby">    filename = &#39;pom.xml&#39; if filename.eql? &#39;pom.json&#39;</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="28">
          <span class="hits">3</span>
          
          <code class="ruby">    repo_name = project.scm_fullname</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="29">
          <span class="hits">3</span>
          
          <code class="ruby">    branch = project.scm_branch</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="30">
          <span class="hits">3</span>
          
          <code class="ruby">    token = user.bitbucket_token</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="31">
          <span class="hits">3</span>
          
          <code class="ruby">    secret = user.bitbucket_secret</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="32">
          <span class="hits">3</span>
          
          <code class="ruby">    Bitbucket.fetch_project_file_from_branch( repo_name, branch, filename, token, secret )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="36">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse project_file, fullname</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="37">
          <span class="hits">2</span>
          
          <code class="ruby">    file_name = fullname.split(&quot;/&quot;).last</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="38">
          <span class="hits">2</span>
          
          <code class="ruby">    parser = parser_for file_name</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="39">
          <span class="hits">2</span>
          
          <code class="ruby">    parse_content parser, project_file, file_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="4ccb88010326baf53e23cd207dc2c37ca4f88c6c">
  <div class="header">
    <h3>lib/versioneye/updaters/common_updater.rb</h3>
    <h4><span class="green">92.11 %</span> covered</h4>
    <div>
      <b>38</b> relevant lines. 
      <span class="green"><b>35</b> lines covered</span> and
      <span class="red"><b>3</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class CommonUpdater &lt; Versioneye::Service</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_old_with_new old_project, new_project, send_email = false</code>
        </li>
      
        <li class="covered" data-hits="9" data-linenumber="5">
          <span class="hits">9</span>
          
          <code class="ruby">    return nil if old_project.nil? || new_project.nil? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="6">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="7">
          <span class="hits">8</span>
          
          <code class="ruby">    old_project.update_from new_project</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="8">
          <span class="hits">8</span>
          
          <code class="ruby">    ProjectService.reset_badge old_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="10">
          <span class="hits">8</span>
          
          <code class="ruby">    SyncService.sync_project_async old_project # For Enterprise environment</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="12">
          <span class="hits">8</span>
          
          <code class="ruby">    ProjectdependencyService.update_licenses_security old_project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="14">
          <span class="hits">8</span>
          
          <code class="ruby">    unknown_licenses = ProjectService.unknown_licenses( old_project )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="15">
          <span class="hits">8</span>
          
          <code class="ruby">    red_licenses     = ProjectService.red_licenses( old_project )</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="16">
          <span class="hits">8</span>
          
          <code class="ruby">    old_project.licenses_red = red_licenses.count</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="17">
          <span class="hits">8</span>
          
          <code class="ruby">    old_project.licenses_unknown = unknown_licenses.count</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="18">
          <span class="hits">8</span>
          
          <code class="ruby">    old_project.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="20">
          <span class="hits">8</span>
          
          <code class="ruby">    active_email   = send_email &amp;&amp; old_project.user.email_inactive == false</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="21">
          <span class="hits">8</span>
          
          <code class="ruby">    outdated_deps  = old_project.out_number &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">    # The next line is commented out because right now the user can not edit licenses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    # license_alerts = !unknown_licenses.empty? || !red_licenses.empty?</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="24">
          <span class="hits">8</span>
          
          <code class="ruby">    license_alerts = old_project.licenses_red.to_i &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="26">
          <span class="hits">8</span>
          
          <code class="ruby">    if active_email &amp;&amp; ( outdated_deps || license_alerts )</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">      log.info &quot;Send out email notification for project #{old_project.name} to user #{old_project.user.fullname}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">      ProjectMailer.projectnotification_email( old_project, nil, unknown_licenses, red_licenses ).deliver_now</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="33">
          <span class="hits">1</span>
          
          <code class="ruby">  def store_parsing_errors project, error_message</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if project.nil? || error_message.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="36">
          <span class="hits">3</span>
          
          <code class="ruby">    project.parsing_errors = []</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="37">
          <span class="hits">3</span>
          
          <code class="ruby">    project.parsing_errors &lt;&lt; error_message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="39">
          <span class="hits">3</span>
          
          <code class="ruby">    project.save </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  rescue =&gt; e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">    log.error &quot;ERROR occured store_parsing_errors - #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="46">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="49">
          <span class="hits">1</span>
          
          <code class="ruby">    def log</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="50">
          <span class="hits">5</span>
          
          <code class="ruby">      Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="53">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.log</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">      Versioneye::Log.instance.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="57">
          <span class="hits">1</span>
          
          <code class="ruby">    def cache</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="58">
          <span class="hits">19</span>
          
          <code class="ruby">      Versioneye::Cache.instance.mc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    def self.cache</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="62">
          <span class="hits">3</span>
          
          <code class="ruby">      Versioneye::Cache.instance.mc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="63">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">    def parser_for file_name</code>
        </li>
      
        <li class="covered" data-hits="8" data-linenumber="66">
          <span class="hits">8</span>
          
          <code class="ruby">      ProjectParseService.parser_for file_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="69">
          <span class="hits">1</span>
          
          <code class="ruby">    def parse_content parser, content, file_name</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="70">
          <span class="hits">5</span>
          
          <code class="ruby">      ProjectParseService.parse_content parser, content, file_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="71">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d60bf1bb5704de017291a55648cc9b562b1eb4c0">
  <div class="header">
    <h3>lib/versioneye/updaters/github_updater.rb</h3>
    <h4><span class="yellow">83.33 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>20</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class GithubUpdater &lt; CommonUpdater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def update project, send_email = false</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="5">
          <span class="hits">5</span>
          
          <code class="ruby">    project.parsing_errors = []</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="6">
          <span class="hits">5</span>
          
          <code class="ruby">    project_file = fetch_project_file project</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="7">
          <span class="hits">5</span>
          
          <code class="ruby">    if project_file.to_s.strip.empty?</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="8">
          <span class="hits">2</span>
          
          <code class="ruby">      message = &quot;Project could not be parsed from the GitHub API. Please make sure that the credentials are still valid and the repository still exists.&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">      log.error message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">      store_parsing_errors project, message</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="14">
          <span class="hits">3</span>
          
          <code class="ruby">    new_project = parse project_file</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>
          
          <code class="ruby">    update_old_with_new project, new_project, send_email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">    log.error &quot;ERROR occured by parsing project from GitHub API - #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    message = &quot;Project could not be parsed from the GitHub API. Please make sure that the credentials are still valid and the repository still exists. - #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    store_parsing_errors project, message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_project_file project</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="25">
          <span class="hits">6</span>
          
          <code class="ruby">    filename = project.filename</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="26">
          <span class="hits">6</span>
          
          <code class="ruby">    filename = &#39;pom.xml&#39; if filename.eql? &#39;pom.json&#39;</code>
        </li>
      
        <li class="covered" data-hits="6" data-linenumber="27">
          <span class="hits">6</span>
          
          <code class="ruby">    Github.fetch_project_file_from_branch project.scm_fullname, filename, project.scm_branch, project.user.github_token</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def parse project_file</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="32">
          <span class="hits">3</span>
          
          <code class="ruby">    content   = GitHubService.pure_text_from project_file</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="33">
          <span class="hits">3</span>
          
          <code class="ruby">    file_name = GitHubService.filename_from project_file</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="34">
          <span class="hits">3</span>
          
          <code class="ruby">    parser    = parser_for file_name</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="35">
          <span class="hits">3</span>
          
          <code class="ruby">    parse_content parser, content, file_name</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="af31d53c21c3b6c27aa1af5cedfa182e8b35a215">
  <div class="header">
    <h3>lib/versioneye/updaters/stash_updater.rb</h3>
    <h4><span class="red">14.29 %</span> covered</h4>
    <div>
      <b>35</b> relevant lines. 
      <span class="green"><b>5</b> lines covered</span> and
      <span class="red"><b>30</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class StashUpdater &lt; CommonUpdater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def update project, send_email = false</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    project.parsing_errors = []</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    project_file = fetch_project_file project</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    if project_file.to_s.strip.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">      message = &quot;Project could not be parsed from the Stash API. Please make sure that the credentials are still valid and the repository still exists.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">      log.error message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">      store_parsing_errors project, message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">      return nil</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    filename    = fetch_filename project</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    new_project = StashService.parse_content project_file, filename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    update_old_with_new project, new_project, send_email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    log.error &quot;ERROR occured by parsing project from Stash API - #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">    message = &quot;Project could not be parsed from the Stash API. Please make sure that the credentials are still valid and the repository still exists. - #{e.message}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">    store_parsing_errors project, message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_project_file project</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">    user         = project.user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">    repo_name    = project.scm_fullname</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="28">
          
          
          <code class="ruby">    repo         = StashRepo.by_user( user ).by_fullname( repo_name ).shift</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    filename     = fetch_filename project</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    branch       = project.scm_branch</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    project_file = StashService.fetch_file_from_stash(user, repo, filename, branch)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    err_message  = error_message(project_file)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    if !err_message.to_s.empty? </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      log.error err_message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      return nil </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    StashService.pure_text_from project_file</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="41">
          <span class="hits">1</span>
          
          <code class="ruby">  def fetch_filename project</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    filename = project.filename</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">    filename = &#39;pom.xml&#39; if filename.eql? &#39;pom.json&#39;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">    filename</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="48">
          <span class="hits">1</span>
          
          <code class="ruby">  def error_message project_file</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    project_file[:errors].first[:message]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  rescue =&gt; e </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    &#39;&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="ded313462d7a762a982ceb5353b66ae2450e438c">
  <div class="header">
    <h3>lib/versioneye/updaters/update_strategy.rb</h3>
    <h4><span class="yellow">90.0 %</span> covered</h4>
    <div>
      <b>10</b> relevant lines. 
      <span class="green"><b>9</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UpdateStrategy</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.updater_for( project_source )</code>
        </li>
      
        <li class="covered" data-hits="26" data-linenumber="4">
          <span class="hits">26</span>
          
          <code class="ruby">    case project_source</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    when Project::A_SOURCE_UPLOAD</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="6">
          <span class="hits">19</span>
          
          <code class="ruby">      return UploadUpdater.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby">    when Project::A_SOURCE_URL</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">      return UrlUpdater.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="10">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">    when Project::A_SOURCE_GITHUB</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">      return GithubUpdater.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby">    when Project::A_SOURCE_BITBUCKET</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="15">
          <span class="hits">1</span>
          
          <code class="ruby">      return BitbucketUpdater.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">    when Project::A_SOURCE_STASH</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">      return StashUpdater.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    when Project::A_SOURCE_API</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">      return UploadUpdater.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">    else</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">      return UploadUpdater.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="cb192a7d1f14d0188ef535b1e420834247f0d1a3">
  <div class="header">
    <h3>lib/versioneye/updaters/upload_updater.rb</h3>
    <h4><span class="red">75.0 %</span> covered</h4>
    <div>
      <b>28</b> relevant lines. 
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UploadUpdater &lt; CommonUpdater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def update( project, send_email = false )</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="4">
          <span class="hits">19</span>
          
          <code class="ruby">    return nil if project.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="6">
          <span class="hits">19</span>
          
          <code class="ruby">    out_number = 0 </code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="7">
          <span class="hits">19</span>
          
          <code class="ruby">    dep_number = 0 </code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="8">
          <span class="hits">19</span>
          
          <code class="ruby">    project.dependencies.each do |dep|</code>
        </li>
      
        <li class="covered" data-hits="107" data-linenumber="9">
          <span class="hits">107</span>
          
          <code class="ruby">      outdated = ProjectdependencyService.outdated?( dep )</code>
        </li>
      
        <li class="covered" data-hits="107" data-linenumber="10">
          <span class="hits">107</span>
          
          <code class="ruby">      out_number += 1 if outdated</code>
        </li>
      
        <li class="covered" data-hits="107" data-linenumber="11">
          <span class="hits">107</span>
          
          <code class="ruby">      dep_number += 1 </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="13">
          <span class="hits">19</span>
          
          <code class="ruby">    project.reload</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="14">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="15">
          <span class="hits">19</span>
          
          <code class="ruby">    cache.delete( project.id.to_s ) # Delete badge status for project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="17">
          <span class="hits">19</span>
          
          <code class="ruby">    SyncService.sync_project_async project # For Enterprise environment</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="19">
          <span class="hits">19</span>
          
          <code class="ruby">    ProjectdependencyService.update_licenses_security project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby">    </code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="21">
          <span class="hits">19</span>
          
          <code class="ruby">    unknown_licenses = ProjectService.unknown_licenses( project )</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="22">
          <span class="hits">19</span>
          
          <code class="ruby">    red_licenses     = ProjectService.red_licenses( project )</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="23">
          <span class="hits">19</span>
          
          <code class="ruby">    project.licenses_red = red_licenses.count</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="24">
          <span class="hits">19</span>
          
          <code class="ruby">    project.licenses_unknown = unknown_licenses.count</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="25">
          <span class="hits">19</span>
          
          <code class="ruby">    project.dep_number = dep_number</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="26">
          <span class="hits">19</span>
          
          <code class="ruby">    project.out_number = out_number</code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="27">
          <span class="hits">19</span>
          
          <code class="ruby">    project.sum_own! </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="19" data-linenumber="29">
          <span class="hits">19</span>
          
          <code class="ruby">    return project if send_email == false </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    return project if project.user.email_inactive == false</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    outdated_deps  = project.out_number &gt; 0</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    # The next line is commented out because right now the user can not edit licenses</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    # license_alerts = !unknown_licenses.empty? || !red_licenses.empty?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    license_alerts = !red_licenses.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    if ( outdated_deps || license_alerts )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">      log.info &quot;Send out email notification for project #{project.name} to user #{project.user.fullname}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">      ProjectMailer.projectnotification_email( project, nil, unknown_licenses, red_licenses ).deliver</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">    project</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="aa230b85a53b5802b291126c0268c067ec22f73a">
  <div class="header">
    <h3>lib/versioneye/updaters/url_updater.rb</h3>
    <h4><span class="yellow">86.67 %</span> covered</h4>
    <div>
      <b>15</b> relevant lines. 
      <span class="green"><b>13</b> lines covered</span> and
      <span class="red"><b>2</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UrlUpdater &lt; CommonUpdater</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby">  </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def update( project, send_email = false )</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="5">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if project.nil?</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="6">
          <span class="hits">3</span>
          
          <code class="ruby">    return nil if project.url.to_s.empty? </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="8">
          <span class="hits">3</span>
          
          <code class="ruby">    parser = parser_for project.url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="9">
          <span class="hits">3</span>
          
          <code class="ruby">    if parser.nil?</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">      log.error &quot;No parser found for project (#{project.id}) url: #{project.url}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="14">
          <span class="hits">3</span>
          
          <code class="ruby">    new_project = parser.parse project.url</code>
        </li>
      
        <li class="covered" data-hits="3" data-linenumber="15">
          <span class="hits">3</span>
          
          <code class="ruby">    new_project.url = project.url</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    update_old_with_new project, new_project, send_email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="18">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error &quot;ERROR occured by parsing #{project.url} - #{e.message}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="19">
          <span class="hits">1</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">    message = &quot;Project could not be parsed from URL: #{project.url}. Please make sure that the URL exists.&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">    store_parsing_errors project, message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="edb18a518ac09bc5e2941db4708458d81a16881e">
  <div class="header">
    <h3>lib/versioneye/workers/common_worker.rb</h3>
    <h4><span class="red">9.38 %</span> covered</h4>
    <div>
      <b>32</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>29</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class CommonWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;common_purpose&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, message|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">        puts &quot; [x] Received #{message}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">        process_work message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def process_work message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    return nil if message.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    if message.eql?(&quot;create_indexes&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      Indexer.create_indexes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">    elsif message.eql?(&quot;update_integration_statuses&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      SubmittedUrlService.update_integration_statuses()</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">    elsif message.eql?(&quot;update_user_languages&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">      UserService.update_languages</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    elsif message.eql?(&quot;update_statistic_data&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      StatisticService.update_all</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">    elsif message.eql?(&quot;send_verification_reminders&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">      User.send_verification_reminders</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="43">
          
          
          <code class="ruby">    elsif message.eql?(&quot;process_receipts&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">      ReceiptService.process_receipts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    elsif message.eql?(&quot;update_smc_meta_data_all&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">      ScmMetaDataService.update_all_users</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">    elsif message.eql?(&quot;update_distinct_languages&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">      LanguageService.update_distinct_languages</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">    log.info &quot;Job done for #{message}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="f2f3e23ec617d2efb964da47cf3d372f23ed3e47">
  <div class="header">
    <h3>lib/versioneye/workers/dependency_badge_worker.rb</h3>
    <h4><span class="red">78.79 %</span> covered</h4>
    <div>
      <b>33</b> relevant lines. 
      <span class="green"><b>26</b> lines covered</span> and
      <span class="red"><b>7</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;benchmark&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;dalli&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class DependencyBadgeWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TTL = 86400 # 24 hours </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="9">
          <span class="hits">2</span>
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="10">
          <span class="hits">2</span>
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="11">
          <span class="hits">2</span>
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="12">
          <span class="hits">2</span>
          
          <code class="ruby">    queue   = channel.queue(&quot;dependency_badge&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="14">
          <span class="hits">2</span>
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="15">
          <span class="hits">2</span>
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="16">
          <span class="hits">2</span>
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="18">
          <span class="hits">2</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="2" data-linenumber="19">
          <span class="hits">2</span>
          
          <code class="ruby">      queue.subscribe(:manual_ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="20">
          <span class="hits">1</span>
          
          <code class="ruby">        msg = &quot; [x] Received #{body}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="22">
          <span class="hits">1</span>
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="24">
          <span class="hits">1</span>
          
          <code class="ruby">        calculate_badge body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="26">
          <span class="hits">1</span>
          
          <code class="ruby">        msg = &quot; - job done for #{body}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="27">
          <span class="hits">1</span>
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="28">
          <span class="hits">1</span>
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    def calculate_badge message</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="44">
          <span class="hits">1</span>
          
          <code class="ruby">      if message.to_s.match(/ref\z/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">        BadgeRefService.update message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="46">
          
          
          <code class="ruby">      else </code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="47">
          <span class="hits">1</span>
          
          <code class="ruby">        BadgeService.update message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="48">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="49">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="fbff4af57429cbcaada43a4e0d578ebb8db51112">
  <div class="header">
    <h3>lib/versioneye/workers/git_repo_file_import_worker.rb</h3>
    <h4><span class="yellow">81.48 %</span> covered</h4>
    <div>
      <b>54</b> relevant lines. 
      <span class="green"><b>44</b> lines covered</span> and
      <span class="red"><b>10</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;benchmark&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;dalli&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class GitRepoFileImportWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_TTL = 60 # 60 seconds = 1 minutes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="9">
          <span class="hits">4</span>
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="10">
          <span class="hits">4</span>
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="11">
          <span class="hits">4</span>
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="12">
          <span class="hits">4</span>
          
          <code class="ruby">    queue   = channel.queue(&quot;git_repo_file_import&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="14">
          <span class="hits">4</span>
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="15">
          <span class="hits">4</span>
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="16">
          <span class="hits">4</span>
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="18">
          <span class="hits">4</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="19">
          <span class="hits">4</span>
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="20">
          <span class="hits">4</span>
          
          <code class="ruby">        msg = &quot; [x] Received #{body}&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="21">
          <span class="hits">4</span>
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="22">
          <span class="hits">4</span>
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="24">
          <span class="hits">4</span>
          
          <code class="ruby">        import body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="25">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="26">
          <span class="hits">4</span>
          
          <code class="ruby">        msg = &quot; - job done for #{body}&quot;</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="27">
          <span class="hits">4</span>
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="28">
          <span class="hits">4</span>
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="30">
          <span class="hits">4</span>
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="43">
          <span class="hits">1</span>
          
          <code class="ruby">    def import message</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="44">
          <span class="hits">4</span>
          
          <code class="ruby">      reload_settings()</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="45">
          <span class="hits">4</span>
          
          <code class="ruby">      sps = message.split(&quot;:::&quot;)</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="46">
          <span class="hits">4</span>
          
          <code class="ruby">      provider  = sps[0]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="47">
          <span class="hits">4</span>
          
          <code class="ruby">      username  = sps[1]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="48">
          <span class="hits">4</span>
          
          <code class="ruby">      repo_name = sps[2]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="49">
          <span class="hits">4</span>
          
          <code class="ruby">      filename  = sps[3]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="50">
          <span class="hits">4</span>
          
          <code class="ruby">      branch    = sps[4]</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="51">
          <span class="hits">4</span>
          
          <code class="ruby">      parent_id = sps[5]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="53">
          <span class="hits">4</span>
          
          <code class="ruby">      user = User.find_by_username username</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="54">
          <span class="hits">4</span>
          
          <code class="ruby">      if user.nil? </code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="55">
          
          
          <code class="ruby">        cache.set( message, &quot;error_User `#{username}` not found!&quot;, A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">        return </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="59">
          <span class="hits">4</span>
          
          <code class="ruby">      project = nil </code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="60">
          <span class="hits">4</span>
          
          <code class="ruby">      if provider.eql?(&quot;stash&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">        project = ProjectImportService.import_from_stash_multi user, repo_name, filename, branch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby">      elsif provider.eql?(&quot;github&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="63">
          <span class="hits">1</span>
          
          <code class="ruby">        project = ProjectImportService.import_from_github_multi user, repo_name, filename, branch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">      elsif provider.eql?(&quot;github_child&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="65">
          <span class="hits">1</span>
          
          <code class="ruby">        parent = Project.find parent_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">        project = ProjectImportService.import_child_from_github user, repo_name, filename, branch, parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="67">
          
          
          <code class="ruby">      elsif provider.eql?(&quot;bitbucket&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="68">
          <span class="hits">1</span>
          
          <code class="ruby">        project = ProjectImportService.import_from_bitbucket_multi user, repo_name, filename, branch</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="69">
          
          
          <code class="ruby">      elsif provider.eql?(&quot;bitbucket_child&quot;)</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="70">
          <span class="hits">1</span>
          
          <code class="ruby">        parent = Project.find parent_id</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="71">
          <span class="hits">1</span>
          
          <code class="ruby">        project = ProjectImportService.import_child_from_bitbucket user, repo_name, filename, branch, parent</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="72">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="73">
          
          
          <code class="ruby">      </code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="74">
          <span class="hits">4</span>
          
          <code class="ruby">      if project </code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="75">
          <span class="hits">4</span>
          
          <code class="ruby">        cache.set( message, &quot;done_#{project.id.to_s}&quot;, A_TASK_TTL )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="76">
          
          
          <code class="ruby">      end </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="78">
          
          
          <code class="ruby">      cache.set( message, &quot;error_#{e.message}&quot;, A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="79">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="80">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="d61515fc8d27fa0b47e273c22241d58fdf914936">
  <div class="header">
    <h3>lib/versioneye/workers/git_repo_import_worker.rb</h3>
    <h4><span class="red">12.2 %</span> covered</h4>
    <div>
      <b>82</b> relevant lines. 
      <span class="green"><b>10</b> lines covered</span> and
      <span class="red"><b>72</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;benchmark&#39;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="2">
          <span class="hits">1</span>
          
          <code class="ruby">require &#39;dalli&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">class GitRepoImportWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  A_TASK_TTL = 180 # 180 seconds = 3 minutes</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;git_repo_import&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">        msg = &quot; [x] Received #{body}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">        handle body</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">        cache.set( body, GitHubService::A_TASK_DONE, A_TASK_TTL )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="29">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="37">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="40">
          <span class="hits">1</span>
          
          <code class="ruby">    def handle message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">      reload_settings()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">      sps = message.split(&quot;:::&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      provider = sps[0]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="44">
          
          
          <code class="ruby">      user_id = sps[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">      repo_id = sps[2]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">      user = User.find user_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">      if provider.eql?(&quot;stash&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">        update_stash_repo( user, repo_id )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">      elsif provider.eql?(&quot;github&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="51">
          
          
          <code class="ruby">        update_github_repo( user, repo_id )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="52">
          
          
          <code class="ruby">      elsif provider.eql?(&quot;bitbucket&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">        update_bitbucket_repo( user, repo_id )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="56">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="57">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="58">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="59">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="61">
          <span class="hits">1</span>
          
          <code class="ruby">    def update_stash_repo user, repo_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">      repo = StashRepo.find repo_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">      time = Benchmark.measure do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">        StashService.update_branches(user, repo)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">        StashService.update_project_files(user, repo)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="66">
          
          
          <code class="ruby">        repo.user_id = user.id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">        repo.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="68">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">      name = repo[:fullname]</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">      log_msg = &quot;Reading Stash / `#{name}` took: #{time}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">      puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">      log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">    def update_bitbucket_repo user, repo_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">      repo = BitbucketRepo.find repo_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="82">
          
          
          <code class="ruby">      time = Benchmark.measure do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">        repo = Bitbucket.update_branches      repo, user.bitbucket_token, user.bitbucket_secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">        repo = Bitbucket.update_project_files repo, user.bitbucket_token, user.bitbucket_secret</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="85">
          
          
          <code class="ruby">        repo.user_id = user.id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">        repo.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">      name = repo[:full_name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">      name = repo[:fullname] if name.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="90">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="91">
          
          
          <code class="ruby">      log_msg = &quot;Reading `#{name}` took: #{time}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">      puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">      log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="95">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="96">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="97">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="98">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="100">
          <span class="hits">1</span>
          
          <code class="ruby">    def update_github_repo user, repo_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      repo = GithubRepo.find repo_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="102">
          
          
          <code class="ruby">      time = Benchmark.measure do</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">        repo = Github.update_branches      repo, user.github_token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">        repo = Github.update_project_files repo, user.github_token</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">        repo.user_id = user.id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">        repo.user_login = user.github_login</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="107">
          
          
          <code class="ruby">        repo.save</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="108">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">      name = repo[:full_name]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="110">
          
          
          <code class="ruby">      name = repo[:fullname] if name.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="112">
          
          
          <code class="ruby">      log_msg = &quot;Reading GitHub / `#{name}` took: #{time}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="113">
          
          
          <code class="ruby">      puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="114">
          
          
          <code class="ruby">      log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="115">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="116">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="117">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="118">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="119">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="120">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="121">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="2c80b50083cde15ce30d6e2432a5e3d5aba65632">
  <div class="header">
    <h3>lib/versioneye/workers/git_repos_import_worker.rb</h3>
    <h4><span class="red">9.86 %</span> covered</h4>
    <div>
      <b>71</b> relevant lines. 
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>64</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class GitReposImportWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;git_repos_import&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    log_msg = &quot; [*] GitReposImportWorker Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      queue.subscribe(:manual_ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">        msg = &quot; [x] GitReposImportWorker Received #{body}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">        import_all_repos body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="35">
          <span class="hits">1</span>
          
          <code class="ruby">    def import_all_repos msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      reload_settings()</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">      provider = msg.split(&quot;:::&quot;).first</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">      user_id = msg.split(&quot;:::&quot;).last</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="39">
          
          
          <code class="ruby">      user = User.find user_id</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">      log_msg = &quot;going to import repos for #{user.username} from provider #{provider}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="42">
          
          
          <code class="ruby">      log.info log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="43">
          
          
          <code class="ruby">      p log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="44">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="45">
          
          
          <code class="ruby">      if provider.eql?(&quot;stash&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">        import_stash_repos( user )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="47">
          
          
          <code class="ruby">      elsif provider.eql?(&quot;github&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">        import_github_repos( user )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">      elsif provider.eql?(&quot;bitbucket&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="50">
          
          
          <code class="ruby">        import_bitbucket_repos( user )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="53">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="54">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">    def import_stash_repos user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">      return nil if user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="60">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="61">
          
          
          <code class="ruby">      user_task_key = &quot;#{user[:username]}-stash&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="62">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">      log_msg = &quot;Fetch Repositories for #{user_task_key} from Stash and cache them in DB.&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="64">
          
          
          <code class="ruby">      log.info log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="65">
          
          
          <code class="ruby">      p log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="66">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="67">
          
          
          <code class="ruby">      cache.set( user_task_key, StashService::A_TASK_RUNNING, StashService::A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="68">
          
          
          <code class="ruby">      StashService.cache_user_all_repos( user )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="69">
          
          
          <code class="ruby">      cache.set( user_task_key, StashService::A_TASK_DONE, StashService::A_TASK_TTL )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="70">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="71">
          
          
          <code class="ruby">      log_msg = &quot;Job done for #{user_task_key}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="72">
          
          
          <code class="ruby">      log.info log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="73">
          
          
          <code class="ruby">      p log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="74">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="75">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="76">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="77">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="79">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="80">
          <span class="hits">1</span>
          
          <code class="ruby">    def import_github_repos user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="81">
          
          
          <code class="ruby">      return nil if user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="83">
          
          
          <code class="ruby">      user_task_key = &quot;#{user[:username]}-#{user[:github_id]}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="84">
          
          
          <code class="ruby">      log.info &quot;Fetch Repositories for #{user_task_key} from GitHub and cache them in DB.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="85">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="86">
          
          
          <code class="ruby">      orga_names = Github.orga_names( user.github_token )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="87">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="88">
          
          
          <code class="ruby">      cache.set( user_task_key, GitHubService::A_TASK_RUNNING, GitHubService::A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="89">
          
          
          <code class="ruby">      GitHubService.cache_user_all_repos(user, orga_names)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="90">
          
          
          <code class="ruby">      cache.set( user_task_key, GitHubService::A_TASK_DONE, GitHubService::A_TASK_TTL )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="91">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="92">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="93">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="94">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="95">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="96">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="97">
          <span class="hits">1</span>
          
          <code class="ruby">    def import_bitbucket_repos user</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="98">
          
          
          <code class="ruby">      return nil if user.nil?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="99">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="100">
          
          
          <code class="ruby">      user_task_key = &quot;#{user[:username]}-bitbucket&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="101">
          
          
          <code class="ruby">      log.info &quot;Fetch Repositories for #{user_task_key} from Bitbucket and cache them in DB.&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="102">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="103">
          
          
          <code class="ruby">      cache.set( user_task_key, BitbucketService::A_TASK_RUNNING, BitbucketService::A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="104">
          
          
          <code class="ruby">      BitbucketService.cache_user_all_repos( user )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="105">
          
          
          <code class="ruby">      cache.set( user_task_key, BitbucketService::A_TASK_DONE, BitbucketService::A_TASK_TTL )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="106">
          
          
          <code class="ruby">      log.info &quot;Job done for #{user_task_key}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="107">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="108">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="109">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="110">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="111">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="112">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="113">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="166f3a1a2a4c9ea61510660887848699cef30a3c">
  <div class="header">
    <h3>lib/versioneye/workers/language_daily_stats_worker.rb</h3>
    <h4><span class="red">12.5 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>21</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class LanguageDailyStatsWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;language_daily_stats&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">        msg = &quot; [x] Received #{body}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">        update_counts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_counts</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    LanguageDailyStats.update_counts(3, 1)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="14925a3bbf6acfd91e9b3ff2063265e9554da150">
  <div class="header">
    <h3>lib/versioneye/workers/process_receipts_worker.rb</h3>
    <h4><span class="red">12.5 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>21</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProcessReceiptsWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;process_receipts&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">        msg = &quot; [x] Received #{body}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">        process_receipts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def process_receipts</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    ReceiptService.process_receipts</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="92dbed1925791e53ac20c9208a00a7b86b8eceb7">
  <div class="header">
    <h3>lib/versioneye/workers/project_update_worker.rb</h3>
    <h4><span class="red">74.0 %</span> covered</h4>
    <div>
      <b>50</b> relevant lines. 
      <span class="green"><b>37</b> lines covered</span> and
      <span class="red"><b>13</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class ProjectUpdateWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"># This worker handels the period update jobs (DAILY, WEEKLY, MONTHLY)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"># And the single project updates. </code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="5">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="6">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="7">
          <span class="hits">1</span>
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="8">
          <span class="hits">1</span>
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="10">
          <span class="hits">1</span>
          
          <code class="ruby">    queue   = channel.queue(&quot;project_update&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="12">
          <span class="hits">1</span>
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="14">
          <span class="hits">1</span>
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="16">
          <span class="hits">1</span>
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="18">
          <span class="hits">5</span>
          
          <code class="ruby">        msg = &quot; [x] Received #{body}&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="19">
          <span class="hits">5</span>
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="20">
          <span class="hits">5</span>
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="22">
          <span class="hits">5</span>
          
          <code class="ruby">        process body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="24">
          <span class="hits">5</span>
          
          <code class="ruby">        msg = &quot; - job done for #{body}&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="25">
          <span class="hits">5</span>
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="26">
          <span class="hits">5</span>
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="28">
          <span class="hits">5</span>
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="30">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="34">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="38">
          <span class="hits">1</span>
          
          <code class="ruby">  def process msg</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="39">
          <span class="hits">5</span>
          
          <code class="ruby">    if msg.eql?( Project::A_PERIOD_MONTHLY ) || msg.eql?( Project::A_PERIOD_WEEKLY ) || msg.eql?( Project::A_PERIOD_DAILY )</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="40">
          
          
          <code class="ruby">      update_projects msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="41">
          
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">    elsif msg.match(/project_/)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="43">
          <span class="hits">5</span>
          
          <code class="ruby">      update_project msg</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="44">
          <span class="hits">5</span>
          
          <code class="ruby">      return</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="45">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="46">
          
          
          <code class="ruby">    log.info &quot;Nothing matched for #{msg}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="47">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="48">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="49">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="50">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="51">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="52">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="53">
          
          
          <code class="ruby">  # msg should have these values:</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="54">
          
          
          <code class="ruby">  # - Project::A_PERIOD_DAILY</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="55">
          
          
          <code class="ruby">  # - Project::A_PERIOD_WEEKLY</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="56">
          
          
          <code class="ruby">  # - Project::A_PERIOD_MONTHLY</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="57">
          
          
          <code class="ruby">  #</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="58">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_projects msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="59">
          
          
          <code class="ruby">    log.info &quot; - ProjectBatchUpdateService.update_all( #{msg} )&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="60">
          
          
          <code class="ruby">    ProjectBatchUpdateService.update_all( msg )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="61">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="62">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="63">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="64">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="65">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="66">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_project msg</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="67">
          <span class="hits">5</span>
          
          <code class="ruby">    pp  = msg.gsub(&quot;project_&quot;, &quot;&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="68">
          <span class="hits">5</span>
          
          <code class="ruby">    pps = pp.split(&quot;:::&quot;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="69">
          <span class="hits">5</span>
          
          <code class="ruby">    project_id = pps[0]</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="70">
          <span class="hits">5</span>
          
          <code class="ruby">    send_email = false </code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="71">
          <span class="hits">5</span>
          
          <code class="ruby">    send_email = true if pps[1].eql?(&#39;true&#39;)</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="72">
          <span class="hits">5</span>
          
          <code class="ruby">    project = Project.find project_id</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="73">
          <span class="hits">5</span>
          
          <code class="ruby">    log.info &quot; - ProjectUpdateService.update #{project_id}&quot;</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="74">
          <span class="hits">5</span>
          
          <code class="ruby">    ProjectUpdateService.update project, send_email</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="75">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="76">
          <span class="hits">5</span>
          
          <code class="ruby">    task_key    = &quot;task_#{project.ids}&quot;</code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="77">
          <span class="hits">1</span>
          
          <code class="ruby">    task_status = cache.set( task_key, ProjectUpdateService::A_TASK_DONE, ProjectUpdateService::A_TASK_TTL )</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="78">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="79">
          <span class="hits">4</span>
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="80">
          <span class="hits">4</span>
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="81">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="82">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="83">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="84">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="20e2e2108128c7101835128ed5119866d819b8da">
  <div class="header">
    <h3>lib/versioneye/workers/send_notification_emails_worker.rb</h3>
    <h4><span class="red">12.5 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>21</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SendNotificationEmailsWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;send_notification_emails&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">        msg = &quot; [x] Received #{body}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">        send_notification_emails body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def send_notification_emails msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    NotificationService.send_notifications</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="a22e214036e3b57d8e980508c029387eb777b3e4">
  <div class="header">
    <h3>lib/versioneye/workers/sync_worker.rb</h3>
    <h4><span class="red">11.54 %</span> covered</h4>
    <div>
      <b>26</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>23</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class SyncWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;sync_db&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, message|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">        puts &quot; [x] SyncWorker Received #{message}&quot;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="17">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">        process_work message</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="26">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="30">
          <span class="hits">1</span>
          
          <code class="ruby">  def process_work message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="31">
          
          
          <code class="ruby">    return nil if message.to_s.empty?</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="32">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    if message.match(/\Aproject\:\:/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      project_id = message.split(&quot;::&quot;)[1]</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      project = Project.find project_id</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">      SyncService.sync_project project</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    elsif message.match(/\Aall_products/)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="38">
          
          
          <code class="ruby">      SyncService.sync_all_products</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="42">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="31ee0c75abb967c62cfcabb46afa9975dd5229cf">
  <div class="header">
    <h3>lib/versioneye/workers/update_index_worker.rb</h3>
    <h4><span class="red">12.0 %</span> covered</h4>
    <div>
      <b>25</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>22</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UpdateIndexWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="3">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="4">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="8">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;update_index&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="9">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="12">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="13">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">        msg = &quot; [x] Received #{body}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="20">
          
          
          <code class="ruby">        update_index body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="21">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="27">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="31">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="32">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_index msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="33">
          
          
          <code class="ruby">    EsProduct.index_newest if msg.eql?(&quot;product&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    EsUser.reindex_all if msg.eql?(&quot;user&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="35">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="36">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="37">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="39">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="40">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="41">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="41f051870ef3fbf70e7a537fbfd24e5d25b730e3">
  <div class="header">
    <h3>lib/versioneye/workers/update_meta_data_worker.rb</h3>
    <h4><span class="red">12.5 %</span> covered</h4>
    <div>
      <b>24</b> relevant lines. 
      <span class="green"><b>3</b> lines covered</span> and
      <span class="red"><b>21</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class UpdateMetaDataWorker &lt; Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  def work</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="4">
          
          
          <code class="ruby">    connection = get_connection</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="5">
          
          
          <code class="ruby">    connection.start</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="6">
          
          
          <code class="ruby">    channel = connection.create_channel</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="7">
          
          
          <code class="ruby">    queue   = channel.queue(&quot;update_meta_data&quot;, :durable =&gt; true)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="9">
          
          
          <code class="ruby">    log_msg = &quot; [*] Waiting for messages in #{queue.name}. To exit press CTRL+C&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="10">
          
          
          <code class="ruby">    puts log_msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="11">
          
          
          <code class="ruby">    log.info log_msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="13">
          
          
          <code class="ruby">    begin</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="14">
          
          
          <code class="ruby">      queue.subscribe(:ack =&gt; true, :block =&gt; true) do |delivery_info, properties, body|</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="15">
          
          
          <code class="ruby">        msg = &quot; [x] Received #{body}&quot;</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="16">
          
          
          <code class="ruby">        puts msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="17">
          
          
          <code class="ruby">        log.info msg</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="18">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="19">
          
          
          <code class="ruby">        update_meta_data body</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="21">
          
          
          <code class="ruby">        channel.ack(delivery_info.delivery_tag)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="22">
          
          
          <code class="ruby">      end</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="23">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="24">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="25">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="26">
          
          
          <code class="ruby">      connection.close</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="29">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">  def update_meta_data msg</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="32">
          
          
          <code class="ruby">    ProductService.update_meta_data_global</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">  rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">    log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">    log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
        <div class="source_table" id="e7928aba3f99d544d09b3bfdad4e927ec89241c1">
  <div class="header">
    <h3>lib/versioneye/workers/worker.rb</h3>
    <h4><span class="red">78.95 %</span> covered</h4>
    <div>
      <b>19</b> relevant lines. 
      <span class="green"><b>15</b> lines covered</span> and
      <span class="red"><b>4</b> lines missed.</span>
    </div>
  </div>
  
  <pre>
    <ol>
      
        <li class="covered" data-hits="1" data-linenumber="1">
          <span class="hits">1</span>
          
          <code class="ruby">class Worker</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="2">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="3">
          <span class="hits">1</span>
          
          <code class="ruby">  require &#39;bunny&#39;</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="4">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="5">
          <span class="hits">1</span>
          
          <code class="ruby">  def get_connection</code>
        </li>
      
        <li class="covered" data-hits="7" data-linenumber="6">
          <span class="hits">7</span>
          
          <code class="ruby">    Bunny.new(&quot;amqp://#{Settings.instance.rabbitmq_addr}:#{Settings.instance.rabbitmq_port}&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="7">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="8">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="9">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.log</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="10">
          <span class="hits">40</span>
          
          <code class="ruby">    ActiveSupport::Logger.new(&#39;log/worker.log&#39;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="11">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="12">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="13">
          <span class="hits">1</span>
          
          <code class="ruby">  def log</code>
        </li>
      
        <li class="covered" data-hits="40" data-linenumber="14">
          <span class="hits">40</span>
          
          <code class="ruby">    Worker.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="15">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="16">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="17">
          <span class="hits">1</span>
          
          <code class="ruby">  def logger</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="18">
          
          
          <code class="ruby">    Worker.log</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="19">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="20">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="21">
          <span class="hits">1</span>
          
          <code class="ruby">  def self.cache</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="22">
          
          
          <code class="ruby">    Versioneye::Cache.instance.mc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="23">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="24">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="25">
          <span class="hits">1</span>
          
          <code class="ruby">  def cache</code>
        </li>
      
        <li class="covered" data-hits="5" data-linenumber="26">
          <span class="hits">5</span>
          
          <code class="ruby">    Versioneye::Cache.instance.mc</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="27">
          
          
          <code class="ruby">  end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="28">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="29">
          <span class="hits">1</span>
          
          <code class="ruby">  private</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="30">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="covered" data-hits="1" data-linenumber="31">
          <span class="hits">1</span>
          
          <code class="ruby">    def reload_settings</code>
        </li>
      
        <li class="covered" data-hits="4" data-linenumber="32">
          <span class="hits">4</span>
          
          <code class="ruby">      Settings.instance.reload_from_db GlobalSetting.new</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="33">
          
          
          <code class="ruby">    rescue =&gt; e</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="34">
          
          
          <code class="ruby">      log.error e.message</code>
        </li>
      
        <li class="missed" data-hits="0" data-linenumber="35">
          
          
          <code class="ruby">      log.error e.backtrace.join(&quot;\n&quot;)</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="36">
          
          
          <code class="ruby">    end</code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="37">
          
          
          <code class="ruby"></code>
        </li>
      
        <li class="never" data-hits="" data-linenumber="38">
          
          
          <code class="ruby">end</code>
        </li>
      
    </ol>
  </pre>
</div>
      
      </div>
    </div>
  </body>
</html>
